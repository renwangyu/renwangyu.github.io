{"version":3,"sources":["../node_modules/@babel/runtime/helpers/esm/arrayLikeToArray.js","../node_modules/@babel/runtime/helpers/esm/slicedToArray.js","../node_modules/@babel/runtime/helpers/esm/arrayWithHoles.js","../node_modules/@babel/runtime/helpers/esm/iterableToArrayLimit.js","../node_modules/@babel/runtime/helpers/esm/unsupportedIterableToArray.js","../node_modules/@babel/runtime/helpers/esm/nonIterableRest.js","../node_modules/@babel/runtime/helpers/esm/classCallCheck.js","../node_modules/@babel/runtime/helpers/esm/createClass.js","../node_modules/three/three.js"],"names":["_arrayLikeToArray","arr","len","length","i","arr2","Array","_slicedToArray","isArray","Symbol","iterator","Object","_arr","_n","_d","_e","undefined","_s","_i","next","done","push","value","err","o","minLen","n","prototype","toString","call","slice","constructor","name","from","test","TypeError","_classCallCheck","instance","Constructor","_defineProperties","target","props","descriptor","enumerable","configurable","writable","defineProperty","key","_createClass","protoProps","staticProps","THREE","REVISION","define","Number","EPSILON","Math","pow","sign","x","Function","get","this","match","assign","output","index","arguments","source","nextKey","hasOwnProperty","MOUSE","LEFT","MIDDLE","RIGHT","CullFaceNone","CullFaceBack","CullFaceFront","CullFaceFrontBack","FrontFaceDirectionCW","FrontFaceDirectionCCW","BasicShadowMap","PCFShadowMap","PCFSoftShadowMap","FrontSide","BackSide","DoubleSide","FlatShading","SmoothShading","NoColors","FaceColors","VertexColors","NoBlending","NormalBlending","AdditiveBlending","SubtractiveBlending","MultiplyBlending","CustomBlending","AddEquation","SubtractEquation","ReverseSubtractEquation","MinEquation","MaxEquation","ZeroFactor","OneFactor","SrcColorFactor","OneMinusSrcColorFactor","SrcAlphaFactor","OneMinusSrcAlphaFactor","DstAlphaFactor","OneMinusDstAlphaFactor","DstColorFactor","OneMinusDstColorFactor","SrcAlphaSaturateFactor","NeverDepth","AlwaysDepth","LessDepth","LessEqualDepth","EqualDepth","GreaterEqualDepth","GreaterDepth","NotEqualDepth","MultiplyOperation","MixOperation","AddOperation","NoToneMapping","LinearToneMapping","ReinhardToneMapping","Uncharted2ToneMapping","CineonToneMapping","UVMapping","CubeReflectionMapping","CubeRefractionMapping","EquirectangularReflectionMapping","EquirectangularRefractionMapping","SphericalReflectionMapping","CubeUVReflectionMapping","CubeUVRefractionMapping","RepeatWrapping","ClampToEdgeWrapping","MirroredRepeatWrapping","NearestFilter","NearestMipMapNearestFilter","NearestMipMapLinearFilter","LinearFilter","LinearMipMapNearestFilter","LinearMipMapLinearFilter","UnsignedByteType","ByteType","ShortType","UnsignedShortType","IntType","UnsignedIntType","FloatType","HalfFloatType","UnsignedShort4444Type","UnsignedShort5551Type","UnsignedShort565Type","AlphaFormat","RGBFormat","RGBAFormat","LuminanceFormat","LuminanceAlphaFormat","RGBEFormat","DepthFormat","RGB_S3TC_DXT1_Format","RGBA_S3TC_DXT1_Format","RGBA_S3TC_DXT3_Format","RGBA_S3TC_DXT5_Format","RGB_PVRTC_4BPPV1_Format","RGB_PVRTC_2BPPV1_Format","RGBA_PVRTC_4BPPV1_Format","RGBA_PVRTC_2BPPV1_Format","RGB_ETC1_Format","LoopOnce","LoopRepeat","LoopPingPong","InterpolateDiscrete","InterpolateLinear","InterpolateSmooth","ZeroCurvatureEnding","ZeroSlopeEnding","WrapAroundEnding","TrianglesDrawMode","TriangleStripDrawMode","TriangleFanDrawMode","LinearEncoding","sRGBEncoding","GammaEncoding","RGBEEncoding","LogLuvEncoding","RGBM7Encoding","RGBM16Encoding","RGBDEncoding","BasicDepthPacking","RGBADepthPacking","Color","r","g","b","set","setRGB","copy","setHex","setStyle","setScalar","scalar","hex","floor","setHSL","hue2rgb","p","q","t","h","s","l","euclideanModulo","clamp","style","handleAlpha","string","parseFloat","console","warn","m","exec","color","components","min","parseInt","size","charAt","ColorKeywords","clone","copyGammaToLinear","gammaFactor","copyLinearToGamma","safeInverse","convertGammaToLinear","convertLinearToGamma","sqrt","getHex","getHexString","getHSL","optionalTarget","hue","saturation","hsl","max","lightness","delta","getStyle","offsetHSL","add","addColors","color1","color2","addScalar","multiply","multiplyScalar","lerp","alpha","equals","c","fromArray","array","offset","toArray","Quaternion","y","z","w","_x","_y","_z","_w","onChangeCallback","quaternion","setFromEuler","euler","update","Euler","Error","c1","cos","c2","c3","s1","sin","s2","s3","order","setFromAxisAngle","axis","angle","halfAngle","setFromRotationMatrix","te","elements","m11","m12","m13","m21","m22","m23","m31","m32","m33","trace","setFromUnitVectors","v1","vFrom","vTo","Vector3","dot","abs","crossVectors","normalize","inverse","conjugate","v","lengthSq","multiplyQuaternions","premultiply","a","qax","qay","qaz","qaw","qbx","qby","qbz","qbw","slerp","qb","cosHalfTheta","sinHalfTheta","halfTheta","atan2","ratioA","ratioB","onChange","callback","qa","qm","slerpFlat","dst","dstOffset","src0","srcOffset0","src1","srcOffset1","x0","y0","z0","w0","x1","y1","z1","w1","dir","sqrSin","tDir","f","Vector2","setX","setY","setComponent","getComponent","addVectors","addScaledVector","sub","subVectors","subScalar","isFinite","divide","divideScalar","clampScalar","minVal","maxVal","clampLength","ceil","round","roundToZero","negate","lengthManhattan","PI","distanceTo","distanceToSquared","dx","dy","setLength","lerpVectors","v2","fromAttribute","attribute","itemSize","rotateAround","center","setZ","multiplyVectors","applyEuler","error","applyQuaternion","applyAxisAngle","applyMatrix3","e","applyMatrix4","applyProjection","d","qx","qy","qz","qw","ix","iy","iz","iw","project","matrix","camera","Matrix4","multiplyMatrices","projectionMatrix","getInverse","matrixWorld","unproject","transformDirection","cross","ax","ay","az","bx","by","bz","projectOnVector","vector","projectOnPlane","planeNormal","reflect","normal","angleTo","theta","acos","dz","setFromSpherical","sinPhiRadius","phi","radius","setFromMatrixPosition","setFromMatrixColumn","setFromMatrixScale","sx","sy","sz","temp","Vector4","setW","setAxisAngleFromQuaternion","setAxisAngleFromRotationMatrix","xx","yy","zz","xy","xz","yz","_order","DefaultOrder","RotationOrders","asin","setFromQuaternion","makeRotationFromQuaternion","setFromVector3","reorder","newOrder","toVector3","optionalResult","Line3","start","end","line","distanceSq","distance","at","result","closestPointToPointParameter","startP","startEnd","point","clampToLine","startEnd2","closestPointToPoint","Box2","Infinity","setFromPoints","points","makeEmpty","il","expandByPoint","setFromCenterAndSize","halfSize","box","isEmpty","expandByVector","expandByScalar","containsPoint","containsBox","getParameter","intersectsBox","clampPoint","distanceToPoint","intersect","union","translate","Box3","setFromArray","minX","minY","minZ","maxX","maxY","maxZ","setFromObject","object","scope","updateMatrixWorld","traverse","node","geometry","Geometry","vertices","BufferGeometry","attributes","positions","intersectsSphere","closestPoint","sphere","intersectsPlane","plane","constant","getBoundingSphere","Sphere","Matrix3","Float32Array","n11","n12","n13","n21","n22","n23","n31","n32","n33","identity","me","setFromMatrix4","applyToVector3Array","j","applyToBuffer","buffer","getX","getY","getZ","setXYZ","determinant","throwOnDegenerate","t11","t12","t13","det","msg","detInv","transpose","tmp","flattenToArrayOffset","getNormalMatrix","matrix4","transposeIntoArray","n14","n24","n34","n41","n42","n43","n44","copyPosition","extractBasis","xAxis","yAxis","zAxis","makeBasis","extractRotation","scaleX","scaleY","scaleZ","makeRotationFromEuler","ae","af","be","bf","ce","cf","de","df","ac","ad","bc","bd","x2","y2","z2","wx","wy","wz","lookAt","eye","up","a11","a12","a13","a14","a21","a22","a23","a24","a31","a32","a33","a34","a41","a42","a43","a44","b11","b12","b13","b14","b21","b22","b23","b24","b31","b32","b33","b34","b41","b42","b43","b44","multiplyToArray","getPosition","setPosition","t14","scale","getMaxScaleOnAxis","scaleXSq","scaleYSq","scaleZSq","makeTranslation","makeRotationX","makeRotationY","makeRotationZ","makeRotationAxis","tx","ty","makeScale","compose","position","decompose","invSX","invSY","invSZ","makeFrustum","left","right","bottom","top","near","far","makePerspective","fov","aspect","ymax","tan","DEG2RAD","ymin","xmin","xmax","makeOrthographic","Ray","origin","direction","ray","recast","directionDistance","distanceSqToPoint","distanceSqToSegment","segCenter","segDir","diff","v0","optionalPointOnRay","optionalPointOnSegment","s0","sqrDist","extDet","segExtent","a01","b0","b1","invDet","intersectSphere","tca","d2","radius2","thc","t0","t1","distanceToPlane","denominator","intersectPlane","distToPoint","intersectBox","tmin","tmax","tymin","tymax","tzmin","tzmax","invdirx","invdiry","invdirz","intersectTriangle","edge1","edge2","backfaceCulling","DdN","DdQxE2","DdE1xQ","QdN","optionalCenter","maxRadiusSq","empty","radiusSum","deltaLengthSq","getBoundingBox","Frustum","p0","p1","p2","p3","p4","p5","planes","Plane","frustum","setFromMatrix","me0","me1","me2","me3","me4","me5","me6","me7","me8","me9","me10","me11","me12","me13","me14","me15","setComponents","intersectsObject","boundingSphere","computeBoundingSphere","intersectsSprite","sprite","negRadius","d1","setFromNormalAndCoplanarPoint","setFromCoplanarPoints","inverseNormalLength","distanceToSphere","projectPoint","orthoPoint","perpendicularMagnitude","intersectLine","intersectsLine","startSign","endSign","coplanarPoint","m1","optionalNormalMatrix","referencePoint","normalMatrix","Spherical","other","makeSafe","vec3","RAD2DEG","generateUUID","chars","split","uuid","rnd","random","join","mapLinear","a1","a2","b2","smoothstep","smootherstep","random16","randInt","low","high","randFloat","randFloatSpread","range","degToRad","degrees","radToDeg","radians","isPowerOfTwo","nearestPowerOfTwo","log","LN2","nextPowerOfTwo","Spline","intPoint","weight","w2","w3","pa","pb","pc","pd","v3","interpolate","t2","t3","initFromArray","getPoint","k","getControlPointsArray","coords","getLength","nSubDivisions","nSamples","oldIntPoint","oldPosition","tmpVec","chunkLengths","totalLength","chunks","total","reparametrizeByArcLength","samplingCoef","indexCurrent","indexNext","realDistance","sampling","newpoints","sl","Triangle","resultLengthSq","barycoordFromPoint","dot00","dot01","dot02","dot11","dot12","denom","invDenom","u","setFromPointsAndIndices","i0","i1","i2","triangle","area","midpoint","edgeList","projectedPoint","minDistance","Interpolant","parameterPositions","sampleValues","sampleSize","resultBuffer","_cachedIndex","valueSize","evaluate","pp","validate_interval","seek","linear_scan","forward_scan","giveUpAt","afterEnd_","t1global","beforeStart_","mid","intervalChanged_","interpolate_","settings","DefaultSettings_","getSettings_","copySampleValue_","values","stride","CubicInterpolant","_weightPrev","_offsetPrev","_weightNext","_offsetNext","create","endingStart","endingEnd","iPrev","iNext","tPrev","tNext","halfDt","o1","o0","oP","oN","wP","wN","ppp","sP","sN","DiscreteInterpolant","LinearInterpolant","offset1","offset0","weight1","weight0","QuaternionLinearInterpolant","Clock","autoStart","startTime","oldTime","elapsedTime","running","performance","Date","now","stop","getElapsedTime","getDelta","newTime","EventDispatcher","addEventListener","type","listener","_listeners","listeners","indexOf","hasEventListener","removeEventListener","listenerArray","splice","dispatchEvent","event","Layers","mask","channel","enable","toggle","disable","layers","ascSort","intersectObject","raycaster","intersects","recursive","visible","raycast","children","Raycaster","params","Mesh","Line","LOD","Points","threshold","Sprite","defineProperties","PointCloud","linePrecision","setFromCamera","PerspectiveCamera","OrthographicCamera","sort","intersectObjects","objects","Object3D","Object3DIdCount","parent","DefaultUp","rotation","modelViewMatrix","matrixAutoUpdate","DefaultMatrixAutoUpdate","matrixWorldNeedsUpdate","castShadow","receiveShadow","frustumCulled","renderOrder","userData","applyMatrix","setRotationFromAxisAngle","setRotationFromEuler","setRotationFromMatrix","setRotationFromQuaternion","rotateOnAxis","q1","rotateX","rotateY","rotateZ","translateOnAxis","translateX","translateY","translateZ","localToWorld","worldToLocal","remove","getObjectById","id","getObjectByProperty","getObjectByName","getWorldPosition","getWorldQuaternion","getWorldRotation","getWorldScale","getWorldDirection","traverseVisible","traverseAncestors","updateMatrix","force","toJSON","meta","isRootObject","geometries","materials","textures","images","metadata","version","generator","JSON","stringify","material","extractFromCache","cache","data","parse","child","Face3","materialIndex","vertexNormals","vertexColors","BufferAttribute","normalized","dynamic","updateRange","count","setDynamic","copyAt","index1","index2","copyArray","copyColorsArray","colors","copyIndicesArray","indices","copyVector2sArray","vectors","copyVector3sArray","copyVector4sArray","getW","setXY","setXYZW","Int8Attribute","Int8Array","Uint8Attribute","Uint8Array","Uint8ClampedAttribute","Uint8ClampedArray","Int16Attribute","Int16Array","Uint16Attribute","Uint16Array","Int32Attribute","Int32Array","Uint32Attribute","Uint32Array","Float32Attribute","Float64Attribute","Float64Array","DynamicBufferAttribute","InstancedBufferAttribute","meshPerAttribute","InterleavedBuffer","InstancedInterleavedBuffer","InterleavedBufferAttribute","interleavedBuffer","GeometryIdCount","faces","faceVertexUvs","morphTargets","morphNormals","skinWeights","skinIndices","lineDistances","boundingBox","verticesNeedUpdate","elementsNeedUpdate","uvsNeedUpdate","normalsNeedUpdate","colorsNeedUpdate","lineDistancesNeedUpdate","groupsNeedUpdate","face","jl","computeBoundingBox","obj","fromBufferGeometry","normals","uvs","uv","uvs2","uv2","tempNormals","tempUVs","tempUVs2","addFace","groups","group","computeFaceNormals","cb","ab","fl","vA","vB","vC","computeVertexNormals","areaWeighted","vl","computeMorphNormals","__originalFaceNormal","__originalVertexNormals","tmpGeo","faceNormals","dstNormalsFace","dstNormalsVertex","faceNormal","computeTangents","computeLineDistances","merge","materialIndexOffset","vertexOffset","vertices1","vertices2","faces1","faces2","uvs1","vertexCopy","faceCopy","faceVertexNormals","faceVertexColors","uvCopy","mergeMesh","mesh","mergeVertices","verticesMap","unique","changes","precision","faceIndicesToRemove","idx","sortFacesByMaterialIndex","_id","newUvs1","newUvs2","parameters","vertex","normalsHash","colorsHash","uvsHash","hasFaceVertexUv","hasFaceNormal","hasFaceVertexNormal","hasFaceColor","hasFaceVertexColor","faceType","setBit","getUvIndex","getNormalIndex","getColorIndex","enabled","hash","uvsCopy","kl","dispose","DirectGeometry","computeGroups","fromGeometry","morphTargetsPosition","hasFaceVertexUv2","morphTargetsLength","morphTargetsNormal","morphNormalsLength","hasSkinIndices","hasSkinWeights","vertexUvs","morphTarget","morphNormal","morphAttributes","drawRange","getIndex","setIndex","addAttribute","getAttribute","removeAttribute","addGroup","clearGroups","setDrawRange","needsUpdate","updateFromObject","direct","__directGeometry","lineDistance","fromDirectGeometry","isNaN","pA","pB","pC","normalizeNormals","attributeArray1","attribute2","attributeArray2","toNonIndexed","geometry2","array2","MaxIndex","InstancedBufferGeometry","maxInstancedCount","instances","Uniform","onUpdate","onUpdateCallback","AnimationAction","_new","mixer","clip","localRoot","_mixer","_clip","_localRoot","tracks","nTracks","interpolants","interpolantSettings","interpolant","createInterpolant","_interpolantSettings","_interpolants","_propertyBindings","_cacheIndex","_byClipCacheIndex","_timeScaleInterpolant","_weightInterpolant","loop","_loopCount","_startTime","time","timeScale","_effectiveTimeScale","_effectiveWeight","repetitions","paused","clampWhenFinished","zeroSlopeAtStart","zeroSlopeAtEnd","play","_activateAction","_deactivateAction","reset","stopFading","stopWarping","isRunning","_isActiveAction","isScheduled","startAt","setLoop","mode","setEffectiveWeight","getEffectiveWeight","fadeIn","duration","_scheduleFading","fadeOut","crossFadeFrom","fadeOutAction","warp","fadeInDuration","fadeOutDuration","startEndRatio","endStartRatio","crossFadeTo","fadeInAction","weightInterpolant","_takeBackControlInterpolant","setEffectiveTimeScale","getEffectiveTimeScale","setDuration","syncWith","action","halt","startTimeScale","endTimeScale","_lendControlInterpolant","times","timeScaleInterpolant","getMixer","getClip","getRoot","_root","_update","deltaTime","timeDirection","accuIndex","timeRunning","_updateTimeScale","clipTime","_updateTime","_updateWeight","propertyMixers","accumulate","interpolantValue","loopCount","_setEndings","handle_stop","pingPong","loopDelta","pending","atStart","atEnd","weightNow","weightThen","AnimationClip","resetDuration","trim","optimize","track","json","jsonTracks","frameTime","fps","KeyframeTrack","clipTracks","CreateFromMorphTargetSequence","morphTargetSequence","noLoop","numMorphTargets","AnimationUtils","getKeyframeOrder","sortedArray","NumberKeyframeTrack","findByName","objectOrClipArray","clipArray","animations","CreateClipsFromMorphTargetSequences","animationToMorphTargets","pattern","parts","animationMorphTargets","clips","parseAnimation","animation","bones","nodeName","addNonemptyTrack","trackType","trackName","animationKeys","propertyName","destTracks","flattenJSON","clipName","hierarchyTracks","hierarchy","keys","morphTargetNames","morphTargetName","animationKey","boneName","VectorKeyframeTrack","QuaternionKeyframeTrack","AnimationMixer","root","_initMemoryManager","_accuIndex","clipAction","optionalRoot","rootUuid","clipObject","clipUuid","actionsForClip","_actionsByClip","prototypeAction","existingAction","actionByRoot","knownActions","newAction","_Action","_bindAction","_addInactiveAction","stopAllAction","actions","_actions","nActions","_nActiveActions","bindings","_bindings","nBindings","_nActiveBindings","useCount","apply","uncacheClip","actionsByClip","actionsToRemove","cacheIndex","lastInactiveAction","pop","_removeInactiveBindingsForAction","uncacheRoot","_removeInactiveAction","bindingByName","_bindingsByRootAndName","binding","restoreOriginalState","_removeInactiveBinding","uncacheAction","bindingsByRoot","bindingsByName","referenceCount","_addInactiveBinding","path","parsedPath","PropertyMixer","PropertyBinding","ValueTypeName","getValueSize","_lendBinding","saveOriginalState","_lendAction","_takeBackBinding","_takeBackAction","_controlInterpolants","_nActiveControlInterpolants","stats","controlInterpolants","knownActionsForClip","lastKnownAction","byClipCacheIndex","prevIndex","lastActiveIndex","firstInactiveAction","firstInactiveIndex","lastActiveAction","propBinding","rootNode","lastInactiveBinding","remove_empty_map","_","firstInactiveBinding","lastActiveBinding","_controlInterpolantsResultBuffer","__cacheIndex","lastActiveInterpolant","AnimationObjectGroup","var_args","_objects","nCachedObjects_","_indicesByUUID","_paths","_parsedPaths","_bindingsIndicesByPath","nObjects","nCachedObjects","indicesByUUID","paths","parsedPaths","knownObject","firstActiveIndex","lastCachedObject","bindingsForPath","lastCached","lastCachedIndex","firstActiveObject","firstActive","uncache","lastObject","lastIndex","last","subscribe_","indicesByPath","unsubscribe_","lastBindingsIndex","lastBindings","arraySlice","to","isTypedArray","subarray","convertArray","forceClone","BYTES_PER_ELEMENT","ArrayBuffer","isView","DataView","nValues","srcOffset","jsonKeys","valuePropertyName","interpolation","TimeBufferType","ValueBufferType","setInterpolation","DefaultInterpolation","validate","InterpolantFactoryMethodDiscrete","InterpolantFactoryMethodLinear","InterpolantFactoryMethodSmooth","factoryMethod","message","getInterpolation","shift","timeOffset","endTime","nKeys","valid","prevTime","currTime","writeIndex","keep","offsetP","offsetN","readOffset","writeOffset","_getTrackTypeForValueTypeName","typeName","toLowerCase","ColorKeyframeTrack","BooleanKeyframeTrack","StringKeyframeTrack","parseTrackName","findNode","getValue","targetArray","bind","setValue","sourceArray","targetObject","objectName","propertyIndex","_getValue_unavailable","_setValue_unavailable","objectIndex","skeleton","nodeProperty","versioning","Versioning","None","NeedsUpdate","MatrixWorldNeedsUpdate","bindingType","BindingType","Direct","ArrayElement","resolvedProperty","HasFromToArray","EntireArray","GetterByBindingType","SetterByBindingTypeAndVersioning","unbind","_getValue_unbound","_setValue_unbound","dest","Composite","targetGroup","optionalParsedPath","_targetGroup","firstValidIndex","re","matches","results","bone","searchSkeleton","subTreeNode","searchNodeSubtree","childNode","mixFunction","bufferType","_slerp","_select","_lerp","_mixBufferRegion","cumulativeWeight","currentWeight","mix","originalValueOffset","Audio","context","createBufferSource","onended","onEnded","gain","createGain","connect","getInput","autoplay","playbackRate","isPlaying","hasPlaybackControl","sourceType","filters","getOutput","setNodeSource","audioNode","setBuffer","audioBuffer","pause","currentTime","disconnect","getFilters","setFilters","getFilter","setFilter","filter","setPlaybackRate","getPlaybackRate","getLoop","getVolume","setVolume","AudioAnalyser","audio","fftSize","analyser","createAnalyser","frequencyBinCount","getFrequencyData","getByteFrequencyData","getAverageFrequency","window","AudioContext","webkitAudioContext","PositionalAudio","panner","createPanner","getRefDistance","refDistance","setRefDistance","getRolloffFactor","rolloffFactor","setRolloffFactor","getDistanceModel","distanceModel","setDistanceModel","getMaxDistance","maxDistance","setMaxDistance","AudioListener","destination","removeFilter","getMasterVolume","setMasterVolume","orientation","setOrientation","Camera","matrixWorldInverse","CubeCamera","cubeResolution","cameraPX","cameraNX","cameraPY","cameraNY","cameraPZ","cameraNZ","options","format","magFilter","minFilter","renderTarget","WebGLRenderTargetCube","updateCubeMap","renderer","scene","generateMipmaps","texture","activeCubeFace","render","setRenderTarget","zoom","updateProjectionMatrix","cx","cy","focus","view","filmGauge","filmOffset","setFocalLength","focalLength","vExtentSlope","getFilmHeight","atan","getFocalLength","getEffectiveFOV","getFilmWidth","setViewOffset","fullWidth","fullHeight","width","height","offsetX","offsetY","clearViewOffset","skew","StereoCamera","cameraL","cameraR","eyeRight","eyeLeft","eyeSepOnProjection","Light","intensity","groundColor","decay","penumbra","LightShadow","bias","mapSize","map","AmbientLight","DirectionalLight","shadow","DirectionalLightShadow","light","HemisphereLight","skyColor","PointLight","power","SpotLight","SpotLightShadow","AudioLoader","manager","DefaultLoadingManager","load","url","onLoad","onProgress","onError","loader","XHRLoader","setResponseType","decodeAudioData","Cache","files","file","clear","Loader","onLoadStart","onLoadProgress","onLoadComplete","crossOrigin","extractUrlBase","initMaterials","texturePath","createMaterial","textureLoader","materialLoader","TextureLoader","MaterialLoader","loadTexture","repeat","wrap","anisotropy","fullPath","Handlers","setCrossOrigin","wrapS","wrapT","blending","specular","emissive","shininess","mapDiffuseRepeat","mapDiffuseOffset","mapDiffuseWrap","mapDiffuseAnisotropy","lightMap","mapLightRepeat","mapLightOffset","mapLightWrap","mapLightAnisotropy","aoMap","mapAORepeat","mapAOOffset","mapAOWrap","mapAOAnisotropy","bumpMap","mapBumpRepeat","mapBumpOffset","mapBumpWrap","mapBumpAnisotropy","bumpScale","normalMap","mapNormalRepeat","mapNormalOffset","mapNormalWrap","mapNormalAnisotropy","normalScale","specularMap","mapSpecularRepeat","mapSpecularOffset","mapSpecularWrap","mapSpecularAnisotropy","alphaMap","mapAlphaRepeat","mapAlphaOffset","mapAlphaWrap","mapAlphaAnisotropy","side","opacity","transparent","setTextures","handlers","regex","cached","setTimeout","request","XMLHttpRequest","overrideMimeType","open","response","status","itemEnd","itemError","responseType","withCredentials","send","itemStart","setPath","setWithCredentials","FontLoader","text","substring","font","Font","ImageLoader","image","document","createElement","src","JSONLoader","_statusDomElement","setTexturePath","isBitSet","fi","zLength","colorIndex","normalIndex","uvIndex","isQuad","hasMaterial","faceA","faceB","uvLayer","nUvLayers","parseModel","influencesPerVertex","parseSkin","dstVertices","srcVertices","morphColors","parseMorphing","outputAnimations","concat","morphAnimationClips","parseAnimations","LoadingManager","isLoading","itemsLoaded","itemsTotal","onStart","BufferGeometryLoader","TYPED_ARRAYS","typedArray","drawcalls","offsets","getTexture","roughness","metalness","uniforms","vertexShader","fragmentShader","shading","alphaTest","depthTest","depthWrite","colorWrite","wireframe","wireframeLinewidth","sizeAttenuation","displacementMap","displacementScale","displacementBias","roughnessMap","metalnessMap","emissiveMap","emissiveIntensity","envMap","combine","reflectivity","lightMapIntensity","aoMapIntensity","ObjectLoader","lastIndexOf","parseGeometries","parseImages","parseTextures","parseMaterials","parseObject","geometryLoader","bufferGeometryLoader","widthSegments","heightSegments","depth","depthSegments","segments","thetaStart","thetaLength","radiusTop","radiusBottom","radialSegments","openEnded","phiStart","phiLength","detail","innerRadius","outerRadius","thetaSegments","phiSegments","tube","tubularSegments","arc","loadImage","parseConstant","Texture","mapping","getGeometry","getMaterial","Scene","SkinnedMesh","Group","levels","level","addLevel","CubeTextureLoader","urls","CubeTexture","loaded","DataTextureLoader","BinaryTextureLoader","_parser","DataTexture","texData","mipmaps","mipmapCount","CompressedTextureLoader","CompressedTexture","texDatas","isCubemap","Material","MaterialIdCount","fog","lights","blendSrc","blendDst","blendEquation","blendSrcAlpha","blendDstAlpha","blendEquationAlpha","depthFunc","clippingPlanes","clipShadows","polygonOffset","polygonOffsetFactor","polygonOffsetUnits","premultipliedAlpha","overdraw","_needsUpdate","setValues","newValue","currentValue","isRoot","srcPlanes","dstPlanes","LineBasicMaterial","linewidth","linecap","linejoin","LineDashedMaterial","dashSize","gapSize","MeshBasicMaterial","refractionRatio","wireframeLinecap","wireframeLinejoin","skinning","MeshDepthMaterial","depthPacking","MeshLambertMaterial","MeshNormalMaterial","MeshPhongMaterial","MeshStandardMaterial","defines","envMapIntensity","MeshPhysicalMaterial","MultiMaterial","PointsMaterial","ShaderMaterial","clipping","extensions","derivatives","fragDepth","drawBuffers","shaderTextureLOD","defaultAttributeValues","index0AttributeName","UniformsUtils","RawShaderMaterial","SpriteMaterial","ShadowMaterial","UniformsLib","ShaderChunk","encoding","TextureIdCount","sourceFile","DEFAULT_IMAGE","DEFAULT_MAPPING","premultiplyAlpha","flipY","unpackAlignment","canvas","toDataURL","getContext","drawImage","getDataURL","transformUv","DepthTexture","CanvasTexture","VideoTexture","video","requestAnimationFrame","readyState","HAVE_CURRENT_DATA","inverseMatrix","localThreshold","localThresholdSq","testPoint","rayPointDistanceSq","intersectPoint","distanceToRay","LineSegments","precisionSq","vStart","vEnd","interSegment","interRay","step","faceIndex","nbVertices","drawMode","updateMorphTargets","setDrawMode","morphTargetBase","morphTargetInfluences","morphTargetDictionary","ml","getMorphTargetIndexByName","tempA","tempB","tempC","uvA","uvB","uvC","barycoord","intersectionPoint","intersectionPointWorld","uvIntersection","uv1","uv3","checkIntersection","checkBufferGeometryIntersection","intersection","fvA","fvB","fvC","isFaceMaterial","faceMaterial","morphInfluences","tl","influence","targets","uvs_f","Bone","skin","Skeleton","boneInverses","useVertexTexture","identityMatrix","boneTextureWidth","boneTextureHeight","boneMatrices","boneTexture","calculateInverses","bl","pose","offsetMatrix","bindMode","bindMatrix","bindMatrixInverse","gbone","pos","rotq","scl","normalizeSkinWeights","sw","vec","skinWeight","getObjectForDistance","matrixPosition","LensFlare","lensFlares","positionScreen","customUpdateCallback","updateLensFlares","flare","vecX","vecY","wantedRotation","overrideMaterial","autoUpdate","Fog","FogExp2","density","merged","uniforms_src","uniforms_dst","parameter_src","common","aomap","lightmap","emissivemap","bumpmap","normalmap","displacementmap","roughnessmap","metalnessmap","properties","ShaderLib","WebGLRenderer","_canvas","_context","_alpha","_depth","_stencil","stencil","_antialias","antialias","_premultipliedAlpha","_preserveDrawingBuffer","preserveDrawingBuffer","opaqueObjects","opaqueObjectsLastIndex","transparentObjects","transparentObjectsLastIndex","sprites","domElement","autoClear","autoClearColor","autoClearDepth","autoClearStencil","sortObjects","localClippingEnabled","gammaInput","gammaOutput","physicallyCorrectLights","toneMapping","toneMappingExposure","toneMappingWhitePoint","maxMorphTargets","maxMorphNormals","autoScaleCubemaps","_gl","_this","_currentProgram","_currentRenderTarget","_currentFramebuffer","_currentMaterialId","_currentGeometryProgram","_currentCamera","_currentScissor","_currentScissorTest","_currentViewport","_usedTextureUnits","_clearColor","_clearAlpha","_width","_height","_pixelRatio","_scissor","_scissorTest","_viewport","_frustum","_clipping","WebGLClipping","_clippingEnabled","_localClippingEnabled","_sphere","_projScreenMatrix","_vector3","_lights","ambient","directional","directionalShadowMap","directionalShadowMatrix","spot","spotShadowMap","spotShadowMatrix","pointShadowMap","pointShadowMatrix","hemi","shadows","_infoMemory","_infoRender","calls","info","memory","programs","getShaderPrecisionFormat","onContextLost","_isWebGL2","WebGL2RenderingContext","WebGLExtensions","capabilities","WebGLCapabilities","state","WebGLState","paramThreeToGL","WebGLProperties","WebGLObjects","programCache","WebGLPrograms","lightCache","WebGLLights","bufferRenderer","WebGLBufferRenderer","indexedBufferRenderer","WebGLIndexedBufferRenderer","getTargetPixelRatio","glClearColor","clearColor","setDefaultGLState","init","scissor","viewport","resetGLState","shadowMap","WebGLShadowMap","spritePlugin","SpritePlugin","lensFlarePlugin","LensFlarePlugin","preventDefault","onTextureDispose","textureProperties","__image__webglTextureCube","deleteTexture","__webglInit","__webglTexture","delete","deallocateTexture","onRenderTargetDispose","renderTargetProperties","depthTexture","deleteFramebuffer","__webglFramebuffer","__webglDepthbuffer","deleteRenderbuffer","deallocateRenderTarget","onMaterialDispose","releaseMaterialProgramReference","deallocateMaterial","programInfo","program","releaseProgram","absNumericalSort","painterSortStable","reversePainterSortStable","pushRenderItem","renderItem","isSphereViewable","numPlanes","negRad","renderObjects","renderList","ImmediateRenderObject","setMaterial","setProgram","renderBufferImmediate","renderBufferDirect","CULL_FACE","setFlipSided","setBlending","setDepthFunc","setDepthTest","setDepthWrite","setColorWrite","setPolygonOffset","materialProperties","useCache","setState","numClippingPlanes","lightsHash","getParameters","code","getProgramCode","programChange","shaderID","shader","__webglShader","acquireProgram","getAttributes","numSupportedMorphTargets","numSupportedMorphNormals","uniform","ambientLightColor","directionalLights","spotLights","pointLights","hemisphereLights","progUniforms","getUniforms","uniformsList","WebGLUniforms","seqWithValue","seq","dynamicUniforms","splitDynamic","initMaterial","refreshProgram","refreshMaterial","refreshLights","p_uniforms","m_uniforms","useProgram","logarithmicDepthBuffer","uCamPos","cameraPosition","setOptional","floatVertexTextures","fogColor","fogNear","fogFar","fogDensity","refreshUniformsFog","diffuse","uvScaleMap","WebGLRenderTarget","offsetRepeat","flipEnvMap","refreshUniformsCommon","refreshUniformsLine","totalSize","refreshUniformsDash","clientHeight","refreshUniformsPoints","refreshUniformsLambert","refreshUniformsPhong","refreshUniformsStandard","refreshUniformsPhysical","upload","dynUniforms","evalDynamic","setTextureParameters","textureType","isPowerOfTwoImage","extension","texParameteri","TEXTURE_WRAP_S","TEXTURE_WRAP_T","TEXTURE_MAG_FILTER","TEXTURE_MIN_FILTER","CLAMP_TO_EDGE","filterFallback","__currentAnisotropy","texParameterf","TEXTURE_MAX_ANISOTROPY_EXT","getMaxAnisotropy","uploadTexture","slot","createTexture","activeTexture","TEXTURE0","bindTexture","TEXTURE_2D","pixelStorei","UNPACK_FLIP_Y_WEBGL","UNPACK_PREMULTIPLY_ALPHA_WEBGL","UNPACK_ALIGNMENT","clampToMaxSize","maxTextureSize","textureNeedsPowerOfTwo","HTMLImageElement","HTMLCanvasElement","makePowerOfTwo","glFormat","glType","mipmap","internalFormat","DEPTH_COMPONENT","DEPTH_COMPONENT32F","DEPTH_COMPONENT16","texImage2D","getCompressedTextureFormats","compressedTexImage2D","generateMipmap","__version","maxSize","setupFrameBufferTexture","framebuffer","attachment","textureTarget","bindFramebuffer","FRAMEBUFFER","framebufferTexture2D","setupRenderBufferStorage","renderbuffer","bindRenderbuffer","RENDERBUFFER","depthBuffer","stencilBuffer","renderbufferStorage","framebufferRenderbuffer","DEPTH_ATTACHMENT","DEPTH_STENCIL","DEPTH_STENCIL_ATTACHMENT","RGBA4","setupDepthRenderbuffer","isCube","setTexture2D","webglDepthTexture","setupDepthTexture","createRenderbuffer","NEAREST","LINEAR","REPEAT","MIRRORED_REPEAT","NEAREST_MIPMAP_NEAREST","NEAREST_MIPMAP_LINEAR","LINEAR_MIPMAP_NEAREST","LINEAR_MIPMAP_LINEAR","UNSIGNED_BYTE","UNSIGNED_SHORT_4_4_4_4","UNSIGNED_SHORT_5_5_5_1","UNSIGNED_SHORT_5_6_5","BYTE","SHORT","UNSIGNED_SHORT","INT","UNSIGNED_INT","FLOAT","HALF_FLOAT_OES","ALPHA","RGB","RGBA","LUMINANCE","LUMINANCE_ALPHA","FUNC_ADD","FUNC_SUBTRACT","FUNC_REVERSE_SUBTRACT","ZERO","ONE","SRC_COLOR","ONE_MINUS_SRC_COLOR","SRC_ALPHA","ONE_MINUS_SRC_ALPHA","DST_ALPHA","ONE_MINUS_DST_ALPHA","DST_COLOR","ONE_MINUS_DST_COLOR","SRC_ALPHA_SATURATE","COMPRESSED_RGB_S3TC_DXT1_EXT","COMPRESSED_RGBA_S3TC_DXT1_EXT","COMPRESSED_RGBA_S3TC_DXT3_EXT","COMPRESSED_RGBA_S3TC_DXT5_EXT","COMPRESSED_RGB_PVRTC_4BPPV1_IMG","COMPRESSED_RGB_PVRTC_2BPPV1_IMG","COMPRESSED_RGBA_PVRTC_4BPPV1_IMG","COMPRESSED_RGBA_PVRTC_2BPPV1_IMG","COMPRESSED_RGB_ETC1_WEBGL","MIN_EXT","MAX_EXT","getContextAttributes","forceContextLoss","loseContext","MAX_TEXTURE_MAX_ANISOTROPY_EXT","getPrecision","getPixelRatio","setPixelRatio","setSize","getSize","updateStyle","setViewport","setScissor","setScissorTest","boolean","getClearColor","setClearColor","getClearAlpha","setClearAlpha","bits","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT","clearDepth","clearStencil","clearTarget","initAttributes","buffers","hasPositions","createBuffer","hasNormals","hasUvs","hasColors","bindBuffer","ARRAY_BUFFER","bufferData","positionArray","DYNAMIC_DRAW","enableAttribute","vertexAttribPointer","normalArray","nx","ny","nz","uvArray","colorArray","disableUnusedAttributes","drawArrays","TRIANGLES","updateBuffers","geometryProgram","activeInfluences","getWireframeAttribute","startIndex","geometryAttributes","programAttributes","materialDefaultAttributeValues","programAttribute","geometryAttribute","getAttributeBuffer","enableAttributeAndDivisor","vertexAttrib2fv","vertexAttrib3fv","vertexAttrib4fv","vertexAttrib1fv","setupVertexAttributes","ELEMENT_ARRAY_BUFFER","dataCount","rangeStart","rangeCount","groupStart","groupCount","drawStart","drawEnd","drawCount","setLineWidth","setMode","LINES","TRIANGLE_STRIP","TRIANGLE_FAN","lineWidth","LINE_STRIP","POINTS","renderInstances","forceClear","projectObject","isObjectViewable","groupMaterial","beginShadows","lightShadowsLength","setupShadows","ll","viewMatrix","directionalLength","pointLength","spotLength","hemiLength","shadowBias","shadowRadius","shadowMapSize","coneCos","penumbraCos","setupLights","endShadows","TEXTURE_CUBE_MAP","updateRenderTargetMipmap","setFaceCulling","cullFace","frontFaceDirection","setCullFace","allocTextureUnit","textureUnit","maxTextures","warned","complete","setTexture","setTextureCube","isCompressed","isDataTexture","cubeImage","maxCubemapSize","TEXTURE_CUBE_MAP_POSITIVE_X","setTextureCubeDynamic","getCurrentRenderTarget","isTargetPowerOfTwo","createFramebuffer","COLOR_ATTACHMENT0","setupRenderTarget","scissorTest","activeMipMapLevel","readRenderTargetPixels","restore","IMPLEMENTATION_COLOR_READ_FORMAT","IMPLEMENTATION_COLOR_READ_TYPE","checkFramebufferStatus","FRAMEBUFFER_COMPLETE","readPixels","drawArraysInstancedANGLE","globalState","numGlobalPlanes","renderingShadows","viewNormalMatrix","resetGlobalState","projectPlanes","skipTransform","nPlanes","dstArray","flatSize","i4","enableLocalClipping","fromCache","nGlobal","lGlobal","clippingState","drawElements","drawElementsInstancedANGLE","gl","getExtension","getMaxPrecision","VERTEX_SHADER","HIGH_FLOAT","FRAGMENT_SHADER","MEDIUM_FLOAT","MAX_TEXTURE_IMAGE_UNITS","maxVertexTextures","MAX_VERTEX_TEXTURE_IMAGE_UNITS","MAX_TEXTURE_SIZE","MAX_CUBE_MAP_TEXTURE_SIZE","maxAttributes","MAX_VERTEX_ATTRIBS","maxVertexUniforms","MAX_VERTEX_UNIFORM_VECTORS","maxVaryings","MAX_VARYING_VECTORS","maxFragmentUniforms","MAX_FRAGMENT_UNIFORM_VECTORS","vertexTextures","floatFragmentTextures","_maxPrecision","WebGLGeometries","onGeometryDispose","buffergeometry","deleteAttribute","deleteAttributes","property","bufferproperty","__webglBuffer","deleteBuffer","removeAttributeBuffer","_bufferGeometry","updateAttribute","attributeProperties","usage","STATIC_DRAW","bufferSubData","updateBuffer","checkEdge","edges","list","TypeArray","WebGLProgram","programIdCount","getEncodingComponents","getTexelDecodingFunction","functionName","getTexelEncodingFunction","getToneMappingFunction","toneMappingName","filterEmptyLine","replaceLightNums","replace","numDirLights","numSpotLights","numPointLights","numHemiLights","parseIncludes","include","unrollLoops","snippet","unroll","shadowMapTypeDefine","shadowMapType","envMapTypeDefine","envMapModeDefine","envMapBlendingDefine","prefixVertex","prefixFragment","gammaFactorDefine","customExtensions","rendererExtensions","envMapCubeUV","flatShading","generateExtensions","customDefines","generateDefines","createProgram","supportsVertexTextures","maxBones","doubleSided","flipSided","shadowMapEnabled","useFog","fogExp","outputEncoding","mapEncoding","envMapEncoding","emissiveMapEncoding","vertexGlsl","fragmentGlsl","glVertexShader","WebGLShader","glFragmentShader","attachShader","bindAttribLocation","linkProgram","cachedUniforms","cachedAttributes","programLog","getProgramInfoLog","vertexLog","getShaderInfoLog","fragmentLog","runnable","haveDiagnostics","getProgramParameter","LINK_STATUS","getError","VALIDATE_STATUS","diagnostics","prefix","deleteShader","identifiers","ACTIVE_ATTRIBUTES","getActiveAttrib","getAttribLocation","fetchAttributeLocations","destroy","deleteProgram","usedTimes","shaderIDs","parameterNames","getTextureEncodingFromMap","gammaOverrideLinear","nClipPlanes","nVertexUniforms","allocateBones","currentRenderTarget","envMapMode","pl","createShader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","lines","addLineNumbers","_renderer","_state","_lightShadows","_shadowMapSize","_lookTarget","_lightPositionWorld","_renderList","_depthMaterials","_distanceMaterials","_materialCache","cubeDirections","cubeUps","cube2DViewPorts","depthMaterialTemplate","distanceShader","distanceUniforms","useMorphing","useSkinning","depthMaterial","distanceMaterial","getDepthMaterial","isPointLight","lightPositionWorld","materialVariants","customMaterial","customDepthMaterial","customDistanceMaterial","variantIndex","keyA","keyB","materialsForVariant","cachedMaterial","renderSingleSided","renderReverseSided","lightPos","shadowCamera","faceCount","BLEND","vpWidth","vpHeight","pars","shadowMatrix","vpDimensions","clearAlpha","WebGLColorBuffer","WebGLDepthBuffer","WebGLStencilBuffer","maxVertexAttributes","newAttributes","enabledAttributes","attributeDivisors","compressedTextureFormats","currentBlending","currentBlendEquation","currentBlendSrc","currentBlendDst","currentBlendEquationAlpha","currentBlendSrcAlpha","currentBlendDstAlpha","currentPremultipledAlpha","currentFlipSided","currentCullFace","currentLineWidth","currentPolygonOffsetFactor","currentPolygonOffsetUnits","currentScissorTest","currentTextureSlot","currentBoundTextures","currentScissor","currentViewport","emptyTextures","DEPTH_TEST","enableVertexAttribArray","vertexAttribDivisorANGLE","disableVertexAttribArray","formats","COMPRESSED_TEXTURE_FORMATS","blendEquationSeparate","blendFuncSeparate","blendFunc","setMask","setTest","setFunc","setStencilTest","stencilTest","setStencilWrite","stencilWrite","setStencilFunc","stencilFunc","stencilRef","stencilMask","setStencilOp","stencilFail","stencilZFail","stencilZPass","setOp","frontFace","CW","CCW","BACK","FRONT","FRONT_AND_BACK","factor","units","POLYGON_OFFSET_FILL","getScissorTest","SCISSOR_TEST","webglSlot","webglType","webglTexture","boundTexture","setClear","locked","currentColorMask","currentColorClear","colorMask","setLocked","lock","currentDepthMask","currentDepthFunc","currentDepthClear","depthMask","NEVER","ALWAYS","LESS","LEQUAL","EQUAL","GEQUAL","GREATER","NOTEQUAL","currentStencilMask","currentStencilFunc","currentStencilRef","currentStencilFuncMask","currentStencilFail","currentStencilZFail","currentStencilZPass","currentStencilClear","STENCIL_TEST","stencilOp","UniformContainer","arrayCacheF32","arrayCacheI32","flatten","nBlocks","blockSize","firstElem","allocTexUnits","setValue1f","uniform1f","addr","setValue1i","uniform1i","setValue2fv","uniform2fv","uniform2f","setValue3fv","uniform3f","uniform3fv","setValue4fv","uniform4fv","uniform4f","setValue2fm","uniformMatrix2fv","setValue3fm","uniformMatrix3fv","setValue4fm","uniformMatrix4fv","setValueT1","unit","setValueT6","setValue2iv","uniform2iv","setValue3iv","uniform3iv","setValue4iv","uniform4iv","setValue1fv","uniform1fv","setValue1iv","uniform1iv","setValueV2a","setValueV3a","setValueV4a","setValueM2a","setValueM3a","setValueM4a","setValueT1a","tex","setValueT6a","SingleUniform","activeInfo","getSingularSetter","PureArrayUniform","getPureArraySetter","StructuredUniform","RePathPart","addUniform","container","uniformObject","parseUniform","pathLength","matchEnd","idIsIndex","subscript","ACTIVE_UNIFORMS","getActiveUniform","getUniformLocation","flares","vertexBuffer","elementBuffer","tempTexture","occlusionTexture","renderType","occlusionMap","screenPosition","tempPosition","invAspect","halfViewportWidth","halfViewportHeight","screenPositionPixels","validArea","TEXTURE1","copyTexImage2D","spritePosition","spriteRotation","spriteScale","uvOffset","uvScale","fogType","fillStyle","fillRect","oldFogType","sceneFogType","Face4","LineStrip","LinePieces","MeshFaceMaterial","Particle","ParticleSystem","PointCloudMaterial","ParticleBasicMaterial","ParticleSystemMaterial","Vertex","isIntersectionBox","isIntersectionSphere","multiplyVector3","multiplyVector3Array","extractPosition","multiplyVector4","rotateAxis","crossVector","rotateByAxis","isIntersectionLine","isIntersectionPlane","setEulerFromRotationMatrix","setEulerFromQuaternion","getPositionFromMatrix","getScaleFromMatrix","getColumnFromMatrix","getChildByName","renderDepth","eulerOrder","useQuaternion","setLens","onlyShadow","shadowCameraFov","shadowCameraLeft","shadowCameraRight","shadowCameraTop","shadowCameraBottom","shadowCameraNear","shadowCameraFar","shadowCameraVisible","shadowDarkness","shadowMapWidth","shadowMapHeight","addIndex","addDrawCall","indexOffset","clearDrawCalls","computeOffsets","wrapAround","wrapRGB","metal","supportsFloatTextures","supportsHalfFloatTextures","supportsStandardDerivatives","supportsCompressedTextureS3TC","supportsCompressedTexturePVRTC","supportsBlendMinMax","supportsInstancedArrays","enableScissorTest","addPrePlugin","addPostPlugin","updateShadowMap","shadowMapCullFace","getData","GeometryUtils","geometry1","ImageUtils","loadTextureCube","loadCompressedTexture","loadCompressedTextureCube","Projector","projectVector","unprojectVector","pickingRay","CanvasRenderer","CurveUtils","tangentQuadraticBezier","tangentCubicBezier","tangentSpline","SceneUtils","createMultiMaterialObject","detach","attach","ShapeUtils","contour","triangulate","snip","verts","px","py","aX","aY","bX","bY","cX","cY","cCROSSap","bCROSScp","vertIndices","nv","triangulateShape","holes","point_in_segment_2D_colin","inSegPt1","inSegPt2","inOtherPt","intersect_segments_2D","inSeg1Pt1","inSeg1Pt2","inSeg2Pt1","inSeg2Pt2","inExcludeAdjacentSegs","seg1dx","seg1dy","seg2dx","seg2dy","seg1seg2dx","seg1seg2dy","limit","perpSeg1","perpSeg2","factorSeg1","seg1min","seg1max","seg1minVal","seg1maxVal","seg2min","seg2max","seg2minVal","seg2maxVal","seg1Pt","seg2Pt","isPointInsideAngle","inVertex","inLegFromPt","inLegToPt","legFromPtX","legFromPtY","legToPtX","legToPtY","otherPtX","otherPtY","from2toAngle","from2otherAngle","other2toAngle","allPointsMap","allpoints","hl","shapeWithoutHoles","hole","shape","isCutLineInsideAngles","inShapeIdx","inHoleIdx","lastShapeIdx","prevShapeIdx","nextShapeIdx","insideAngle","lastHoleIdx","prevHoleIdx","nextHoleIdx","intersectsShapeEdge","inShapePt","inHolePt","sIdx","nextIdx","indepHoles","intersectsHoleEdge","ihIdx","chkHole","hIdx","holeIndex","shapeIndex","shapePt","holePt","holeIdx","cutKey","tmpShape1","tmpShape2","tmpHole1","tmpHole2","failedCuts","minShapeIndex","counter","h2","removeHoles","triangles","isClockWise","pts","b2p0","b2p1","b2p2","b3","b3p0","b3p1","b3p2","b3p3","Curve","getPointAt","getUtoTmapping","getPoints","divisions","getSpacedPoints","lengths","getLengths","__arcLengthDivisions","cacheArcLengths","current","sum","updateArcLengths","targetArcLength","arcLengths","comparison","lengthBefore","getTangent","pt1","getTangentAt","getPointFunc","CurvePath","curves","autoClose","curve","closePath","startPoint","endPoint","LineCurve","curveLengths","getCurveLengths","lens","cacheLengths","sums","createPointsGeometry","createGeometry","createSpacedPointsGeometry","generateShapes","createPath","glyph","glyphs","cpx","cpy","cpx0","cpy0","cpx1","cpy1","cpx2","cpy2","laste","Path","outline","_cachedOutline","moveTo","lineTo","quadraticCurveTo","bezierCurveTo","ha","String","resolution","ret","createPaths","shapes","toShapes","fromPoints","args","lastargs","aCPx","aCPy","QuadraticBezierCurve","aCP1x","aCP1y","aCP2x","aCP2y","CubicBezierCurve","splineThru","npts","SplineCurve","aRadius","aStartAngle","aEndAngle","aClockwise","absarc","absellipse","ellipse","xRadius","yRadius","aRotation","EllipseCurve","lastPoint","item","spts","spline","deltaAngle","tdivisions","isCCW","noHoles","toShapesNoHoles","inSubpaths","tmpPath","tmpShape","Shape","isPointInsidePolygon","inPt","inPolygon","polyLen","inside","edgeLowPt","edgeHighPt","edgeDx","edgeDy","perpEdge","subPaths","inActions","lastPath","extractSubpaths","solid","holesFirst","tmpPoints","tmpHoles","betterShapeHoles","newShapes","newShapeHoles","mainIdx","ambiguous","toChange","sLen","sho","ho","hole_unassigned","s2Idx","froms","tos","extrude","ExtrudeGeometry","makeGeometry","ShapeGeometry","getPointsHoles","holesPts","extractAllPoints","extractPoints","point0","point1","point2","point3","ArcCurve","LineCurve3","QuadraticBezierCurve3","CubicBezierCurve3","SplineCurve3","CatmullRomCurve3","CubicPoly","pz","c0","initNonuniformCatmullRom","x3","dt0","dt1","dt2","initCatmullRom","tension","calc","closed","ClosedSplineCurve3","BoxGeometry","BoxBufferGeometry","CubeGeometry","vertexCount","calculateVertexCount","indexCount","calculateIndexCount","vertexBufferOffset","uvBufferOffset","indexBufferOffset","numberOfVertices","buildPlane","udir","vdir","gridX","gridY","segmentWidth","segmentHeight","widthHalf","heightHalf","depthHalf","gridX1","gridY1","vertexCounter","CircleGeometry","CircleBufferGeometry","ii","segment","CylinderBufferGeometry","nbCap","indexArray","halfHeight","generateCap","centerIndexStart","centerIndexEnd","cosTheta","sinTheta","tanTheta","indexRow","i3","generateTorso","CylinderGeometry","ConeBufferGeometry","ConeGeometry","EdgesGeometry","thresholdAngle","thresholdDot","edge","sortFunction","vert1","vert2","face1","face2","addShapeList","addShape","extrudePts","splineTube","binormal","position2","ahole","amount","bevelThickness","bevelSize","bevelSegments","bevelEnabled","curveSegments","steps","extrudePath","extrudeByPath","uvgen","UVGenerator","WorldUVGenerator","frames","TubeGeometry","FrenetFrames","shapesOffset","shapePoints","reverse","scalePt2","pt","bs","vert","vlen","flen","getBevelVec","inPrev","inNext","v_trans_x","v_trans_y","shrink_by","v_prev_x","v_prev_y","v_next_x","v_next_y","v_prev_lensq","collinear0","v_prev_len","v_next_len","ptPrevShift_x","ptPrevShift_y","sf","v_trans_lensq","direction_eq","contourMovements","oneHoleMovements","holesMovements","verticesMovements","binormals","sidewalls","layeroffset","slen1","slen2","f4","f3","generateTopUV","wallContour","stepIndex","stepsLength","contourIndex1","contourIndex2","generateSideWallUV","layer","buildLidFaces","buildSideFaces","indexA","indexB","indexC","indexD","LatheBufferGeometry","base","inverseSegments","n1","n2","LatheGeometry","PlaneGeometry","PlaneBufferGeometry","width_half","height_half","segment_width","segment_height","offset2","RingBufferGeometry","radiusStep","thetaSegmentLevel","RingGeometry","SphereGeometry","SphereBufferGeometry","thetaEnd","verticesRow","v4","TextGeometry","TorusBufferGeometry","TorusGeometry","TorusKnotBufferGeometry","P1","P2","B","T","N","calculatePositionOnCurve","cu","su","quOverP","cs","TorusKnotGeometry","heightScale","taper","NoTaper","ip","jp","uva","uvb","uvc","uvd","grid","numpoints","pos2","tangents","SinusoidalTaper","smallest","tz","mat","MAX_VALUE","initialNormal3","PolyhedronGeometry","that","prepare","centroid","subdivide","azimuth","inclination","make","azi","correctUV","cols","aj","bj","rows","DodecahedronGeometry","IcosahedronGeometry","OctahedronGeometry","TetrahedronGeometry","ParametricGeometry","func","slices","stacks","sliceCount","WireframeGeometry","numEdges","ol","numTris","AxisHelper","ArrowHelper","lineGeometry","coneGeometry","headLength","headWidth","cone","setDirection","setColor","BoxHelper","BoundingBoxHelper","CameraHelper","pointMap","addLine","addPoint","setPoint","DirectionalLightHelper","lightPlane","targetLine","EdgesHelper","FaceNormalsHelper","nNormals","objGeometry","GridHelper","setColors","HemisphereLightHelper","sphereSize","lightSphere","PointLightHelper","SkeletonHelper","getBoneList","boneList","matrixWorldInv","boneMatrix","SpotLightHelper","vector2","coneLength","coneWidth","VertexNormalsHelper","objPos","objNorm","WireframeHelper","renderCallback","MorphBlendMesh","animationsMap","animationsList","numFrames","endFrame","createAnimation","setAnimationWeight","lastFrame","currentFrame","active","directionBackwards","mirroredLoop","autoCreateAnimations","firstAnimation","frameRanges","setAnimationDirectionForward","setAnimationDirectionBackward","setAnimationFPS","setAnimationDuration","setAnimationTime","getAnimationTime","getAnimationDuration","playAnimation","stopAnimation","keyframe","module","exports"],"mappings":"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","file":"static/js/5.712ca06c.chunk.js","sourcesContent":["export default function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}","import arrayWithHoles from \"./arrayWithHoles\";\nimport iterableToArrayLimit from \"./iterableToArrayLimit\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray\";\nimport nonIterableRest from \"./nonIterableRest\";\nexport default function _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || unsupportedIterableToArray(arr, i) || nonIterableRest();\n}","export default function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}","export default function _iterableToArrayLimit(arr, i) {\n  if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}","import arrayLikeToArray from \"./arrayLikeToArray\";\nexport default function _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(n);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}","export default function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","export default function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nexport default function _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}","var self = self || {};// File:src/Three.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nvar THREE = { REVISION: '77' };\r\n\r\n//\r\n\r\nif ( typeof define === 'function' && define.amd ) {\r\n\r\n\tdefine( 'three', THREE );\r\n\r\n} else if ( 'undefined' !== typeof exports && 'undefined' !== typeof module ) {\r\n\r\n\tmodule.exports = THREE;\r\n\r\n}\r\n\r\n// Polyfills\r\n\r\nif ( Number.EPSILON === undefined ) {\r\n\r\n\tNumber.EPSILON = Math.pow( 2, - 52 );\r\n\r\n}\r\n\r\n//\r\n\r\nif ( Math.sign === undefined ) {\r\n\r\n\t// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/sign\r\n\r\n\tMath.sign = function ( x ) {\r\n\r\n\t\treturn ( x < 0 ) ? - 1 : ( x > 0 ) ? 1 : + x;\r\n\r\n\t};\r\n\r\n}\r\n\r\nif ( Function.prototype.name === undefined ) {\r\n\r\n\t// Missing in IE9-11.\r\n\t// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/name\r\n\r\n\tObject.defineProperty( Function.prototype, 'name', {\r\n\r\n\t\tget: function () {\r\n\r\n\t\t\treturn this.toString().match( /^\\s*function\\s*(\\S*)\\s*\\(/ )[ 1 ];\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n}\r\n\r\nif ( Object.assign === undefined ) {\r\n\r\n\t// Missing in IE.\r\n\t// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign\r\n\r\n\t( function () {\r\n\r\n\t\tObject.assign = function ( target ) {\r\n\r\n\t\t\t'use strict';\r\n\r\n\t\t\tif ( target === undefined || target === null ) {\r\n\r\n\t\t\t\tthrow new TypeError( 'Cannot convert undefined or null to object' );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar output = Object( target );\r\n\r\n\t\t\tfor ( var index = 1; index < arguments.length; index ++ ) {\r\n\r\n\t\t\t\tvar source = arguments[ index ];\r\n\r\n\t\t\t\tif ( source !== undefined && source !== null ) {\r\n\r\n\t\t\t\t\tfor ( var nextKey in source ) {\r\n\r\n\t\t\t\t\t\tif ( Object.prototype.hasOwnProperty.call( source, nextKey ) ) {\r\n\r\n\t\t\t\t\t\t\toutput[ nextKey ] = source[ nextKey ];\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn output;\r\n\r\n\t\t};\r\n\r\n\t} )();\r\n\r\n}\r\n\r\n//\r\n\r\nObject.assign( THREE, {\r\n\r\n\t// https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent.button\r\n\r\n\tMOUSE: { LEFT: 0, MIDDLE: 1, RIGHT: 2 },\r\n\r\n\t// GL STATE CONSTANTS\r\n\r\n\tCullFaceNone: 0,\r\n\tCullFaceBack: 1,\r\n\tCullFaceFront: 2,\r\n\tCullFaceFrontBack: 3,\r\n\r\n\tFrontFaceDirectionCW: 0,\r\n\tFrontFaceDirectionCCW: 1,\r\n\r\n\t// SHADOWING TYPES\r\n\r\n\tBasicShadowMap: 0,\r\n\tPCFShadowMap: 1,\r\n\tPCFSoftShadowMap: 2,\r\n\r\n\t// MATERIAL CONSTANTS\r\n\r\n\t// side\r\n\r\n\tFrontSide: 0,\r\n\tBackSide: 1,\r\n\tDoubleSide: 2,\r\n\r\n\t// shading\r\n\r\n\tFlatShading: 1,\r\n\tSmoothShading: 2,\r\n\r\n\t// colors\r\n\r\n\tNoColors: 0,\r\n\tFaceColors: 1,\r\n\tVertexColors: 2,\r\n\r\n\t// blending modes\r\n\r\n\tNoBlending: 0,\r\n\tNormalBlending: 1,\r\n\tAdditiveBlending: 2,\r\n\tSubtractiveBlending: 3,\r\n\tMultiplyBlending: 4,\r\n\tCustomBlending: 5,\r\n\r\n\t// custom blending equations\r\n\t// (numbers start from 100 not to clash with other\r\n\t// mappings to OpenGL constants defined in Texture.js)\r\n\r\n\tAddEquation: 100,\r\n\tSubtractEquation: 101,\r\n\tReverseSubtractEquation: 102,\r\n\tMinEquation: 103,\r\n\tMaxEquation: 104,\r\n\r\n\t// custom blending destination factors\r\n\r\n\tZeroFactor: 200,\r\n\tOneFactor: 201,\r\n\tSrcColorFactor: 202,\r\n\tOneMinusSrcColorFactor: 203,\r\n\tSrcAlphaFactor: 204,\r\n\tOneMinusSrcAlphaFactor: 205,\r\n\tDstAlphaFactor: 206,\r\n\tOneMinusDstAlphaFactor: 207,\r\n\r\n\t// custom blending source factors\r\n\r\n\t//ZeroFactor: 200,\r\n\t//OneFactor: 201,\r\n\t//SrcAlphaFactor: 204,\r\n\t//OneMinusSrcAlphaFactor: 205,\r\n\t//DstAlphaFactor: 206,\r\n\t//OneMinusDstAlphaFactor: 207,\r\n\tDstColorFactor: 208,\r\n\tOneMinusDstColorFactor: 209,\r\n\tSrcAlphaSaturateFactor: 210,\r\n\r\n\t// depth modes\r\n\r\n\tNeverDepth: 0,\r\n\tAlwaysDepth: 1,\r\n\tLessDepth: 2,\r\n\tLessEqualDepth: 3,\r\n\tEqualDepth: 4,\r\n\tGreaterEqualDepth: 5,\r\n\tGreaterDepth: 6,\r\n\tNotEqualDepth: 7,\r\n\r\n\r\n\t// TEXTURE CONSTANTS\r\n\r\n\tMultiplyOperation: 0,\r\n\tMixOperation: 1,\r\n\tAddOperation: 2,\r\n\r\n\t// Tone Mapping modes\r\n\r\n\tNoToneMapping: 0, // do not do any tone mapping, not even exposure (required for special purpose passes.)\r\n\tLinearToneMapping: 1, // only apply exposure.\r\n\tReinhardToneMapping: 2,\r\n\tUncharted2ToneMapping: 3, // John Hable\r\n\tCineonToneMapping: 4, // optimized filmic operator by Jim Hejl and Richard Burgess-Dawson\r\n\r\n\t// Mapping modes\r\n\r\n\tUVMapping: 300,\r\n\r\n\tCubeReflectionMapping: 301,\r\n\tCubeRefractionMapping: 302,\r\n\r\n\tEquirectangularReflectionMapping: 303,\r\n\tEquirectangularRefractionMapping: 304,\r\n\r\n\tSphericalReflectionMapping: 305,\r\n\tCubeUVReflectionMapping: 306,\r\n\tCubeUVRefractionMapping: 307,\r\n\r\n\t// Wrapping modes\r\n\r\n\tRepeatWrapping: 1000,\r\n\tClampToEdgeWrapping: 1001,\r\n\tMirroredRepeatWrapping: 1002,\r\n\r\n\t// Filters\r\n\r\n\tNearestFilter: 1003,\r\n\tNearestMipMapNearestFilter: 1004,\r\n\tNearestMipMapLinearFilter: 1005,\r\n\tLinearFilter: 1006,\r\n\tLinearMipMapNearestFilter: 1007,\r\n\tLinearMipMapLinearFilter: 1008,\r\n\r\n\t// Data types\r\n\r\n\tUnsignedByteType: 1009,\r\n\tByteType: 1010,\r\n\tShortType: 1011,\r\n\tUnsignedShortType: 1012,\r\n\tIntType: 1013,\r\n\tUnsignedIntType: 1014,\r\n\tFloatType: 1015,\r\n\tHalfFloatType: 1025,\r\n\r\n\t// Pixel types\r\n\r\n\t//UnsignedByteType: 1009,\r\n\tUnsignedShort4444Type: 1016,\r\n\tUnsignedShort5551Type: 1017,\r\n\tUnsignedShort565Type: 1018,\r\n\r\n\t// Pixel formats\r\n\r\n\tAlphaFormat: 1019,\r\n\tRGBFormat: 1020,\r\n\tRGBAFormat: 1021,\r\n\tLuminanceFormat: 1022,\r\n\tLuminanceAlphaFormat: 1023,\r\n\t// THREE.RGBEFormat handled as THREE.RGBAFormat in shaders\r\n\tRGBEFormat: THREE.RGBAFormat, //1024;\r\n\tDepthFormat: 1026,\r\n\r\n\t// DDS / ST3C Compressed texture formats\r\n\r\n\tRGB_S3TC_DXT1_Format: 2001,\r\n\tRGBA_S3TC_DXT1_Format: 2002,\r\n\tRGBA_S3TC_DXT3_Format: 2003,\r\n\tRGBA_S3TC_DXT5_Format: 2004,\r\n\r\n\t// PVRTC compressed texture formats\r\n\r\n\tRGB_PVRTC_4BPPV1_Format: 2100,\r\n\tRGB_PVRTC_2BPPV1_Format: 2101,\r\n\tRGBA_PVRTC_4BPPV1_Format: 2102,\r\n\tRGBA_PVRTC_2BPPV1_Format: 2103,\r\n\r\n\t// ETC compressed texture formats\r\n\r\n\tRGB_ETC1_Format: 2151,\r\n\r\n\t// Loop styles for AnimationAction\r\n\r\n\tLoopOnce: 2200,\r\n\tLoopRepeat: 2201,\r\n\tLoopPingPong: 2202,\r\n\r\n\t// Interpolation\r\n\r\n\tInterpolateDiscrete: 2300,\r\n\tInterpolateLinear: 2301,\r\n\tInterpolateSmooth: 2302,\r\n\r\n\t// Interpolant ending modes\r\n\r\n\tZeroCurvatureEnding: 2400,\r\n\tZeroSlopeEnding: 2401,\r\n\tWrapAroundEnding: 2402,\r\n\r\n\t// Triangle Draw modes\r\n\r\n\tTrianglesDrawMode: 0,\r\n\tTriangleStripDrawMode: 1,\r\n\tTriangleFanDrawMode: 2,\r\n\r\n\t// Texture Encodings\r\n\r\n\tLinearEncoding: 3000, // No encoding at all.\r\n\tsRGBEncoding: 3001,\r\n\tGammaEncoding: 3007, // uses GAMMA_FACTOR, for backwards compatibility with WebGLRenderer.gammaInput/gammaOutput\r\n\r\n\t// The following Texture Encodings are for RGB-only (no alpha) HDR light emission sources.\r\n\t// These encodings should not specified as output encodings except in rare situations.\r\n\tRGBEEncoding: 3002, // AKA Radiance.\r\n\tLogLuvEncoding: 3003,\r\n\tRGBM7Encoding: 3004,\r\n\tRGBM16Encoding: 3005,\r\n\tRGBDEncoding: 3006, // MaxRange is 256.\r\n\r\n\t// Depth packing strategies\r\n\r\n\tBasicDepthPacking: 3200, // for writing to float textures for high precision or for visualizing results in RGB buffers\r\n\tRGBADepthPacking: 3201 // for packing into RGBA buffers.\r\n\r\n} );\r\n\r\n// File:src/math/Color.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Color = function ( r, g, b ) {\r\n\r\n\tif ( g === undefined && b === undefined ) {\r\n\r\n\t\t// r is THREE.Color, hex or string\r\n\t\treturn this.set( r );\r\n\r\n\t}\r\n\r\n\treturn this.setRGB( r, g, b );\r\n\r\n};\r\n\r\nTHREE.Color.prototype = {\r\n\r\n\tconstructor: THREE.Color,\r\n\r\n\tr: 1, g: 1, b: 1,\r\n\r\n\tset: function ( value ) {\r\n\r\n\t\tif ( value instanceof THREE.Color ) {\r\n\r\n\t\t\tthis.copy( value );\r\n\r\n\t\t} else if ( typeof value === 'number' ) {\r\n\r\n\t\t\tthis.setHex( value );\r\n\r\n\t\t} else if ( typeof value === 'string' ) {\r\n\r\n\t\t\tthis.setStyle( value );\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetScalar: function ( scalar ) {\r\n\r\n\t\tthis.r = scalar;\r\n\t\tthis.g = scalar;\r\n\t\tthis.b = scalar;\r\n\r\n\t},\r\n\r\n\tsetHex: function ( hex ) {\r\n\r\n\t\thex = Math.floor( hex );\r\n\r\n\t\tthis.r = ( hex >> 16 & 255 ) / 255;\r\n\t\tthis.g = ( hex >> 8 & 255 ) / 255;\r\n\t\tthis.b = ( hex & 255 ) / 255;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetRGB: function ( r, g, b ) {\r\n\r\n\t\tthis.r = r;\r\n\t\tthis.g = g;\r\n\t\tthis.b = b;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetHSL: function () {\r\n\r\n\t\tfunction hue2rgb( p, q, t ) {\r\n\r\n\t\t\tif ( t < 0 ) t += 1;\r\n\t\t\tif ( t > 1 ) t -= 1;\r\n\t\t\tif ( t < 1 / 6 ) return p + ( q - p ) * 6 * t;\r\n\t\t\tif ( t < 1 / 2 ) return q;\r\n\t\t\tif ( t < 2 / 3 ) return p + ( q - p ) * 6 * ( 2 / 3 - t );\r\n\t\t\treturn p;\r\n\r\n\t\t}\r\n\r\n\t\treturn function ( h, s, l ) {\r\n\r\n\t\t\t// h,s,l ranges are in 0.0 - 1.0\r\n\t\t\th = THREE.Math.euclideanModulo( h, 1 );\r\n\t\t\ts = THREE.Math.clamp( s, 0, 1 );\r\n\t\t\tl = THREE.Math.clamp( l, 0, 1 );\r\n\r\n\t\t\tif ( s === 0 ) {\r\n\r\n\t\t\t\tthis.r = this.g = this.b = l;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tvar p = l <= 0.5 ? l * ( 1 + s ) : l + s - ( l * s );\r\n\t\t\t\tvar q = ( 2 * l ) - p;\r\n\r\n\t\t\t\tthis.r = hue2rgb( q, p, h + 1 / 3 );\r\n\t\t\t\tthis.g = hue2rgb( q, p, h );\r\n\t\t\t\tthis.b = hue2rgb( q, p, h - 1 / 3 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tsetStyle: function ( style ) {\r\n\r\n\t\tfunction handleAlpha( string ) {\r\n\r\n\t\t\tif ( string === undefined ) return;\r\n\r\n\t\t\tif ( parseFloat( string ) < 1 ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Color: Alpha component of ' + style + ' will be ignored.' );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\r\n\t\tvar m;\r\n\r\n\t\tif ( m = /^((?:rgb|hsl)a?)\\(\\s*([^\\)]*)\\)/.exec( style ) ) {\r\n\r\n\t\t\t// rgb / hsl\r\n\r\n\t\t\tvar color;\r\n\t\t\tvar name = m[ 1 ];\r\n\t\t\tvar components = m[ 2 ];\r\n\r\n\t\t\tswitch ( name ) {\r\n\r\n\t\t\t\tcase 'rgb':\r\n\t\t\t\tcase 'rgba':\r\n\r\n\t\t\t\t\tif ( color = /^(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*(,\\s*([0-9]*\\.?[0-9]+)\\s*)?$/.exec( components ) ) {\r\n\r\n\t\t\t\t\t\t// rgb(255,0,0) rgba(255,0,0,0.5)\r\n\t\t\t\t\t\tthis.r = Math.min( 255, parseInt( color[ 1 ], 10 ) ) / 255;\r\n\t\t\t\t\t\tthis.g = Math.min( 255, parseInt( color[ 2 ], 10 ) ) / 255;\r\n\t\t\t\t\t\tthis.b = Math.min( 255, parseInt( color[ 3 ], 10 ) ) / 255;\r\n\r\n\t\t\t\t\t\thandleAlpha( color[ 5 ] );\r\n\r\n\t\t\t\t\t\treturn this;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( color = /^(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*(,\\s*([0-9]*\\.?[0-9]+)\\s*)?$/.exec( components ) ) {\r\n\r\n\t\t\t\t\t\t// rgb(100%,0%,0%) rgba(100%,0%,0%,0.5)\r\n\t\t\t\t\t\tthis.r = Math.min( 100, parseInt( color[ 1 ], 10 ) ) / 100;\r\n\t\t\t\t\t\tthis.g = Math.min( 100, parseInt( color[ 2 ], 10 ) ) / 100;\r\n\t\t\t\t\t\tthis.b = Math.min( 100, parseInt( color[ 3 ], 10 ) ) / 100;\r\n\r\n\t\t\t\t\t\thandleAlpha( color[ 5 ] );\r\n\r\n\t\t\t\t\t\treturn this;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'hsl':\r\n\t\t\t\tcase 'hsla':\r\n\r\n\t\t\t\t\tif ( color = /^([0-9]*\\.?[0-9]+)\\s*,\\s*(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*(,\\s*([0-9]*\\.?[0-9]+)\\s*)?$/.exec( components ) ) {\r\n\r\n\t\t\t\t\t\t// hsl(120,50%,50%) hsla(120,50%,50%,0.5)\r\n\t\t\t\t\t\tvar h = parseFloat( color[ 1 ] ) / 360;\r\n\t\t\t\t\t\tvar s = parseInt( color[ 2 ], 10 ) / 100;\r\n\t\t\t\t\t\tvar l = parseInt( color[ 3 ], 10 ) / 100;\r\n\r\n\t\t\t\t\t\thandleAlpha( color[ 5 ] );\r\n\r\n\t\t\t\t\t\treturn this.setHSL( h, s, l );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( m = /^\\#([A-Fa-f0-9]+)$/.exec( style ) ) {\r\n\r\n\t\t\t// hex color\r\n\r\n\t\t\tvar hex = m[ 1 ];\r\n\t\t\tvar size = hex.length;\r\n\r\n\t\t\tif ( size === 3 ) {\r\n\r\n\t\t\t\t// #ff0\r\n\t\t\t\tthis.r = parseInt( hex.charAt( 0 ) + hex.charAt( 0 ), 16 ) / 255;\r\n\t\t\t\tthis.g = parseInt( hex.charAt( 1 ) + hex.charAt( 1 ), 16 ) / 255;\r\n\t\t\t\tthis.b = parseInt( hex.charAt( 2 ) + hex.charAt( 2 ), 16 ) / 255;\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t} else if ( size === 6 ) {\r\n\r\n\t\t\t\t// #ff0000\r\n\t\t\t\tthis.r = parseInt( hex.charAt( 0 ) + hex.charAt( 1 ), 16 ) / 255;\r\n\t\t\t\tthis.g = parseInt( hex.charAt( 2 ) + hex.charAt( 3 ), 16 ) / 255;\r\n\t\t\t\tthis.b = parseInt( hex.charAt( 4 ) + hex.charAt( 5 ), 16 ) / 255;\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( style && style.length > 0 ) {\r\n\r\n\t\t\t// color keywords\r\n\t\t\tvar hex = THREE.ColorKeywords[ style ];\r\n\r\n\t\t\tif ( hex !== undefined ) {\r\n\r\n\t\t\t\t// red\r\n\t\t\t\tthis.setHex( hex );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// unknown color\r\n\t\t\t\tconsole.warn( 'THREE.Color: Unknown color ' + style );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor( this.r, this.g, this.b );\r\n\r\n\t},\r\n\r\n\tcopy: function ( color ) {\r\n\r\n\t\tthis.r = color.r;\r\n\t\tthis.g = color.g;\r\n\t\tthis.b = color.b;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcopyGammaToLinear: function ( color, gammaFactor ) {\r\n\r\n\t\tif ( gammaFactor === undefined ) gammaFactor = 2.0;\r\n\r\n\t\tthis.r = Math.pow( color.r, gammaFactor );\r\n\t\tthis.g = Math.pow( color.g, gammaFactor );\r\n\t\tthis.b = Math.pow( color.b, gammaFactor );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcopyLinearToGamma: function ( color, gammaFactor ) {\r\n\r\n\t\tif ( gammaFactor === undefined ) gammaFactor = 2.0;\r\n\r\n\t\tvar safeInverse = ( gammaFactor > 0 ) ? ( 1.0 / gammaFactor ) : 1.0;\r\n\r\n\t\tthis.r = Math.pow( color.r, safeInverse );\r\n\t\tthis.g = Math.pow( color.g, safeInverse );\r\n\t\tthis.b = Math.pow( color.b, safeInverse );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tconvertGammaToLinear: function () {\r\n\r\n\t\tvar r = this.r, g = this.g, b = this.b;\r\n\r\n\t\tthis.r = r * r;\r\n\t\tthis.g = g * g;\r\n\t\tthis.b = b * b;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tconvertLinearToGamma: function () {\r\n\r\n\t\tthis.r = Math.sqrt( this.r );\r\n\t\tthis.g = Math.sqrt( this.g );\r\n\t\tthis.b = Math.sqrt( this.b );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tgetHex: function () {\r\n\r\n\t\treturn ( this.r * 255 ) << 16 ^ ( this.g * 255 ) << 8 ^ ( this.b * 255 ) << 0;\r\n\r\n\t},\r\n\r\n\tgetHexString: function () {\r\n\r\n\t\treturn ( '000000' + this.getHex().toString( 16 ) ).slice( - 6 );\r\n\r\n\t},\r\n\r\n\tgetHSL: function ( optionalTarget ) {\r\n\r\n\t\t// h,s,l ranges are in 0.0 - 1.0\r\n\r\n\t\tvar hsl = optionalTarget || { h: 0, s: 0, l: 0 };\r\n\r\n\t\tvar r = this.r, g = this.g, b = this.b;\r\n\r\n\t\tvar max = Math.max( r, g, b );\r\n\t\tvar min = Math.min( r, g, b );\r\n\r\n\t\tvar hue, saturation;\r\n\t\tvar lightness = ( min + max ) / 2.0;\r\n\r\n\t\tif ( min === max ) {\r\n\r\n\t\t\thue = 0;\r\n\t\t\tsaturation = 0;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tvar delta = max - min;\r\n\r\n\t\t\tsaturation = lightness <= 0.5 ? delta / ( max + min ) : delta / ( 2 - max - min );\r\n\r\n\t\t\tswitch ( max ) {\r\n\r\n\t\t\t\tcase r: hue = ( g - b ) / delta + ( g < b ? 6 : 0 ); break;\r\n\t\t\t\tcase g: hue = ( b - r ) / delta + 2; break;\r\n\t\t\t\tcase b: hue = ( r - g ) / delta + 4; break;\r\n\r\n\t\t\t}\r\n\r\n\t\t\thue /= 6;\r\n\r\n\t\t}\r\n\r\n\t\thsl.h = hue;\r\n\t\thsl.s = saturation;\r\n\t\thsl.l = lightness;\r\n\r\n\t\treturn hsl;\r\n\r\n\t},\r\n\r\n\tgetStyle: function () {\r\n\r\n\t\treturn 'rgb(' + ( ( this.r * 255 ) | 0 ) + ',' + ( ( this.g * 255 ) | 0 ) + ',' + ( ( this.b * 255 ) | 0 ) + ')';\r\n\r\n\t},\r\n\r\n\toffsetHSL: function ( h, s, l ) {\r\n\r\n\t\tvar hsl = this.getHSL();\r\n\r\n\t\thsl.h += h; hsl.s += s; hsl.l += l;\r\n\r\n\t\tthis.setHSL( hsl.h, hsl.s, hsl.l );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tadd: function ( color ) {\r\n\r\n\t\tthis.r += color.r;\r\n\t\tthis.g += color.g;\r\n\t\tthis.b += color.b;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\taddColors: function ( color1, color2 ) {\r\n\r\n\t\tthis.r = color1.r + color2.r;\r\n\t\tthis.g = color1.g + color2.g;\r\n\t\tthis.b = color1.b + color2.b;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\taddScalar: function ( s ) {\r\n\r\n\t\tthis.r += s;\r\n\t\tthis.g += s;\r\n\t\tthis.b += s;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmultiply: function ( color ) {\r\n\r\n\t\tthis.r *= color.r;\r\n\t\tthis.g *= color.g;\r\n\t\tthis.b *= color.b;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmultiplyScalar: function ( s ) {\r\n\r\n\t\tthis.r *= s;\r\n\t\tthis.g *= s;\r\n\t\tthis.b *= s;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tlerp: function ( color, alpha ) {\r\n\r\n\t\tthis.r += ( color.r - this.r ) * alpha;\r\n\t\tthis.g += ( color.g - this.g ) * alpha;\r\n\t\tthis.b += ( color.b - this.b ) * alpha;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tequals: function ( c ) {\r\n\r\n\t\treturn ( c.r === this.r ) && ( c.g === this.g ) && ( c.b === this.b );\r\n\r\n\t},\r\n\r\n\tfromArray: function ( array, offset ) {\r\n\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tthis.r = array[ offset ];\r\n\t\tthis.g = array[ offset + 1 ];\r\n\t\tthis.b = array[ offset + 2 ];\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\ttoArray: function ( array, offset ) {\r\n\r\n\t\tif ( array === undefined ) array = [];\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tarray[ offset ] = this.r;\r\n\t\tarray[ offset + 1 ] = this.g;\r\n\t\tarray[ offset + 2 ] = this.b;\r\n\r\n\t\treturn array;\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.ColorKeywords = { 'aliceblue': 0xF0F8FF, 'antiquewhite': 0xFAEBD7, 'aqua': 0x00FFFF, 'aquamarine': 0x7FFFD4, 'azure': 0xF0FFFF,\r\n'beige': 0xF5F5DC, 'bisque': 0xFFE4C4, 'black': 0x000000, 'blanchedalmond': 0xFFEBCD, 'blue': 0x0000FF, 'blueviolet': 0x8A2BE2,\r\n'brown': 0xA52A2A, 'burlywood': 0xDEB887, 'cadetblue': 0x5F9EA0, 'chartreuse': 0x7FFF00, 'chocolate': 0xD2691E, 'coral': 0xFF7F50,\r\n'cornflowerblue': 0x6495ED, 'cornsilk': 0xFFF8DC, 'crimson': 0xDC143C, 'cyan': 0x00FFFF, 'darkblue': 0x00008B, 'darkcyan': 0x008B8B,\r\n'darkgoldenrod': 0xB8860B, 'darkgray': 0xA9A9A9, 'darkgreen': 0x006400, 'darkgrey': 0xA9A9A9, 'darkkhaki': 0xBDB76B, 'darkmagenta': 0x8B008B,\r\n'darkolivegreen': 0x556B2F, 'darkorange': 0xFF8C00, 'darkorchid': 0x9932CC, 'darkred': 0x8B0000, 'darksalmon': 0xE9967A, 'darkseagreen': 0x8FBC8F,\r\n'darkslateblue': 0x483D8B, 'darkslategray': 0x2F4F4F, 'darkslategrey': 0x2F4F4F, 'darkturquoise': 0x00CED1, 'darkviolet': 0x9400D3,\r\n'deeppink': 0xFF1493, 'deepskyblue': 0x00BFFF, 'dimgray': 0x696969, 'dimgrey': 0x696969, 'dodgerblue': 0x1E90FF, 'firebrick': 0xB22222,\r\n'floralwhite': 0xFFFAF0, 'forestgreen': 0x228B22, 'fuchsia': 0xFF00FF, 'gainsboro': 0xDCDCDC, 'ghostwhite': 0xF8F8FF, 'gold': 0xFFD700,\r\n'goldenrod': 0xDAA520, 'gray': 0x808080, 'green': 0x008000, 'greenyellow': 0xADFF2F, 'grey': 0x808080, 'honeydew': 0xF0FFF0, 'hotpink': 0xFF69B4,\r\n'indianred': 0xCD5C5C, 'indigo': 0x4B0082, 'ivory': 0xFFFFF0, 'khaki': 0xF0E68C, 'lavender': 0xE6E6FA, 'lavenderblush': 0xFFF0F5, 'lawngreen': 0x7CFC00,\r\n'lemonchiffon': 0xFFFACD, 'lightblue': 0xADD8E6, 'lightcoral': 0xF08080, 'lightcyan': 0xE0FFFF, 'lightgoldenrodyellow': 0xFAFAD2, 'lightgray': 0xD3D3D3,\r\n'lightgreen': 0x90EE90, 'lightgrey': 0xD3D3D3, 'lightpink': 0xFFB6C1, 'lightsalmon': 0xFFA07A, 'lightseagreen': 0x20B2AA, 'lightskyblue': 0x87CEFA,\r\n'lightslategray': 0x778899, 'lightslategrey': 0x778899, 'lightsteelblue': 0xB0C4DE, 'lightyellow': 0xFFFFE0, 'lime': 0x00FF00, 'limegreen': 0x32CD32,\r\n'linen': 0xFAF0E6, 'magenta': 0xFF00FF, 'maroon': 0x800000, 'mediumaquamarine': 0x66CDAA, 'mediumblue': 0x0000CD, 'mediumorchid': 0xBA55D3,\r\n'mediumpurple': 0x9370DB, 'mediumseagreen': 0x3CB371, 'mediumslateblue': 0x7B68EE, 'mediumspringgreen': 0x00FA9A, 'mediumturquoise': 0x48D1CC,\r\n'mediumvioletred': 0xC71585, 'midnightblue': 0x191970, 'mintcream': 0xF5FFFA, 'mistyrose': 0xFFE4E1, 'moccasin': 0xFFE4B5, 'navajowhite': 0xFFDEAD,\r\n'navy': 0x000080, 'oldlace': 0xFDF5E6, 'olive': 0x808000, 'olivedrab': 0x6B8E23, 'orange': 0xFFA500, 'orangered': 0xFF4500, 'orchid': 0xDA70D6,\r\n'palegoldenrod': 0xEEE8AA, 'palegreen': 0x98FB98, 'paleturquoise': 0xAFEEEE, 'palevioletred': 0xDB7093, 'papayawhip': 0xFFEFD5, 'peachpuff': 0xFFDAB9,\r\n'peru': 0xCD853F, 'pink': 0xFFC0CB, 'plum': 0xDDA0DD, 'powderblue': 0xB0E0E6, 'purple': 0x800080, 'red': 0xFF0000, 'rosybrown': 0xBC8F8F,\r\n'royalblue': 0x4169E1, 'saddlebrown': 0x8B4513, 'salmon': 0xFA8072, 'sandybrown': 0xF4A460, 'seagreen': 0x2E8B57, 'seashell': 0xFFF5EE,\r\n'sienna': 0xA0522D, 'silver': 0xC0C0C0, 'skyblue': 0x87CEEB, 'slateblue': 0x6A5ACD, 'slategray': 0x708090, 'slategrey': 0x708090, 'snow': 0xFFFAFA,\r\n'springgreen': 0x00FF7F, 'steelblue': 0x4682B4, 'tan': 0xD2B48C, 'teal': 0x008080, 'thistle': 0xD8BFD8, 'tomato': 0xFF6347, 'turquoise': 0x40E0D0,\r\n'violet': 0xEE82EE, 'wheat': 0xF5DEB3, 'white': 0xFFFFFF, 'whitesmoke': 0xF5F5F5, 'yellow': 0xFFFF00, 'yellowgreen': 0x9ACD32 };\r\n\r\n// File:src/math/Quaternion.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n * @author bhouston / http://clara.io\r\n */\r\n\r\nTHREE.Quaternion = function ( x, y, z, w ) {\r\n\r\n\tthis._x = x || 0;\r\n\tthis._y = y || 0;\r\n\tthis._z = z || 0;\r\n\tthis._w = ( w !== undefined ) ? w : 1;\r\n\r\n};\r\n\r\nTHREE.Quaternion.prototype = {\r\n\r\n\tconstructor: THREE.Quaternion,\r\n\r\n\tget x () {\r\n\r\n\t\treturn this._x;\r\n\r\n\t},\r\n\r\n\tset x ( value ) {\r\n\r\n\t\tthis._x = value;\r\n\t\tthis.onChangeCallback();\r\n\r\n\t},\r\n\r\n\tget y () {\r\n\r\n\t\treturn this._y;\r\n\r\n\t},\r\n\r\n\tset y ( value ) {\r\n\r\n\t\tthis._y = value;\r\n\t\tthis.onChangeCallback();\r\n\r\n\t},\r\n\r\n\tget z () {\r\n\r\n\t\treturn this._z;\r\n\r\n\t},\r\n\r\n\tset z ( value ) {\r\n\r\n\t\tthis._z = value;\r\n\t\tthis.onChangeCallback();\r\n\r\n\t},\r\n\r\n\tget w () {\r\n\r\n\t\treturn this._w;\r\n\r\n\t},\r\n\r\n\tset w ( value ) {\r\n\r\n\t\tthis._w = value;\r\n\t\tthis.onChangeCallback();\r\n\r\n\t},\r\n\r\n\tset: function ( x, y, z, w ) {\r\n\r\n\t\tthis._x = x;\r\n\t\tthis._y = y;\r\n\t\tthis._z = z;\r\n\t\tthis._w = w;\r\n\r\n\t\tthis.onChangeCallback();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor( this._x, this._y, this._z, this._w );\r\n\r\n\t},\r\n\r\n\tcopy: function ( quaternion ) {\r\n\r\n\t\tthis._x = quaternion.x;\r\n\t\tthis._y = quaternion.y;\r\n\t\tthis._z = quaternion.z;\r\n\t\tthis._w = quaternion.w;\r\n\r\n\t\tthis.onChangeCallback();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromEuler: function ( euler, update ) {\r\n\r\n\t\tif ( euler instanceof THREE.Euler === false ) {\r\n\r\n\t\t\tthrow new Error( 'THREE.Quaternion: .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.' );\r\n\r\n\t\t}\r\n\r\n\t\t// http://www.mathworks.com/matlabcentral/fileexchange/\r\n\t\t// \t20696-function-to-convert-between-dcm-euler-angles-quaternions-and-euler-vectors/\r\n\t\t//\tcontent/SpinCalc.m\r\n\r\n\t\tvar c1 = Math.cos( euler._x / 2 );\r\n\t\tvar c2 = Math.cos( euler._y / 2 );\r\n\t\tvar c3 = Math.cos( euler._z / 2 );\r\n\t\tvar s1 = Math.sin( euler._x / 2 );\r\n\t\tvar s2 = Math.sin( euler._y / 2 );\r\n\t\tvar s3 = Math.sin( euler._z / 2 );\r\n\r\n\t\tvar order = euler.order;\r\n\r\n\t\tif ( order === 'XYZ' ) {\r\n\r\n\t\t\tthis._x = s1 * c2 * c3 + c1 * s2 * s3;\r\n\t\t\tthis._y = c1 * s2 * c3 - s1 * c2 * s3;\r\n\t\t\tthis._z = c1 * c2 * s3 + s1 * s2 * c3;\r\n\t\t\tthis._w = c1 * c2 * c3 - s1 * s2 * s3;\r\n\r\n\t\t} else if ( order === 'YXZ' ) {\r\n\r\n\t\t\tthis._x = s1 * c2 * c3 + c1 * s2 * s3;\r\n\t\t\tthis._y = c1 * s2 * c3 - s1 * c2 * s3;\r\n\t\t\tthis._z = c1 * c2 * s3 - s1 * s2 * c3;\r\n\t\t\tthis._w = c1 * c2 * c3 + s1 * s2 * s3;\r\n\r\n\t\t} else if ( order === 'ZXY' ) {\r\n\r\n\t\t\tthis._x = s1 * c2 * c3 - c1 * s2 * s3;\r\n\t\t\tthis._y = c1 * s2 * c3 + s1 * c2 * s3;\r\n\t\t\tthis._z = c1 * c2 * s3 + s1 * s2 * c3;\r\n\t\t\tthis._w = c1 * c2 * c3 - s1 * s2 * s3;\r\n\r\n\t\t} else if ( order === 'ZYX' ) {\r\n\r\n\t\t\tthis._x = s1 * c2 * c3 - c1 * s2 * s3;\r\n\t\t\tthis._y = c1 * s2 * c3 + s1 * c2 * s3;\r\n\t\t\tthis._z = c1 * c2 * s3 - s1 * s2 * c3;\r\n\t\t\tthis._w = c1 * c2 * c3 + s1 * s2 * s3;\r\n\r\n\t\t} else if ( order === 'YZX' ) {\r\n\r\n\t\t\tthis._x = s1 * c2 * c3 + c1 * s2 * s3;\r\n\t\t\tthis._y = c1 * s2 * c3 + s1 * c2 * s3;\r\n\t\t\tthis._z = c1 * c2 * s3 - s1 * s2 * c3;\r\n\t\t\tthis._w = c1 * c2 * c3 - s1 * s2 * s3;\r\n\r\n\t\t} else if ( order === 'XZY' ) {\r\n\r\n\t\t\tthis._x = s1 * c2 * c3 - c1 * s2 * s3;\r\n\t\t\tthis._y = c1 * s2 * c3 - s1 * c2 * s3;\r\n\t\t\tthis._z = c1 * c2 * s3 + s1 * s2 * c3;\r\n\t\t\tthis._w = c1 * c2 * c3 + s1 * s2 * s3;\r\n\r\n\t\t}\r\n\r\n\t\tif ( update !== false ) this.onChangeCallback();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromAxisAngle: function ( axis, angle ) {\r\n\r\n\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/angleToQuaternion/index.htm\r\n\r\n\t\t// assumes axis is normalized\r\n\r\n\t\tvar halfAngle = angle / 2, s = Math.sin( halfAngle );\r\n\r\n\t\tthis._x = axis.x * s;\r\n\t\tthis._y = axis.y * s;\r\n\t\tthis._z = axis.z * s;\r\n\t\tthis._w = Math.cos( halfAngle );\r\n\r\n\t\tthis.onChangeCallback();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromRotationMatrix: function ( m ) {\r\n\r\n\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/matrixToQuaternion/index.htm\r\n\r\n\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\r\n\r\n\t\tvar te = m.elements,\r\n\r\n\t\t\tm11 = te[ 0 ], m12 = te[ 4 ], m13 = te[ 8 ],\r\n\t\t\tm21 = te[ 1 ], m22 = te[ 5 ], m23 = te[ 9 ],\r\n\t\t\tm31 = te[ 2 ], m32 = te[ 6 ], m33 = te[ 10 ],\r\n\r\n\t\t\ttrace = m11 + m22 + m33,\r\n\t\t\ts;\r\n\r\n\t\tif ( trace > 0 ) {\r\n\r\n\t\t\ts = 0.5 / Math.sqrt( trace + 1.0 );\r\n\r\n\t\t\tthis._w = 0.25 / s;\r\n\t\t\tthis._x = ( m32 - m23 ) * s;\r\n\t\t\tthis._y = ( m13 - m31 ) * s;\r\n\t\t\tthis._z = ( m21 - m12 ) * s;\r\n\r\n\t\t} else if ( m11 > m22 && m11 > m33 ) {\r\n\r\n\t\t\ts = 2.0 * Math.sqrt( 1.0 + m11 - m22 - m33 );\r\n\r\n\t\t\tthis._w = ( m32 - m23 ) / s;\r\n\t\t\tthis._x = 0.25 * s;\r\n\t\t\tthis._y = ( m12 + m21 ) / s;\r\n\t\t\tthis._z = ( m13 + m31 ) / s;\r\n\r\n\t\t} else if ( m22 > m33 ) {\r\n\r\n\t\t\ts = 2.0 * Math.sqrt( 1.0 + m22 - m11 - m33 );\r\n\r\n\t\t\tthis._w = ( m13 - m31 ) / s;\r\n\t\t\tthis._x = ( m12 + m21 ) / s;\r\n\t\t\tthis._y = 0.25 * s;\r\n\t\t\tthis._z = ( m23 + m32 ) / s;\r\n\r\n\t\t} else {\r\n\r\n\t\t\ts = 2.0 * Math.sqrt( 1.0 + m33 - m11 - m22 );\r\n\r\n\t\t\tthis._w = ( m21 - m12 ) / s;\r\n\t\t\tthis._x = ( m13 + m31 ) / s;\r\n\t\t\tthis._y = ( m23 + m32 ) / s;\r\n\t\t\tthis._z = 0.25 * s;\r\n\r\n\t\t}\r\n\r\n\t\tthis.onChangeCallback();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromUnitVectors: function () {\r\n\r\n\t\t// http://lolengine.net/blog/2014/02/24/quaternion-from-two-vectors-final\r\n\r\n\t\t// assumes direction vectors vFrom and vTo are normalized\r\n\r\n\t\tvar v1, r;\r\n\r\n\t\tvar EPS = 0.000001;\r\n\r\n\t\treturn function ( vFrom, vTo ) {\r\n\r\n\t\t\tif ( v1 === undefined ) v1 = new THREE.Vector3();\r\n\r\n\t\t\tr = vFrom.dot( vTo ) + 1;\r\n\r\n\t\t\tif ( r < EPS ) {\r\n\r\n\t\t\t\tr = 0;\r\n\r\n\t\t\t\tif ( Math.abs( vFrom.x ) > Math.abs( vFrom.z ) ) {\r\n\r\n\t\t\t\t\tv1.set( - vFrom.y, vFrom.x, 0 );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tv1.set( 0, - vFrom.z, vFrom.y );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tv1.crossVectors( vFrom, vTo );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis._x = v1.x;\r\n\t\t\tthis._y = v1.y;\r\n\t\t\tthis._z = v1.z;\r\n\t\t\tthis._w = r;\r\n\r\n\t\t\treturn this.normalize();\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tinverse: function () {\r\n\r\n\t\treturn this.conjugate().normalize();\r\n\r\n\t},\r\n\r\n\tconjugate: function () {\r\n\r\n\t\tthis._x *= - 1;\r\n\t\tthis._y *= - 1;\r\n\t\tthis._z *= - 1;\r\n\r\n\t\tthis.onChangeCallback();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdot: function ( v ) {\r\n\r\n\t\treturn this._x * v._x + this._y * v._y + this._z * v._z + this._w * v._w;\r\n\r\n\t},\r\n\r\n\tlengthSq: function () {\r\n\r\n\t\treturn this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w;\r\n\r\n\t},\r\n\r\n\tlength: function () {\r\n\r\n\t\treturn Math.sqrt( this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w );\r\n\r\n\t},\r\n\r\n\tnormalize: function () {\r\n\r\n\t\tvar l = this.length();\r\n\r\n\t\tif ( l === 0 ) {\r\n\r\n\t\t\tthis._x = 0;\r\n\t\t\tthis._y = 0;\r\n\t\t\tthis._z = 0;\r\n\t\t\tthis._w = 1;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tl = 1 / l;\r\n\r\n\t\t\tthis._x = this._x * l;\r\n\t\t\tthis._y = this._y * l;\r\n\t\t\tthis._z = this._z * l;\r\n\t\t\tthis._w = this._w * l;\r\n\r\n\t\t}\r\n\r\n\t\tthis.onChangeCallback();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmultiply: function ( q, p ) {\r\n\r\n\t\tif ( p !== undefined ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead.' );\r\n\t\t\treturn this.multiplyQuaternions( q, p );\r\n\r\n\t\t}\r\n\r\n\t\treturn this.multiplyQuaternions( this, q );\r\n\r\n\t},\r\n\r\n\tpremultiply: function ( q ) {\r\n\r\n\t\treturn this.multiplyQuaternions( q, this );\r\n\r\n\t},\r\n\r\n\tmultiplyQuaternions: function ( a, b ) {\r\n\r\n\t\t// from http://www.euclideanspace.com/maths/algebra/realNormedAlgebra/quaternions/code/index.htm\r\n\r\n\t\tvar qax = a._x, qay = a._y, qaz = a._z, qaw = a._w;\r\n\t\tvar qbx = b._x, qby = b._y, qbz = b._z, qbw = b._w;\r\n\r\n\t\tthis._x = qax * qbw + qaw * qbx + qay * qbz - qaz * qby;\r\n\t\tthis._y = qay * qbw + qaw * qby + qaz * qbx - qax * qbz;\r\n\t\tthis._z = qaz * qbw + qaw * qbz + qax * qby - qay * qbx;\r\n\t\tthis._w = qaw * qbw - qax * qbx - qay * qby - qaz * qbz;\r\n\r\n\t\tthis.onChangeCallback();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tslerp: function ( qb, t ) {\r\n\r\n\t\tif ( t === 0 ) return this;\r\n\t\tif ( t === 1 ) return this.copy( qb );\r\n\r\n\t\tvar x = this._x, y = this._y, z = this._z, w = this._w;\r\n\r\n\t\t// http://www.euclideanspace.com/maths/algebra/realNormedAlgebra/quaternions/slerp/\r\n\r\n\t\tvar cosHalfTheta = w * qb._w + x * qb._x + y * qb._y + z * qb._z;\r\n\r\n\t\tif ( cosHalfTheta < 0 ) {\r\n\r\n\t\t\tthis._w = - qb._w;\r\n\t\t\tthis._x = - qb._x;\r\n\t\t\tthis._y = - qb._y;\r\n\t\t\tthis._z = - qb._z;\r\n\r\n\t\t\tcosHalfTheta = - cosHalfTheta;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.copy( qb );\r\n\r\n\t\t}\r\n\r\n\t\tif ( cosHalfTheta >= 1.0 ) {\r\n\r\n\t\t\tthis._w = w;\r\n\t\t\tthis._x = x;\r\n\t\t\tthis._y = y;\r\n\t\t\tthis._z = z;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t\tvar sinHalfTheta = Math.sqrt( 1.0 - cosHalfTheta * cosHalfTheta );\r\n\r\n\t\tif ( Math.abs( sinHalfTheta ) < 0.001 ) {\r\n\r\n\t\t\tthis._w = 0.5 * ( w + this._w );\r\n\t\t\tthis._x = 0.5 * ( x + this._x );\r\n\t\t\tthis._y = 0.5 * ( y + this._y );\r\n\t\t\tthis._z = 0.5 * ( z + this._z );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t\tvar halfTheta = Math.atan2( sinHalfTheta, cosHalfTheta );\r\n\t\tvar ratioA = Math.sin( ( 1 - t ) * halfTheta ) / sinHalfTheta,\r\n\t\tratioB = Math.sin( t * halfTheta ) / sinHalfTheta;\r\n\r\n\t\tthis._w = ( w * ratioA + this._w * ratioB );\r\n\t\tthis._x = ( x * ratioA + this._x * ratioB );\r\n\t\tthis._y = ( y * ratioA + this._y * ratioB );\r\n\t\tthis._z = ( z * ratioA + this._z * ratioB );\r\n\r\n\t\tthis.onChangeCallback();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tequals: function ( quaternion ) {\r\n\r\n\t\treturn ( quaternion._x === this._x ) && ( quaternion._y === this._y ) && ( quaternion._z === this._z ) && ( quaternion._w === this._w );\r\n\r\n\t},\r\n\r\n\tfromArray: function ( array, offset ) {\r\n\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tthis._x = array[ offset ];\r\n\t\tthis._y = array[ offset + 1 ];\r\n\t\tthis._z = array[ offset + 2 ];\r\n\t\tthis._w = array[ offset + 3 ];\r\n\r\n\t\tthis.onChangeCallback();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\ttoArray: function ( array, offset ) {\r\n\r\n\t\tif ( array === undefined ) array = [];\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tarray[ offset ] = this._x;\r\n\t\tarray[ offset + 1 ] = this._y;\r\n\t\tarray[ offset + 2 ] = this._z;\r\n\t\tarray[ offset + 3 ] = this._w;\r\n\r\n\t\treturn array;\r\n\r\n\t},\r\n\r\n\tonChange: function ( callback ) {\r\n\r\n\t\tthis.onChangeCallback = callback;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tonChangeCallback: function () {}\r\n\r\n};\r\n\r\nObject.assign( THREE.Quaternion, {\r\n\r\n\tslerp: function( qa, qb, qm, t ) {\r\n\r\n\t\treturn qm.copy( qa ).slerp( qb, t );\r\n\r\n\t},\r\n\r\n\tslerpFlat: function(\r\n\t\t\tdst, dstOffset, src0, srcOffset0, src1, srcOffset1, t ) {\r\n\r\n\t\t// fuzz-free, array-based Quaternion SLERP operation\r\n\r\n\t\tvar x0 = src0[ srcOffset0 + 0 ],\r\n\t\t\ty0 = src0[ srcOffset0 + 1 ],\r\n\t\t\tz0 = src0[ srcOffset0 + 2 ],\r\n\t\t\tw0 = src0[ srcOffset0 + 3 ],\r\n\r\n\t\t\tx1 = src1[ srcOffset1 + 0 ],\r\n\t\t\ty1 = src1[ srcOffset1 + 1 ],\r\n\t\t\tz1 = src1[ srcOffset1 + 2 ],\r\n\t\t\tw1 = src1[ srcOffset1 + 3 ];\r\n\r\n\t\tif ( w0 !== w1 || x0 !== x1 || y0 !== y1 || z0 !== z1 ) {\r\n\r\n\t\t\tvar s = 1 - t,\r\n\r\n\t\t\t\tcos = x0 * x1 + y0 * y1 + z0 * z1 + w0 * w1,\r\n\r\n\t\t\t\tdir = ( cos >= 0 ? 1 : - 1 ),\r\n\t\t\t\tsqrSin = 1 - cos * cos;\r\n\r\n\t\t\t// Skip the Slerp for tiny steps to avoid numeric problems:\r\n\t\t\tif ( sqrSin > Number.EPSILON ) {\r\n\r\n\t\t\t\tvar sin = Math.sqrt( sqrSin ),\r\n\t\t\t\t\tlen = Math.atan2( sin, cos * dir );\r\n\r\n\t\t\t\ts = Math.sin( s * len ) / sin;\r\n\t\t\t\tt = Math.sin( t * len ) / sin;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar tDir = t * dir;\r\n\r\n\t\t\tx0 = x0 * s + x1 * tDir;\r\n\t\t\ty0 = y0 * s + y1 * tDir;\r\n\t\t\tz0 = z0 * s + z1 * tDir;\r\n\t\t\tw0 = w0 * s + w1 * tDir;\r\n\r\n\t\t\t// Normalize in case we just did a lerp:\r\n\t\t\tif ( s === 1 - t ) {\r\n\r\n\t\t\t\tvar f = 1 / Math.sqrt( x0 * x0 + y0 * y0 + z0 * z0 + w0 * w0 );\r\n\r\n\t\t\t\tx0 *= f;\r\n\t\t\t\ty0 *= f;\r\n\t\t\t\tz0 *= f;\r\n\t\t\t\tw0 *= f;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tdst[ dstOffset ] = x0;\r\n\t\tdst[ dstOffset + 1 ] = y0;\r\n\t\tdst[ dstOffset + 2 ] = z0;\r\n\t\tdst[ dstOffset + 3 ] = w0;\r\n\r\n\t}\r\n\r\n} );\r\n\r\n// File:src/math/Vector2.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author philogb / http://blog.thejit.org/\r\n * @author egraether / http://egraether.com/\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n */\r\n\r\nTHREE.Vector2 = function ( x, y ) {\r\n\r\n\tthis.x = x || 0;\r\n\tthis.y = y || 0;\r\n\r\n};\r\n\r\nTHREE.Vector2.prototype = {\r\n\r\n\tconstructor: THREE.Vector2,\r\n\r\n\tget width() {\r\n\r\n\t\treturn this.x;\r\n\r\n\t},\r\n\r\n\tset width( value ) {\r\n\r\n\t\tthis.x = value;\r\n\r\n\t},\r\n\r\n\tget height() {\r\n\r\n\t\treturn this.y;\r\n\r\n\t},\r\n\r\n\tset height( value ) {\r\n\r\n\t\tthis.y = value;\r\n\r\n\t},\r\n\r\n\t//\r\n\r\n\tset: function ( x, y ) {\r\n\r\n\t\tthis.x = x;\r\n\t\tthis.y = y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetScalar: function ( scalar ) {\r\n\r\n\t\tthis.x = scalar;\r\n\t\tthis.y = scalar;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetX: function ( x ) {\r\n\r\n\t\tthis.x = x;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetY: function ( y ) {\r\n\r\n\t\tthis.y = y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetComponent: function ( index, value ) {\r\n\r\n\t\tswitch ( index ) {\r\n\r\n\t\t\tcase 0: this.x = value; break;\r\n\t\t\tcase 1: this.y = value; break;\r\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tgetComponent: function ( index ) {\r\n\r\n\t\tswitch ( index ) {\r\n\r\n\t\t\tcase 0: return this.x;\r\n\t\t\tcase 1: return this.y;\r\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor( this.x, this.y );\r\n\r\n\t},\r\n\r\n\tcopy: function ( v ) {\r\n\r\n\t\tthis.x = v.x;\r\n\t\tthis.y = v.y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tadd: function ( v, w ) {\r\n\r\n\t\tif ( w !== undefined ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead.' );\r\n\t\t\treturn this.addVectors( v, w );\r\n\r\n\t\t}\r\n\r\n\t\tthis.x += v.x;\r\n\t\tthis.y += v.y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\taddScalar: function ( s ) {\r\n\r\n\t\tthis.x += s;\r\n\t\tthis.y += s;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\taddVectors: function ( a, b ) {\r\n\r\n\t\tthis.x = a.x + b.x;\r\n\t\tthis.y = a.y + b.y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\taddScaledVector: function ( v, s ) {\r\n\r\n\t\tthis.x += v.x * s;\r\n\t\tthis.y += v.y * s;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsub: function ( v, w ) {\r\n\r\n\t\tif ( w !== undefined ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.' );\r\n\t\t\treturn this.subVectors( v, w );\r\n\r\n\t\t}\r\n\r\n\t\tthis.x -= v.x;\r\n\t\tthis.y -= v.y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsubScalar: function ( s ) {\r\n\r\n\t\tthis.x -= s;\r\n\t\tthis.y -= s;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsubVectors: function ( a, b ) {\r\n\r\n\t\tthis.x = a.x - b.x;\r\n\t\tthis.y = a.y - b.y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmultiply: function ( v ) {\r\n\r\n\t\tthis.x *= v.x;\r\n\t\tthis.y *= v.y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmultiplyScalar: function ( scalar ) {\r\n\r\n\t\tif ( isFinite( scalar ) ) {\r\n\r\n\t\t\tthis.x *= scalar;\r\n\t\t\tthis.y *= scalar;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.x = 0;\r\n\t\t\tthis.y = 0;\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdivide: function ( v ) {\r\n\r\n\t\tthis.x /= v.x;\r\n\t\tthis.y /= v.y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdivideScalar: function ( scalar ) {\r\n\r\n\t\treturn this.multiplyScalar( 1 / scalar );\r\n\r\n\t},\r\n\r\n\tmin: function ( v ) {\r\n\r\n\t\tthis.x = Math.min( this.x, v.x );\r\n\t\tthis.y = Math.min( this.y, v.y );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmax: function ( v ) {\r\n\r\n\t\tthis.x = Math.max( this.x, v.x );\r\n\t\tthis.y = Math.max( this.y, v.y );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclamp: function ( min, max ) {\r\n\r\n\t\t// This function assumes min < max, if this assumption isn't true it will not operate correctly\r\n\r\n\t\tthis.x = Math.max( min.x, Math.min( max.x, this.x ) );\r\n\t\tthis.y = Math.max( min.y, Math.min( max.y, this.y ) );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclampScalar: function () {\r\n\r\n\t\tvar min, max;\r\n\r\n\t\treturn function clampScalar( minVal, maxVal ) {\r\n\r\n\t\t\tif ( min === undefined ) {\r\n\r\n\t\t\t\tmin = new THREE.Vector2();\r\n\t\t\t\tmax = new THREE.Vector2();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tmin.set( minVal, minVal );\r\n\t\t\tmax.set( maxVal, maxVal );\r\n\r\n\t\t\treturn this.clamp( min, max );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tclampLength: function ( min, max ) {\r\n\r\n\t\tvar length = this.length();\r\n\r\n\t\treturn this.multiplyScalar( Math.max( min, Math.min( max, length ) ) / length );\r\n\r\n\t},\r\n\r\n\tfloor: function () {\r\n\r\n\t\tthis.x = Math.floor( this.x );\r\n\t\tthis.y = Math.floor( this.y );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tceil: function () {\r\n\r\n\t\tthis.x = Math.ceil( this.x );\r\n\t\tthis.y = Math.ceil( this.y );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tround: function () {\r\n\r\n\t\tthis.x = Math.round( this.x );\r\n\t\tthis.y = Math.round( this.y );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\troundToZero: function () {\r\n\r\n\t\tthis.x = ( this.x < 0 ) ? Math.ceil( this.x ) : Math.floor( this.x );\r\n\t\tthis.y = ( this.y < 0 ) ? Math.ceil( this.y ) : Math.floor( this.y );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tnegate: function () {\r\n\r\n\t\tthis.x = - this.x;\r\n\t\tthis.y = - this.y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdot: function ( v ) {\r\n\r\n\t\treturn this.x * v.x + this.y * v.y;\r\n\r\n\t},\r\n\r\n\tlengthSq: function () {\r\n\r\n\t\treturn this.x * this.x + this.y * this.y;\r\n\r\n\t},\r\n\r\n\tlength: function () {\r\n\r\n\t\treturn Math.sqrt( this.x * this.x + this.y * this.y );\r\n\r\n\t},\r\n\r\n\tlengthManhattan: function() {\r\n\r\n\t\treturn Math.abs( this.x ) + Math.abs( this.y );\r\n\r\n\t},\r\n\r\n\tnormalize: function () {\r\n\r\n\t\treturn this.divideScalar( this.length() );\r\n\r\n\t},\r\n\r\n\tangle: function () {\r\n\r\n\t\t// computes the angle in radians with respect to the positive x-axis\r\n\r\n\t\tvar angle = Math.atan2( this.y, this.x );\r\n\r\n\t\tif ( angle < 0 ) angle += 2 * Math.PI;\r\n\r\n\t\treturn angle;\r\n\r\n\t},\r\n\r\n\tdistanceTo: function ( v ) {\r\n\r\n\t\treturn Math.sqrt( this.distanceToSquared( v ) );\r\n\r\n\t},\r\n\r\n\tdistanceToSquared: function ( v ) {\r\n\r\n\t\tvar dx = this.x - v.x, dy = this.y - v.y;\r\n\t\treturn dx * dx + dy * dy;\r\n\r\n\t},\r\n\r\n\tsetLength: function ( length ) {\r\n\r\n\t\treturn this.multiplyScalar( length / this.length() );\r\n\r\n\t},\r\n\r\n\tlerp: function ( v, alpha ) {\r\n\r\n\t\tthis.x += ( v.x - this.x ) * alpha;\r\n\t\tthis.y += ( v.y - this.y ) * alpha;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tlerpVectors: function ( v1, v2, alpha ) {\r\n\r\n\t\treturn this.subVectors( v2, v1 ).multiplyScalar( alpha ).add( v1 );\r\n\r\n\t},\r\n\r\n\tequals: function ( v ) {\r\n\r\n\t\treturn ( ( v.x === this.x ) && ( v.y === this.y ) );\r\n\r\n\t},\r\n\r\n\tfromArray: function ( array, offset ) {\r\n\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tthis.x = array[ offset ];\r\n\t\tthis.y = array[ offset + 1 ];\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\ttoArray: function ( array, offset ) {\r\n\r\n\t\tif ( array === undefined ) array = [];\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tarray[ offset ] = this.x;\r\n\t\tarray[ offset + 1 ] = this.y;\r\n\r\n\t\treturn array;\r\n\r\n\t},\r\n\r\n\tfromAttribute: function ( attribute, index, offset ) {\r\n\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tindex = index * attribute.itemSize + offset;\r\n\r\n\t\tthis.x = attribute.array[ index ];\r\n\t\tthis.y = attribute.array[ index + 1 ];\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\trotateAround: function ( center, angle ) {\r\n\r\n\t\tvar c = Math.cos( angle ), s = Math.sin( angle );\r\n\r\n\t\tvar x = this.x - center.x;\r\n\t\tvar y = this.y - center.y;\r\n\r\n\t\tthis.x = x * c - y * s + center.x;\r\n\t\tthis.y = x * s + y * c + center.y;\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Vector3.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author *kile / http://kile.stravaganza.org/\r\n * @author philogb / http://blog.thejit.org/\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author egraether / http://egraether.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.Vector3 = function ( x, y, z ) {\r\n\r\n\tthis.x = x || 0;\r\n\tthis.y = y || 0;\r\n\tthis.z = z || 0;\r\n\r\n};\r\n\r\nTHREE.Vector3.prototype = {\r\n\r\n\tconstructor: THREE.Vector3,\r\n\r\n\tset: function ( x, y, z ) {\r\n\r\n\t\tthis.x = x;\r\n\t\tthis.y = y;\r\n\t\tthis.z = z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetScalar: function ( scalar ) {\r\n\r\n\t\tthis.x = scalar;\r\n\t\tthis.y = scalar;\r\n\t\tthis.z = scalar;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetX: function ( x ) {\r\n\r\n\t\tthis.x = x;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetY: function ( y ) {\r\n\r\n\t\tthis.y = y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetZ: function ( z ) {\r\n\r\n\t\tthis.z = z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetComponent: function ( index, value ) {\r\n\r\n\t\tswitch ( index ) {\r\n\r\n\t\t\tcase 0: this.x = value; break;\r\n\t\t\tcase 1: this.y = value; break;\r\n\t\t\tcase 2: this.z = value; break;\r\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tgetComponent: function ( index ) {\r\n\r\n\t\tswitch ( index ) {\r\n\r\n\t\t\tcase 0: return this.x;\r\n\t\t\tcase 1: return this.y;\r\n\t\t\tcase 2: return this.z;\r\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor( this.x, this.y, this.z );\r\n\r\n\t},\r\n\r\n\tcopy: function ( v ) {\r\n\r\n\t\tthis.x = v.x;\r\n\t\tthis.y = v.y;\r\n\t\tthis.z = v.z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tadd: function ( v, w ) {\r\n\r\n\t\tif ( w !== undefined ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead.' );\r\n\t\t\treturn this.addVectors( v, w );\r\n\r\n\t\t}\r\n\r\n\t\tthis.x += v.x;\r\n\t\tthis.y += v.y;\r\n\t\tthis.z += v.z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\taddScalar: function ( s ) {\r\n\r\n\t\tthis.x += s;\r\n\t\tthis.y += s;\r\n\t\tthis.z += s;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\taddVectors: function ( a, b ) {\r\n\r\n\t\tthis.x = a.x + b.x;\r\n\t\tthis.y = a.y + b.y;\r\n\t\tthis.z = a.z + b.z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\taddScaledVector: function ( v, s ) {\r\n\r\n\t\tthis.x += v.x * s;\r\n\t\tthis.y += v.y * s;\r\n\t\tthis.z += v.z * s;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsub: function ( v, w ) {\r\n\r\n\t\tif ( w !== undefined ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.' );\r\n\t\t\treturn this.subVectors( v, w );\r\n\r\n\t\t}\r\n\r\n\t\tthis.x -= v.x;\r\n\t\tthis.y -= v.y;\r\n\t\tthis.z -= v.z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsubScalar: function ( s ) {\r\n\r\n\t\tthis.x -= s;\r\n\t\tthis.y -= s;\r\n\t\tthis.z -= s;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsubVectors: function ( a, b ) {\r\n\r\n\t\tthis.x = a.x - b.x;\r\n\t\tthis.y = a.y - b.y;\r\n\t\tthis.z = a.z - b.z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmultiply: function ( v, w ) {\r\n\r\n\t\tif ( w !== undefined ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead.' );\r\n\t\t\treturn this.multiplyVectors( v, w );\r\n\r\n\t\t}\r\n\r\n\t\tthis.x *= v.x;\r\n\t\tthis.y *= v.y;\r\n\t\tthis.z *= v.z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmultiplyScalar: function ( scalar ) {\r\n\r\n\t\tif ( isFinite( scalar ) ) {\r\n\r\n\t\t\tthis.x *= scalar;\r\n\t\t\tthis.y *= scalar;\r\n\t\t\tthis.z *= scalar;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.x = 0;\r\n\t\t\tthis.y = 0;\r\n\t\t\tthis.z = 0;\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmultiplyVectors: function ( a, b ) {\r\n\r\n\t\tthis.x = a.x * b.x;\r\n\t\tthis.y = a.y * b.y;\r\n\t\tthis.z = a.z * b.z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tapplyEuler: function () {\r\n\r\n\t\tvar quaternion;\r\n\r\n\t\treturn function applyEuler( euler ) {\r\n\r\n\t\t\tif ( euler instanceof THREE.Euler === false ) {\r\n\r\n\t\t\t\tconsole.error( 'THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order.' );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( quaternion === undefined ) quaternion = new THREE.Quaternion();\r\n\r\n\t\t\treturn this.applyQuaternion( quaternion.setFromEuler( euler ) );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tapplyAxisAngle: function () {\r\n\r\n\t\tvar quaternion;\r\n\r\n\t\treturn function applyAxisAngle( axis, angle ) {\r\n\r\n\t\t\tif ( quaternion === undefined ) quaternion = new THREE.Quaternion();\r\n\r\n\t\t\treturn this.applyQuaternion( quaternion.setFromAxisAngle( axis, angle ) );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tapplyMatrix3: function ( m ) {\r\n\r\n\t\tvar x = this.x, y = this.y, z = this.z;\r\n\t\tvar e = m.elements;\r\n\r\n\t\tthis.x = e[ 0 ] * x + e[ 3 ] * y + e[ 6 ] * z;\r\n\t\tthis.y = e[ 1 ] * x + e[ 4 ] * y + e[ 7 ] * z;\r\n\t\tthis.z = e[ 2 ] * x + e[ 5 ] * y + e[ 8 ] * z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tapplyMatrix4: function ( m ) {\r\n\r\n\t\t// input: THREE.Matrix4 affine matrix\r\n\r\n\t\tvar x = this.x, y = this.y, z = this.z;\r\n\t\tvar e = m.elements;\r\n\r\n\t\tthis.x = e[ 0 ] * x + e[ 4 ] * y + e[ 8 ]  * z + e[ 12 ];\r\n\t\tthis.y = e[ 1 ] * x + e[ 5 ] * y + e[ 9 ]  * z + e[ 13 ];\r\n\t\tthis.z = e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z + e[ 14 ];\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tapplyProjection: function ( m ) {\r\n\r\n\t\t// input: THREE.Matrix4 projection matrix\r\n\r\n\t\tvar x = this.x, y = this.y, z = this.z;\r\n\t\tvar e = m.elements;\r\n\t\tvar d = 1 / ( e[ 3 ] * x + e[ 7 ] * y + e[ 11 ] * z + e[ 15 ] ); // perspective divide\r\n\r\n\t\tthis.x = ( e[ 0 ] * x + e[ 4 ] * y + e[ 8 ]  * z + e[ 12 ] ) * d;\r\n\t\tthis.y = ( e[ 1 ] * x + e[ 5 ] * y + e[ 9 ]  * z + e[ 13 ] ) * d;\r\n\t\tthis.z = ( e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z + e[ 14 ] ) * d;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tapplyQuaternion: function ( q ) {\r\n\r\n\t\tvar x = this.x, y = this.y, z = this.z;\r\n\t\tvar qx = q.x, qy = q.y, qz = q.z, qw = q.w;\r\n\r\n\t\t// calculate quat * vector\r\n\r\n\t\tvar ix =  qw * x + qy * z - qz * y;\r\n\t\tvar iy =  qw * y + qz * x - qx * z;\r\n\t\tvar iz =  qw * z + qx * y - qy * x;\r\n\t\tvar iw = - qx * x - qy * y - qz * z;\r\n\r\n\t\t// calculate result * inverse quat\r\n\r\n\t\tthis.x = ix * qw + iw * - qx + iy * - qz - iz * - qy;\r\n\t\tthis.y = iy * qw + iw * - qy + iz * - qx - ix * - qz;\r\n\t\tthis.z = iz * qw + iw * - qz + ix * - qy - iy * - qx;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tproject: function () {\r\n\r\n\t\tvar matrix;\r\n\r\n\t\treturn function project( camera ) {\r\n\r\n\t\t\tif ( matrix === undefined ) matrix = new THREE.Matrix4();\r\n\r\n\t\t\tmatrix.multiplyMatrices( camera.projectionMatrix, matrix.getInverse( camera.matrixWorld ) );\r\n\t\t\treturn this.applyProjection( matrix );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tunproject: function () {\r\n\r\n\t\tvar matrix;\r\n\r\n\t\treturn function unproject( camera ) {\r\n\r\n\t\t\tif ( matrix === undefined ) matrix = new THREE.Matrix4();\r\n\r\n\t\t\tmatrix.multiplyMatrices( camera.matrixWorld, matrix.getInverse( camera.projectionMatrix ) );\r\n\t\t\treturn this.applyProjection( matrix );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\ttransformDirection: function ( m ) {\r\n\r\n\t\t// input: THREE.Matrix4 affine matrix\r\n\t\t// vector interpreted as a direction\r\n\r\n\t\tvar x = this.x, y = this.y, z = this.z;\r\n\t\tvar e = m.elements;\r\n\r\n\t\tthis.x = e[ 0 ] * x + e[ 4 ] * y + e[ 8 ]  * z;\r\n\t\tthis.y = e[ 1 ] * x + e[ 5 ] * y + e[ 9 ]  * z;\r\n\t\tthis.z = e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z;\r\n\r\n\t\treturn this.normalize();\r\n\r\n\t},\r\n\r\n\tdivide: function ( v ) {\r\n\r\n\t\tthis.x /= v.x;\r\n\t\tthis.y /= v.y;\r\n\t\tthis.z /= v.z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdivideScalar: function ( scalar ) {\r\n\r\n\t\treturn this.multiplyScalar( 1 / scalar );\r\n\r\n\t},\r\n\r\n\tmin: function ( v ) {\r\n\r\n\t\tthis.x = Math.min( this.x, v.x );\r\n\t\tthis.y = Math.min( this.y, v.y );\r\n\t\tthis.z = Math.min( this.z, v.z );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmax: function ( v ) {\r\n\r\n\t\tthis.x = Math.max( this.x, v.x );\r\n\t\tthis.y = Math.max( this.y, v.y );\r\n\t\tthis.z = Math.max( this.z, v.z );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclamp: function ( min, max ) {\r\n\r\n\t\t// This function assumes min < max, if this assumption isn't true it will not operate correctly\r\n\r\n\t\tthis.x = Math.max( min.x, Math.min( max.x, this.x ) );\r\n\t\tthis.y = Math.max( min.y, Math.min( max.y, this.y ) );\r\n\t\tthis.z = Math.max( min.z, Math.min( max.z, this.z ) );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclampScalar: function () {\r\n\r\n\t\tvar min, max;\r\n\r\n\t\treturn function clampScalar( minVal, maxVal ) {\r\n\r\n\t\t\tif ( min === undefined ) {\r\n\r\n\t\t\t\tmin = new THREE.Vector3();\r\n\t\t\t\tmax = new THREE.Vector3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tmin.set( minVal, minVal, minVal );\r\n\t\t\tmax.set( maxVal, maxVal, maxVal );\r\n\r\n\t\t\treturn this.clamp( min, max );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tclampLength: function ( min, max ) {\r\n\r\n\t\tvar length = this.length();\r\n\r\n\t\treturn this.multiplyScalar( Math.max( min, Math.min( max, length ) ) / length );\r\n\r\n\t},\r\n\r\n\tfloor: function () {\r\n\r\n\t\tthis.x = Math.floor( this.x );\r\n\t\tthis.y = Math.floor( this.y );\r\n\t\tthis.z = Math.floor( this.z );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tceil: function () {\r\n\r\n\t\tthis.x = Math.ceil( this.x );\r\n\t\tthis.y = Math.ceil( this.y );\r\n\t\tthis.z = Math.ceil( this.z );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tround: function () {\r\n\r\n\t\tthis.x = Math.round( this.x );\r\n\t\tthis.y = Math.round( this.y );\r\n\t\tthis.z = Math.round( this.z );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\troundToZero: function () {\r\n\r\n\t\tthis.x = ( this.x < 0 ) ? Math.ceil( this.x ) : Math.floor( this.x );\r\n\t\tthis.y = ( this.y < 0 ) ? Math.ceil( this.y ) : Math.floor( this.y );\r\n\t\tthis.z = ( this.z < 0 ) ? Math.ceil( this.z ) : Math.floor( this.z );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tnegate: function () {\r\n\r\n\t\tthis.x = - this.x;\r\n\t\tthis.y = - this.y;\r\n\t\tthis.z = - this.z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdot: function ( v ) {\r\n\r\n\t\treturn this.x * v.x + this.y * v.y + this.z * v.z;\r\n\r\n\t},\r\n\r\n\tlengthSq: function () {\r\n\r\n\t\treturn this.x * this.x + this.y * this.y + this.z * this.z;\r\n\r\n\t},\r\n\r\n\tlength: function () {\r\n\r\n\t\treturn Math.sqrt( this.x * this.x + this.y * this.y + this.z * this.z );\r\n\r\n\t},\r\n\r\n\tlengthManhattan: function () {\r\n\r\n\t\treturn Math.abs( this.x ) + Math.abs( this.y ) + Math.abs( this.z );\r\n\r\n\t},\r\n\r\n\tnormalize: function () {\r\n\r\n\t\treturn this.divideScalar( this.length() );\r\n\r\n\t},\r\n\r\n\tsetLength: function ( length ) {\r\n\r\n\t\treturn this.multiplyScalar( length / this.length() );\r\n\r\n\t},\r\n\r\n\tlerp: function ( v, alpha ) {\r\n\r\n\t\tthis.x += ( v.x - this.x ) * alpha;\r\n\t\tthis.y += ( v.y - this.y ) * alpha;\r\n\t\tthis.z += ( v.z - this.z ) * alpha;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tlerpVectors: function ( v1, v2, alpha ) {\r\n\r\n\t\treturn this.subVectors( v2, v1 ).multiplyScalar( alpha ).add( v1 );\r\n\r\n\t},\r\n\r\n\tcross: function ( v, w ) {\r\n\r\n\t\tif ( w !== undefined ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead.' );\r\n\t\t\treturn this.crossVectors( v, w );\r\n\r\n\t\t}\r\n\r\n\t\tvar x = this.x, y = this.y, z = this.z;\r\n\r\n\t\tthis.x = y * v.z - z * v.y;\r\n\t\tthis.y = z * v.x - x * v.z;\r\n\t\tthis.z = x * v.y - y * v.x;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcrossVectors: function ( a, b ) {\r\n\r\n\t\tvar ax = a.x, ay = a.y, az = a.z;\r\n\t\tvar bx = b.x, by = b.y, bz = b.z;\r\n\r\n\t\tthis.x = ay * bz - az * by;\r\n\t\tthis.y = az * bx - ax * bz;\r\n\t\tthis.z = ax * by - ay * bx;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tprojectOnVector: function () {\r\n\r\n\t\tvar v1, dot;\r\n\r\n\t\treturn function projectOnVector( vector ) {\r\n\r\n\t\t\tif ( v1 === undefined ) v1 = new THREE.Vector3();\r\n\r\n\t\t\tv1.copy( vector ).normalize();\r\n\r\n\t\t\tdot = this.dot( v1 );\r\n\r\n\t\t\treturn this.copy( v1 ).multiplyScalar( dot );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tprojectOnPlane: function () {\r\n\r\n\t\tvar v1;\r\n\r\n\t\treturn function projectOnPlane( planeNormal ) {\r\n\r\n\t\t\tif ( v1 === undefined ) v1 = new THREE.Vector3();\r\n\r\n\t\t\tv1.copy( this ).projectOnVector( planeNormal );\r\n\r\n\t\t\treturn this.sub( v1 );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\treflect: function () {\r\n\r\n\t\t// reflect incident vector off plane orthogonal to normal\r\n\t\t// normal is assumed to have unit length\r\n\r\n\t\tvar v1;\r\n\r\n\t\treturn function reflect( normal ) {\r\n\r\n\t\t\tif ( v1 === undefined ) v1 = new THREE.Vector3();\r\n\r\n\t\t\treturn this.sub( v1.copy( normal ).multiplyScalar( 2 * this.dot( normal ) ) );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tangleTo: function ( v ) {\r\n\r\n\t\tvar theta = this.dot( v ) / ( Math.sqrt( this.lengthSq() * v.lengthSq() ) );\r\n\r\n\t\t// clamp, to handle numerical problems\r\n\r\n\t\treturn Math.acos( THREE.Math.clamp( theta, - 1, 1 ) );\r\n\r\n\t},\r\n\r\n\tdistanceTo: function ( v ) {\r\n\r\n\t\treturn Math.sqrt( this.distanceToSquared( v ) );\r\n\r\n\t},\r\n\r\n\tdistanceToSquared: function ( v ) {\r\n\r\n\t\tvar dx = this.x - v.x, dy = this.y - v.y, dz = this.z - v.z;\r\n\r\n\t\treturn dx * dx + dy * dy + dz * dz;\r\n\r\n\t},\r\n\r\n\tsetFromSpherical: function( s ) {\r\n\r\n\t\tvar sinPhiRadius = Math.sin( s.phi ) * s.radius;\r\n\r\n\t\tthis.x = sinPhiRadius * Math.sin( s.theta );\r\n\t\tthis.y = Math.cos( s.phi ) * s.radius;\r\n\t\tthis.z = sinPhiRadius * Math.cos( s.theta );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromMatrixPosition: function ( m ) {\r\n\r\n\t\treturn this.setFromMatrixColumn( m, 3 );\r\n\r\n\t},\r\n\r\n\tsetFromMatrixScale: function ( m ) {\r\n\r\n\t\tvar sx = this.setFromMatrixColumn( m, 0 ).length();\r\n\t\tvar sy = this.setFromMatrixColumn( m, 1 ).length();\r\n\t\tvar sz = this.setFromMatrixColumn( m, 2 ).length();\r\n\r\n\t\tthis.x = sx;\r\n\t\tthis.y = sy;\r\n\t\tthis.z = sz;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromMatrixColumn: function ( m, index ) {\r\n\r\n\t\tif ( typeof m === 'number' ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Vector3: setFromMatrixColumn now expects ( matrix, index ).' );\r\n\t\t\tvar temp = m\r\n\t\t\tm = index;\r\n\t\t\tindex = temp;\r\n\r\n\t\t}\r\n\r\n\t\treturn this.fromArray( m.elements, index * 4 );\r\n\r\n\t},\r\n\r\n\tequals: function ( v ) {\r\n\r\n\t\treturn ( ( v.x === this.x ) && ( v.y === this.y ) && ( v.z === this.z ) );\r\n\r\n\t},\r\n\r\n\tfromArray: function ( array, offset ) {\r\n\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tthis.x = array[ offset ];\r\n\t\tthis.y = array[ offset + 1 ];\r\n\t\tthis.z = array[ offset + 2 ];\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\ttoArray: function ( array, offset ) {\r\n\r\n\t\tif ( array === undefined ) array = [];\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tarray[ offset ] = this.x;\r\n\t\tarray[ offset + 1 ] = this.y;\r\n\t\tarray[ offset + 2 ] = this.z;\r\n\r\n\t\treturn array;\r\n\r\n\t},\r\n\r\n\tfromAttribute: function ( attribute, index, offset ) {\r\n\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tindex = index * attribute.itemSize + offset;\r\n\r\n\t\tthis.x = attribute.array[ index ];\r\n\t\tthis.y = attribute.array[ index + 1 ];\r\n\t\tthis.z = attribute.array[ index + 2 ];\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Vector4.js\r\n\r\n/**\r\n * @author supereggbert / http://www.paulbrunt.co.uk/\r\n * @author philogb / http://blog.thejit.org/\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author egraether / http://egraether.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.Vector4 = function ( x, y, z, w ) {\r\n\r\n\tthis.x = x || 0;\r\n\tthis.y = y || 0;\r\n\tthis.z = z || 0;\r\n\tthis.w = ( w !== undefined ) ? w : 1;\r\n\r\n};\r\n\r\nTHREE.Vector4.prototype = {\r\n\r\n\tconstructor: THREE.Vector4,\r\n\r\n\tset: function ( x, y, z, w ) {\r\n\r\n\t\tthis.x = x;\r\n\t\tthis.y = y;\r\n\t\tthis.z = z;\r\n\t\tthis.w = w;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetScalar: function ( scalar ) {\r\n\r\n\t\tthis.x = scalar;\r\n\t\tthis.y = scalar;\r\n\t\tthis.z = scalar;\r\n\t\tthis.w = scalar;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetX: function ( x ) {\r\n\r\n\t\tthis.x = x;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetY: function ( y ) {\r\n\r\n\t\tthis.y = y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetZ: function ( z ) {\r\n\r\n\t\tthis.z = z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetW: function ( w ) {\r\n\r\n\t\tthis.w = w;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetComponent: function ( index, value ) {\r\n\r\n\t\tswitch ( index ) {\r\n\r\n\t\t\tcase 0: this.x = value; break;\r\n\t\t\tcase 1: this.y = value; break;\r\n\t\t\tcase 2: this.z = value; break;\r\n\t\t\tcase 3: this.w = value; break;\r\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tgetComponent: function ( index ) {\r\n\r\n\t\tswitch ( index ) {\r\n\r\n\t\t\tcase 0: return this.x;\r\n\t\t\tcase 1: return this.y;\r\n\t\t\tcase 2: return this.z;\r\n\t\t\tcase 3: return this.w;\r\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor( this.x, this.y, this.z, this.w );\r\n\r\n\t},\r\n\r\n\tcopy: function ( v ) {\r\n\r\n\t\tthis.x = v.x;\r\n\t\tthis.y = v.y;\r\n\t\tthis.z = v.z;\r\n\t\tthis.w = ( v.w !== undefined ) ? v.w : 1;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tadd: function ( v, w ) {\r\n\r\n\t\tif ( w !== undefined ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead.' );\r\n\t\t\treturn this.addVectors( v, w );\r\n\r\n\t\t}\r\n\r\n\t\tthis.x += v.x;\r\n\t\tthis.y += v.y;\r\n\t\tthis.z += v.z;\r\n\t\tthis.w += v.w;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\taddScalar: function ( s ) {\r\n\r\n\t\tthis.x += s;\r\n\t\tthis.y += s;\r\n\t\tthis.z += s;\r\n\t\tthis.w += s;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\taddVectors: function ( a, b ) {\r\n\r\n\t\tthis.x = a.x + b.x;\r\n\t\tthis.y = a.y + b.y;\r\n\t\tthis.z = a.z + b.z;\r\n\t\tthis.w = a.w + b.w;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\taddScaledVector: function ( v, s ) {\r\n\r\n\t\tthis.x += v.x * s;\r\n\t\tthis.y += v.y * s;\r\n\t\tthis.z += v.z * s;\r\n\t\tthis.w += v.w * s;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsub: function ( v, w ) {\r\n\r\n\t\tif ( w !== undefined ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.' );\r\n\t\t\treturn this.subVectors( v, w );\r\n\r\n\t\t}\r\n\r\n\t\tthis.x -= v.x;\r\n\t\tthis.y -= v.y;\r\n\t\tthis.z -= v.z;\r\n\t\tthis.w -= v.w;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsubScalar: function ( s ) {\r\n\r\n\t\tthis.x -= s;\r\n\t\tthis.y -= s;\r\n\t\tthis.z -= s;\r\n\t\tthis.w -= s;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsubVectors: function ( a, b ) {\r\n\r\n\t\tthis.x = a.x - b.x;\r\n\t\tthis.y = a.y - b.y;\r\n\t\tthis.z = a.z - b.z;\r\n\t\tthis.w = a.w - b.w;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmultiplyScalar: function ( scalar ) {\r\n\r\n\t\tif ( isFinite( scalar ) ) {\r\n\r\n\t\t\tthis.x *= scalar;\r\n\t\t\tthis.y *= scalar;\r\n\t\t\tthis.z *= scalar;\r\n\t\t\tthis.w *= scalar;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.x = 0;\r\n\t\t\tthis.y = 0;\r\n\t\t\tthis.z = 0;\r\n\t\t\tthis.w = 0;\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tapplyMatrix4: function ( m ) {\r\n\r\n\t\tvar x = this.x, y = this.y, z = this.z, w = this.w;\r\n\t\tvar e = m.elements;\r\n\r\n\t\tthis.x = e[ 0 ] * x + e[ 4 ] * y + e[ 8 ] * z + e[ 12 ] * w;\r\n\t\tthis.y = e[ 1 ] * x + e[ 5 ] * y + e[ 9 ] * z + e[ 13 ] * w;\r\n\t\tthis.z = e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z + e[ 14 ] * w;\r\n\t\tthis.w = e[ 3 ] * x + e[ 7 ] * y + e[ 11 ] * z + e[ 15 ] * w;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdivideScalar: function ( scalar ) {\r\n\r\n\t\treturn this.multiplyScalar( 1 / scalar );\r\n\r\n\t},\r\n\r\n\tsetAxisAngleFromQuaternion: function ( q ) {\r\n\r\n\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/quaternionToAngle/index.htm\r\n\r\n\t\t// q is assumed to be normalized\r\n\r\n\t\tthis.w = 2 * Math.acos( q.w );\r\n\r\n\t\tvar s = Math.sqrt( 1 - q.w * q.w );\r\n\r\n\t\tif ( s < 0.0001 ) {\r\n\r\n\t\t\t this.x = 1;\r\n\t\t\t this.y = 0;\r\n\t\t\t this.z = 0;\r\n\r\n\t\t} else {\r\n\r\n\t\t\t this.x = q.x / s;\r\n\t\t\t this.y = q.y / s;\r\n\t\t\t this.z = q.z / s;\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetAxisAngleFromRotationMatrix: function ( m ) {\r\n\r\n\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/matrixToAngle/index.htm\r\n\r\n\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\r\n\r\n\t\tvar angle, x, y, z,\t\t// variables for result\r\n\t\t\tepsilon = 0.01,\t\t// margin to allow for rounding errors\r\n\t\t\tepsilon2 = 0.1,\t\t// margin to distinguish between 0 and 180 degrees\r\n\r\n\t\t\tte = m.elements,\r\n\r\n\t\t\tm11 = te[ 0 ], m12 = te[ 4 ], m13 = te[ 8 ],\r\n\t\t\tm21 = te[ 1 ], m22 = te[ 5 ], m23 = te[ 9 ],\r\n\t\t\tm31 = te[ 2 ], m32 = te[ 6 ], m33 = te[ 10 ];\r\n\r\n\t\tif ( ( Math.abs( m12 - m21 ) < epsilon ) &&\r\n\t\t     ( Math.abs( m13 - m31 ) < epsilon ) &&\r\n\t\t     ( Math.abs( m23 - m32 ) < epsilon ) ) {\r\n\r\n\t\t\t// singularity found\r\n\t\t\t// first check for identity matrix which must have +1 for all terms\r\n\t\t\t// in leading diagonal and zero in other terms\r\n\r\n\t\t\tif ( ( Math.abs( m12 + m21 ) < epsilon2 ) &&\r\n\t\t\t     ( Math.abs( m13 + m31 ) < epsilon2 ) &&\r\n\t\t\t     ( Math.abs( m23 + m32 ) < epsilon2 ) &&\r\n\t\t\t     ( Math.abs( m11 + m22 + m33 - 3 ) < epsilon2 ) ) {\r\n\r\n\t\t\t\t// this singularity is identity matrix so angle = 0\r\n\r\n\t\t\t\tthis.set( 1, 0, 0, 0 );\r\n\r\n\t\t\t\treturn this; // zero angle, arbitrary axis\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// otherwise this singularity is angle = 180\r\n\r\n\t\t\tangle = Math.PI;\r\n\r\n\t\t\tvar xx = ( m11 + 1 ) / 2;\r\n\t\t\tvar yy = ( m22 + 1 ) / 2;\r\n\t\t\tvar zz = ( m33 + 1 ) / 2;\r\n\t\t\tvar xy = ( m12 + m21 ) / 4;\r\n\t\t\tvar xz = ( m13 + m31 ) / 4;\r\n\t\t\tvar yz = ( m23 + m32 ) / 4;\r\n\r\n\t\t\tif ( ( xx > yy ) && ( xx > zz ) ) {\r\n\r\n\t\t\t\t// m11 is the largest diagonal term\r\n\r\n\t\t\t\tif ( xx < epsilon ) {\r\n\r\n\t\t\t\t\tx = 0;\r\n\t\t\t\t\ty = 0.707106781;\r\n\t\t\t\t\tz = 0.707106781;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tx = Math.sqrt( xx );\r\n\t\t\t\t\ty = xy / x;\r\n\t\t\t\t\tz = xz / x;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( yy > zz ) {\r\n\r\n\t\t\t\t// m22 is the largest diagonal term\r\n\r\n\t\t\t\tif ( yy < epsilon ) {\r\n\r\n\t\t\t\t\tx = 0.707106781;\r\n\t\t\t\t\ty = 0;\r\n\t\t\t\t\tz = 0.707106781;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\ty = Math.sqrt( yy );\r\n\t\t\t\t\tx = xy / y;\r\n\t\t\t\t\tz = yz / y;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// m33 is the largest diagonal term so base result on this\r\n\r\n\t\t\t\tif ( zz < epsilon ) {\r\n\r\n\t\t\t\t\tx = 0.707106781;\r\n\t\t\t\t\ty = 0.707106781;\r\n\t\t\t\t\tz = 0;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tz = Math.sqrt( zz );\r\n\t\t\t\t\tx = xz / z;\r\n\t\t\t\t\ty = yz / z;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.set( x, y, z, angle );\r\n\r\n\t\t\treturn this; // return 180 deg rotation\r\n\r\n\t\t}\r\n\r\n\t\t// as we have reached here there are no singularities so we can handle normally\r\n\r\n\t\tvar s = Math.sqrt( ( m32 - m23 ) * ( m32 - m23 ) +\r\n\t\t                   ( m13 - m31 ) * ( m13 - m31 ) +\r\n\t\t                   ( m21 - m12 ) * ( m21 - m12 ) ); // used to normalize\r\n\r\n\t\tif ( Math.abs( s ) < 0.001 ) s = 1;\r\n\r\n\t\t// prevent divide by zero, should not happen if matrix is orthogonal and should be\r\n\t\t// caught by singularity test above, but I've left it in just in case\r\n\r\n\t\tthis.x = ( m32 - m23 ) / s;\r\n\t\tthis.y = ( m13 - m31 ) / s;\r\n\t\tthis.z = ( m21 - m12 ) / s;\r\n\t\tthis.w = Math.acos( ( m11 + m22 + m33 - 1 ) / 2 );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmin: function ( v ) {\r\n\r\n\t\tthis.x = Math.min( this.x, v.x );\r\n\t\tthis.y = Math.min( this.y, v.y );\r\n\t\tthis.z = Math.min( this.z, v.z );\r\n\t\tthis.w = Math.min( this.w, v.w );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmax: function ( v ) {\r\n\r\n\t\tthis.x = Math.max( this.x, v.x );\r\n\t\tthis.y = Math.max( this.y, v.y );\r\n\t\tthis.z = Math.max( this.z, v.z );\r\n\t\tthis.w = Math.max( this.w, v.w );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclamp: function ( min, max ) {\r\n\r\n\t\t// This function assumes min < max, if this assumption isn't true it will not operate correctly\r\n\r\n\t\tthis.x = Math.max( min.x, Math.min( max.x, this.x ) );\r\n\t\tthis.y = Math.max( min.y, Math.min( max.y, this.y ) );\r\n\t\tthis.z = Math.max( min.z, Math.min( max.z, this.z ) );\r\n\t\tthis.w = Math.max( min.w, Math.min( max.w, this.w ) );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclampScalar: function () {\r\n\r\n\t\tvar min, max;\r\n\r\n\t\treturn function clampScalar( minVal, maxVal ) {\r\n\r\n\t\t\tif ( min === undefined ) {\r\n\r\n\t\t\t\tmin = new THREE.Vector4();\r\n\t\t\t\tmax = new THREE.Vector4();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tmin.set( minVal, minVal, minVal, minVal );\r\n\t\t\tmax.set( maxVal, maxVal, maxVal, maxVal );\r\n\r\n\t\t\treturn this.clamp( min, max );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tfloor: function () {\r\n\r\n\t\tthis.x = Math.floor( this.x );\r\n\t\tthis.y = Math.floor( this.y );\r\n\t\tthis.z = Math.floor( this.z );\r\n\t\tthis.w = Math.floor( this.w );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tceil: function () {\r\n\r\n\t\tthis.x = Math.ceil( this.x );\r\n\t\tthis.y = Math.ceil( this.y );\r\n\t\tthis.z = Math.ceil( this.z );\r\n\t\tthis.w = Math.ceil( this.w );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tround: function () {\r\n\r\n\t\tthis.x = Math.round( this.x );\r\n\t\tthis.y = Math.round( this.y );\r\n\t\tthis.z = Math.round( this.z );\r\n\t\tthis.w = Math.round( this.w );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\troundToZero: function () {\r\n\r\n\t\tthis.x = ( this.x < 0 ) ? Math.ceil( this.x ) : Math.floor( this.x );\r\n\t\tthis.y = ( this.y < 0 ) ? Math.ceil( this.y ) : Math.floor( this.y );\r\n\t\tthis.z = ( this.z < 0 ) ? Math.ceil( this.z ) : Math.floor( this.z );\r\n\t\tthis.w = ( this.w < 0 ) ? Math.ceil( this.w ) : Math.floor( this.w );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tnegate: function () {\r\n\r\n\t\tthis.x = - this.x;\r\n\t\tthis.y = - this.y;\r\n\t\tthis.z = - this.z;\r\n\t\tthis.w = - this.w;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdot: function ( v ) {\r\n\r\n\t\treturn this.x * v.x + this.y * v.y + this.z * v.z + this.w * v.w;\r\n\r\n\t},\r\n\r\n\tlengthSq: function () {\r\n\r\n\t\treturn this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w;\r\n\r\n\t},\r\n\r\n\tlength: function () {\r\n\r\n\t\treturn Math.sqrt( this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w );\r\n\r\n\t},\r\n\r\n\tlengthManhattan: function () {\r\n\r\n\t\treturn Math.abs( this.x ) + Math.abs( this.y ) + Math.abs( this.z ) + Math.abs( this.w );\r\n\r\n\t},\r\n\r\n\tnormalize: function () {\r\n\r\n\t\treturn this.divideScalar( this.length() );\r\n\r\n\t},\r\n\r\n\tsetLength: function ( length ) {\r\n\r\n\t\treturn this.multiplyScalar( length / this.length() );\r\n\r\n\t},\r\n\r\n\tlerp: function ( v, alpha ) {\r\n\r\n\t\tthis.x += ( v.x - this.x ) * alpha;\r\n\t\tthis.y += ( v.y - this.y ) * alpha;\r\n\t\tthis.z += ( v.z - this.z ) * alpha;\r\n\t\tthis.w += ( v.w - this.w ) * alpha;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tlerpVectors: function ( v1, v2, alpha ) {\r\n\r\n\t\treturn this.subVectors( v2, v1 ).multiplyScalar( alpha ).add( v1 );\r\n\r\n\t},\r\n\r\n\tequals: function ( v ) {\r\n\r\n\t\treturn ( ( v.x === this.x ) && ( v.y === this.y ) && ( v.z === this.z ) && ( v.w === this.w ) );\r\n\r\n\t},\r\n\r\n\tfromArray: function ( array, offset ) {\r\n\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tthis.x = array[ offset ];\r\n\t\tthis.y = array[ offset + 1 ];\r\n\t\tthis.z = array[ offset + 2 ];\r\n\t\tthis.w = array[ offset + 3 ];\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\ttoArray: function ( array, offset ) {\r\n\r\n\t\tif ( array === undefined ) array = [];\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tarray[ offset ] = this.x;\r\n\t\tarray[ offset + 1 ] = this.y;\r\n\t\tarray[ offset + 2 ] = this.z;\r\n\t\tarray[ offset + 3 ] = this.w;\r\n\r\n\t\treturn array;\r\n\r\n\t},\r\n\r\n\tfromAttribute: function ( attribute, index, offset ) {\r\n\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tindex = index * attribute.itemSize + offset;\r\n\r\n\t\tthis.x = attribute.array[ index ];\r\n\t\tthis.y = attribute.array[ index + 1 ];\r\n\t\tthis.z = attribute.array[ index + 2 ];\r\n\t\tthis.w = attribute.array[ index + 3 ];\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Euler.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n * @author bhouston / http://clara.io\r\n */\r\n\r\nTHREE.Euler = function ( x, y, z, order ) {\r\n\r\n\tthis._x = x || 0;\r\n\tthis._y = y || 0;\r\n\tthis._z = z || 0;\r\n\tthis._order = order || THREE.Euler.DefaultOrder;\r\n\r\n};\r\n\r\nTHREE.Euler.RotationOrders = [ 'XYZ', 'YZX', 'ZXY', 'XZY', 'YXZ', 'ZYX' ];\r\n\r\nTHREE.Euler.DefaultOrder = 'XYZ';\r\n\r\nTHREE.Euler.prototype = {\r\n\r\n\tconstructor: THREE.Euler,\r\n\r\n\tget x () {\r\n\r\n\t\treturn this._x;\r\n\r\n\t},\r\n\r\n\tset x ( value ) {\r\n\r\n\t\tthis._x = value;\r\n\t\tthis.onChangeCallback();\r\n\r\n\t},\r\n\r\n\tget y () {\r\n\r\n\t\treturn this._y;\r\n\r\n\t},\r\n\r\n\tset y ( value ) {\r\n\r\n\t\tthis._y = value;\r\n\t\tthis.onChangeCallback();\r\n\r\n\t},\r\n\r\n\tget z () {\r\n\r\n\t\treturn this._z;\r\n\r\n\t},\r\n\r\n\tset z ( value ) {\r\n\r\n\t\tthis._z = value;\r\n\t\tthis.onChangeCallback();\r\n\r\n\t},\r\n\r\n\tget order () {\r\n\r\n\t\treturn this._order;\r\n\r\n\t},\r\n\r\n\tset order ( value ) {\r\n\r\n\t\tthis._order = value;\r\n\t\tthis.onChangeCallback();\r\n\r\n\t},\r\n\r\n\tset: function ( x, y, z, order ) {\r\n\r\n\t\tthis._x = x;\r\n\t\tthis._y = y;\r\n\t\tthis._z = z;\r\n\t\tthis._order = order || this._order;\r\n\r\n\t\tthis.onChangeCallback();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor( this._x, this._y, this._z, this._order );\r\n\r\n\t},\r\n\r\n\tcopy: function ( euler ) {\r\n\r\n\t\tthis._x = euler._x;\r\n\t\tthis._y = euler._y;\r\n\t\tthis._z = euler._z;\r\n\t\tthis._order = euler._order;\r\n\r\n\t\tthis.onChangeCallback();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromRotationMatrix: function ( m, order, update ) {\r\n\r\n\t\tvar clamp = THREE.Math.clamp;\r\n\r\n\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\r\n\r\n\t\tvar te = m.elements;\r\n\t\tvar m11 = te[ 0 ], m12 = te[ 4 ], m13 = te[ 8 ];\r\n\t\tvar m21 = te[ 1 ], m22 = te[ 5 ], m23 = te[ 9 ];\r\n\t\tvar m31 = te[ 2 ], m32 = te[ 6 ], m33 = te[ 10 ];\r\n\r\n\t\torder = order || this._order;\r\n\r\n\t\tif ( order === 'XYZ' ) {\r\n\r\n\t\t\tthis._y = Math.asin( clamp( m13, - 1, 1 ) );\r\n\r\n\t\t\tif ( Math.abs( m13 ) < 0.99999 ) {\r\n\r\n\t\t\t\tthis._x = Math.atan2( - m23, m33 );\r\n\t\t\t\tthis._z = Math.atan2( - m12, m11 );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis._x = Math.atan2( m32, m22 );\r\n\t\t\t\tthis._z = 0;\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( order === 'YXZ' ) {\r\n\r\n\t\t\tthis._x = Math.asin( - clamp( m23, - 1, 1 ) );\r\n\r\n\t\t\tif ( Math.abs( m23 ) < 0.99999 ) {\r\n\r\n\t\t\t\tthis._y = Math.atan2( m13, m33 );\r\n\t\t\t\tthis._z = Math.atan2( m21, m22 );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis._y = Math.atan2( - m31, m11 );\r\n\t\t\t\tthis._z = 0;\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( order === 'ZXY' ) {\r\n\r\n\t\t\tthis._x = Math.asin( clamp( m32, - 1, 1 ) );\r\n\r\n\t\t\tif ( Math.abs( m32 ) < 0.99999 ) {\r\n\r\n\t\t\t\tthis._y = Math.atan2( - m31, m33 );\r\n\t\t\t\tthis._z = Math.atan2( - m12, m22 );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis._y = 0;\r\n\t\t\t\tthis._z = Math.atan2( m21, m11 );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( order === 'ZYX' ) {\r\n\r\n\t\t\tthis._y = Math.asin( - clamp( m31, - 1, 1 ) );\r\n\r\n\t\t\tif ( Math.abs( m31 ) < 0.99999 ) {\r\n\r\n\t\t\t\tthis._x = Math.atan2( m32, m33 );\r\n\t\t\t\tthis._z = Math.atan2( m21, m11 );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis._x = 0;\r\n\t\t\t\tthis._z = Math.atan2( - m12, m22 );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( order === 'YZX' ) {\r\n\r\n\t\t\tthis._z = Math.asin( clamp( m21, - 1, 1 ) );\r\n\r\n\t\t\tif ( Math.abs( m21 ) < 0.99999 ) {\r\n\r\n\t\t\t\tthis._x = Math.atan2( - m23, m22 );\r\n\t\t\t\tthis._y = Math.atan2( - m31, m11 );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis._x = 0;\r\n\t\t\t\tthis._y = Math.atan2( m13, m33 );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( order === 'XZY' ) {\r\n\r\n\t\t\tthis._z = Math.asin( - clamp( m12, - 1, 1 ) );\r\n\r\n\t\t\tif ( Math.abs( m12 ) < 0.99999 ) {\r\n\r\n\t\t\t\tthis._x = Math.atan2( m32, m22 );\r\n\t\t\t\tthis._y = Math.atan2( m13, m11 );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis._x = Math.atan2( - m23, m33 );\r\n\t\t\t\tthis._y = 0;\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tconsole.warn( 'THREE.Euler: .setFromRotationMatrix() given unsupported order: ' + order );\r\n\r\n\t\t}\r\n\r\n\t\tthis._order = order;\r\n\r\n\t\tif ( update !== false ) this.onChangeCallback();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromQuaternion: function () {\r\n\r\n\t\tvar matrix;\r\n\r\n\t\treturn function ( q, order, update ) {\r\n\r\n\t\t\tif ( matrix === undefined ) matrix = new THREE.Matrix4();\r\n\r\n\t\t\tmatrix.makeRotationFromQuaternion( q );\r\n\r\n\t\t\treturn this.setFromRotationMatrix( matrix, order, update );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tsetFromVector3: function ( v, order ) {\r\n\r\n\t\treturn this.set( v.x, v.y, v.z, order || this._order );\r\n\r\n\t},\r\n\r\n\treorder: function () {\r\n\r\n\t\t// WARNING: this discards revolution information -bhouston\r\n\r\n\t\tvar q = new THREE.Quaternion();\r\n\r\n\t\treturn function ( newOrder ) {\r\n\r\n\t\t\tq.setFromEuler( this );\r\n\t\t\t\r\n\t\t\treturn this.setFromQuaternion( q, newOrder );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tequals: function ( euler ) {\r\n\r\n\t\treturn ( euler._x === this._x ) && ( euler._y === this._y ) && ( euler._z === this._z ) && ( euler._order === this._order );\r\n\r\n\t},\r\n\r\n\tfromArray: function ( array ) {\r\n\r\n\t\tthis._x = array[ 0 ];\r\n\t\tthis._y = array[ 1 ];\r\n\t\tthis._z = array[ 2 ];\r\n\t\tif ( array[ 3 ] !== undefined ) this._order = array[ 3 ];\r\n\r\n\t\tthis.onChangeCallback();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\ttoArray: function ( array, offset ) {\r\n\r\n\t\tif ( array === undefined ) array = [];\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tarray[ offset ] = this._x;\r\n\t\tarray[ offset + 1 ] = this._y;\r\n\t\tarray[ offset + 2 ] = this._z;\r\n\t\tarray[ offset + 3 ] = this._order;\r\n\r\n\t\treturn array;\r\n\r\n\t},\r\n\r\n\ttoVector3: function ( optionalResult ) {\r\n\r\n\t\tif ( optionalResult ) {\r\n\r\n\t\t\treturn optionalResult.set( this._x, this._y, this._z );\r\n\r\n\t\t} else {\r\n\r\n\t\t\treturn new THREE.Vector3( this._x, this._y, this._z );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tonChange: function ( callback ) {\r\n\r\n\t\tthis.onChangeCallback = callback;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tonChangeCallback: function () {}\r\n\r\n};\r\n\r\n// File:src/math/Line3.js\r\n\r\n/**\r\n * @author bhouston / http://clara.io\r\n */\r\n\r\nTHREE.Line3 = function ( start, end ) {\r\n\r\n\tthis.start = ( start !== undefined ) ? start : new THREE.Vector3();\r\n\tthis.end = ( end !== undefined ) ? end : new THREE.Vector3();\r\n\r\n};\r\n\r\nTHREE.Line3.prototype = {\r\n\r\n\tconstructor: THREE.Line3,\r\n\r\n\tset: function ( start, end ) {\r\n\r\n\t\tthis.start.copy( start );\r\n\t\tthis.end.copy( end );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor().copy( this );\r\n\r\n\t},\r\n\r\n\tcopy: function ( line ) {\r\n\r\n\t\tthis.start.copy( line.start );\r\n\t\tthis.end.copy( line.end );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcenter: function ( optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\treturn result.addVectors( this.start, this.end ).multiplyScalar( 0.5 );\r\n\r\n\t},\r\n\r\n\tdelta: function ( optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\treturn result.subVectors( this.end, this.start );\r\n\r\n\t},\r\n\r\n\tdistanceSq: function () {\r\n\r\n\t\treturn this.start.distanceToSquared( this.end );\r\n\r\n\t},\r\n\r\n\tdistance: function () {\r\n\r\n\t\treturn this.start.distanceTo( this.end );\r\n\r\n\t},\r\n\r\n\tat: function ( t, optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\r\n\t\treturn this.delta( result ).multiplyScalar( t ).add( this.start );\r\n\r\n\t},\r\n\r\n\tclosestPointToPointParameter: function () {\r\n\r\n\t\tvar startP = new THREE.Vector3();\r\n\t\tvar startEnd = new THREE.Vector3();\r\n\r\n\t\treturn function ( point, clampToLine ) {\r\n\r\n\t\t\tstartP.subVectors( point, this.start );\r\n\t\t\tstartEnd.subVectors( this.end, this.start );\r\n\r\n\t\t\tvar startEnd2 = startEnd.dot( startEnd );\r\n\t\t\tvar startEnd_startP = startEnd.dot( startP );\r\n\r\n\t\t\tvar t = startEnd_startP / startEnd2;\r\n\r\n\t\t\tif ( clampToLine ) {\r\n\r\n\t\t\t\tt = THREE.Math.clamp( t, 0, 1 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn t;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tclosestPointToPoint: function ( point, clampToLine, optionalTarget ) {\r\n\r\n\t\tvar t = this.closestPointToPointParameter( point, clampToLine );\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\r\n\t\treturn this.delta( result ).multiplyScalar( t ).add( this.start );\r\n\r\n\t},\r\n\r\n\tapplyMatrix4: function ( matrix ) {\r\n\r\n\t\tthis.start.applyMatrix4( matrix );\r\n\t\tthis.end.applyMatrix4( matrix );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tequals: function ( line ) {\r\n\r\n\t\treturn line.start.equals( this.start ) && line.end.equals( this.end );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Box2.js\r\n\r\n/**\r\n * @author bhouston / http://clara.io\r\n */\r\n\r\nTHREE.Box2 = function ( min, max ) {\r\n\r\n\tthis.min = ( min !== undefined ) ? min : new THREE.Vector2( + Infinity, + Infinity );\r\n\tthis.max = ( max !== undefined ) ? max : new THREE.Vector2( - Infinity, - Infinity );\r\n\r\n};\r\n\r\nTHREE.Box2.prototype = {\r\n\r\n\tconstructor: THREE.Box2,\r\n\r\n\tset: function ( min, max ) {\r\n\r\n\t\tthis.min.copy( min );\r\n\t\tthis.max.copy( max );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromPoints: function ( points ) {\r\n\r\n\t\tthis.makeEmpty();\r\n\r\n\t\tfor ( var i = 0, il = points.length; i < il; i ++ ) {\r\n\r\n\t\t\tthis.expandByPoint( points[ i ] );\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromCenterAndSize: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector2();\r\n\r\n\t\treturn function ( center, size ) {\r\n\r\n\t\t\tvar halfSize = v1.copy( size ).multiplyScalar( 0.5 );\r\n\t\t\tthis.min.copy( center ).sub( halfSize );\r\n\t\t\tthis.max.copy( center ).add( halfSize );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor().copy( this );\r\n\r\n\t},\r\n\r\n\tcopy: function ( box ) {\r\n\r\n\t\tthis.min.copy( box.min );\r\n\t\tthis.max.copy( box.max );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmakeEmpty: function () {\r\n\r\n\t\tthis.min.x = this.min.y = + Infinity;\r\n\t\tthis.max.x = this.max.y = - Infinity;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tisEmpty: function () {\r\n\r\n\t\t// this is a more robust check for empty than ( volume <= 0 ) because volume can get positive with two negative axes\r\n\r\n\t\treturn ( this.max.x < this.min.x ) || ( this.max.y < this.min.y );\r\n\r\n\t},\r\n\r\n\tcenter: function ( optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector2();\r\n\t\treturn result.addVectors( this.min, this.max ).multiplyScalar( 0.5 );\r\n\r\n\t},\r\n\r\n\tsize: function ( optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector2();\r\n\t\treturn result.subVectors( this.max, this.min );\r\n\r\n\t},\r\n\r\n\texpandByPoint: function ( point ) {\r\n\r\n\t\tthis.min.min( point );\r\n\t\tthis.max.max( point );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\texpandByVector: function ( vector ) {\r\n\r\n\t\tthis.min.sub( vector );\r\n\t\tthis.max.add( vector );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\texpandByScalar: function ( scalar ) {\r\n\r\n\t\tthis.min.addScalar( - scalar );\r\n\t\tthis.max.addScalar( scalar );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcontainsPoint: function ( point ) {\r\n\r\n\t\tif ( point.x < this.min.x || point.x > this.max.x ||\r\n\t\t     point.y < this.min.y || point.y > this.max.y ) {\r\n\r\n\t\t\treturn false;\r\n\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\r\n\t},\r\n\r\n\tcontainsBox: function ( box ) {\r\n\r\n\t\tif ( ( this.min.x <= box.min.x ) && ( box.max.x <= this.max.x ) &&\r\n\t\t     ( this.min.y <= box.min.y ) && ( box.max.y <= this.max.y ) ) {\r\n\r\n\t\t\treturn true;\r\n\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\r\n\t},\r\n\r\n\tgetParameter: function ( point, optionalTarget ) {\r\n\r\n\t\t// This can potentially have a divide by zero if the box\r\n\t\t// has a size dimension of 0.\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector2();\r\n\r\n\t\treturn result.set(\r\n\t\t\t( point.x - this.min.x ) / ( this.max.x - this.min.x ),\r\n\t\t\t( point.y - this.min.y ) / ( this.max.y - this.min.y )\r\n\t\t);\r\n\r\n\t},\r\n\r\n\tintersectsBox: function ( box ) {\r\n\r\n\t\t// using 6 splitting planes to rule out intersections.\r\n\r\n\t\tif ( box.max.x < this.min.x || box.min.x > this.max.x ||\r\n\t\t     box.max.y < this.min.y || box.min.y > this.max.y ) {\r\n\r\n\t\t\treturn false;\r\n\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\r\n\t},\r\n\r\n\tclampPoint: function ( point, optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector2();\r\n\t\treturn result.copy( point ).clamp( this.min, this.max );\r\n\r\n\t},\r\n\r\n\tdistanceToPoint: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector2();\r\n\r\n\t\treturn function ( point ) {\r\n\r\n\t\t\tvar clampedPoint = v1.copy( point ).clamp( this.min, this.max );\r\n\t\t\treturn clampedPoint.sub( point ).length();\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tintersect: function ( box ) {\r\n\r\n\t\tthis.min.max( box.min );\r\n\t\tthis.max.min( box.max );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tunion: function ( box ) {\r\n\r\n\t\tthis.min.min( box.min );\r\n\t\tthis.max.max( box.max );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\ttranslate: function ( offset ) {\r\n\r\n\t\tthis.min.add( offset );\r\n\t\tthis.max.add( offset );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tequals: function ( box ) {\r\n\r\n\t\treturn box.min.equals( this.min ) && box.max.equals( this.max );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Box3.js\r\n\r\n/**\r\n * @author bhouston / http://clara.io\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.Box3 = function ( min, max ) {\r\n\r\n\tthis.min = ( min !== undefined ) ? min : new THREE.Vector3( + Infinity, + Infinity, + Infinity );\r\n\tthis.max = ( max !== undefined ) ? max : new THREE.Vector3( - Infinity, - Infinity, - Infinity );\r\n\r\n};\r\n\r\nTHREE.Box3.prototype = {\r\n\r\n\tconstructor: THREE.Box3,\r\n\r\n\tset: function ( min, max ) {\r\n\r\n\t\tthis.min.copy( min );\r\n\t\tthis.max.copy( max );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromArray: function ( array ) {\r\n\r\n\t\tvar minX = + Infinity;\r\n\t\tvar minY = + Infinity;\r\n\t\tvar minZ = + Infinity;\r\n\r\n\t\tvar maxX = - Infinity;\r\n\t\tvar maxY = - Infinity;\r\n\t\tvar maxZ = - Infinity;\r\n\r\n\t\tfor ( var i = 0, l = array.length; i < l; i += 3 ) {\r\n\r\n\t\t\tvar x = array[ i ];\r\n\t\t\tvar y = array[ i + 1 ];\r\n\t\t\tvar z = array[ i + 2 ];\r\n\r\n\t\t\tif ( x < minX ) minX = x;\r\n\t\t\tif ( y < minY ) minY = y;\r\n\t\t\tif ( z < minZ ) minZ = z;\r\n\r\n\t\t\tif ( x > maxX ) maxX = x;\r\n\t\t\tif ( y > maxY ) maxY = y;\r\n\t\t\tif ( z > maxZ ) maxZ = z;\r\n\r\n\t\t}\r\n\r\n\t\tthis.min.set( minX, minY, minZ );\r\n\t\tthis.max.set( maxX, maxY, maxZ );\r\n\r\n\t},\r\n\r\n\tsetFromPoints: function ( points ) {\r\n\r\n\t\tthis.makeEmpty();\r\n\r\n\t\tfor ( var i = 0, il = points.length; i < il; i ++ ) {\r\n\r\n\t\t\tthis.expandByPoint( points[ i ] );\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromCenterAndSize: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3();\r\n\r\n\t\treturn function ( center, size ) {\r\n\r\n\t\t\tvar halfSize = v1.copy( size ).multiplyScalar( 0.5 );\r\n\r\n\t\t\tthis.min.copy( center ).sub( halfSize );\r\n\t\t\tthis.max.copy( center ).add( halfSize );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tsetFromObject: function () {\r\n\r\n\t\t// Computes the world-axis-aligned bounding box of an object (including its children),\r\n\t\t// accounting for both the object's, and children's, world transforms\r\n\r\n\t\tvar v1 = new THREE.Vector3();\r\n\r\n\t\treturn function ( object ) {\r\n\r\n\t\t\tvar scope = this;\r\n\r\n\t\t\tobject.updateMatrixWorld( true );\r\n\r\n\t\t\tthis.makeEmpty();\r\n\r\n\t\t\tobject.traverse( function ( node ) {\r\n\r\n\t\t\t\tvar geometry = node.geometry;\r\n\r\n\t\t\t\tif ( geometry !== undefined ) {\r\n\r\n\t\t\t\t\tif ( geometry instanceof THREE.Geometry ) {\r\n\r\n\t\t\t\t\t\tvar vertices = geometry.vertices;\r\n\r\n\t\t\t\t\t\tfor ( var i = 0, il = vertices.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\t\t\tv1.copy( vertices[ i ] );\r\n\t\t\t\t\t\t\tv1.applyMatrix4( node.matrixWorld );\r\n\r\n\t\t\t\t\t\t\tscope.expandByPoint( v1 );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else if ( geometry instanceof THREE.BufferGeometry && geometry.attributes[ 'position' ] !== undefined ) {\r\n\r\n\t\t\t\t\t\tvar positions = geometry.attributes[ 'position' ].array;\r\n\r\n\t\t\t\t\t\tfor ( var i = 0, il = positions.length; i < il; i += 3 ) {\r\n\r\n\t\t\t\t\t\t\tv1.fromArray( positions, i );\r\n\t\t\t\t\t\t\tv1.applyMatrix4( node.matrixWorld );\r\n\r\n\t\t\t\t\t\t\tscope.expandByPoint( v1 );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor().copy( this );\r\n\r\n\t},\r\n\r\n\tcopy: function ( box ) {\r\n\r\n\t\tthis.min.copy( box.min );\r\n\t\tthis.max.copy( box.max );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmakeEmpty: function () {\r\n\r\n\t\tthis.min.x = this.min.y = this.min.z = + Infinity;\r\n\t\tthis.max.x = this.max.y = this.max.z = - Infinity;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tisEmpty: function () {\r\n\r\n\t\t// this is a more robust check for empty than ( volume <= 0 ) because volume can get positive with two negative axes\r\n\r\n\t\treturn ( this.max.x < this.min.x ) || ( this.max.y < this.min.y ) || ( this.max.z < this.min.z );\r\n\r\n\t},\r\n\r\n\tcenter: function ( optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\treturn result.addVectors( this.min, this.max ).multiplyScalar( 0.5 );\r\n\r\n\t},\r\n\r\n\tsize: function ( optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\treturn result.subVectors( this.max, this.min );\r\n\r\n\t},\r\n\r\n\texpandByPoint: function ( point ) {\r\n\r\n\t\tthis.min.min( point );\r\n\t\tthis.max.max( point );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\texpandByVector: function ( vector ) {\r\n\r\n\t\tthis.min.sub( vector );\r\n\t\tthis.max.add( vector );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\texpandByScalar: function ( scalar ) {\r\n\r\n\t\tthis.min.addScalar( - scalar );\r\n\t\tthis.max.addScalar( scalar );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcontainsPoint: function ( point ) {\r\n\r\n\t\tif ( point.x < this.min.x || point.x > this.max.x ||\r\n\t\t\t\t point.y < this.min.y || point.y > this.max.y ||\r\n\t\t\t\t point.z < this.min.z || point.z > this.max.z ) {\r\n\r\n\t\t\treturn false;\r\n\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\r\n\t},\r\n\r\n\tcontainsBox: function ( box ) {\r\n\r\n\t\tif ( ( this.min.x <= box.min.x ) && ( box.max.x <= this.max.x ) &&\r\n\t\t\t ( this.min.y <= box.min.y ) && ( box.max.y <= this.max.y ) &&\r\n\t\t\t ( this.min.z <= box.min.z ) && ( box.max.z <= this.max.z ) ) {\r\n\r\n\t\t\treturn true;\r\n\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\r\n\t},\r\n\r\n\tgetParameter: function ( point, optionalTarget ) {\r\n\r\n\t\t// This can potentially have a divide by zero if the box\r\n\t\t// has a size dimension of 0.\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\r\n\t\treturn result.set(\r\n\t\t\t( point.x - this.min.x ) / ( this.max.x - this.min.x ),\r\n\t\t\t( point.y - this.min.y ) / ( this.max.y - this.min.y ),\r\n\t\t\t( point.z - this.min.z ) / ( this.max.z - this.min.z )\r\n\t\t);\r\n\r\n\t},\r\n\r\n\tintersectsBox: function ( box ) {\r\n\r\n\t\t// using 6 splitting planes to rule out intersections.\r\n\r\n\t\tif ( box.max.x < this.min.x || box.min.x > this.max.x ||\r\n\t\t\t\t box.max.y < this.min.y || box.min.y > this.max.y ||\r\n\t\t\t\t box.max.z < this.min.z || box.min.z > this.max.z ) {\r\n\r\n\t\t\treturn false;\r\n\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\r\n\t},\r\n\r\n\tintersectsSphere: ( function () {\r\n\r\n\t\tvar closestPoint;\r\n\r\n\t\treturn function intersectsSphere( sphere ) {\r\n\r\n\t\t\tif ( closestPoint === undefined ) closestPoint = new THREE.Vector3();\r\n\r\n\t\t\t// Find the point on the AABB closest to the sphere center.\r\n\t\t\tthis.clampPoint( sphere.center, closestPoint );\r\n\r\n\t\t\t// If that point is inside the sphere, the AABB and sphere intersect.\r\n\t\t\treturn closestPoint.distanceToSquared( sphere.center ) <= ( sphere.radius * sphere.radius );\r\n\r\n\t\t};\r\n\r\n\t} )(),\r\n\r\n\tintersectsPlane: function ( plane ) {\r\n\r\n\t\t// We compute the minimum and maximum dot product values. If those values\r\n\t\t// are on the same side (back or front) of the plane, then there is no intersection.\r\n\r\n\t\tvar min, max;\r\n\r\n\t\tif ( plane.normal.x > 0 ) {\r\n\r\n\t\t\tmin = plane.normal.x * this.min.x;\r\n\t\t\tmax = plane.normal.x * this.max.x;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tmin = plane.normal.x * this.max.x;\r\n\t\t\tmax = plane.normal.x * this.min.x;\r\n\r\n\t\t}\r\n\r\n\t\tif ( plane.normal.y > 0 ) {\r\n\r\n\t\t\tmin += plane.normal.y * this.min.y;\r\n\t\t\tmax += plane.normal.y * this.max.y;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tmin += plane.normal.y * this.max.y;\r\n\t\t\tmax += plane.normal.y * this.min.y;\r\n\r\n\t\t}\r\n\r\n\t\tif ( plane.normal.z > 0 ) {\r\n\r\n\t\t\tmin += plane.normal.z * this.min.z;\r\n\t\t\tmax += plane.normal.z * this.max.z;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tmin += plane.normal.z * this.max.z;\r\n\t\t\tmax += plane.normal.z * this.min.z;\r\n\r\n\t\t}\r\n\r\n\t\treturn ( min <= plane.constant && max >= plane.constant );\r\n\r\n\t},\r\n\r\n\tclampPoint: function ( point, optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\treturn result.copy( point ).clamp( this.min, this.max );\r\n\r\n\t},\r\n\r\n\tdistanceToPoint: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3();\r\n\r\n\t\treturn function ( point ) {\r\n\r\n\t\t\tvar clampedPoint = v1.copy( point ).clamp( this.min, this.max );\r\n\t\t\treturn clampedPoint.sub( point ).length();\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tgetBoundingSphere: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3();\r\n\r\n\t\treturn function ( optionalTarget ) {\r\n\r\n\t\t\tvar result = optionalTarget || new THREE.Sphere();\r\n\r\n\t\t\tresult.center = this.center();\r\n\t\t\tresult.radius = this.size( v1 ).length() * 0.5;\r\n\r\n\t\t\treturn result;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tintersect: function ( box ) {\r\n\r\n\t\tthis.min.max( box.min );\r\n\t\tthis.max.min( box.max );\r\n\r\n\t\t// ensure that if there is no overlap, the result is fully empty, not slightly empty with non-inf/+inf values that will cause subsequence intersects to erroneously return valid values.\r\n\t\tif( this.isEmpty() ) this.makeEmpty();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tunion: function ( box ) {\r\n\r\n\t\tthis.min.min( box.min );\r\n\t\tthis.max.max( box.max );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tapplyMatrix4: function () {\r\n\r\n\t\tvar points = [\r\n\t\t\tnew THREE.Vector3(),\r\n\t\t\tnew THREE.Vector3(),\r\n\t\t\tnew THREE.Vector3(),\r\n\t\t\tnew THREE.Vector3(),\r\n\t\t\tnew THREE.Vector3(),\r\n\t\t\tnew THREE.Vector3(),\r\n\t\t\tnew THREE.Vector3(),\r\n\t\t\tnew THREE.Vector3()\r\n\t\t];\r\n\r\n\t\treturn function ( matrix ) {\r\n\r\n\t\t\t// transform of empty box is an empty box.\r\n\t\t\tif( this.isEmpty() ) return this;\r\n\r\n\t\t\t// NOTE: I am using a binary pattern to specify all 2^3 combinations below\r\n\t\t\tpoints[ 0 ].set( this.min.x, this.min.y, this.min.z ).applyMatrix4( matrix ); // 000\r\n\t\t\tpoints[ 1 ].set( this.min.x, this.min.y, this.max.z ).applyMatrix4( matrix ); // 001\r\n\t\t\tpoints[ 2 ].set( this.min.x, this.max.y, this.min.z ).applyMatrix4( matrix ); // 010\r\n\t\t\tpoints[ 3 ].set( this.min.x, this.max.y, this.max.z ).applyMatrix4( matrix ); // 011\r\n\t\t\tpoints[ 4 ].set( this.max.x, this.min.y, this.min.z ).applyMatrix4( matrix ); // 100\r\n\t\t\tpoints[ 5 ].set( this.max.x, this.min.y, this.max.z ).applyMatrix4( matrix ); // 101\r\n\t\t\tpoints[ 6 ].set( this.max.x, this.max.y, this.min.z ).applyMatrix4( matrix ); // 110\r\n\t\t\tpoints[ 7 ].set( this.max.x, this.max.y, this.max.z ).applyMatrix4( matrix );\t// 111\r\n\r\n\t\t\tthis.setFromPoints( points );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\ttranslate: function ( offset ) {\r\n\r\n\t\tthis.min.add( offset );\r\n\t\tthis.max.add( offset );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tequals: function ( box ) {\r\n\r\n\t\treturn box.min.equals( this.min ) && box.max.equals( this.max );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Matrix3.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n * @author bhouston / http://clara.io\r\n * @author tschw\r\n */\r\n\r\nTHREE.Matrix3 = function () {\r\n\r\n\tthis.elements = new Float32Array( [\r\n\r\n\t\t1, 0, 0,\r\n\t\t0, 1, 0,\r\n\t\t0, 0, 1\r\n\r\n\t] );\r\n\r\n\tif ( arguments.length > 0 ) {\r\n\r\n\t\tconsole.error( 'THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.' );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.Matrix3.prototype = {\r\n\r\n\tconstructor: THREE.Matrix3,\r\n\r\n\tset: function ( n11, n12, n13, n21, n22, n23, n31, n32, n33 ) {\r\n\r\n\t\tvar te = this.elements;\r\n\r\n\t\tte[ 0 ] = n11; te[ 1 ] = n21; te[ 2 ] = n31;\r\n\t\tte[ 3 ] = n12; te[ 4 ] = n22; te[ 5 ] = n32;\r\n\t\tte[ 6 ] = n13; te[ 7 ] = n23; te[ 8 ] = n33;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tidentity: function () {\r\n\r\n\t\tthis.set(\r\n\r\n\t\t\t1, 0, 0,\r\n\t\t\t0, 1, 0,\r\n\t\t\t0, 0, 1\r\n\r\n\t\t);\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor().fromArray( this.elements );\r\n\r\n\t},\r\n\r\n\tcopy: function ( m ) {\r\n\r\n\t\tvar me = m.elements;\r\n\r\n\t\tthis.set(\r\n\r\n\t\t\tme[ 0 ], me[ 3 ], me[ 6 ],\r\n\t\t\tme[ 1 ], me[ 4 ], me[ 7 ],\r\n\t\t\tme[ 2 ], me[ 5 ], me[ 8 ]\r\n\r\n\t\t);\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromMatrix4: function( m ) {\r\n\r\n\t\tvar me = m.elements;\r\n\r\n\t\tthis.set(\r\n\r\n\t\t\tme[ 0 ], me[ 4 ], me[  8 ],\r\n\t\t\tme[ 1 ], me[ 5 ], me[  9 ],\r\n\t\t\tme[ 2 ], me[ 6 ], me[ 10 ]\r\n\r\n\t\t);\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tapplyToVector3Array: function () {\r\n\r\n\t\tvar v1;\r\n\r\n\t\treturn function ( array, offset, length ) {\r\n\r\n\t\t\tif ( v1 === undefined ) v1 = new THREE.Vector3();\r\n\t\t\tif ( offset === undefined ) offset = 0;\r\n\t\t\tif ( length === undefined ) length = array.length;\r\n\r\n\t\t\tfor ( var i = 0, j = offset; i < length; i += 3, j += 3 ) {\r\n\r\n\t\t\t\tv1.fromArray( array, j );\r\n\t\t\t\tv1.applyMatrix3( this );\r\n\t\t\t\tv1.toArray( array, j );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn array;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tapplyToBuffer: function () {\r\n\r\n\t\tvar v1;\r\n\r\n\t\treturn function applyToBuffer( buffer, offset, length ) {\r\n\r\n\t\t\tif ( v1 === undefined ) v1 = new THREE.Vector3();\r\n\t\t\tif ( offset === undefined ) offset = 0;\r\n\t\t\tif ( length === undefined ) length = buffer.length / buffer.itemSize;\r\n\r\n\t\t\tfor ( var i = 0, j = offset; i < length; i ++, j ++ ) {\r\n\r\n\t\t\t\tv1.x = buffer.getX( j );\r\n\t\t\t\tv1.y = buffer.getY( j );\r\n\t\t\t\tv1.z = buffer.getZ( j );\r\n\r\n\t\t\t\tv1.applyMatrix3( this );\r\n\r\n\t\t\t\tbuffer.setXYZ( v1.x, v1.y, v1.z );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn buffer;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tmultiplyScalar: function ( s ) {\r\n\r\n\t\tvar te = this.elements;\r\n\r\n\t\tte[ 0 ] *= s; te[ 3 ] *= s; te[ 6 ] *= s;\r\n\t\tte[ 1 ] *= s; te[ 4 ] *= s; te[ 7 ] *= s;\r\n\t\tte[ 2 ] *= s; te[ 5 ] *= s; te[ 8 ] *= s;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdeterminant: function () {\r\n\r\n\t\tvar te = this.elements;\r\n\r\n\t\tvar a = te[ 0 ], b = te[ 1 ], c = te[ 2 ],\r\n\t\t\td = te[ 3 ], e = te[ 4 ], f = te[ 5 ],\r\n\t\t\tg = te[ 6 ], h = te[ 7 ], i = te[ 8 ];\r\n\r\n\t\treturn a * e * i - a * f * h - b * d * i + b * f * g + c * d * h - c * e * g;\r\n\r\n\t},\r\n\r\n\tgetInverse: function ( matrix, throwOnDegenerate ) {\r\n\r\n\t\tif ( matrix instanceof THREE.Matrix4 ) {\r\n\r\n\t\t\tconsole.error( \"THREE.Matrix3.getInverse no longer takes a Matrix4 argument.\" );\r\n\r\n\t\t}\r\n\r\n\t\tvar me = matrix.elements,\r\n\t\t\tte = this.elements,\r\n\r\n\t\t\tn11 = me[ 0 ], n21 = me[ 1 ], n31 = me[ 2 ],\r\n\t\t\tn12 = me[ 3 ], n22 = me[ 4 ], n32 = me[ 5 ],\r\n\t\t\tn13 = me[ 6 ], n23 = me[ 7 ], n33 = me[ 8 ],\r\n\r\n\t\t\tt11 = n33 * n22 - n32 * n23,\r\n\t\t\tt12 = n32 * n13 - n33 * n12,\r\n\t\t\tt13 = n23 * n12 - n22 * n13,\r\n\r\n\t\t\tdet = n11 * t11 + n21 * t12 + n31 * t13;\r\n\r\n\t\tif ( det === 0 ) {\r\n\r\n\t\t\tvar msg = \"THREE.Matrix3.getInverse(): can't invert matrix, determinant is 0\";\r\n\r\n\t\t\tif ( throwOnDegenerate || false ) {\r\n\r\n\t\t\t\tthrow new Error( msg );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tconsole.warn( msg );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this.identity();\r\n\t\t}\r\n\t\t\r\n\t\tvar detInv = 1 / det;\r\n\r\n\t\tte[ 0 ] = t11 * detInv;\r\n\t\tte[ 1 ] = ( n31 * n23 - n33 * n21 ) * detInv;\r\n\t\tte[ 2 ] = ( n32 * n21 - n31 * n22 ) * detInv;\r\n\r\n\t\tte[ 3 ] = t12 * detInv;\r\n\t\tte[ 4 ] = ( n33 * n11 - n31 * n13 ) * detInv;\r\n\t\tte[ 5 ] = ( n31 * n12 - n32 * n11 ) * detInv;\r\n\r\n\t\tte[ 6 ] = t13 * detInv;\r\n\t\tte[ 7 ] = ( n21 * n13 - n23 * n11 ) * detInv;\r\n\t\tte[ 8 ] = ( n22 * n11 - n21 * n12 ) * detInv;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\ttranspose: function () {\r\n\r\n\t\tvar tmp, m = this.elements;\r\n\r\n\t\ttmp = m[ 1 ]; m[ 1 ] = m[ 3 ]; m[ 3 ] = tmp;\r\n\t\ttmp = m[ 2 ]; m[ 2 ] = m[ 6 ]; m[ 6 ] = tmp;\r\n\t\ttmp = m[ 5 ]; m[ 5 ] = m[ 7 ]; m[ 7 ] = tmp;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tflattenToArrayOffset: function ( array, offset ) {\r\n\r\n\t\tconsole.warn( \"THREE.Matrix3: .flattenToArrayOffset is deprecated \" +\r\n\t\t\t\t\"- just use .toArray instead.\" );\r\n\r\n\t\treturn this.toArray( array, offset );\r\n\r\n\t},\r\n\r\n\tgetNormalMatrix: function ( matrix4 ) {\r\n\r\n\t\treturn this.setFromMatrix4( matrix4 ).getInverse( this ).transpose();\r\n\r\n\t},\r\n\r\n\ttransposeIntoArray: function ( r ) {\r\n\r\n\t\tvar m = this.elements;\r\n\r\n\t\tr[ 0 ] = m[ 0 ];\r\n\t\tr[ 1 ] = m[ 3 ];\r\n\t\tr[ 2 ] = m[ 6 ];\r\n\t\tr[ 3 ] = m[ 1 ];\r\n\t\tr[ 4 ] = m[ 4 ];\r\n\t\tr[ 5 ] = m[ 7 ];\r\n\t\tr[ 6 ] = m[ 2 ];\r\n\t\tr[ 7 ] = m[ 5 ];\r\n\t\tr[ 8 ] = m[ 8 ];\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tfromArray: function ( array ) {\r\n\r\n\t\tthis.elements.set( array );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\ttoArray: function ( array, offset ) {\r\n\r\n\t\tif ( array === undefined ) array = [];\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tvar te = this.elements;\r\n\r\n\t\tarray[ offset ] = te[ 0 ];\r\n\t\tarray[ offset + 1 ] = te[ 1 ];\r\n\t\tarray[ offset + 2 ] = te[ 2 ];\r\n\r\n\t\tarray[ offset + 3 ] = te[ 3 ];\r\n\t\tarray[ offset + 4 ] = te[ 4 ];\r\n\t\tarray[ offset + 5 ] = te[ 5 ];\r\n\r\n\t\tarray[ offset + 6 ] = te[ 6 ];\r\n\t\tarray[ offset + 7 ] = te[ 7 ];\r\n\t\tarray[ offset + 8 ]  = te[ 8 ];\r\n\r\n\t\treturn array;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Matrix4.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author supereggbert / http://www.paulbrunt.co.uk/\r\n * @author philogb / http://blog.thejit.org/\r\n * @author jordi_ros / http://plattsoft.com\r\n * @author D1plo1d / http://github.com/D1plo1d\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author timknip / http://www.floorplanner.com/\r\n * @author bhouston / http://clara.io\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.Matrix4 = function () {\r\n\r\n\tthis.elements = new Float32Array( [\r\n\r\n\t\t1, 0, 0, 0,\r\n\t\t0, 1, 0, 0,\r\n\t\t0, 0, 1, 0,\r\n\t\t0, 0, 0, 1\r\n\r\n\t] );\r\n\r\n\tif ( arguments.length > 0 ) {\r\n\r\n\t\tconsole.error( 'THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.' );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.Matrix4.prototype = {\r\n\r\n\tconstructor: THREE.Matrix4,\r\n\r\n\tset: function ( n11, n12, n13, n14, n21, n22, n23, n24, n31, n32, n33, n34, n41, n42, n43, n44 ) {\r\n\r\n\t\tvar te = this.elements;\r\n\r\n\t\tte[ 0 ] = n11; te[ 4 ] = n12; te[ 8 ] = n13; te[ 12 ] = n14;\r\n\t\tte[ 1 ] = n21; te[ 5 ] = n22; te[ 9 ] = n23; te[ 13 ] = n24;\r\n\t\tte[ 2 ] = n31; te[ 6 ] = n32; te[ 10 ] = n33; te[ 14 ] = n34;\r\n\t\tte[ 3 ] = n41; te[ 7 ] = n42; te[ 11 ] = n43; te[ 15 ] = n44;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tidentity: function () {\r\n\r\n\t\tthis.set(\r\n\r\n\t\t\t1, 0, 0, 0,\r\n\t\t\t0, 1, 0, 0,\r\n\t\t\t0, 0, 1, 0,\r\n\t\t\t0, 0, 0, 1\r\n\r\n\t\t);\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new THREE.Matrix4().fromArray( this.elements );\r\n\r\n\t},\r\n\r\n\tcopy: function ( m ) {\r\n\r\n\t\tthis.elements.set( m.elements );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcopyPosition: function ( m ) {\r\n\r\n\t\tvar te = this.elements;\r\n\t\tvar me = m.elements;\r\n\r\n\t\tte[ 12 ] = me[ 12 ];\r\n\t\tte[ 13 ] = me[ 13 ];\r\n\t\tte[ 14 ] = me[ 14 ];\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\textractBasis: function ( xAxis, yAxis, zAxis ) {\r\n\r\n\t\txAxis.setFromMatrixColumn( this, 0 );\r\n\t\tyAxis.setFromMatrixColumn( this, 1 );\r\n\t\tzAxis.setFromMatrixColumn( this, 2 );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmakeBasis: function ( xAxis, yAxis, zAxis ) {\r\n\r\n\t\tthis.set(\r\n\t\t\txAxis.x, yAxis.x, zAxis.x, 0,\r\n\t\t\txAxis.y, yAxis.y, zAxis.y, 0,\r\n\t\t\txAxis.z, yAxis.z, zAxis.z, 0,\r\n\t\t\t0,       0,       0,       1\r\n\t\t);\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\textractRotation: function () {\r\n\r\n\t\tvar v1;\r\n\r\n\t\treturn function ( m ) {\r\n\r\n\t\t\tif ( v1 === undefined ) v1 = new THREE.Vector3();\r\n\r\n\t\t\tvar te = this.elements;\r\n\t\t\tvar me = m.elements;\r\n\r\n\t\t\tvar scaleX = 1 / v1.setFromMatrixColumn( m, 0 ).length();\r\n\t\t\tvar scaleY = 1 / v1.setFromMatrixColumn( m, 1 ).length();\r\n\t\t\tvar scaleZ = 1 / v1.setFromMatrixColumn( m, 2 ).length();\r\n\r\n\t\t\tte[ 0 ] = me[ 0 ] * scaleX;\r\n\t\t\tte[ 1 ] = me[ 1 ] * scaleX;\r\n\t\t\tte[ 2 ] = me[ 2 ] * scaleX;\r\n\r\n\t\t\tte[ 4 ] = me[ 4 ] * scaleY;\r\n\t\t\tte[ 5 ] = me[ 5 ] * scaleY;\r\n\t\t\tte[ 6 ] = me[ 6 ] * scaleY;\r\n\r\n\t\t\tte[ 8 ] = me[ 8 ] * scaleZ;\r\n\t\t\tte[ 9 ] = me[ 9 ] * scaleZ;\r\n\t\t\tte[ 10 ] = me[ 10 ] * scaleZ;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tmakeRotationFromEuler: function ( euler ) {\r\n\r\n\t\tif ( euler instanceof THREE.Euler === false ) {\r\n\r\n\t\t\tconsole.error( 'THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.' );\r\n\r\n\t\t}\r\n\r\n\t\tvar te = this.elements;\r\n\r\n\t\tvar x = euler.x, y = euler.y, z = euler.z;\r\n\t\tvar a = Math.cos( x ), b = Math.sin( x );\r\n\t\tvar c = Math.cos( y ), d = Math.sin( y );\r\n\t\tvar e = Math.cos( z ), f = Math.sin( z );\r\n\r\n\t\tif ( euler.order === 'XYZ' ) {\r\n\r\n\t\t\tvar ae = a * e, af = a * f, be = b * e, bf = b * f;\r\n\r\n\t\t\tte[ 0 ] = c * e;\r\n\t\t\tte[ 4 ] = - c * f;\r\n\t\t\tte[ 8 ] = d;\r\n\r\n\t\t\tte[ 1 ] = af + be * d;\r\n\t\t\tte[ 5 ] = ae - bf * d;\r\n\t\t\tte[ 9 ] = - b * c;\r\n\r\n\t\t\tte[ 2 ] = bf - ae * d;\r\n\t\t\tte[ 6 ] = be + af * d;\r\n\t\t\tte[ 10 ] = a * c;\r\n\r\n\t\t} else if ( euler.order === 'YXZ' ) {\r\n\r\n\t\t\tvar ce = c * e, cf = c * f, de = d * e, df = d * f;\r\n\r\n\t\t\tte[ 0 ] = ce + df * b;\r\n\t\t\tte[ 4 ] = de * b - cf;\r\n\t\t\tte[ 8 ] = a * d;\r\n\r\n\t\t\tte[ 1 ] = a * f;\r\n\t\t\tte[ 5 ] = a * e;\r\n\t\t\tte[ 9 ] = - b;\r\n\r\n\t\t\tte[ 2 ] = cf * b - de;\r\n\t\t\tte[ 6 ] = df + ce * b;\r\n\t\t\tte[ 10 ] = a * c;\r\n\r\n\t\t} else if ( euler.order === 'ZXY' ) {\r\n\r\n\t\t\tvar ce = c * e, cf = c * f, de = d * e, df = d * f;\r\n\r\n\t\t\tte[ 0 ] = ce - df * b;\r\n\t\t\tte[ 4 ] = - a * f;\r\n\t\t\tte[ 8 ] = de + cf * b;\r\n\r\n\t\t\tte[ 1 ] = cf + de * b;\r\n\t\t\tte[ 5 ] = a * e;\r\n\t\t\tte[ 9 ] = df - ce * b;\r\n\r\n\t\t\tte[ 2 ] = - a * d;\r\n\t\t\tte[ 6 ] = b;\r\n\t\t\tte[ 10 ] = a * c;\r\n\r\n\t\t} else if ( euler.order === 'ZYX' ) {\r\n\r\n\t\t\tvar ae = a * e, af = a * f, be = b * e, bf = b * f;\r\n\r\n\t\t\tte[ 0 ] = c * e;\r\n\t\t\tte[ 4 ] = be * d - af;\r\n\t\t\tte[ 8 ] = ae * d + bf;\r\n\r\n\t\t\tte[ 1 ] = c * f;\r\n\t\t\tte[ 5 ] = bf * d + ae;\r\n\t\t\tte[ 9 ] = af * d - be;\r\n\r\n\t\t\tte[ 2 ] = - d;\r\n\t\t\tte[ 6 ] = b * c;\r\n\t\t\tte[ 10 ] = a * c;\r\n\r\n\t\t} else if ( euler.order === 'YZX' ) {\r\n\r\n\t\t\tvar ac = a * c, ad = a * d, bc = b * c, bd = b * d;\r\n\r\n\t\t\tte[ 0 ] = c * e;\r\n\t\t\tte[ 4 ] = bd - ac * f;\r\n\t\t\tte[ 8 ] = bc * f + ad;\r\n\r\n\t\t\tte[ 1 ] = f;\r\n\t\t\tte[ 5 ] = a * e;\r\n\t\t\tte[ 9 ] = - b * e;\r\n\r\n\t\t\tte[ 2 ] = - d * e;\r\n\t\t\tte[ 6 ] = ad * f + bc;\r\n\t\t\tte[ 10 ] = ac - bd * f;\r\n\r\n\t\t} else if ( euler.order === 'XZY' ) {\r\n\r\n\t\t\tvar ac = a * c, ad = a * d, bc = b * c, bd = b * d;\r\n\r\n\t\t\tte[ 0 ] = c * e;\r\n\t\t\tte[ 4 ] = - f;\r\n\t\t\tte[ 8 ] = d * e;\r\n\r\n\t\t\tte[ 1 ] = ac * f + bd;\r\n\t\t\tte[ 5 ] = a * e;\r\n\t\t\tte[ 9 ] = ad * f - bc;\r\n\r\n\t\t\tte[ 2 ] = bc * f - ad;\r\n\t\t\tte[ 6 ] = b * e;\r\n\t\t\tte[ 10 ] = bd * f + ac;\r\n\r\n\t\t}\r\n\r\n\t\t// last column\r\n\t\tte[ 3 ] = 0;\r\n\t\tte[ 7 ] = 0;\r\n\t\tte[ 11 ] = 0;\r\n\r\n\t\t// bottom row\r\n\t\tte[ 12 ] = 0;\r\n\t\tte[ 13 ] = 0;\r\n\t\tte[ 14 ] = 0;\r\n\t\tte[ 15 ] = 1;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmakeRotationFromQuaternion: function ( q ) {\r\n\r\n\t\tvar te = this.elements;\r\n\r\n\t\tvar x = q.x, y = q.y, z = q.z, w = q.w;\r\n\t\tvar x2 = x + x, y2 = y + y, z2 = z + z;\r\n\t\tvar xx = x * x2, xy = x * y2, xz = x * z2;\r\n\t\tvar yy = y * y2, yz = y * z2, zz = z * z2;\r\n\t\tvar wx = w * x2, wy = w * y2, wz = w * z2;\r\n\r\n\t\tte[ 0 ] = 1 - ( yy + zz );\r\n\t\tte[ 4 ] = xy - wz;\r\n\t\tte[ 8 ] = xz + wy;\r\n\r\n\t\tte[ 1 ] = xy + wz;\r\n\t\tte[ 5 ] = 1 - ( xx + zz );\r\n\t\tte[ 9 ] = yz - wx;\r\n\r\n\t\tte[ 2 ] = xz - wy;\r\n\t\tte[ 6 ] = yz + wx;\r\n\t\tte[ 10 ] = 1 - ( xx + yy );\r\n\r\n\t\t// last column\r\n\t\tte[ 3 ] = 0;\r\n\t\tte[ 7 ] = 0;\r\n\t\tte[ 11 ] = 0;\r\n\r\n\t\t// bottom row\r\n\t\tte[ 12 ] = 0;\r\n\t\tte[ 13 ] = 0;\r\n\t\tte[ 14 ] = 0;\r\n\t\tte[ 15 ] = 1;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tlookAt: function () {\r\n\r\n\t\tvar x, y, z;\r\n\r\n\t\treturn function ( eye, target, up ) {\r\n\r\n\t\t\tif ( x === undefined ) {\r\n\r\n\t\t\t\tx = new THREE.Vector3();\r\n\t\t\t\ty = new THREE.Vector3();\r\n\t\t\t\tz = new THREE.Vector3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar te = this.elements;\r\n\r\n\t\t\tz.subVectors( eye, target ).normalize();\r\n\r\n\t\t\tif ( z.lengthSq() === 0 ) {\r\n\r\n\t\t\t\tz.z = 1;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tx.crossVectors( up, z ).normalize();\r\n\r\n\t\t\tif ( x.lengthSq() === 0 ) {\r\n\r\n\t\t\t\tz.z += 0.0001;\r\n\t\t\t\tx.crossVectors( up, z ).normalize();\r\n\r\n\t\t\t}\r\n\r\n\t\t\ty.crossVectors( z, x );\r\n\r\n\r\n\t\t\tte[ 0 ] = x.x; te[ 4 ] = y.x; te[ 8 ] = z.x;\r\n\t\t\tte[ 1 ] = x.y; te[ 5 ] = y.y; te[ 9 ] = z.y;\r\n\t\t\tte[ 2 ] = x.z; te[ 6 ] = y.z; te[ 10 ] = z.z;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tmultiply: function ( m, n ) {\r\n\r\n\t\tif ( n !== undefined ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead.' );\r\n\t\t\treturn this.multiplyMatrices( m, n );\r\n\r\n\t\t}\r\n\r\n\t\treturn this.multiplyMatrices( this, m );\r\n\r\n\t},\r\n\r\n\tpremultiply: function ( m ) {\r\n\r\n\t\treturn this.multiplyMatrices( m, this );\r\n\r\n\t},\r\n\r\n\tmultiplyMatrices: function ( a, b ) {\r\n\r\n\t\tvar ae = a.elements;\r\n\t\tvar be = b.elements;\r\n\t\tvar te = this.elements;\r\n\r\n\t\tvar a11 = ae[ 0 ], a12 = ae[ 4 ], a13 = ae[ 8 ], a14 = ae[ 12 ];\r\n\t\tvar a21 = ae[ 1 ], a22 = ae[ 5 ], a23 = ae[ 9 ], a24 = ae[ 13 ];\r\n\t\tvar a31 = ae[ 2 ], a32 = ae[ 6 ], a33 = ae[ 10 ], a34 = ae[ 14 ];\r\n\t\tvar a41 = ae[ 3 ], a42 = ae[ 7 ], a43 = ae[ 11 ], a44 = ae[ 15 ];\r\n\r\n\t\tvar b11 = be[ 0 ], b12 = be[ 4 ], b13 = be[ 8 ], b14 = be[ 12 ];\r\n\t\tvar b21 = be[ 1 ], b22 = be[ 5 ], b23 = be[ 9 ], b24 = be[ 13 ];\r\n\t\tvar b31 = be[ 2 ], b32 = be[ 6 ], b33 = be[ 10 ], b34 = be[ 14 ];\r\n\t\tvar b41 = be[ 3 ], b42 = be[ 7 ], b43 = be[ 11 ], b44 = be[ 15 ];\r\n\r\n\t\tte[ 0 ] = a11 * b11 + a12 * b21 + a13 * b31 + a14 * b41;\r\n\t\tte[ 4 ] = a11 * b12 + a12 * b22 + a13 * b32 + a14 * b42;\r\n\t\tte[ 8 ] = a11 * b13 + a12 * b23 + a13 * b33 + a14 * b43;\r\n\t\tte[ 12 ] = a11 * b14 + a12 * b24 + a13 * b34 + a14 * b44;\r\n\r\n\t\tte[ 1 ] = a21 * b11 + a22 * b21 + a23 * b31 + a24 * b41;\r\n\t\tte[ 5 ] = a21 * b12 + a22 * b22 + a23 * b32 + a24 * b42;\r\n\t\tte[ 9 ] = a21 * b13 + a22 * b23 + a23 * b33 + a24 * b43;\r\n\t\tte[ 13 ] = a21 * b14 + a22 * b24 + a23 * b34 + a24 * b44;\r\n\r\n\t\tte[ 2 ] = a31 * b11 + a32 * b21 + a33 * b31 + a34 * b41;\r\n\t\tte[ 6 ] = a31 * b12 + a32 * b22 + a33 * b32 + a34 * b42;\r\n\t\tte[ 10 ] = a31 * b13 + a32 * b23 + a33 * b33 + a34 * b43;\r\n\t\tte[ 14 ] = a31 * b14 + a32 * b24 + a33 * b34 + a34 * b44;\r\n\r\n\t\tte[ 3 ] = a41 * b11 + a42 * b21 + a43 * b31 + a44 * b41;\r\n\t\tte[ 7 ] = a41 * b12 + a42 * b22 + a43 * b32 + a44 * b42;\r\n\t\tte[ 11 ] = a41 * b13 + a42 * b23 + a43 * b33 + a44 * b43;\r\n\t\tte[ 15 ] = a41 * b14 + a42 * b24 + a43 * b34 + a44 * b44;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmultiplyToArray: function ( a, b, r ) {\r\n\r\n\t\tvar te = this.elements;\r\n\r\n\t\tthis.multiplyMatrices( a, b );\r\n\r\n\t\tr[ 0 ] = te[ 0 ]; r[ 1 ] = te[ 1 ]; r[ 2 ] = te[ 2 ]; r[ 3 ] = te[ 3 ];\r\n\t\tr[ 4 ] = te[ 4 ]; r[ 5 ] = te[ 5 ]; r[ 6 ] = te[ 6 ]; r[ 7 ] = te[ 7 ];\r\n\t\tr[ 8 ]  = te[ 8 ]; r[ 9 ]  = te[ 9 ]; r[ 10 ] = te[ 10 ]; r[ 11 ] = te[ 11 ];\r\n\t\tr[ 12 ] = te[ 12 ]; r[ 13 ] = te[ 13 ]; r[ 14 ] = te[ 14 ]; r[ 15 ] = te[ 15 ];\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmultiplyScalar: function ( s ) {\r\n\r\n\t\tvar te = this.elements;\r\n\r\n\t\tte[ 0 ] *= s; te[ 4 ] *= s; te[ 8 ] *= s; te[ 12 ] *= s;\r\n\t\tte[ 1 ] *= s; te[ 5 ] *= s; te[ 9 ] *= s; te[ 13 ] *= s;\r\n\t\tte[ 2 ] *= s; te[ 6 ] *= s; te[ 10 ] *= s; te[ 14 ] *= s;\r\n\t\tte[ 3 ] *= s; te[ 7 ] *= s; te[ 11 ] *= s; te[ 15 ] *= s;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tapplyToVector3Array: function () {\r\n\r\n\t\tvar v1;\r\n\r\n\t\treturn function ( array, offset, length ) {\r\n\r\n\t\t\tif ( v1 === undefined ) v1 = new THREE.Vector3();\r\n\t\t\tif ( offset === undefined ) offset = 0;\r\n\t\t\tif ( length === undefined ) length = array.length;\r\n\r\n\t\t\tfor ( var i = 0, j = offset; i < length; i += 3, j += 3 ) {\r\n\r\n\t\t\t\tv1.fromArray( array, j );\r\n\t\t\t\tv1.applyMatrix4( this );\r\n\t\t\t\tv1.toArray( array, j );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn array;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tapplyToBuffer: function () {\r\n\r\n\t\tvar v1;\r\n\r\n\t\treturn function applyToBuffer( buffer, offset, length ) {\r\n\r\n\t\t\tif ( v1 === undefined ) v1 = new THREE.Vector3();\r\n\t\t\tif ( offset === undefined ) offset = 0;\r\n\t\t\tif ( length === undefined ) length = buffer.length / buffer.itemSize;\r\n\r\n\t\t\tfor ( var i = 0, j = offset; i < length; i ++, j ++ ) {\r\n\r\n\t\t\t\tv1.x = buffer.getX( j );\r\n\t\t\t\tv1.y = buffer.getY( j );\r\n\t\t\t\tv1.z = buffer.getZ( j );\r\n\r\n\t\t\t\tv1.applyMatrix4( this );\r\n\r\n\t\t\t\tbuffer.setXYZ( v1.x, v1.y, v1.z );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn buffer;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tdeterminant: function () {\r\n\r\n\t\tvar te = this.elements;\r\n\r\n\t\tvar n11 = te[ 0 ], n12 = te[ 4 ], n13 = te[ 8 ], n14 = te[ 12 ];\r\n\t\tvar n21 = te[ 1 ], n22 = te[ 5 ], n23 = te[ 9 ], n24 = te[ 13 ];\r\n\t\tvar n31 = te[ 2 ], n32 = te[ 6 ], n33 = te[ 10 ], n34 = te[ 14 ];\r\n\t\tvar n41 = te[ 3 ], n42 = te[ 7 ], n43 = te[ 11 ], n44 = te[ 15 ];\r\n\r\n\t\t//TODO: make this more efficient\r\n\t\t//( based on http://www.euclideanspace.com/maths/algebra/matrix/functions/inverse/fourD/index.htm )\r\n\r\n\t\treturn (\r\n\t\t\tn41 * (\r\n\t\t\t\t+ n14 * n23 * n32\r\n\t\t\t\t - n13 * n24 * n32\r\n\t\t\t\t - n14 * n22 * n33\r\n\t\t\t\t + n12 * n24 * n33\r\n\t\t\t\t + n13 * n22 * n34\r\n\t\t\t\t - n12 * n23 * n34\r\n\t\t\t) +\r\n\t\t\tn42 * (\r\n\t\t\t\t+ n11 * n23 * n34\r\n\t\t\t\t - n11 * n24 * n33\r\n\t\t\t\t + n14 * n21 * n33\r\n\t\t\t\t - n13 * n21 * n34\r\n\t\t\t\t + n13 * n24 * n31\r\n\t\t\t\t - n14 * n23 * n31\r\n\t\t\t) +\r\n\t\t\tn43 * (\r\n\t\t\t\t+ n11 * n24 * n32\r\n\t\t\t\t - n11 * n22 * n34\r\n\t\t\t\t - n14 * n21 * n32\r\n\t\t\t\t + n12 * n21 * n34\r\n\t\t\t\t + n14 * n22 * n31\r\n\t\t\t\t - n12 * n24 * n31\r\n\t\t\t) +\r\n\t\t\tn44 * (\r\n\t\t\t\t- n13 * n22 * n31\r\n\t\t\t\t - n11 * n23 * n32\r\n\t\t\t\t + n11 * n22 * n33\r\n\t\t\t\t + n13 * n21 * n32\r\n\t\t\t\t - n12 * n21 * n33\r\n\t\t\t\t + n12 * n23 * n31\r\n\t\t\t)\r\n\r\n\t\t);\r\n\r\n\t},\r\n\r\n\ttranspose: function () {\r\n\r\n\t\tvar te = this.elements;\r\n\t\tvar tmp;\r\n\r\n\t\ttmp = te[ 1 ]; te[ 1 ] = te[ 4 ]; te[ 4 ] = tmp;\r\n\t\ttmp = te[ 2 ]; te[ 2 ] = te[ 8 ]; te[ 8 ] = tmp;\r\n\t\ttmp = te[ 6 ]; te[ 6 ] = te[ 9 ]; te[ 9 ] = tmp;\r\n\r\n\t\ttmp = te[ 3 ]; te[ 3 ] = te[ 12 ]; te[ 12 ] = tmp;\r\n\t\ttmp = te[ 7 ]; te[ 7 ] = te[ 13 ]; te[ 13 ] = tmp;\r\n\t\ttmp = te[ 11 ]; te[ 11 ] = te[ 14 ]; te[ 14 ] = tmp;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tflattenToArrayOffset: function ( array, offset ) {\r\n\r\n\t\tconsole.warn( \"THREE.Matrix3: .flattenToArrayOffset is deprecated \" +\r\n\t\t\t\t\"- just use .toArray instead.\" );\r\n\r\n\t\treturn this.toArray( array, offset );\r\n\r\n\t},\r\n\r\n\tgetPosition: function () {\r\n\r\n\t\tvar v1;\r\n\r\n\t\treturn function () {\r\n\r\n\t\t\tif ( v1 === undefined ) v1 = new THREE.Vector3();\r\n\t\t\tconsole.warn( 'THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.' );\r\n\r\n\t\t\treturn v1.setFromMatrixColumn( this, 3 );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tsetPosition: function ( v ) {\r\n\r\n\t\tvar te = this.elements;\r\n\r\n\t\tte[ 12 ] = v.x;\r\n\t\tte[ 13 ] = v.y;\r\n\t\tte[ 14 ] = v.z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tgetInverse: function ( m, throwOnDegenerate ) {\r\n\r\n\t\t// based on http://www.euclideanspace.com/maths/algebra/matrix/functions/inverse/fourD/index.htm\r\n\t\tvar te = this.elements,\r\n\t\t\tme = m.elements,\r\n\r\n\t\t\tn11 = me[ 0 ], n21 = me[ 1 ], n31 = me[ 2 ], n41 = me[ 3 ],\r\n\t\t\tn12 = me[ 4 ], n22 = me[ 5 ], n32 = me[ 6 ], n42 = me[ 7 ],\r\n\t\t\tn13 = me[ 8 ], n23 = me[ 9 ], n33 = me[ 10 ], n43 = me[ 11 ],\r\n\t\t\tn14 = me[ 12 ], n24 = me[ 13 ], n34 = me[ 14 ], n44 = me[ 15 ],\r\n\r\n\t\t\tt11 = n23 * n34 * n42 - n24 * n33 * n42 + n24 * n32 * n43 - n22 * n34 * n43 - n23 * n32 * n44 + n22 * n33 * n44,\r\n\t\t\tt12 = n14 * n33 * n42 - n13 * n34 * n42 - n14 * n32 * n43 + n12 * n34 * n43 + n13 * n32 * n44 - n12 * n33 * n44,\r\n\t\t\tt13 = n13 * n24 * n42 - n14 * n23 * n42 + n14 * n22 * n43 - n12 * n24 * n43 - n13 * n22 * n44 + n12 * n23 * n44,\r\n\t\t\tt14 = n14 * n23 * n32 - n13 * n24 * n32 - n14 * n22 * n33 + n12 * n24 * n33 + n13 * n22 * n34 - n12 * n23 * n34;\r\n\r\n\t\tvar det = n11 * t11 + n21 * t12 + n31 * t13 + n41 * t14;\r\n\r\n\t\tif ( det === 0 ) {\r\n\r\n\t\t\tvar msg = \"THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0\";\r\n\r\n\t\t\tif ( throwOnDegenerate || false ) {\r\n\r\n\t\t\t\tthrow new Error( msg );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tconsole.warn( msg );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this.identity();\r\n\r\n\t\t}\r\n\t\t\r\n\t\tvar detInv = 1 / det;\r\n\r\n\t\tte[ 0 ] = t11 * detInv;\r\n\t\tte[ 1 ] = ( n24 * n33 * n41 - n23 * n34 * n41 - n24 * n31 * n43 + n21 * n34 * n43 + n23 * n31 * n44 - n21 * n33 * n44 ) * detInv;\r\n\t\tte[ 2 ] = ( n22 * n34 * n41 - n24 * n32 * n41 + n24 * n31 * n42 - n21 * n34 * n42 - n22 * n31 * n44 + n21 * n32 * n44 ) * detInv;\r\n\t\tte[ 3 ] = ( n23 * n32 * n41 - n22 * n33 * n41 - n23 * n31 * n42 + n21 * n33 * n42 + n22 * n31 * n43 - n21 * n32 * n43 ) * detInv;\r\n\r\n\t\tte[ 4 ] = t12 * detInv;\r\n\t\tte[ 5 ] = ( n13 * n34 * n41 - n14 * n33 * n41 + n14 * n31 * n43 - n11 * n34 * n43 - n13 * n31 * n44 + n11 * n33 * n44 ) * detInv;\r\n\t\tte[ 6 ] = ( n14 * n32 * n41 - n12 * n34 * n41 - n14 * n31 * n42 + n11 * n34 * n42 + n12 * n31 * n44 - n11 * n32 * n44 ) * detInv;\r\n\t\tte[ 7 ] = ( n12 * n33 * n41 - n13 * n32 * n41 + n13 * n31 * n42 - n11 * n33 * n42 - n12 * n31 * n43 + n11 * n32 * n43 ) * detInv;\r\n\r\n\t\tte[ 8 ] = t13 * detInv;\r\n\t\tte[ 9 ] = ( n14 * n23 * n41 - n13 * n24 * n41 - n14 * n21 * n43 + n11 * n24 * n43 + n13 * n21 * n44 - n11 * n23 * n44 ) * detInv;\r\n\t\tte[ 10 ] = ( n12 * n24 * n41 - n14 * n22 * n41 + n14 * n21 * n42 - n11 * n24 * n42 - n12 * n21 * n44 + n11 * n22 * n44 ) * detInv;\r\n\t\tte[ 11 ] = ( n13 * n22 * n41 - n12 * n23 * n41 - n13 * n21 * n42 + n11 * n23 * n42 + n12 * n21 * n43 - n11 * n22 * n43 ) * detInv;\r\n\r\n\t\tte[ 12 ] = t14 * detInv;\r\n\t\tte[ 13 ] = ( n13 * n24 * n31 - n14 * n23 * n31 + n14 * n21 * n33 - n11 * n24 * n33 - n13 * n21 * n34 + n11 * n23 * n34 ) * detInv;\r\n\t\tte[ 14 ] = ( n14 * n22 * n31 - n12 * n24 * n31 - n14 * n21 * n32 + n11 * n24 * n32 + n12 * n21 * n34 - n11 * n22 * n34 ) * detInv;\r\n\t\tte[ 15 ] = ( n12 * n23 * n31 - n13 * n22 * n31 + n13 * n21 * n32 - n11 * n23 * n32 - n12 * n21 * n33 + n11 * n22 * n33 ) * detInv;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tscale: function ( v ) {\r\n\r\n\t\tvar te = this.elements;\r\n\t\tvar x = v.x, y = v.y, z = v.z;\r\n\r\n\t\tte[ 0 ] *= x; te[ 4 ] *= y; te[ 8 ] *= z;\r\n\t\tte[ 1 ] *= x; te[ 5 ] *= y; te[ 9 ] *= z;\r\n\t\tte[ 2 ] *= x; te[ 6 ] *= y; te[ 10 ] *= z;\r\n\t\tte[ 3 ] *= x; te[ 7 ] *= y; te[ 11 ] *= z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tgetMaxScaleOnAxis: function () {\r\n\r\n\t\tvar te = this.elements;\r\n\r\n\t\tvar scaleXSq = te[ 0 ] * te[ 0 ] + te[ 1 ] * te[ 1 ] + te[ 2 ] * te[ 2 ];\r\n\t\tvar scaleYSq = te[ 4 ] * te[ 4 ] + te[ 5 ] * te[ 5 ] + te[ 6 ] * te[ 6 ];\r\n\t\tvar scaleZSq = te[ 8 ] * te[ 8 ] + te[ 9 ] * te[ 9 ] + te[ 10 ] * te[ 10 ];\r\n\r\n\t\treturn Math.sqrt( Math.max( scaleXSq, scaleYSq, scaleZSq ) );\r\n\r\n\t},\r\n\r\n\tmakeTranslation: function ( x, y, z ) {\r\n\r\n\t\tthis.set(\r\n\r\n\t\t\t1, 0, 0, x,\r\n\t\t\t0, 1, 0, y,\r\n\t\t\t0, 0, 1, z,\r\n\t\t\t0, 0, 0, 1\r\n\r\n\t\t);\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmakeRotationX: function ( theta ) {\r\n\r\n\t\tvar c = Math.cos( theta ), s = Math.sin( theta );\r\n\r\n\t\tthis.set(\r\n\r\n\t\t\t1, 0,  0, 0,\r\n\t\t\t0, c, - s, 0,\r\n\t\t\t0, s,  c, 0,\r\n\t\t\t0, 0,  0, 1\r\n\r\n\t\t);\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmakeRotationY: function ( theta ) {\r\n\r\n\t\tvar c = Math.cos( theta ), s = Math.sin( theta );\r\n\r\n\t\tthis.set(\r\n\r\n\t\t\t c, 0, s, 0,\r\n\t\t\t 0, 1, 0, 0,\r\n\t\t\t- s, 0, c, 0,\r\n\t\t\t 0, 0, 0, 1\r\n\r\n\t\t);\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmakeRotationZ: function ( theta ) {\r\n\r\n\t\tvar c = Math.cos( theta ), s = Math.sin( theta );\r\n\r\n\t\tthis.set(\r\n\r\n\t\t\tc, - s, 0, 0,\r\n\t\t\ts,  c, 0, 0,\r\n\t\t\t0,  0, 1, 0,\r\n\t\t\t0,  0, 0, 1\r\n\r\n\t\t);\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmakeRotationAxis: function ( axis, angle ) {\r\n\r\n\t\t// Based on http://www.gamedev.net/reference/articles/article1199.asp\r\n\r\n\t\tvar c = Math.cos( angle );\r\n\t\tvar s = Math.sin( angle );\r\n\t\tvar t = 1 - c;\r\n\t\tvar x = axis.x, y = axis.y, z = axis.z;\r\n\t\tvar tx = t * x, ty = t * y;\r\n\r\n\t\tthis.set(\r\n\r\n\t\t\ttx * x + c, tx * y - s * z, tx * z + s * y, 0,\r\n\t\t\ttx * y + s * z, ty * y + c, ty * z - s * x, 0,\r\n\t\t\ttx * z - s * y, ty * z + s * x, t * z * z + c, 0,\r\n\t\t\t0, 0, 0, 1\r\n\r\n\t\t);\r\n\r\n\t\t return this;\r\n\r\n\t},\r\n\r\n\tmakeScale: function ( x, y, z ) {\r\n\r\n\t\tthis.set(\r\n\r\n\t\t\tx, 0, 0, 0,\r\n\t\t\t0, y, 0, 0,\r\n\t\t\t0, 0, z, 0,\r\n\t\t\t0, 0, 0, 1\r\n\r\n\t\t);\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcompose: function ( position, quaternion, scale ) {\r\n\r\n\t\tthis.makeRotationFromQuaternion( quaternion );\r\n\t\tthis.scale( scale );\r\n\t\tthis.setPosition( position );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdecompose: function () {\r\n\r\n\t\tvar vector, matrix;\r\n\r\n\t\treturn function ( position, quaternion, scale ) {\r\n\r\n\t\t\tif ( vector === undefined ) {\r\n\r\n\t\t\t\tvector = new THREE.Vector3();\r\n\t\t\t\tmatrix = new THREE.Matrix4();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar te = this.elements;\r\n\r\n\t\t\tvar sx = vector.set( te[ 0 ], te[ 1 ], te[ 2 ] ).length();\r\n\t\t\tvar sy = vector.set( te[ 4 ], te[ 5 ], te[ 6 ] ).length();\r\n\t\t\tvar sz = vector.set( te[ 8 ], te[ 9 ], te[ 10 ] ).length();\r\n\r\n\t\t\t// if determine is negative, we need to invert one scale\r\n\t\t\tvar det = this.determinant();\r\n\t\t\tif ( det < 0 ) {\r\n\r\n\t\t\t\tsx = - sx;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tposition.x = te[ 12 ];\r\n\t\t\tposition.y = te[ 13 ];\r\n\t\t\tposition.z = te[ 14 ];\r\n\r\n\t\t\t// scale the rotation part\r\n\r\n\t\t\tmatrix.elements.set( this.elements ); // at this point matrix is incomplete so we can't use .copy()\r\n\r\n\t\t\tvar invSX = 1 / sx;\r\n\t\t\tvar invSY = 1 / sy;\r\n\t\t\tvar invSZ = 1 / sz;\r\n\r\n\t\t\tmatrix.elements[ 0 ] *= invSX;\r\n\t\t\tmatrix.elements[ 1 ] *= invSX;\r\n\t\t\tmatrix.elements[ 2 ] *= invSX;\r\n\r\n\t\t\tmatrix.elements[ 4 ] *= invSY;\r\n\t\t\tmatrix.elements[ 5 ] *= invSY;\r\n\t\t\tmatrix.elements[ 6 ] *= invSY;\r\n\r\n\t\t\tmatrix.elements[ 8 ] *= invSZ;\r\n\t\t\tmatrix.elements[ 9 ] *= invSZ;\r\n\t\t\tmatrix.elements[ 10 ] *= invSZ;\r\n\r\n\t\t\tquaternion.setFromRotationMatrix( matrix );\r\n\r\n\t\t\tscale.x = sx;\r\n\t\t\tscale.y = sy;\r\n\t\t\tscale.z = sz;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tmakeFrustum: function ( left, right, bottom, top, near, far ) {\r\n\r\n\t\tvar te = this.elements;\r\n\t\tvar x = 2 * near / ( right - left );\r\n\t\tvar y = 2 * near / ( top - bottom );\r\n\r\n\t\tvar a = ( right + left ) / ( right - left );\r\n\t\tvar b = ( top + bottom ) / ( top - bottom );\r\n\t\tvar c = - ( far + near ) / ( far - near );\r\n\t\tvar d = - 2 * far * near / ( far - near );\r\n\r\n\t\tte[ 0 ] = x;\tte[ 4 ] = 0;\tte[ 8 ] = a;\tte[ 12 ] = 0;\r\n\t\tte[ 1 ] = 0;\tte[ 5 ] = y;\tte[ 9 ] = b;\tte[ 13 ] = 0;\r\n\t\tte[ 2 ] = 0;\tte[ 6 ] = 0;\tte[ 10 ] = c;\tte[ 14 ] = d;\r\n\t\tte[ 3 ] = 0;\tte[ 7 ] = 0;\tte[ 11 ] = - 1;\tte[ 15 ] = 0;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmakePerspective: function ( fov, aspect, near, far ) {\r\n\r\n\t\tvar ymax = near * Math.tan( THREE.Math.DEG2RAD * fov * 0.5 );\r\n\t\tvar ymin = - ymax;\r\n\t\tvar xmin = ymin * aspect;\r\n\t\tvar xmax = ymax * aspect;\r\n\r\n\t\treturn this.makeFrustum( xmin, xmax, ymin, ymax, near, far );\r\n\r\n\t},\r\n\r\n\tmakeOrthographic: function ( left, right, top, bottom, near, far ) {\r\n\r\n\t\tvar te = this.elements;\r\n\t\tvar w = 1.0 / ( right - left );\r\n\t\tvar h = 1.0 / ( top - bottom );\r\n\t\tvar p = 1.0 / ( far - near );\r\n\r\n\t\tvar x = ( right + left ) * w;\r\n\t\tvar y = ( top + bottom ) * h;\r\n\t\tvar z = ( far + near ) * p;\r\n\r\n\t\tte[ 0 ] = 2 * w;\tte[ 4 ] = 0;\tte[ 8 ] = 0;\tte[ 12 ] = - x;\r\n\t\tte[ 1 ] = 0;\tte[ 5 ] = 2 * h;\tte[ 9 ] = 0;\tte[ 13 ] = - y;\r\n\t\tte[ 2 ] = 0;\tte[ 6 ] = 0;\tte[ 10 ] = - 2 * p;\tte[ 14 ] = - z;\r\n\t\tte[ 3 ] = 0;\tte[ 7 ] = 0;\tte[ 11 ] = 0;\tte[ 15 ] = 1;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tequals: function ( matrix ) {\r\n\r\n\t\tvar te = this.elements;\r\n\t\tvar me = matrix.elements;\r\n\r\n\t\tfor ( var i = 0; i < 16; i ++ ) {\r\n\r\n\t\t\tif ( te[ i ] !== me[ i ] ) return false;\r\n\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\r\n\t},\r\n\r\n\tfromArray: function ( array ) {\r\n\r\n\t\tthis.elements.set( array );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\ttoArray: function ( array, offset ) {\r\n\r\n\t\tif ( array === undefined ) array = [];\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tvar te = this.elements;\r\n\r\n\t\tarray[ offset ] = te[ 0 ];\r\n\t\tarray[ offset + 1 ] = te[ 1 ];\r\n\t\tarray[ offset + 2 ] = te[ 2 ];\r\n\t\tarray[ offset + 3 ] = te[ 3 ];\r\n\r\n\t\tarray[ offset + 4 ] = te[ 4 ];\r\n\t\tarray[ offset + 5 ] = te[ 5 ];\r\n\t\tarray[ offset + 6 ] = te[ 6 ];\r\n\t\tarray[ offset + 7 ] = te[ 7 ];\r\n\r\n\t\tarray[ offset + 8 ]  = te[ 8 ];\r\n\t\tarray[ offset + 9 ]  = te[ 9 ];\r\n\t\tarray[ offset + 10 ] = te[ 10 ];\r\n\t\tarray[ offset + 11 ] = te[ 11 ];\r\n\r\n\t\tarray[ offset + 12 ] = te[ 12 ];\r\n\t\tarray[ offset + 13 ] = te[ 13 ];\r\n\t\tarray[ offset + 14 ] = te[ 14 ];\r\n\t\tarray[ offset + 15 ] = te[ 15 ];\r\n\r\n\t\treturn array;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Ray.js\r\n\r\n/**\r\n * @author bhouston / http://clara.io\r\n */\r\n\r\nTHREE.Ray = function ( origin, direction ) {\r\n\r\n\tthis.origin = ( origin !== undefined ) ? origin : new THREE.Vector3();\r\n\tthis.direction = ( direction !== undefined ) ? direction : new THREE.Vector3();\r\n\r\n};\r\n\r\nTHREE.Ray.prototype = {\r\n\r\n\tconstructor: THREE.Ray,\r\n\r\n\tset: function ( origin, direction ) {\r\n\r\n\t\tthis.origin.copy( origin );\r\n\t\tthis.direction.copy( direction );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor().copy( this );\r\n\r\n\t},\r\n\r\n\tcopy: function ( ray ) {\r\n\r\n\t\tthis.origin.copy( ray.origin );\r\n\t\tthis.direction.copy( ray.direction );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tat: function ( t, optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\r\n\t\treturn result.copy( this.direction ).multiplyScalar( t ).add( this.origin );\r\n\r\n\t},\r\n\r\n\tlookAt: function ( v ) {\r\n\r\n\t\tthis.direction.copy( v ).sub( this.origin ).normalize();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\trecast: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3();\r\n\r\n\t\treturn function ( t ) {\r\n\r\n\t\t\tthis.origin.copy( this.at( t, v1 ) );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tclosestPointToPoint: function ( point, optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\tresult.subVectors( point, this.origin );\r\n\t\tvar directionDistance = result.dot( this.direction );\r\n\r\n\t\tif ( directionDistance < 0 ) {\r\n\r\n\t\t\treturn result.copy( this.origin );\r\n\r\n\t\t}\r\n\r\n\t\treturn result.copy( this.direction ).multiplyScalar( directionDistance ).add( this.origin );\r\n\r\n\t},\r\n\r\n\tdistanceToPoint: function ( point ) {\r\n\r\n\t\treturn Math.sqrt( this.distanceSqToPoint( point ) );\r\n\r\n\t},\r\n\r\n\tdistanceSqToPoint: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3();\r\n\r\n\t\treturn function ( point ) {\r\n\r\n\t\t\tvar directionDistance = v1.subVectors( point, this.origin ).dot( this.direction );\r\n\r\n\t\t\t// point behind the ray\r\n\r\n\t\t\tif ( directionDistance < 0 ) {\r\n\r\n\t\t\t\treturn this.origin.distanceToSquared( point );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tv1.copy( this.direction ).multiplyScalar( directionDistance ).add( this.origin );\r\n\r\n\t\t\treturn v1.distanceToSquared( point );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tdistanceSqToSegment: function () {\r\n\r\n\t\tvar segCenter = new THREE.Vector3();\r\n\t\tvar segDir = new THREE.Vector3();\r\n\t\tvar diff = new THREE.Vector3();\r\n\r\n\t\treturn function ( v0, v1, optionalPointOnRay, optionalPointOnSegment ) {\r\n\r\n\t\t\t// from http://www.geometrictools.com/GTEngine/Include/Mathematics/GteDistRaySegment.h\r\n\t\t\t// It returns the min distance between the ray and the segment\r\n\t\t\t// defined by v0 and v1\r\n\t\t\t// It can also set two optional targets :\r\n\t\t\t// - The closest point on the ray\r\n\t\t\t// - The closest point on the segment\r\n\r\n\t\t\tsegCenter.copy( v0 ).add( v1 ).multiplyScalar( 0.5 );\r\n\t\t\tsegDir.copy( v1 ).sub( v0 ).normalize();\r\n\t\t\tdiff.copy( this.origin ).sub( segCenter );\r\n\r\n\t\t\tvar segExtent = v0.distanceTo( v1 ) * 0.5;\r\n\t\t\tvar a01 = - this.direction.dot( segDir );\r\n\t\t\tvar b0 = diff.dot( this.direction );\r\n\t\t\tvar b1 = - diff.dot( segDir );\r\n\t\t\tvar c = diff.lengthSq();\r\n\t\t\tvar det = Math.abs( 1 - a01 * a01 );\r\n\t\t\tvar s0, s1, sqrDist, extDet;\r\n\r\n\t\t\tif ( det > 0 ) {\r\n\r\n\t\t\t\t// The ray and segment are not parallel.\r\n\r\n\t\t\t\ts0 = a01 * b1 - b0;\r\n\t\t\t\ts1 = a01 * b0 - b1;\r\n\t\t\t\textDet = segExtent * det;\r\n\r\n\t\t\t\tif ( s0 >= 0 ) {\r\n\r\n\t\t\t\t\tif ( s1 >= - extDet ) {\r\n\r\n\t\t\t\t\t\tif ( s1 <= extDet ) {\r\n\r\n\t\t\t\t\t\t\t// region 0\r\n\t\t\t\t\t\t\t// Minimum at interior points of ray and segment.\r\n\r\n\t\t\t\t\t\t\tvar invDet = 1 / det;\r\n\t\t\t\t\t\t\ts0 *= invDet;\r\n\t\t\t\t\t\t\ts1 *= invDet;\r\n\t\t\t\t\t\t\tsqrDist = s0 * ( s0 + a01 * s1 + 2 * b0 ) + s1 * ( a01 * s0 + s1 + 2 * b1 ) + c;\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t// region 1\r\n\r\n\t\t\t\t\t\t\ts1 = segExtent;\r\n\t\t\t\t\t\t\ts0 = Math.max( 0, - ( a01 * s1 + b0 ) );\r\n\t\t\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t// region 5\r\n\r\n\t\t\t\t\t\ts1 = - segExtent;\r\n\t\t\t\t\t\ts0 = Math.max( 0, - ( a01 * s1 + b0 ) );\r\n\t\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tif ( s1 <= - extDet ) {\r\n\r\n\t\t\t\t\t\t// region 4\r\n\r\n\t\t\t\t\t\ts0 = Math.max( 0, - ( - a01 * segExtent + b0 ) );\r\n\t\t\t\t\t\ts1 = ( s0 > 0 ) ? - segExtent : Math.min( Math.max( - segExtent, - b1 ), segExtent );\r\n\t\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\r\n\r\n\t\t\t\t\t} else if ( s1 <= extDet ) {\r\n\r\n\t\t\t\t\t\t// region 3\r\n\r\n\t\t\t\t\t\ts0 = 0;\r\n\t\t\t\t\t\ts1 = Math.min( Math.max( - segExtent, - b1 ), segExtent );\r\n\t\t\t\t\t\tsqrDist = s1 * ( s1 + 2 * b1 ) + c;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t// region 2\r\n\r\n\t\t\t\t\t\ts0 = Math.max( 0, - ( a01 * segExtent + b0 ) );\r\n\t\t\t\t\t\ts1 = ( s0 > 0 ) ? segExtent : Math.min( Math.max( - segExtent, - b1 ), segExtent );\r\n\t\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// Ray and segment are parallel.\r\n\r\n\t\t\t\ts1 = ( a01 > 0 ) ? - segExtent : segExtent;\r\n\t\t\t\ts0 = Math.max( 0, - ( a01 * s1 + b0 ) );\r\n\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( optionalPointOnRay ) {\r\n\r\n\t\t\t\toptionalPointOnRay.copy( this.direction ).multiplyScalar( s0 ).add( this.origin );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( optionalPointOnSegment ) {\r\n\r\n\t\t\t\toptionalPointOnSegment.copy( segDir ).multiplyScalar( s1 ).add( segCenter );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn sqrDist;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tintersectSphere: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3();\r\n\r\n\t\treturn function ( sphere, optionalTarget ) {\r\n\r\n\t\t\tv1.subVectors( sphere.center, this.origin );\r\n\t\t\tvar tca = v1.dot( this.direction );\r\n\t\t\tvar d2 = v1.dot( v1 ) - tca * tca;\r\n\t\t\tvar radius2 = sphere.radius * sphere.radius;\r\n\r\n\t\t\tif ( d2 > radius2 ) return null;\r\n\r\n\t\t\tvar thc = Math.sqrt( radius2 - d2 );\r\n\r\n\t\t\t// t0 = first intersect point - entrance on front of sphere\r\n\t\t\tvar t0 = tca - thc;\r\n\r\n\t\t\t// t1 = second intersect point - exit point on back of sphere\r\n\t\t\tvar t1 = tca + thc;\r\n\r\n\t\t\t// test to see if both t0 and t1 are behind the ray - if so, return null\r\n\t\t\tif ( t0 < 0 && t1 < 0 ) return null;\r\n\r\n\t\t\t// test to see if t0 is behind the ray:\r\n\t\t\t// if it is, the ray is inside the sphere, so return the second exit point scaled by t1,\r\n\t\t\t// in order to always return an intersect point that is in front of the ray.\r\n\t\t\tif ( t0 < 0 ) return this.at( t1, optionalTarget );\r\n\r\n\t\t\t// else t0 is in front of the ray, so return the first collision point scaled by t0\r\n\t\t\treturn this.at( t0, optionalTarget );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tintersectsSphere: function ( sphere ) {\r\n\r\n\t\treturn this.distanceToPoint( sphere.center ) <= sphere.radius;\r\n\r\n\t},\r\n\r\n\tdistanceToPlane: function ( plane ) {\r\n\r\n\t\tvar denominator = plane.normal.dot( this.direction );\r\n\r\n\t\tif ( denominator === 0 ) {\r\n\r\n\t\t\t// line is coplanar, return origin\r\n\t\t\tif ( plane.distanceToPoint( this.origin ) === 0 ) {\r\n\r\n\t\t\t\treturn 0;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Null is preferable to undefined since undefined means.... it is undefined\r\n\r\n\t\t\treturn null;\r\n\r\n\t\t}\r\n\r\n\t\tvar t = - ( this.origin.dot( plane.normal ) + plane.constant ) / denominator;\r\n\r\n\t\t// Return if the ray never intersects the plane\r\n\r\n\t\treturn t >= 0 ? t :  null;\r\n\r\n\t},\r\n\r\n\tintersectPlane: function ( plane, optionalTarget ) {\r\n\r\n\t\tvar t = this.distanceToPlane( plane );\r\n\r\n\t\tif ( t === null ) {\r\n\r\n\t\t\treturn null;\r\n\r\n\t\t}\r\n\r\n\t\treturn this.at( t, optionalTarget );\r\n\r\n\t},\r\n\r\n\r\n\r\n\tintersectsPlane: function ( plane ) {\r\n\r\n\t\t// check if the ray lies on the plane first\r\n\r\n\t\tvar distToPoint = plane.distanceToPoint( this.origin );\r\n\r\n\t\tif ( distToPoint === 0 ) {\r\n\r\n\t\t\treturn true;\r\n\r\n\t\t}\r\n\r\n\t\tvar denominator = plane.normal.dot( this.direction );\r\n\r\n\t\tif ( denominator * distToPoint < 0 ) {\r\n\r\n\t\t\treturn true;\r\n\r\n\t\t}\r\n\r\n\t\t// ray origin is behind the plane (and is pointing behind it)\r\n\r\n\t\treturn false;\r\n\r\n\t},\r\n\r\n\tintersectBox: function ( box, optionalTarget ) {\r\n\r\n\t\tvar tmin, tmax, tymin, tymax, tzmin, tzmax;\r\n\r\n\t\tvar invdirx = 1 / this.direction.x,\r\n\t\t\tinvdiry = 1 / this.direction.y,\r\n\t\t\tinvdirz = 1 / this.direction.z;\r\n\r\n\t\tvar origin = this.origin;\r\n\r\n\t\tif ( invdirx >= 0 ) {\r\n\r\n\t\t\ttmin = ( box.min.x - origin.x ) * invdirx;\r\n\t\t\ttmax = ( box.max.x - origin.x ) * invdirx;\r\n\r\n\t\t} else {\r\n\r\n\t\t\ttmin = ( box.max.x - origin.x ) * invdirx;\r\n\t\t\ttmax = ( box.min.x - origin.x ) * invdirx;\r\n\r\n\t\t}\r\n\r\n\t\tif ( invdiry >= 0 ) {\r\n\r\n\t\t\ttymin = ( box.min.y - origin.y ) * invdiry;\r\n\t\t\ttymax = ( box.max.y - origin.y ) * invdiry;\r\n\r\n\t\t} else {\r\n\r\n\t\t\ttymin = ( box.max.y - origin.y ) * invdiry;\r\n\t\t\ttymax = ( box.min.y - origin.y ) * invdiry;\r\n\r\n\t\t}\r\n\r\n\t\tif ( ( tmin > tymax ) || ( tymin > tmax ) ) return null;\r\n\r\n\t\t// These lines also handle the case where tmin or tmax is NaN\r\n\t\t// (result of 0 * Infinity). x !== x returns true if x is NaN\r\n\r\n\t\tif ( tymin > tmin || tmin !== tmin ) tmin = tymin;\r\n\r\n\t\tif ( tymax < tmax || tmax !== tmax ) tmax = tymax;\r\n\r\n\t\tif ( invdirz >= 0 ) {\r\n\r\n\t\t\ttzmin = ( box.min.z - origin.z ) * invdirz;\r\n\t\t\ttzmax = ( box.max.z - origin.z ) * invdirz;\r\n\r\n\t\t} else {\r\n\r\n\t\t\ttzmin = ( box.max.z - origin.z ) * invdirz;\r\n\t\t\ttzmax = ( box.min.z - origin.z ) * invdirz;\r\n\r\n\t\t}\r\n\r\n\t\tif ( ( tmin > tzmax ) || ( tzmin > tmax ) ) return null;\r\n\r\n\t\tif ( tzmin > tmin || tmin !== tmin ) tmin = tzmin;\r\n\r\n\t\tif ( tzmax < tmax || tmax !== tmax ) tmax = tzmax;\r\n\r\n\t\t//return point closest to the ray (positive side)\r\n\r\n\t\tif ( tmax < 0 ) return null;\r\n\r\n\t\treturn this.at( tmin >= 0 ? tmin : tmax, optionalTarget );\r\n\r\n\t},\r\n\r\n\tintersectsBox: ( function () {\r\n\r\n\t\tvar v = new THREE.Vector3();\r\n\r\n\t\treturn function ( box ) {\r\n\r\n\t\t\treturn this.intersectBox( box, v ) !== null;\r\n\r\n\t\t};\r\n\r\n\t} )(),\r\n\r\n\tintersectTriangle: function () {\r\n\r\n\t\t// Compute the offset origin, edges, and normal.\r\n\t\tvar diff = new THREE.Vector3();\r\n\t\tvar edge1 = new THREE.Vector3();\r\n\t\tvar edge2 = new THREE.Vector3();\r\n\t\tvar normal = new THREE.Vector3();\r\n\r\n\t\treturn function ( a, b, c, backfaceCulling, optionalTarget ) {\r\n\r\n\t\t\t// from http://www.geometrictools.com/GTEngine/Include/Mathematics/GteIntrRay3Triangle3.h\r\n\r\n\t\t\tedge1.subVectors( b, a );\r\n\t\t\tedge2.subVectors( c, a );\r\n\t\t\tnormal.crossVectors( edge1, edge2 );\r\n\r\n\t\t\t// Solve Q + t*D = b1*E1 + b2*E2 (Q = kDiff, D = ray direction,\r\n\t\t\t// E1 = kEdge1, E2 = kEdge2, N = Cross(E1,E2)) by\r\n\t\t\t//   |Dot(D,N)|*b1 = sign(Dot(D,N))*Dot(D,Cross(Q,E2))\r\n\t\t\t//   |Dot(D,N)|*b2 = sign(Dot(D,N))*Dot(D,Cross(E1,Q))\r\n\t\t\t//   |Dot(D,N)|*t = -sign(Dot(D,N))*Dot(Q,N)\r\n\t\t\tvar DdN = this.direction.dot( normal );\r\n\t\t\tvar sign;\r\n\r\n\t\t\tif ( DdN > 0 ) {\r\n\r\n\t\t\t\tif ( backfaceCulling ) return null;\r\n\t\t\t\tsign = 1;\r\n\r\n\t\t\t} else if ( DdN < 0 ) {\r\n\r\n\t\t\t\tsign = - 1;\r\n\t\t\t\tDdN = - DdN;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\treturn null;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tdiff.subVectors( this.origin, a );\r\n\t\t\tvar DdQxE2 = sign * this.direction.dot( edge2.crossVectors( diff, edge2 ) );\r\n\r\n\t\t\t// b1 < 0, no intersection\r\n\t\t\tif ( DdQxE2 < 0 ) {\r\n\r\n\t\t\t\treturn null;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar DdE1xQ = sign * this.direction.dot( edge1.cross( diff ) );\r\n\r\n\t\t\t// b2 < 0, no intersection\r\n\t\t\tif ( DdE1xQ < 0 ) {\r\n\r\n\t\t\t\treturn null;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// b1+b2 > 1, no intersection\r\n\t\t\tif ( DdQxE2 + DdE1xQ > DdN ) {\r\n\r\n\t\t\t\treturn null;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Line intersects triangle, check if ray does.\r\n\t\t\tvar QdN = - sign * diff.dot( normal );\r\n\r\n\t\t\t// t < 0, no intersection\r\n\t\t\tif ( QdN < 0 ) {\r\n\r\n\t\t\t\treturn null;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Ray intersects triangle.\r\n\t\t\treturn this.at( QdN / DdN, optionalTarget );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tapplyMatrix4: function ( matrix4 ) {\r\n\r\n\t\tthis.direction.add( this.origin ).applyMatrix4( matrix4 );\r\n\t\tthis.origin.applyMatrix4( matrix4 );\r\n\t\tthis.direction.sub( this.origin );\r\n\t\tthis.direction.normalize();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tequals: function ( ray ) {\r\n\r\n\t\treturn ray.origin.equals( this.origin ) && ray.direction.equals( this.direction );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Sphere.js\r\n\r\n/**\r\n * @author bhouston / http://clara.io\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Sphere = function ( center, radius ) {\r\n\r\n\tthis.center = ( center !== undefined ) ? center : new THREE.Vector3();\r\n\tthis.radius = ( radius !== undefined ) ? radius : 0;\r\n\r\n};\r\n\r\nTHREE.Sphere.prototype = {\r\n\r\n\tconstructor: THREE.Sphere,\r\n\r\n\tset: function ( center, radius ) {\r\n\r\n\t\tthis.center.copy( center );\r\n\t\tthis.radius = radius;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromPoints: function () {\r\n\r\n\t\tvar box = new THREE.Box3();\r\n\r\n\t\treturn function ( points, optionalCenter ) {\r\n\r\n\t\t\tvar center = this.center;\r\n\r\n\t\t\tif ( optionalCenter !== undefined ) {\r\n\r\n\t\t\t\tcenter.copy( optionalCenter );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tbox.setFromPoints( points ).center( center );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar maxRadiusSq = 0;\r\n\r\n\t\t\tfor ( var i = 0, il = points.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tmaxRadiusSq = Math.max( maxRadiusSq, center.distanceToSquared( points[ i ] ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.radius = Math.sqrt( maxRadiusSq );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor().copy( this );\r\n\r\n\t},\r\n\r\n\tcopy: function ( sphere ) {\r\n\r\n\t\tthis.center.copy( sphere.center );\r\n\t\tthis.radius = sphere.radius;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tempty: function () {\r\n\r\n\t\treturn ( this.radius <= 0 );\r\n\r\n\t},\r\n\r\n\tcontainsPoint: function ( point ) {\r\n\r\n\t\treturn ( point.distanceToSquared( this.center ) <= ( this.radius * this.radius ) );\r\n\r\n\t},\r\n\r\n\tdistanceToPoint: function ( point ) {\r\n\r\n\t\treturn ( point.distanceTo( this.center ) - this.radius );\r\n\r\n\t},\r\n\r\n\tintersectsSphere: function ( sphere ) {\r\n\r\n\t\tvar radiusSum = this.radius + sphere.radius;\r\n\r\n\t\treturn sphere.center.distanceToSquared( this.center ) <= ( radiusSum * radiusSum );\r\n\r\n\t},\r\n\r\n\tintersectsBox: function ( box ) {\r\n\r\n\t\treturn box.intersectsSphere( this );\r\n\r\n\t},\r\n\r\n\tintersectsPlane: function ( plane ) {\r\n\r\n\t\t// We use the following equation to compute the signed distance from\r\n\t\t// the center of the sphere to the plane.\r\n\t\t//\r\n\t\t// distance = q * n - d\r\n\t\t//\r\n\t\t// If this distance is greater than the radius of the sphere,\r\n\t\t// then there is no intersection.\r\n\r\n\t\treturn Math.abs( this.center.dot( plane.normal ) - plane.constant ) <= this.radius;\r\n\r\n\t},\r\n\r\n\tclampPoint: function ( point, optionalTarget ) {\r\n\r\n\t\tvar deltaLengthSq = this.center.distanceToSquared( point );\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\r\n\t\tresult.copy( point );\r\n\r\n\t\tif ( deltaLengthSq > ( this.radius * this.radius ) ) {\r\n\r\n\t\t\tresult.sub( this.center ).normalize();\r\n\t\t\tresult.multiplyScalar( this.radius ).add( this.center );\r\n\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\r\n\t},\r\n\r\n\tgetBoundingBox: function ( optionalTarget ) {\r\n\r\n\t\tvar box = optionalTarget || new THREE.Box3();\r\n\r\n\t\tbox.set( this.center, this.center );\r\n\t\tbox.expandByScalar( this.radius );\r\n\r\n\t\treturn box;\r\n\r\n\t},\r\n\r\n\tapplyMatrix4: function ( matrix ) {\r\n\r\n\t\tthis.center.applyMatrix4( matrix );\r\n\t\tthis.radius = this.radius * matrix.getMaxScaleOnAxis();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\ttranslate: function ( offset ) {\r\n\r\n\t\tthis.center.add( offset );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tequals: function ( sphere ) {\r\n\r\n\t\treturn sphere.center.equals( this.center ) && ( sphere.radius === this.radius );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Frustum.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author bhouston / http://clara.io\r\n */\r\n\r\nTHREE.Frustum = function ( p0, p1, p2, p3, p4, p5 ) {\r\n\r\n\tthis.planes = [\r\n\r\n\t\t( p0 !== undefined ) ? p0 : new THREE.Plane(),\r\n\t\t( p1 !== undefined ) ? p1 : new THREE.Plane(),\r\n\t\t( p2 !== undefined ) ? p2 : new THREE.Plane(),\r\n\t\t( p3 !== undefined ) ? p3 : new THREE.Plane(),\r\n\t\t( p4 !== undefined ) ? p4 : new THREE.Plane(),\r\n\t\t( p5 !== undefined ) ? p5 : new THREE.Plane()\r\n\r\n\t];\r\n\r\n};\r\n\r\nTHREE.Frustum.prototype = {\r\n\r\n\tconstructor: THREE.Frustum,\r\n\r\n\tset: function ( p0, p1, p2, p3, p4, p5 ) {\r\n\r\n\t\tvar planes = this.planes;\r\n\r\n\t\tplanes[ 0 ].copy( p0 );\r\n\t\tplanes[ 1 ].copy( p1 );\r\n\t\tplanes[ 2 ].copy( p2 );\r\n\t\tplanes[ 3 ].copy( p3 );\r\n\t\tplanes[ 4 ].copy( p4 );\r\n\t\tplanes[ 5 ].copy( p5 );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor().copy( this );\r\n\r\n\t},\r\n\r\n\tcopy: function ( frustum ) {\r\n\r\n\t\tvar planes = this.planes;\r\n\r\n\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\r\n\t\t\tplanes[ i ].copy( frustum.planes[ i ] );\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromMatrix: function ( m ) {\r\n\r\n\t\tvar planes = this.planes;\r\n\t\tvar me = m.elements;\r\n\t\tvar me0 = me[ 0 ], me1 = me[ 1 ], me2 = me[ 2 ], me3 = me[ 3 ];\r\n\t\tvar me4 = me[ 4 ], me5 = me[ 5 ], me6 = me[ 6 ], me7 = me[ 7 ];\r\n\t\tvar me8 = me[ 8 ], me9 = me[ 9 ], me10 = me[ 10 ], me11 = me[ 11 ];\r\n\t\tvar me12 = me[ 12 ], me13 = me[ 13 ], me14 = me[ 14 ], me15 = me[ 15 ];\r\n\r\n\t\tplanes[ 0 ].setComponents( me3 - me0, me7 - me4, me11 - me8, me15 - me12 ).normalize();\r\n\t\tplanes[ 1 ].setComponents( me3 + me0, me7 + me4, me11 + me8, me15 + me12 ).normalize();\r\n\t\tplanes[ 2 ].setComponents( me3 + me1, me7 + me5, me11 + me9, me15 + me13 ).normalize();\r\n\t\tplanes[ 3 ].setComponents( me3 - me1, me7 - me5, me11 - me9, me15 - me13 ).normalize();\r\n\t\tplanes[ 4 ].setComponents( me3 - me2, me7 - me6, me11 - me10, me15 - me14 ).normalize();\r\n\t\tplanes[ 5 ].setComponents( me3 + me2, me7 + me6, me11 + me10, me15 + me14 ).normalize();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tintersectsObject: function () {\r\n\r\n\t\tvar sphere = new THREE.Sphere();\r\n\r\n\t\treturn function ( object ) {\r\n\r\n\t\t\tvar geometry = object.geometry;\r\n\r\n\t\t\tif ( geometry.boundingSphere === null )\r\n\t\t\t\tgeometry.computeBoundingSphere();\r\n\r\n\t\t\tsphere.copy( geometry.boundingSphere )\r\n\t\t\t\t.applyMatrix4( object.matrixWorld );\r\n\r\n\t\t\treturn this.intersectsSphere( sphere );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tintersectsSprite: function () {\r\n\r\n\t\tvar sphere = new THREE.Sphere();\r\n\r\n\t\treturn function ( sprite ) {\r\n\r\n\t\t\tsphere.center.set( 0, 0, 0 );\r\n\t\t\tsphere.radius = 0.7071067811865476;\r\n\t\t\tsphere.applyMatrix4( sprite.matrixWorld );\r\n\r\n\t\t\treturn this.intersectsSphere( sphere );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tintersectsSphere: function ( sphere ) {\r\n\r\n\t\tvar planes = this.planes;\r\n\t\tvar center = sphere.center;\r\n\t\tvar negRadius = - sphere.radius;\r\n\r\n\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\r\n\t\t\tvar distance = planes[ i ].distanceToPoint( center );\r\n\r\n\t\t\tif ( distance < negRadius ) {\r\n\r\n\t\t\t\treturn false;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\r\n\t},\r\n\r\n\tintersectsBox: function () {\r\n\r\n\t\tvar p1 = new THREE.Vector3(),\r\n\t\t\tp2 = new THREE.Vector3();\r\n\r\n\t\treturn function ( box ) {\r\n\r\n\t\t\tvar planes = this.planes;\r\n\r\n\t\t\tfor ( var i = 0; i < 6 ; i ++ ) {\r\n\r\n\t\t\t\tvar plane = planes[ i ];\r\n\r\n\t\t\t\tp1.x = plane.normal.x > 0 ? box.min.x : box.max.x;\r\n\t\t\t\tp2.x = plane.normal.x > 0 ? box.max.x : box.min.x;\r\n\t\t\t\tp1.y = plane.normal.y > 0 ? box.min.y : box.max.y;\r\n\t\t\t\tp2.y = plane.normal.y > 0 ? box.max.y : box.min.y;\r\n\t\t\t\tp1.z = plane.normal.z > 0 ? box.min.z : box.max.z;\r\n\t\t\t\tp2.z = plane.normal.z > 0 ? box.max.z : box.min.z;\r\n\r\n\t\t\t\tvar d1 = plane.distanceToPoint( p1 );\r\n\t\t\t\tvar d2 = plane.distanceToPoint( p2 );\r\n\r\n\t\t\t\t// if both outside plane, no intersection\r\n\r\n\t\t\t\tif ( d1 < 0 && d2 < 0 ) {\r\n\r\n\t\t\t\t\treturn false;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn true;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\r\n\tcontainsPoint: function ( point ) {\r\n\r\n\t\tvar planes = this.planes;\r\n\r\n\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\r\n\t\t\tif ( planes[ i ].distanceToPoint( point ) < 0 ) {\r\n\r\n\t\t\t\treturn false;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Plane.js\r\n\r\n/**\r\n * @author bhouston / http://clara.io\r\n */\r\n\r\nTHREE.Plane = function ( normal, constant ) {\r\n\r\n\tthis.normal = ( normal !== undefined ) ? normal : new THREE.Vector3( 1, 0, 0 );\r\n\tthis.constant = ( constant !== undefined ) ? constant : 0;\r\n\r\n};\r\n\r\nTHREE.Plane.prototype = {\r\n\r\n\tconstructor: THREE.Plane,\r\n\r\n\tset: function ( normal, constant ) {\r\n\r\n\t\tthis.normal.copy( normal );\r\n\t\tthis.constant = constant;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetComponents: function ( x, y, z, w ) {\r\n\r\n\t\tthis.normal.set( x, y, z );\r\n\t\tthis.constant = w;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromNormalAndCoplanarPoint: function ( normal, point ) {\r\n\r\n\t\tthis.normal.copy( normal );\r\n\t\tthis.constant = - point.dot( this.normal );\t// must be this.normal, not normal, as this.normal is normalized\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromCoplanarPoints: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3();\r\n\t\tvar v2 = new THREE.Vector3();\r\n\r\n\t\treturn function ( a, b, c ) {\r\n\r\n\t\t\tvar normal = v1.subVectors( c, b ).cross( v2.subVectors( a, b ) ).normalize();\r\n\r\n\t\t\t// Q: should an error be thrown if normal is zero (e.g. degenerate plane)?\r\n\r\n\t\t\tthis.setFromNormalAndCoplanarPoint( normal, a );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor().copy( this );\r\n\r\n\t},\r\n\r\n\tcopy: function ( plane ) {\r\n\r\n\t\tthis.normal.copy( plane.normal );\r\n\t\tthis.constant = plane.constant;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tnormalize: function () {\r\n\r\n\t\t// Note: will lead to a divide by zero if the plane is invalid.\r\n\r\n\t\tvar inverseNormalLength = 1.0 / this.normal.length();\r\n\t\tthis.normal.multiplyScalar( inverseNormalLength );\r\n\t\tthis.constant *= inverseNormalLength;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tnegate: function () {\r\n\r\n\t\tthis.constant *= - 1;\r\n\t\tthis.normal.negate();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdistanceToPoint: function ( point ) {\r\n\r\n\t\treturn this.normal.dot( point ) + this.constant;\r\n\r\n\t},\r\n\r\n\tdistanceToSphere: function ( sphere ) {\r\n\r\n\t\treturn this.distanceToPoint( sphere.center ) - sphere.radius;\r\n\r\n\t},\r\n\r\n\tprojectPoint: function ( point, optionalTarget ) {\r\n\r\n\t\treturn this.orthoPoint( point, optionalTarget ).sub( point ).negate();\r\n\r\n\t},\r\n\r\n\torthoPoint: function ( point, optionalTarget ) {\r\n\r\n\t\tvar perpendicularMagnitude = this.distanceToPoint( point );\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\treturn result.copy( this.normal ).multiplyScalar( perpendicularMagnitude );\r\n\r\n\t},\r\n\r\n\tintersectLine: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3();\r\n\r\n\t\treturn function ( line, optionalTarget ) {\r\n\r\n\t\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\r\n\t\t\tvar direction = line.delta( v1 );\r\n\r\n\t\t\tvar denominator = this.normal.dot( direction );\r\n\r\n\t\t\tif ( denominator === 0 ) {\r\n\r\n\t\t\t\t// line is coplanar, return origin\r\n\t\t\t\tif ( this.distanceToPoint( line.start ) === 0 ) {\r\n\r\n\t\t\t\t\treturn result.copy( line.start );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Unsure if this is the correct method to handle this case.\r\n\t\t\t\treturn undefined;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar t = - ( line.start.dot( this.normal ) + this.constant ) / denominator;\r\n\r\n\t\t\tif ( t < 0 || t > 1 ) {\r\n\r\n\t\t\t\treturn undefined;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn result.copy( direction ).multiplyScalar( t ).add( line.start );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tintersectsLine: function ( line ) {\r\n\r\n\t\t// Note: this tests if a line intersects the plane, not whether it (or its end-points) are coplanar with it.\r\n\r\n\t\tvar startSign = this.distanceToPoint( line.start );\r\n\t\tvar endSign = this.distanceToPoint( line.end );\r\n\r\n\t\treturn ( startSign < 0 && endSign > 0 ) || ( endSign < 0 && startSign > 0 );\r\n\r\n\t},\r\n\r\n\tintersectsBox: function ( box ) {\r\n\r\n\t\treturn box.intersectsPlane( this );\r\n\r\n\t},\r\n\r\n\tintersectsSphere: function ( sphere ) {\r\n\r\n\t\treturn sphere.intersectsPlane( this );\r\n\r\n\t},\r\n\r\n\tcoplanarPoint: function ( optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\treturn result.copy( this.normal ).multiplyScalar( - this.constant );\r\n\r\n\t},\r\n\r\n\tapplyMatrix4: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3();\r\n\t\tvar m1 = new THREE.Matrix3();\r\n\r\n\t\treturn function ( matrix, optionalNormalMatrix ) {\r\n\r\n\t\t\tvar referencePoint = this.coplanarPoint( v1 ).applyMatrix4( matrix );\r\n\r\n\t\t\t// transform normal based on theory here:\r\n\t\t\t// http://www.songho.ca/opengl/gl_normaltransform.html\r\n\t\t\tvar normalMatrix = optionalNormalMatrix || m1.getNormalMatrix( matrix );\r\n\t\t\tvar normal = this.normal.applyMatrix3( normalMatrix ).normalize();\r\n\r\n\t\t\t// recalculate constant (like in setFromNormalAndCoplanarPoint)\r\n\t\t\tthis.constant = - referencePoint.dot( normal );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\ttranslate: function ( offset ) {\r\n\r\n\t\tthis.constant = this.constant - offset.dot( this.normal );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tequals: function ( plane ) {\r\n\r\n\t\treturn plane.normal.equals( this.normal ) && ( plane.constant === this.constant );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Spherical.js\r\n\r\n/**\r\n * @author bhouston / http://clara.io\r\n * @author WestLangley / http://github.com/WestLangley\r\n *\r\n * Ref: https://en.wikipedia.org/wiki/Spherical_coordinate_system\r\n *\r\n * The poles (phi) are at the positive and negative y axis.\r\n * The equator starts at positive z.\r\n */\r\n\r\nTHREE.Spherical = function ( radius, phi, theta ) {\r\n\r\n\tthis.radius = ( radius !== undefined ) ? radius : 1.0;\r\n\tthis.phi = ( phi !== undefined ) ? phi : 0; // up / down towards top and bottom pole\r\n\tthis.theta = ( theta !== undefined ) ? theta : 0; // around the equator of the sphere\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nTHREE.Spherical.prototype = {\r\n\r\n\tconstructor: THREE.Spherical,\r\n\r\n\tset: function ( radius, phi, theta ) {\r\n\r\n\t\tthis.radius = radius;\r\n\t\tthis.phi = phi;\r\n\t\tthis.theta = theta;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor().copy( this );\r\n\r\n\t},\r\n\r\n\tcopy: function ( other ) {\r\n\r\n\t\tthis.radius.copy( other.radius );\r\n\t\tthis.phi.copy( other.phi );\r\n\t\tthis.theta.copy( other.theta );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\t// restrict phi to be betwee EPS and PI-EPS\r\n\tmakeSafe: function() {\r\n\r\n\t\tvar EPS = 0.000001;\r\n\t\tthis.phi = Math.max( EPS, Math.min( Math.PI - EPS, this.phi ) );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromVector3: function( vec3 ) {\r\n\r\n\t\tthis.radius = vec3.length();\r\n\r\n\t\tif ( this.radius === 0 ) {\r\n\r\n\t\t\tthis.theta = 0;\r\n\t\t\tthis.phi = 0;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.theta = Math.atan2( vec3.x, vec3.z ); // equator angle around y-up axis\r\n\t\t\tthis.phi = Math.acos( THREE.Math.clamp( vec3.y / this.radius, - 1, 1 ) ); // polar angle\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n};\r\n\r\n// File:src/math/Math.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Math = {\r\n\r\n\tDEG2RAD: Math.PI / 180,\r\n\tRAD2DEG: 180 / Math.PI,\r\n\r\n\tgenerateUUID: function () {\r\n\r\n\t\t// http://www.broofa.com/Tools/Math.uuid.htm\r\n\r\n\t\tvar chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'.split( '' );\r\n\t\tvar uuid = new Array( 36 );\r\n\t\tvar rnd = 0, r;\r\n\r\n\t\treturn function () {\r\n\r\n\t\t\tfor ( var i = 0; i < 36; i ++ ) {\r\n\r\n\t\t\t\tif ( i === 8 || i === 13 || i === 18 || i === 23 ) {\r\n\r\n\t\t\t\t\tuuid[ i ] = '-';\r\n\r\n\t\t\t\t} else if ( i === 14 ) {\r\n\r\n\t\t\t\t\tuuid[ i ] = '4';\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tif ( rnd <= 0x02 ) rnd = 0x2000000 + ( Math.random() * 0x1000000 ) | 0;\r\n\t\t\t\t\tr = rnd & 0xf;\r\n\t\t\t\t\trnd = rnd >> 4;\r\n\t\t\t\t\tuuid[ i ] = chars[ ( i === 19 ) ? ( r & 0x3 ) | 0x8 : r ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn uuid.join( '' );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tclamp: function ( value, min, max ) {\r\n\r\n\t\treturn Math.max( min, Math.min( max, value ) );\r\n\r\n\t},\r\n\r\n\t// compute euclidian modulo of m % n\r\n\t// https://en.wikipedia.org/wiki/Modulo_operation\r\n\r\n\teuclideanModulo: function ( n, m ) {\r\n\r\n\t\treturn ( ( n % m ) + m ) % m;\r\n\r\n\t},\r\n\r\n\t// Linear mapping from range <a1, a2> to range <b1, b2>\r\n\r\n\tmapLinear: function ( x, a1, a2, b1, b2 ) {\r\n\r\n\t\treturn b1 + ( x - a1 ) * ( b2 - b1 ) / ( a2 - a1 );\r\n\r\n\t},\r\n\r\n\t// http://en.wikipedia.org/wiki/Smoothstep\r\n\r\n\tsmoothstep: function ( x, min, max ) {\r\n\r\n\t\tif ( x <= min ) return 0;\r\n\t\tif ( x >= max ) return 1;\r\n\r\n\t\tx = ( x - min ) / ( max - min );\r\n\r\n\t\treturn x * x * ( 3 - 2 * x );\r\n\r\n\t},\r\n\r\n\tsmootherstep: function ( x, min, max ) {\r\n\r\n\t\tif ( x <= min ) return 0;\r\n\t\tif ( x >= max ) return 1;\r\n\r\n\t\tx = ( x - min ) / ( max - min );\r\n\r\n\t\treturn x * x * x * ( x * ( x * 6 - 15 ) + 10 );\r\n\r\n\t},\r\n\r\n\trandom16: function () {\r\n\r\n\t\tconsole.warn( 'THREE.Math.random16() has been deprecated. Use Math.random() instead.' );\r\n\t\treturn Math.random();\r\n\r\n\t},\r\n\r\n\t// Random integer from <low, high> interval\r\n\r\n\trandInt: function ( low, high ) {\r\n\r\n\t\treturn low + Math.floor( Math.random() * ( high - low + 1 ) );\r\n\r\n\t},\r\n\r\n\t// Random float from <low, high> interval\r\n\r\n\trandFloat: function ( low, high ) {\r\n\r\n\t\treturn low + Math.random() * ( high - low );\r\n\r\n\t},\r\n\r\n\t// Random float from <-range/2, range/2> interval\r\n\r\n\trandFloatSpread: function ( range ) {\r\n\r\n\t\treturn range * ( 0.5 - Math.random() );\r\n\r\n\t},\r\n\r\n\tdegToRad: function ( degrees ) {\r\n\r\n\t\treturn degrees * THREE.Math.DEG2RAD;\r\n\r\n\t},\r\n\r\n\tradToDeg: function ( radians ) {\r\n\r\n\t\treturn radians * THREE.Math.RAD2DEG;\r\n\r\n\t},\r\n\r\n\tisPowerOfTwo: function ( value ) {\r\n\r\n\t\treturn ( value & ( value - 1 ) ) === 0 && value !== 0;\r\n\r\n\t},\r\n\r\n\tnearestPowerOfTwo: function ( value ) {\r\n\r\n\t\treturn Math.pow( 2, Math.round( Math.log( value ) / Math.LN2 ) );\r\n\r\n\t},\r\n\r\n\tnextPowerOfTwo: function ( value ) {\r\n\r\n\t\tvalue --;\r\n\t\tvalue |= value >> 1;\r\n\t\tvalue |= value >> 2;\r\n\t\tvalue |= value >> 4;\r\n\t\tvalue |= value >> 8;\r\n\t\tvalue |= value >> 16;\r\n\t\tvalue ++;\r\n\r\n\t\treturn value;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Spline.js\r\n\r\n/**\r\n * Spline from Tween.js, slightly optimized (and trashed)\r\n * http://sole.github.com/tween.js/examples/05_spline.html\r\n *\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Spline = function ( points ) {\r\n\r\n\tthis.points = points;\r\n\r\n\tvar c = [], v3 = { x: 0, y: 0, z: 0 },\r\n\tpoint, intPoint, weight, w2, w3,\r\n\tpa, pb, pc, pd;\r\n\r\n\tthis.initFromArray = function ( a ) {\r\n\r\n\t\tthis.points = [];\r\n\r\n\t\tfor ( var i = 0; i < a.length; i ++ ) {\r\n\r\n\t\t\tthis.points[ i ] = { x: a[ i ][ 0 ], y: a[ i ][ 1 ], z: a[ i ][ 2 ] };\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.getPoint = function ( k ) {\r\n\r\n\t\tpoint = ( this.points.length - 1 ) * k;\r\n\t\tintPoint = Math.floor( point );\r\n\t\tweight = point - intPoint;\r\n\r\n\t\tc[ 0 ] = intPoint === 0 ? intPoint : intPoint - 1;\r\n\t\tc[ 1 ] = intPoint;\r\n\t\tc[ 2 ] = intPoint  > this.points.length - 2 ? this.points.length - 1 : intPoint + 1;\r\n\t\tc[ 3 ] = intPoint  > this.points.length - 3 ? this.points.length - 1 : intPoint + 2;\r\n\r\n\t\tpa = this.points[ c[ 0 ] ];\r\n\t\tpb = this.points[ c[ 1 ] ];\r\n\t\tpc = this.points[ c[ 2 ] ];\r\n\t\tpd = this.points[ c[ 3 ] ];\r\n\r\n\t\tw2 = weight * weight;\r\n\t\tw3 = weight * w2;\r\n\r\n\t\tv3.x = interpolate( pa.x, pb.x, pc.x, pd.x, weight, w2, w3 );\r\n\t\tv3.y = interpolate( pa.y, pb.y, pc.y, pd.y, weight, w2, w3 );\r\n\t\tv3.z = interpolate( pa.z, pb.z, pc.z, pd.z, weight, w2, w3 );\r\n\r\n\t\treturn v3;\r\n\r\n\t};\r\n\r\n\tthis.getControlPointsArray = function () {\r\n\r\n\t\tvar i, p, l = this.points.length,\r\n\t\t\tcoords = [];\r\n\r\n\t\tfor ( i = 0; i < l; i ++ ) {\r\n\r\n\t\t\tp = this.points[ i ];\r\n\t\t\tcoords[ i ] = [ p.x, p.y, p.z ];\r\n\r\n\t\t}\r\n\r\n\t\treturn coords;\r\n\r\n\t};\r\n\r\n\t// approximate length by summing linear segments\r\n\r\n\tthis.getLength = function ( nSubDivisions ) {\r\n\r\n\t\tvar i, index, nSamples, position,\r\n\t\t\tpoint = 0, intPoint = 0, oldIntPoint = 0,\r\n\t\t\toldPosition = new THREE.Vector3(),\r\n\t\t\ttmpVec = new THREE.Vector3(),\r\n\t\t\tchunkLengths = [],\r\n\t\t\ttotalLength = 0;\r\n\r\n\t\t// first point has 0 length\r\n\r\n\t\tchunkLengths[ 0 ] = 0;\r\n\r\n\t\tif ( ! nSubDivisions ) nSubDivisions = 100;\r\n\r\n\t\tnSamples = this.points.length * nSubDivisions;\r\n\r\n\t\toldPosition.copy( this.points[ 0 ] );\r\n\r\n\t\tfor ( i = 1; i < nSamples; i ++ ) {\r\n\r\n\t\t\tindex = i / nSamples;\r\n\r\n\t\t\tposition = this.getPoint( index );\r\n\t\t\ttmpVec.copy( position );\r\n\r\n\t\t\ttotalLength += tmpVec.distanceTo( oldPosition );\r\n\r\n\t\t\toldPosition.copy( position );\r\n\r\n\t\t\tpoint = ( this.points.length - 1 ) * index;\r\n\t\t\tintPoint = Math.floor( point );\r\n\r\n\t\t\tif ( intPoint !== oldIntPoint ) {\r\n\r\n\t\t\t\tchunkLengths[ intPoint ] = totalLength;\r\n\t\t\t\toldIntPoint = intPoint;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// last point ends with total length\r\n\r\n\t\tchunkLengths[ chunkLengths.length ] = totalLength;\r\n\r\n\t\treturn { chunks: chunkLengths, total: totalLength };\r\n\r\n\t};\r\n\r\n\tthis.reparametrizeByArcLength = function ( samplingCoef ) {\r\n\r\n\t\tvar i, j,\r\n\t\t\tindex, indexCurrent, indexNext,\r\n\t\t\trealDistance,\r\n\t\t\tsampling, position,\r\n\t\t\tnewpoints = [],\r\n\t\t\ttmpVec = new THREE.Vector3(),\r\n\t\t\tsl = this.getLength();\r\n\r\n\t\tnewpoints.push( tmpVec.copy( this.points[ 0 ] ).clone() );\r\n\r\n\t\tfor ( i = 1; i < this.points.length; i ++ ) {\r\n\r\n\t\t\t//tmpVec.copy( this.points[ i - 1 ] );\r\n\t\t\t//linearDistance = tmpVec.distanceTo( this.points[ i ] );\r\n\r\n\t\t\trealDistance = sl.chunks[ i ] - sl.chunks[ i - 1 ];\r\n\r\n\t\t\tsampling = Math.ceil( samplingCoef * realDistance / sl.total );\r\n\r\n\t\t\tindexCurrent = ( i - 1 ) / ( this.points.length - 1 );\r\n\t\t\tindexNext = i / ( this.points.length - 1 );\r\n\r\n\t\t\tfor ( j = 1; j < sampling - 1; j ++ ) {\r\n\r\n\t\t\t\tindex = indexCurrent + j * ( 1 / sampling ) * ( indexNext - indexCurrent );\r\n\r\n\t\t\t\tposition = this.getPoint( index );\r\n\t\t\t\tnewpoints.push( tmpVec.copy( position ).clone() );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tnewpoints.push( tmpVec.copy( this.points[ i ] ).clone() );\r\n\r\n\t\t}\r\n\r\n\t\tthis.points = newpoints;\r\n\r\n\t};\r\n\r\n\t// Catmull-Rom\r\n\r\n\tfunction interpolate( p0, p1, p2, p3, t, t2, t3 ) {\r\n\r\n\t\tvar v0 = ( p2 - p0 ) * 0.5,\r\n\t\t\tv1 = ( p3 - p1 ) * 0.5;\r\n\r\n\t\treturn ( 2 * ( p1 - p2 ) + v0 + v1 ) * t3 + ( - 3 * ( p1 - p2 ) - 2 * v0 - v1 ) * t2 + v0 * t + p1;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Triangle.js\r\n\r\n/**\r\n * @author bhouston / http://clara.io\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Triangle = function ( a, b, c ) {\r\n\r\n\tthis.a = ( a !== undefined ) ? a : new THREE.Vector3();\r\n\tthis.b = ( b !== undefined ) ? b : new THREE.Vector3();\r\n\tthis.c = ( c !== undefined ) ? c : new THREE.Vector3();\r\n\r\n};\r\n\r\nTHREE.Triangle.normal = function () {\r\n\r\n\tvar v0 = new THREE.Vector3();\r\n\r\n\treturn function ( a, b, c, optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\r\n\t\tresult.subVectors( c, b );\r\n\t\tv0.subVectors( a, b );\r\n\t\tresult.cross( v0 );\r\n\r\n\t\tvar resultLengthSq = result.lengthSq();\r\n\t\tif ( resultLengthSq > 0 ) {\r\n\r\n\t\t\treturn result.multiplyScalar( 1 / Math.sqrt( resultLengthSq ) );\r\n\r\n\t\t}\r\n\r\n\t\treturn result.set( 0, 0, 0 );\r\n\r\n\t};\r\n\r\n}();\r\n\r\n// static/instance method to calculate barycentric coordinates\r\n// based on: http://www.blackpawn.com/texts/pointinpoly/default.html\r\nTHREE.Triangle.barycoordFromPoint = function () {\r\n\r\n\tvar v0 = new THREE.Vector3();\r\n\tvar v1 = new THREE.Vector3();\r\n\tvar v2 = new THREE.Vector3();\r\n\r\n\treturn function ( point, a, b, c, optionalTarget ) {\r\n\r\n\t\tv0.subVectors( c, a );\r\n\t\tv1.subVectors( b, a );\r\n\t\tv2.subVectors( point, a );\r\n\r\n\t\tvar dot00 = v0.dot( v0 );\r\n\t\tvar dot01 = v0.dot( v1 );\r\n\t\tvar dot02 = v0.dot( v2 );\r\n\t\tvar dot11 = v1.dot( v1 );\r\n\t\tvar dot12 = v1.dot( v2 );\r\n\r\n\t\tvar denom = ( dot00 * dot11 - dot01 * dot01 );\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\r\n\t\t// collinear or singular triangle\r\n\t\tif ( denom === 0 ) {\r\n\r\n\t\t\t// arbitrary location outside of triangle?\r\n\t\t\t// not sure if this is the best idea, maybe should be returning undefined\r\n\t\t\treturn result.set( - 2, - 1, - 1 );\r\n\r\n\t\t}\r\n\r\n\t\tvar invDenom = 1 / denom;\r\n\t\tvar u = ( dot11 * dot02 - dot01 * dot12 ) * invDenom;\r\n\t\tvar v = ( dot00 * dot12 - dot01 * dot02 ) * invDenom;\r\n\r\n\t\t// barycentric coordinates must always sum to 1\r\n\t\treturn result.set( 1 - u - v, v, u );\r\n\r\n\t};\r\n\r\n}();\r\n\r\nTHREE.Triangle.containsPoint = function () {\r\n\r\n\tvar v1 = new THREE.Vector3();\r\n\r\n\treturn function ( point, a, b, c ) {\r\n\r\n\t\tvar result = THREE.Triangle.barycoordFromPoint( point, a, b, c, v1 );\r\n\r\n\t\treturn ( result.x >= 0 ) && ( result.y >= 0 ) && ( ( result.x + result.y ) <= 1 );\r\n\r\n\t};\r\n\r\n}();\r\n\r\nTHREE.Triangle.prototype = {\r\n\r\n\tconstructor: THREE.Triangle,\r\n\r\n\tset: function ( a, b, c ) {\r\n\r\n\t\tthis.a.copy( a );\r\n\t\tthis.b.copy( b );\r\n\t\tthis.c.copy( c );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetFromPointsAndIndices: function ( points, i0, i1, i2 ) {\r\n\r\n\t\tthis.a.copy( points[ i0 ] );\r\n\t\tthis.b.copy( points[ i1 ] );\r\n\t\tthis.c.copy( points[ i2 ] );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor().copy( this );\r\n\r\n\t},\r\n\r\n\tcopy: function ( triangle ) {\r\n\r\n\t\tthis.a.copy( triangle.a );\r\n\t\tthis.b.copy( triangle.b );\r\n\t\tthis.c.copy( triangle.c );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tarea: function () {\r\n\r\n\t\tvar v0 = new THREE.Vector3();\r\n\t\tvar v1 = new THREE.Vector3();\r\n\r\n\t\treturn function () {\r\n\r\n\t\t\tv0.subVectors( this.c, this.b );\r\n\t\t\tv1.subVectors( this.a, this.b );\r\n\r\n\t\t\treturn v0.cross( v1 ).length() * 0.5;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tmidpoint: function ( optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\treturn result.addVectors( this.a, this.b ).add( this.c ).multiplyScalar( 1 / 3 );\r\n\r\n\t},\r\n\r\n\tnormal: function ( optionalTarget ) {\r\n\r\n\t\treturn THREE.Triangle.normal( this.a, this.b, this.c, optionalTarget );\r\n\r\n\t},\r\n\r\n\tplane: function ( optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Plane();\r\n\r\n\t\treturn result.setFromCoplanarPoints( this.a, this.b, this.c );\r\n\r\n\t},\r\n\r\n\tbarycoordFromPoint: function ( point, optionalTarget ) {\r\n\r\n\t\treturn THREE.Triangle.barycoordFromPoint( point, this.a, this.b, this.c, optionalTarget );\r\n\r\n\t},\r\n\r\n\tcontainsPoint: function ( point ) {\r\n\r\n\t\treturn THREE.Triangle.containsPoint( point, this.a, this.b, this.c );\r\n\r\n\t},\r\n\r\n\tclosestPointToPoint: function () {\r\n\r\n\t\tvar plane, edgeList, projectedPoint, closestPoint;\r\n\r\n\t\treturn function closestPointToPoint( point, optionalTarget ) {\r\n\r\n\t\t\tif ( plane === undefined ) {\r\n\r\n\t\t\t\tplane = new THREE.Plane();\r\n\t\t\t\tedgeList = [ new THREE.Line3(), new THREE.Line3(), new THREE.Line3() ];\r\n\t\t\t\tprojectedPoint = new THREE.Vector3();\r\n\t\t\t\tclosestPoint = new THREE.Vector3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\t\t\tvar minDistance = Infinity;\r\n\r\n\t\t\t// project the point onto the plane of the triangle\r\n\r\n\t\t\tplane.setFromCoplanarPoints( this.a, this.b, this.c );\r\n\t\t\tplane.projectPoint( point, projectedPoint );\r\n\r\n\t\t\t// check if the projection lies within the triangle\r\n\r\n\t\t\tif( this.containsPoint( projectedPoint ) === true ) {\r\n\r\n\t\t\t\t// if so, this is the closest point\r\n\r\n\t\t\t\tresult.copy( projectedPoint );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// if not, the point falls outside the triangle. the result is the closest point to the triangle's edges or vertices\r\n\r\n\t\t\t\tedgeList[ 0 ].set( this.a, this.b );\r\n\t\t\t\tedgeList[ 1 ].set( this.b, this.c );\r\n\t\t\t\tedgeList[ 2 ].set( this.c, this.a );\r\n\r\n\t\t\t\tfor( var i = 0; i < edgeList.length; i ++ ) {\r\n\r\n\t\t\t\t\tedgeList[ i ].closestPointToPoint( projectedPoint, true, closestPoint );\r\n\r\n\t\t\t\t\tvar distance = projectedPoint.distanceToSquared( closestPoint );\r\n\r\n\t\t\t\t\tif( distance < minDistance ) {\r\n\r\n\t\t\t\t\t\tminDistance = distance;\r\n\r\n\t\t\t\t\t\tresult.copy( closestPoint );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn result;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tequals: function ( triangle ) {\r\n\r\n\t\treturn triangle.a.equals( this.a ) && triangle.b.equals( this.b ) && triangle.c.equals( this.c );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/math/Interpolant.js\r\n\r\n/**\r\n * Abstract base class of interpolants over parametric samples.\r\n *\r\n * The parameter domain is one dimensional, typically the time or a path\r\n * along a curve defined by the data.\r\n *\r\n * The sample values can have any dimensionality and derived classes may\r\n * apply special interpretations to the data.\r\n *\r\n * This class provides the interval seek in a Template Method, deferring\r\n * the actual interpolation to derived classes.\r\n *\r\n * Time complexity is O(1) for linear access crossing at most two points\r\n * and O(log N) for random access, where N is the number of positions.\r\n *\r\n * References:\r\n *\r\n * \t\thttp://www.oodesign.com/template-method-pattern.html\r\n *\r\n * @author tschw\r\n */\r\n\r\nTHREE.Interpolant = function(\r\n\t\tparameterPositions, sampleValues, sampleSize, resultBuffer ) {\r\n\r\n\tthis.parameterPositions = parameterPositions;\r\n\tthis._cachedIndex = 0;\r\n\r\n\tthis.resultBuffer = resultBuffer !== undefined ?\r\n\t\t\tresultBuffer : new sampleValues.constructor( sampleSize );\r\n\tthis.sampleValues = sampleValues;\r\n\tthis.valueSize = sampleSize;\r\n\r\n};\r\n\r\nTHREE.Interpolant.prototype = {\r\n\r\n\tconstructor: THREE.Interpolant,\r\n\r\n\tevaluate: function( t ) {\r\n\r\n\t\tvar pp = this.parameterPositions,\r\n\t\t\ti1 = this._cachedIndex,\r\n\r\n\t\t\tt1 = pp[   i1   ],\r\n\t\t\tt0 = pp[ i1 - 1 ];\r\n\r\n\t\tvalidate_interval: {\r\n\r\n\t\t\tseek: {\r\n\r\n\t\t\t\tvar right;\r\n\r\n\t\t\t\tlinear_scan: {\r\n//- See http://jsperf.com/comparison-to-undefined/3\r\n//- slower code:\r\n//-\r\n//- \t\t\t\tif ( t >= t1 || t1 === undefined ) {\r\n\t\t\t\t\tforward_scan: if ( ! ( t < t1 ) ) {\r\n\r\n\t\t\t\t\t\tfor ( var giveUpAt = i1 + 2; ;) {\r\n\r\n\t\t\t\t\t\t\tif ( t1 === undefined ) {\r\n\r\n\t\t\t\t\t\t\t\tif ( t < t0 ) break forward_scan;\r\n\r\n\t\t\t\t\t\t\t\t// after end\r\n\r\n\t\t\t\t\t\t\t\ti1 = pp.length;\r\n\t\t\t\t\t\t\t\tthis._cachedIndex = i1;\r\n\t\t\t\t\t\t\t\treturn this.afterEnd_( i1 - 1, t, t0 );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif ( i1 === giveUpAt ) break; // this loop\r\n\r\n\t\t\t\t\t\t\tt0 = t1;\r\n\t\t\t\t\t\t\tt1 = pp[ ++ i1 ];\r\n\r\n\t\t\t\t\t\t\tif ( t < t1 ) {\r\n\r\n\t\t\t\t\t\t\t\t// we have arrived at the sought interval\r\n\t\t\t\t\t\t\t\tbreak seek;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// prepare binary search on the right side of the index\r\n\t\t\t\t\t\tright = pp.length;\r\n\t\t\t\t\t\tbreak linear_scan;\r\n\r\n\t\t\t\t\t}\r\n\r\n//- slower code:\r\n//-\t\t\t\t\tif ( t < t0 || t0 === undefined ) {\r\n\t\t\t\t\tif ( ! ( t >= t0 ) ) {\r\n\r\n\t\t\t\t\t\t// looping?\r\n\r\n\t\t\t\t\t\tvar t1global = pp[ 1 ];\r\n\r\n\t\t\t\t\t\tif ( t < t1global ) {\r\n\r\n\t\t\t\t\t\t\ti1 = 2; // + 1, using the scan for the details\r\n\t\t\t\t\t\t\tt0 = t1global;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// linear reverse scan\r\n\r\n\t\t\t\t\t\tfor ( var giveUpAt = i1 - 2; ;) {\r\n\r\n\t\t\t\t\t\t\tif ( t0 === undefined ) {\r\n\r\n\t\t\t\t\t\t\t\t// before start\r\n\r\n\t\t\t\t\t\t\t\tthis._cachedIndex = 0;\r\n\t\t\t\t\t\t\t\treturn this.beforeStart_( 0, t, t1 );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif ( i1 === giveUpAt ) break; // this loop\r\n\r\n\t\t\t\t\t\t\tt1 = t0;\r\n\t\t\t\t\t\t\tt0 = pp[ -- i1 - 1 ];\r\n\r\n\t\t\t\t\t\t\tif ( t >= t0 ) {\r\n\r\n\t\t\t\t\t\t\t\t// we have arrived at the sought interval\r\n\t\t\t\t\t\t\t\tbreak seek;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// prepare binary search on the left side of the index\r\n\t\t\t\t\t\tright = i1;\r\n\t\t\t\t\t\ti1 = 0;\r\n\t\t\t\t\t\tbreak linear_scan;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// the interval is valid\r\n\r\n\t\t\t\t\tbreak validate_interval;\r\n\r\n\t\t\t\t} // linear scan\r\n\r\n\t\t\t\t// binary search\r\n\r\n\t\t\t\twhile ( i1 < right ) {\r\n\r\n\t\t\t\t\tvar mid = ( i1 + right ) >>> 1;\r\n\r\n\t\t\t\t\tif ( t < pp[ mid ] ) {\r\n\r\n\t\t\t\t\t\tright = mid;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\ti1 = mid + 1;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tt1 = pp[   i1   ];\r\n\t\t\t\tt0 = pp[ i1 - 1 ];\r\n\r\n\t\t\t\t// check boundary cases, again\r\n\r\n\t\t\t\tif ( t0 === undefined ) {\r\n\r\n\t\t\t\t\tthis._cachedIndex = 0;\r\n\t\t\t\t\treturn this.beforeStart_( 0, t, t1 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( t1 === undefined ) {\r\n\r\n\t\t\t\t\ti1 = pp.length;\r\n\t\t\t\t\tthis._cachedIndex = i1;\r\n\t\t\t\t\treturn this.afterEnd_( i1 - 1, t0, t );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} // seek\r\n\r\n\t\t\tthis._cachedIndex = i1;\r\n\r\n\t\t\tthis.intervalChanged_( i1, t0, t1 );\r\n\r\n\t\t} // validate_interval\r\n\r\n\t\treturn this.interpolate_( i1, t0, t, t1 );\r\n\r\n\t},\r\n\r\n\tsettings: null, // optional, subclass-specific settings structure\r\n\t// Note: The indirection allows central control of many interpolants.\r\n\r\n\t// --- Protected interface\r\n\r\n\tDefaultSettings_: {},\r\n\r\n\tgetSettings_: function() {\r\n\r\n\t\treturn this.settings || this.DefaultSettings_;\r\n\r\n\t},\r\n\r\n\tcopySampleValue_: function( index ) {\r\n\r\n\t\t// copies a sample value to the result buffer\r\n\r\n\t\tvar result = this.resultBuffer,\r\n\t\t\tvalues = this.sampleValues,\r\n\t\t\tstride = this.valueSize,\r\n\t\t\toffset = index * stride;\r\n\r\n\t\tfor ( var i = 0; i !== stride; ++ i ) {\r\n\r\n\t\t\tresult[ i ] = values[ offset + i ];\r\n\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\r\n\t},\r\n\r\n\t// Template methods for derived classes:\r\n\r\n\tinterpolate_: function( i1, t0, t, t1 ) {\r\n\r\n\t\tthrow new Error( \"call to abstract method\" );\r\n\t\t// implementations shall return this.resultBuffer\r\n\r\n\t},\r\n\r\n\tintervalChanged_: function( i1, t0, t1 ) {\r\n\r\n\t\t// empty\r\n\r\n\t}\r\n\r\n};\r\n\r\nObject.assign( THREE.Interpolant.prototype, {\r\n\r\n\tbeforeStart_: //( 0, t, t0 ), returns this.resultBuffer\r\n\t\tTHREE.Interpolant.prototype.copySampleValue_,\r\n\r\n\tafterEnd_: //( N-1, tN-1, t ), returns this.resultBuffer\r\n\t\tTHREE.Interpolant.prototype.copySampleValue_\r\n\r\n} );\r\n\r\n// File:src/math/interpolants/CubicInterpolant.js\r\n\r\n/**\r\n * Fast and simple cubic spline interpolant.\r\n *\r\n * It was derived from a Hermitian construction setting the first derivative\r\n * at each sample position to the linear slope between neighboring positions\r\n * over their parameter interval.\r\n *\r\n * @author tschw\r\n */\r\n\r\nTHREE.CubicInterpolant = function(\r\n\t\tparameterPositions, sampleValues, sampleSize, resultBuffer ) {\r\n\r\n\tTHREE.Interpolant.call(\r\n\t\t\tthis, parameterPositions, sampleValues, sampleSize, resultBuffer );\r\n\r\n\tthis._weightPrev = -0;\r\n\tthis._offsetPrev = -0;\r\n\tthis._weightNext = -0;\r\n\tthis._offsetNext = -0;\r\n\r\n};\r\n\r\nTHREE.CubicInterpolant.prototype =\r\n\t\tObject.assign( Object.create( THREE.Interpolant.prototype ), {\r\n\r\n\tconstructor: THREE.CubicInterpolant,\r\n\r\n\tDefaultSettings_: {\r\n\r\n\t\tendingStart: \tTHREE.ZeroCurvatureEnding,\r\n\t\tendingEnd:\t\tTHREE.ZeroCurvatureEnding\r\n\r\n\t},\r\n\r\n\tintervalChanged_: function( i1, t0, t1 ) {\r\n\r\n\t\tvar pp = this.parameterPositions,\r\n\t\t\tiPrev = i1 - 2,\r\n\t\t\tiNext = i1 + 1,\r\n\r\n\t\t\ttPrev = pp[ iPrev ],\r\n\t\t\ttNext = pp[ iNext ];\r\n\r\n\t\tif ( tPrev === undefined ) {\r\n\r\n\t\t\tswitch ( this.getSettings_().endingStart ) {\r\n\r\n\t\t\t\tcase THREE.ZeroSlopeEnding:\r\n\r\n\t\t\t\t\t// f'(t0) = 0\r\n\t\t\t\t\tiPrev = i1;\r\n\t\t\t\t\ttPrev = 2 * t0 - t1;\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase THREE.WrapAroundEnding:\r\n\r\n\t\t\t\t\t// use the other end of the curve\r\n\t\t\t\t\tiPrev = pp.length - 2;\r\n\t\t\t\t\ttPrev = t0 + pp[ iPrev ] - pp[ iPrev + 1 ];\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault: // ZeroCurvatureEnding\r\n\r\n\t\t\t\t\t// f''(t0) = 0 a.k.a. Natural Spline\r\n\t\t\t\t\tiPrev = i1;\r\n\t\t\t\t\ttPrev = t1;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( tNext === undefined ) {\r\n\r\n\t\t\tswitch ( this.getSettings_().endingEnd ) {\r\n\r\n\t\t\t\tcase THREE.ZeroSlopeEnding:\r\n\r\n\t\t\t\t\t// f'(tN) = 0\r\n\t\t\t\t\tiNext = i1;\r\n\t\t\t\t\ttNext = 2 * t1 - t0;\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase THREE.WrapAroundEnding:\r\n\r\n\t\t\t\t\t// use the other end of the curve\r\n\t\t\t\t\tiNext = 1;\r\n\t\t\t\t\ttNext = t1 + pp[ 1 ] - pp[ 0 ];\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault: // ZeroCurvatureEnding\r\n\r\n\t\t\t\t\t// f''(tN) = 0, a.k.a. Natural Spline\r\n\t\t\t\t\tiNext = i1 - 1;\r\n\t\t\t\t\ttNext = t0;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar halfDt = ( t1 - t0 ) * 0.5,\r\n\t\t\tstride = this.valueSize;\r\n\r\n\t\tthis._weightPrev = halfDt / ( t0 - tPrev );\r\n\t\tthis._weightNext = halfDt / ( tNext - t1 );\r\n\t\tthis._offsetPrev = iPrev * stride;\r\n\t\tthis._offsetNext = iNext * stride;\r\n\r\n\t},\r\n\r\n\tinterpolate_: function( i1, t0, t, t1 ) {\r\n\r\n\t\tvar result = this.resultBuffer,\r\n\t\t\tvalues = this.sampleValues,\r\n\t\t\tstride = this.valueSize,\r\n\r\n\t\t\to1 = i1 * stride,\t\to0 = o1 - stride,\r\n\t\t\toP = this._offsetPrev, \toN = this._offsetNext,\r\n\t\t\twP = this._weightPrev,\twN = this._weightNext,\r\n\r\n\t\t\tp = ( t - t0 ) / ( t1 - t0 ),\r\n\t\t\tpp = p * p,\r\n\t\t\tppp = pp * p;\r\n\r\n\t\t// evaluate polynomials\r\n\r\n\t\tvar sP =     - wP   * ppp   +         2 * wP    * pp    -          wP   * p;\r\n\t\tvar s0 = ( 1 + wP ) * ppp   + (-1.5 - 2 * wP )  * pp    + ( -0.5 + wP ) * p     + 1;\r\n\t\tvar s1 = (-1 - wN ) * ppp   + ( 1.5 +   wN   )  * pp    +    0.5        * p;\r\n\t\tvar sN =       wN   * ppp   -           wN      * pp;\r\n\r\n\t\t// combine data linearly\r\n\r\n\t\tfor ( var i = 0; i !== stride; ++ i ) {\r\n\r\n\t\t\tresult[ i ] =\r\n\t\t\t\t\tsP * values[ oP + i ] +\r\n\t\t\t\t\ts0 * values[ o0 + i ] +\r\n\t\t\t\t\ts1 * values[ o1 + i ] +\r\n\t\t\t\t\tsN * values[ oN + i ];\r\n\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\r\n\t}\r\n\r\n} );\r\n\r\n// File:src/math/interpolants/DiscreteInterpolant.js\r\n\r\n/**\r\n *\r\n * Interpolant that evaluates to the sample value at the position preceeding\r\n * the parameter.\r\n *\r\n * @author tschw\r\n */\r\n\r\nTHREE.DiscreteInterpolant = function(\r\n\t\tparameterPositions, sampleValues, sampleSize, resultBuffer ) {\r\n\r\n\tTHREE.Interpolant.call(\r\n\t\t\tthis, parameterPositions, sampleValues, sampleSize, resultBuffer );\r\n\r\n};\r\n\r\nTHREE.DiscreteInterpolant.prototype =\r\n\t\tObject.assign( Object.create( THREE.Interpolant.prototype ), {\r\n\r\n\tconstructor: THREE.DiscreteInterpolant,\r\n\r\n\tinterpolate_: function( i1, t0, t, t1 ) {\r\n\r\n\t\treturn this.copySampleValue_( i1 - 1 );\r\n\r\n\t}\r\n\r\n} );\r\n\r\n// File:src/math/interpolants/LinearInterpolant.js\r\n\r\n/**\r\n * @author tschw\r\n */\r\n\r\nTHREE.LinearInterpolant = function(\r\n\t\tparameterPositions, sampleValues, sampleSize, resultBuffer ) {\r\n\r\n\tTHREE.Interpolant.call(\r\n\t\t\tthis, parameterPositions, sampleValues, sampleSize, resultBuffer );\r\n\r\n};\r\n\r\nTHREE.LinearInterpolant.prototype =\r\n\t\tObject.assign( Object.create( THREE.Interpolant.prototype ), {\r\n\r\n\tconstructor: THREE.LinearInterpolant,\r\n\r\n\tinterpolate_: function( i1, t0, t, t1 ) {\r\n\r\n\t\tvar result = this.resultBuffer,\r\n\t\t\tvalues = this.sampleValues,\r\n\t\t\tstride = this.valueSize,\r\n\r\n\t\t\toffset1 = i1 * stride,\r\n\t\t\toffset0 = offset1 - stride,\r\n\r\n\t\t\tweight1 = ( t - t0 ) / ( t1 - t0 ),\r\n\t\t\tweight0 = 1 - weight1;\r\n\r\n\t\tfor ( var i = 0; i !== stride; ++ i ) {\r\n\r\n\t\t\tresult[ i ] =\r\n\t\t\t\t\tvalues[ offset0 + i ] * weight0 +\r\n\t\t\t\t\tvalues[ offset1 + i ] * weight1;\r\n\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\r\n\t}\r\n\r\n} );\r\n\r\n// File:src/math/interpolants/QuaternionLinearInterpolant.js\r\n\r\n/**\r\n * Spherical linear unit quaternion interpolant.\r\n *\r\n * @author tschw\r\n */\r\n\r\nTHREE.QuaternionLinearInterpolant = function(\r\n\t\tparameterPositions, sampleValues, sampleSize, resultBuffer ) {\r\n\r\n\tTHREE.Interpolant.call(\r\n\t\t\tthis, parameterPositions, sampleValues, sampleSize, resultBuffer );\r\n\r\n};\r\n\r\nTHREE.QuaternionLinearInterpolant.prototype =\r\n\t\tObject.assign( Object.create( THREE.Interpolant.prototype ), {\r\n\r\n\tconstructor: THREE.QuaternionLinearInterpolant,\r\n\r\n\tinterpolate_: function( i1, t0, t, t1 ) {\r\n\r\n\t\tvar result = this.resultBuffer,\r\n\t\t\tvalues = this.sampleValues,\r\n\t\t\tstride = this.valueSize,\r\n\r\n\t\t\toffset = i1 * stride,\r\n\r\n\t\t\talpha = ( t - t0 ) / ( t1 - t0 );\r\n\r\n\t\tfor ( var end = offset + stride; offset !== end; offset += 4 ) {\r\n\r\n\t\t\tTHREE.Quaternion.slerpFlat( result, 0,\r\n\t\t\t\t\tvalues, offset - stride, values, offset, alpha );\r\n\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\r\n\t}\r\n\r\n} );\r\n\r\n// File:src/core/Clock.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Clock = function ( autoStart ) {\r\n\r\n\tthis.autoStart = ( autoStart !== undefined ) ? autoStart : true;\r\n\r\n\tthis.startTime = 0;\r\n\tthis.oldTime = 0;\r\n\tthis.elapsedTime = 0;\r\n\r\n\tthis.running = false;\r\n\r\n};\r\n\r\nTHREE.Clock.prototype = {\r\n\r\n\tconstructor: THREE.Clock,\r\n\r\n\tstart: function () {\r\n\r\n\t\tthis.startTime = ( performance || Date ).now();\r\n\r\n\t\tthis.oldTime = this.startTime;\r\n\t\tthis.running = true;\r\n\r\n\t},\r\n\r\n\tstop: function () {\r\n\r\n\t\tthis.getElapsedTime();\r\n\t\tthis.running = false;\r\n\r\n\t},\r\n\r\n\tgetElapsedTime: function () {\r\n\r\n\t\tthis.getDelta();\r\n\t\treturn this.elapsedTime;\r\n\r\n\t},\r\n\r\n\tgetDelta: function () {\r\n\r\n\t\tvar diff = 0;\r\n\r\n\t\tif ( this.autoStart && ! this.running ) {\r\n\r\n\t\t\tthis.start();\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.running ) {\r\n\r\n\t\t\tvar newTime = ( performance || Date ).now();\r\n\r\n\t\t\tdiff = ( newTime - this.oldTime ) / 1000;\r\n\t\t\tthis.oldTime = newTime;\r\n\r\n\t\t\tthis.elapsedTime += diff;\r\n\r\n\t\t}\r\n\r\n\t\treturn diff;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/core/EventDispatcher.js\r\n\r\n/**\r\n * https://github.com/mrdoob/eventdispatcher.js/\r\n */\r\n\r\nTHREE.EventDispatcher = function () {};\r\n\r\nObject.assign( THREE.EventDispatcher.prototype, {\r\n\r\n\taddEventListener: function ( type, listener ) {\r\n\r\n\t\tif ( this._listeners === undefined ) this._listeners = {};\r\n\r\n\t\tvar listeners = this._listeners;\r\n\r\n\t\tif ( listeners[ type ] === undefined ) {\r\n\r\n\t\t\tlisteners[ type ] = [];\r\n\r\n\t\t}\r\n\r\n\t\tif ( listeners[ type ].indexOf( listener ) === - 1 ) {\r\n\r\n\t\t\tlisteners[ type ].push( listener );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\thasEventListener: function ( type, listener ) {\r\n\r\n\t\tif ( this._listeners === undefined ) return false;\r\n\r\n\t\tvar listeners = this._listeners;\r\n\r\n\t\tif ( listeners[ type ] !== undefined && listeners[ type ].indexOf( listener ) !== - 1 ) {\r\n\r\n\t\t\treturn true;\r\n\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\r\n\t},\r\n\r\n\tremoveEventListener: function ( type, listener ) {\r\n\r\n\t\tif ( this._listeners === undefined ) return;\r\n\r\n\t\tvar listeners = this._listeners;\r\n\t\tvar listenerArray = listeners[ type ];\r\n\r\n\t\tif ( listenerArray !== undefined ) {\r\n\r\n\t\t\tvar index = listenerArray.indexOf( listener );\r\n\r\n\t\t\tif ( index !== - 1 ) {\r\n\r\n\t\t\t\tlistenerArray.splice( index, 1 );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tdispatchEvent: function ( event ) {\r\n\r\n\t\tif ( this._listeners === undefined ) return;\r\n\r\n\t\tvar listeners = this._listeners;\r\n\t\tvar listenerArray = listeners[ event.type ];\r\n\r\n\t\tif ( listenerArray !== undefined ) {\r\n\r\n\t\t\tevent.target = this;\r\n\r\n\t\t\tvar array = [], i = 0;\r\n\t\t\tvar length = listenerArray.length;\r\n\r\n\t\t\tfor ( i = 0; i < length; i ++ ) {\r\n\r\n\t\t\t\tarray[ i ] = listenerArray[ i ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( i = 0; i < length; i ++ ) {\r\n\r\n\t\t\t\tarray[ i ].call( this, event );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n} );\r\n\r\n// File:src/core/Layers.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Layers = function () {\r\n\r\n\tthis.mask = 1;\r\n\r\n};\r\n\r\nTHREE.Layers.prototype = {\r\n\r\n\tconstructor: THREE.Layers,\r\n\r\n\tset: function ( channel ) {\r\n\r\n\t\tthis.mask = 1 << channel;\r\n\r\n\t},\r\n\r\n\tenable: function ( channel ) {\r\n\r\n\t\tthis.mask |= 1 << channel;\r\n\r\n\t},\r\n\r\n\ttoggle: function ( channel ) {\r\n\r\n\t\tthis.mask ^= 1 << channel;\r\n\r\n\t},\r\n\r\n\tdisable: function ( channel ) {\r\n\r\n\t\tthis.mask &= ~ ( 1 << channel );\r\n\r\n\t},\r\n\r\n\ttest: function ( layers ) {\r\n\r\n\t\treturn ( this.mask & layers.mask ) !== 0;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/core/Raycaster.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author bhouston / http://clara.io/\r\n * @author stephomi / http://stephaneginier.com/\r\n */\r\n\r\n( function ( THREE ) {\r\n\r\n\tTHREE.Raycaster = function ( origin, direction, near, far ) {\r\n\r\n\t\tthis.ray = new THREE.Ray( origin, direction );\r\n\t\t// direction is assumed to be normalized (for accurate distance calculations)\r\n\r\n\t\tthis.near = near || 0;\r\n\t\tthis.far = far || Infinity;\r\n\r\n\t\tthis.params = {\r\n\t\t\tMesh: {},\r\n\t\t\tLine: {},\r\n\t\t\tLOD: {},\r\n\t\t\tPoints: { threshold: 1 },\r\n\t\t\tSprite: {}\r\n\t\t};\r\n\r\n\t\tObject.defineProperties( this.params, {\r\n\t\t\tPointCloud: {\r\n\t\t\t\tget: function () {\r\n\t\t\t\t\tconsole.warn( 'THREE.Raycaster: params.PointCloud has been renamed to params.Points.' );\r\n\t\t\t\t\treturn this.Points;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} );\r\n\r\n\t};\r\n\r\n\tfunction ascSort( a, b ) {\r\n\r\n\t\treturn a.distance - b.distance;\r\n\r\n\t}\r\n\r\n\tfunction intersectObject( object, raycaster, intersects, recursive ) {\r\n\r\n\t\tif ( object.visible === false ) return;\r\n\r\n\t\tobject.raycast( raycaster, intersects );\r\n\r\n\t\tif ( recursive === true ) {\r\n\r\n\t\t\tvar children = object.children;\r\n\r\n\t\t\tfor ( var i = 0, l = children.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tintersectObject( children[ i ], raycaster, intersects, true );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t//\r\n\r\n\tTHREE.Raycaster.prototype = {\r\n\r\n\t\tconstructor: THREE.Raycaster,\r\n\r\n\t\tlinePrecision: 1,\r\n\r\n\t\tset: function ( origin, direction ) {\r\n\r\n\t\t\t// direction is assumed to be normalized (for accurate distance calculations)\r\n\r\n\t\t\tthis.ray.set( origin, direction );\r\n\r\n\t\t},\r\n\r\n\t\tsetFromCamera: function ( coords, camera ) {\r\n\r\n\t\t\tif ( camera instanceof THREE.PerspectiveCamera ) {\r\n\r\n\t\t\t\tthis.ray.origin.setFromMatrixPosition( camera.matrixWorld );\r\n\t\t\t\tthis.ray.direction.set( coords.x, coords.y, 0.5 ).unproject( camera ).sub( this.ray.origin ).normalize();\r\n\r\n\t\t\t} else if ( camera instanceof THREE.OrthographicCamera ) {\r\n\r\n\t\t\t\tthis.ray.origin.set( coords.x, coords.y, - 1 ).unproject( camera );\r\n\t\t\t\tthis.ray.direction.set( 0, 0, - 1 ).transformDirection( camera.matrixWorld );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tconsole.error( 'THREE.Raycaster: Unsupported camera type.' );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tintersectObject: function ( object, recursive ) {\r\n\r\n\t\t\tvar intersects = [];\r\n\r\n\t\t\tintersectObject( object, this, intersects, recursive );\r\n\r\n\t\t\tintersects.sort( ascSort );\r\n\r\n\t\t\treturn intersects;\r\n\r\n\t\t},\r\n\r\n\t\tintersectObjects: function ( objects, recursive ) {\r\n\r\n\t\t\tvar intersects = [];\r\n\r\n\t\t\tif ( Array.isArray( objects ) === false ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Raycaster.intersectObjects: objects is not an Array.' );\r\n\t\t\t\treturn intersects;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var i = 0, l = objects.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tintersectObject( objects[ i ], this, intersects, recursive );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tintersects.sort( ascSort );\r\n\r\n\t\t\treturn intersects;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n}( THREE ) );\r\n\r\n// File:src/core/Object3D.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n * @author elephantatwork / www.elephantatwork.ch\r\n */\r\n\r\nTHREE.Object3D = function () {\r\n\r\n\tObject.defineProperty( this, 'id', { value: THREE.Object3DIdCount ++ } );\r\n\r\n\tthis.uuid = THREE.Math.generateUUID();\r\n\r\n\tthis.name = '';\r\n\tthis.type = 'Object3D';\r\n\r\n\tthis.parent = null;\r\n\tthis.children = [];\r\n\r\n\tthis.up = THREE.Object3D.DefaultUp.clone();\r\n\r\n\tvar position = new THREE.Vector3();\r\n\tvar rotation = new THREE.Euler();\r\n\tvar quaternion = new THREE.Quaternion();\r\n\tvar scale = new THREE.Vector3( 1, 1, 1 );\r\n\r\n\tfunction onRotationChange() {\r\n\r\n\t\tquaternion.setFromEuler( rotation, false );\r\n\r\n\t}\r\n\r\n\tfunction onQuaternionChange() {\r\n\r\n\t\trotation.setFromQuaternion( quaternion, undefined, false );\r\n\r\n\t}\r\n\r\n\trotation.onChange( onRotationChange );\r\n\tquaternion.onChange( onQuaternionChange );\r\n\r\n\tObject.defineProperties( this, {\r\n\t\tposition: {\r\n\t\t\tenumerable: true,\r\n\t\t\tvalue: position\r\n\t\t},\r\n\t\trotation: {\r\n\t\t\tenumerable: true,\r\n\t\t\tvalue: rotation\r\n\t\t},\r\n\t\tquaternion: {\r\n\t\t\tenumerable: true,\r\n\t\t\tvalue: quaternion\r\n\t\t},\r\n\t\tscale: {\r\n\t\t\tenumerable: true,\r\n\t\t\tvalue: scale\r\n\t\t},\r\n\t\tmodelViewMatrix: {\r\n\t\t\tvalue: new THREE.Matrix4()\r\n\t\t},\r\n\t\tnormalMatrix: {\r\n\t\t\tvalue: new THREE.Matrix3()\r\n\t\t}\r\n\t} );\r\n\r\n\tthis.matrix = new THREE.Matrix4();\r\n\tthis.matrixWorld = new THREE.Matrix4();\r\n\r\n\tthis.matrixAutoUpdate = THREE.Object3D.DefaultMatrixAutoUpdate;\r\n\tthis.matrixWorldNeedsUpdate = false;\r\n\r\n\tthis.layers = new THREE.Layers();\r\n\tthis.visible = true;\r\n\r\n\tthis.castShadow = false;\r\n\tthis.receiveShadow = false;\r\n\r\n\tthis.frustumCulled = true;\r\n\tthis.renderOrder = 0;\r\n\r\n\tthis.userData = {};\r\n\r\n};\r\n\r\nTHREE.Object3D.DefaultUp = new THREE.Vector3( 0, 1, 0 );\r\nTHREE.Object3D.DefaultMatrixAutoUpdate = true;\r\n\r\nObject.assign( THREE.Object3D.prototype, THREE.EventDispatcher.prototype, {\r\n\r\n\tapplyMatrix: function ( matrix ) {\r\n\r\n\t\tthis.matrix.multiplyMatrices( matrix, this.matrix );\r\n\r\n\t\tthis.matrix.decompose( this.position, this.quaternion, this.scale );\r\n\r\n\t},\r\n\r\n\tsetRotationFromAxisAngle: function ( axis, angle ) {\r\n\r\n\t\t// assumes axis is normalized\r\n\r\n\t\tthis.quaternion.setFromAxisAngle( axis, angle );\r\n\r\n\t},\r\n\r\n\tsetRotationFromEuler: function ( euler ) {\r\n\r\n\t\tthis.quaternion.setFromEuler( euler, true );\r\n\r\n\t},\r\n\r\n\tsetRotationFromMatrix: function ( m ) {\r\n\r\n\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\r\n\r\n\t\tthis.quaternion.setFromRotationMatrix( m );\r\n\r\n\t},\r\n\r\n\tsetRotationFromQuaternion: function ( q ) {\r\n\r\n\t\t// assumes q is normalized\r\n\r\n\t\tthis.quaternion.copy( q );\r\n\r\n\t},\r\n\r\n\trotateOnAxis: function () {\r\n\r\n\t\t// rotate object on axis in object space\r\n\t\t// axis is assumed to be normalized\r\n\r\n\t\tvar q1 = new THREE.Quaternion();\r\n\r\n\t\treturn function ( axis, angle ) {\r\n\r\n\t\t\tq1.setFromAxisAngle( axis, angle );\r\n\r\n\t\t\tthis.quaternion.multiply( q1 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\trotateX: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3( 1, 0, 0 );\r\n\r\n\t\treturn function ( angle ) {\r\n\r\n\t\t\treturn this.rotateOnAxis( v1, angle );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\trotateY: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3( 0, 1, 0 );\r\n\r\n\t\treturn function ( angle ) {\r\n\r\n\t\t\treturn this.rotateOnAxis( v1, angle );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\trotateZ: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3( 0, 0, 1 );\r\n\r\n\t\treturn function ( angle ) {\r\n\r\n\t\t\treturn this.rotateOnAxis( v1, angle );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\ttranslateOnAxis: function () {\r\n\r\n\t\t// translate object by distance along axis in object space\r\n\t\t// axis is assumed to be normalized\r\n\r\n\t\tvar v1 = new THREE.Vector3();\r\n\r\n\t\treturn function ( axis, distance ) {\r\n\r\n\t\t\tv1.copy( axis ).applyQuaternion( this.quaternion );\r\n\r\n\t\t\tthis.position.add( v1.multiplyScalar( distance ) );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\ttranslateX: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3( 1, 0, 0 );\r\n\r\n\t\treturn function ( distance ) {\r\n\r\n\t\t\treturn this.translateOnAxis( v1, distance );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\ttranslateY: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3( 0, 1, 0 );\r\n\r\n\t\treturn function ( distance ) {\r\n\r\n\t\t\treturn this.translateOnAxis( v1, distance );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\ttranslateZ: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3( 0, 0, 1 );\r\n\r\n\t\treturn function ( distance ) {\r\n\r\n\t\t\treturn this.translateOnAxis( v1, distance );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tlocalToWorld: function ( vector ) {\r\n\r\n\t\treturn vector.applyMatrix4( this.matrixWorld );\r\n\r\n\t},\r\n\r\n\tworldToLocal: function () {\r\n\r\n\t\tvar m1 = new THREE.Matrix4();\r\n\r\n\t\treturn function ( vector ) {\r\n\r\n\t\t\treturn vector.applyMatrix4( m1.getInverse( this.matrixWorld ) );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tlookAt: function () {\r\n\r\n\t\t// This routine does not support objects with rotated and/or translated parent(s)\r\n\r\n\t\tvar m1 = new THREE.Matrix4();\r\n\r\n\t\treturn function ( vector ) {\r\n\r\n\t\t\tm1.lookAt( vector, this.position, this.up );\r\n\r\n\t\t\tthis.quaternion.setFromRotationMatrix( m1 );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tadd: function ( object ) {\r\n\r\n\t\tif ( arguments.length > 1 ) {\r\n\r\n\t\t\tfor ( var i = 0; i < arguments.length; i ++ ) {\r\n\r\n\t\t\t\tthis.add( arguments[ i ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t\tif ( object === this ) {\r\n\r\n\t\t\tconsole.error( \"THREE.Object3D.add: object can't be added as a child of itself.\", object );\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t\tif ( object instanceof THREE.Object3D ) {\r\n\r\n\t\t\tif ( object.parent !== null ) {\r\n\r\n\t\t\t\tobject.parent.remove( object );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tobject.parent = this;\r\n\t\t\tobject.dispatchEvent( { type: 'added' } );\r\n\r\n\t\t\tthis.children.push( object );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tconsole.error( \"THREE.Object3D.add: object not an instance of THREE.Object3D.\", object );\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tremove: function ( object ) {\r\n\r\n\t\tif ( arguments.length > 1 ) {\r\n\r\n\t\t\tfor ( var i = 0; i < arguments.length; i ++ ) {\r\n\r\n\t\t\t\tthis.remove( arguments[ i ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar index = this.children.indexOf( object );\r\n\r\n\t\tif ( index !== - 1 ) {\r\n\r\n\t\t\tobject.parent = null;\r\n\r\n\t\t\tobject.dispatchEvent( { type: 'removed' } );\r\n\r\n\t\t\tthis.children.splice( index, 1 );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tgetObjectById: function ( id ) {\r\n\r\n\t\treturn this.getObjectByProperty( 'id', id );\r\n\r\n\t},\r\n\r\n\tgetObjectByName: function ( name ) {\r\n\r\n\t\treturn this.getObjectByProperty( 'name', name );\r\n\r\n\t},\r\n\r\n\tgetObjectByProperty: function ( name, value ) {\r\n\r\n\t\tif ( this[ name ] === value ) return this;\r\n\r\n\t\tfor ( var i = 0, l = this.children.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar child = this.children[ i ];\r\n\t\t\tvar object = child.getObjectByProperty( name, value );\r\n\r\n\t\t\tif ( object !== undefined ) {\r\n\r\n\t\t\t\treturn object;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn undefined;\r\n\r\n\t},\r\n\r\n\tgetWorldPosition: function ( optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\r\n\t\tthis.updateMatrixWorld( true );\r\n\r\n\t\treturn result.setFromMatrixPosition( this.matrixWorld );\r\n\r\n\t},\r\n\r\n\tgetWorldQuaternion: function () {\r\n\r\n\t\tvar position = new THREE.Vector3();\r\n\t\tvar scale = new THREE.Vector3();\r\n\r\n\t\treturn function ( optionalTarget ) {\r\n\r\n\t\t\tvar result = optionalTarget || new THREE.Quaternion();\r\n\r\n\t\t\tthis.updateMatrixWorld( true );\r\n\r\n\t\t\tthis.matrixWorld.decompose( position, result, scale );\r\n\r\n\t\t\treturn result;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tgetWorldRotation: function () {\r\n\r\n\t\tvar quaternion = new THREE.Quaternion();\r\n\r\n\t\treturn function ( optionalTarget ) {\r\n\r\n\t\t\tvar result = optionalTarget || new THREE.Euler();\r\n\r\n\t\t\tthis.getWorldQuaternion( quaternion );\r\n\r\n\t\t\treturn result.setFromQuaternion( quaternion, this.rotation.order, false );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tgetWorldScale: function () {\r\n\r\n\t\tvar position = new THREE.Vector3();\r\n\t\tvar quaternion = new THREE.Quaternion();\r\n\r\n\t\treturn function ( optionalTarget ) {\r\n\r\n\t\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\r\n\t\t\tthis.updateMatrixWorld( true );\r\n\r\n\t\t\tthis.matrixWorld.decompose( position, quaternion, result );\r\n\r\n\t\t\treturn result;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tgetWorldDirection: function () {\r\n\r\n\t\tvar quaternion = new THREE.Quaternion();\r\n\r\n\t\treturn function ( optionalTarget ) {\r\n\r\n\t\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\r\n\t\t\tthis.getWorldQuaternion( quaternion );\r\n\r\n\t\t\treturn result.set( 0, 0, 1 ).applyQuaternion( quaternion );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\traycast: function () {},\r\n\r\n\ttraverse: function ( callback ) {\r\n\r\n\t\tcallback( this );\r\n\r\n\t\tvar children = this.children;\r\n\r\n\t\tfor ( var i = 0, l = children.length; i < l; i ++ ) {\r\n\r\n\t\t\tchildren[ i ].traverse( callback );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\ttraverseVisible: function ( callback ) {\r\n\r\n\t\tif ( this.visible === false ) return;\r\n\r\n\t\tcallback( this );\r\n\r\n\t\tvar children = this.children;\r\n\r\n\t\tfor ( var i = 0, l = children.length; i < l; i ++ ) {\r\n\r\n\t\t\tchildren[ i ].traverseVisible( callback );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\ttraverseAncestors: function ( callback ) {\r\n\r\n\t\tvar parent = this.parent;\r\n\r\n\t\tif ( parent !== null ) {\r\n\r\n\t\t\tcallback( parent );\r\n\r\n\t\t\tparent.traverseAncestors( callback );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tupdateMatrix: function () {\r\n\r\n\t\tthis.matrix.compose( this.position, this.quaternion, this.scale );\r\n\r\n\t\tthis.matrixWorldNeedsUpdate = true;\r\n\r\n\t},\r\n\r\n\tupdateMatrixWorld: function ( force ) {\r\n\r\n\t\tif ( this.matrixAutoUpdate === true ) this.updateMatrix();\r\n\r\n\t\tif ( this.matrixWorldNeedsUpdate === true || force === true ) {\r\n\r\n\t\t\tif ( this.parent === null ) {\r\n\r\n\t\t\t\tthis.matrixWorld.copy( this.matrix );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis.matrixWorld.multiplyMatrices( this.parent.matrixWorld, this.matrix );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.matrixWorldNeedsUpdate = false;\r\n\r\n\t\t\tforce = true;\r\n\r\n\t\t}\r\n\r\n\t\t// update children\r\n\r\n\t\tfor ( var i = 0, l = this.children.length; i < l; i ++ ) {\r\n\r\n\t\t\tthis.children[ i ].updateMatrixWorld( force );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\ttoJSON: function ( meta ) {\r\n\r\n\t\t// meta is '' when called from JSON.stringify\r\n\t\tvar isRootObject = ( meta === undefined || meta === '' );\r\n\r\n\t\tvar output = {};\r\n\r\n\t\t// meta is a hash used to collect geometries, materials.\r\n\t\t// not providing it implies that this is the root object\r\n\t\t// being serialized.\r\n\t\tif ( isRootObject ) {\r\n\r\n\t\t\t// initialize meta obj\r\n\t\t\tmeta = {\r\n\t\t\t\tgeometries: {},\r\n\t\t\t\tmaterials: {},\r\n\t\t\t\ttextures: {},\r\n\t\t\t\timages: {}\r\n\t\t\t};\r\n\r\n\t\t\toutput.metadata = {\r\n\t\t\t\tversion: 4.4,\r\n\t\t\t\ttype: 'Object',\r\n\t\t\t\tgenerator: 'Object3D.toJSON'\r\n\t\t\t};\r\n\r\n\t\t}\r\n\r\n\t\t// standard Object3D serialization\r\n\r\n\t\tvar object = {};\r\n\r\n\t\tobject.uuid = this.uuid;\r\n\t\tobject.type = this.type;\r\n\r\n\t\tif ( this.name !== '' ) object.name = this.name;\r\n\t\tif ( JSON.stringify( this.userData ) !== '{}' ) object.userData = this.userData;\r\n\t\tif ( this.castShadow === true ) object.castShadow = true;\r\n\t\tif ( this.receiveShadow === true ) object.receiveShadow = true;\r\n\t\tif ( this.visible === false ) object.visible = false;\r\n\r\n\t\tobject.matrix = this.matrix.toArray();\r\n\r\n\t\t//\r\n\r\n\t\tif ( this.geometry !== undefined ) {\r\n\r\n\t\t\tif ( meta.geometries[ this.geometry.uuid ] === undefined ) {\r\n\r\n\t\t\t\tmeta.geometries[ this.geometry.uuid ] = this.geometry.toJSON( meta );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tobject.geometry = this.geometry.uuid;\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.material !== undefined ) {\r\n\r\n\t\t\tif ( meta.materials[ this.material.uuid ] === undefined ) {\r\n\r\n\t\t\t\tmeta.materials[ this.material.uuid ] = this.material.toJSON( meta );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tobject.material = this.material.uuid;\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tif ( this.children.length > 0 ) {\r\n\r\n\t\t\tobject.children = [];\r\n\r\n\t\t\tfor ( var i = 0; i < this.children.length; i ++ ) {\r\n\r\n\t\t\t\tobject.children.push( this.children[ i ].toJSON( meta ).object );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( isRootObject ) {\r\n\r\n\t\t\tvar geometries = extractFromCache( meta.geometries );\r\n\t\t\tvar materials = extractFromCache( meta.materials );\r\n\t\t\tvar textures = extractFromCache( meta.textures );\r\n\t\t\tvar images = extractFromCache( meta.images );\r\n\r\n\t\t\tif ( geometries.length > 0 ) output.geometries = geometries;\r\n\t\t\tif ( materials.length > 0 ) output.materials = materials;\r\n\t\t\tif ( textures.length > 0 ) output.textures = textures;\r\n\t\t\tif ( images.length > 0 ) output.images = images;\r\n\r\n\t\t}\r\n\r\n\t\toutput.object = object;\r\n\r\n\t\treturn output;\r\n\r\n\t\t// extract data from the cache hash\r\n\t\t// remove metadata on each item\r\n\t\t// and return as array\r\n\t\tfunction extractFromCache ( cache ) {\r\n\r\n\t\t\tvar values = [];\r\n\t\t\tfor ( var key in cache ) {\r\n\r\n\t\t\t\tvar data = cache[ key ];\r\n\t\t\t\tdelete data.metadata;\r\n\t\t\t\tvalues.push( data );\r\n\r\n\t\t\t}\r\n\t\t\treturn values;\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tclone: function ( recursive ) {\r\n\r\n\t\treturn new this.constructor().copy( this, recursive );\r\n\r\n\t},\r\n\r\n\tcopy: function ( source, recursive ) {\r\n\r\n\t\tif ( recursive === undefined ) recursive = true;\r\n\r\n\t\tthis.name = source.name;\r\n\r\n\t\tthis.up.copy( source.up );\r\n\r\n\t\tthis.position.copy( source.position );\r\n\t\tthis.quaternion.copy( source.quaternion );\r\n\t\tthis.scale.copy( source.scale );\r\n\r\n\t\tthis.matrix.copy( source.matrix );\r\n\t\tthis.matrixWorld.copy( source.matrixWorld );\r\n\r\n\t\tthis.matrixAutoUpdate = source.matrixAutoUpdate;\r\n\t\tthis.matrixWorldNeedsUpdate = source.matrixWorldNeedsUpdate;\r\n\r\n\t\tthis.visible = source.visible;\r\n\r\n\t\tthis.castShadow = source.castShadow;\r\n\t\tthis.receiveShadow = source.receiveShadow;\r\n\r\n\t\tthis.frustumCulled = source.frustumCulled;\r\n\t\tthis.renderOrder = source.renderOrder;\r\n\r\n\t\tthis.userData = JSON.parse( JSON.stringify( source.userData ) );\r\n\r\n\t\tif ( recursive === true ) {\r\n\r\n\t\t\tfor ( var i = 0; i < source.children.length; i ++ ) {\r\n\r\n\t\t\t\tvar child = source.children[ i ];\r\n\t\t\t\tthis.add( child.clone() );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n} );\r\n\r\nTHREE.Object3DIdCount = 0;\r\n\r\n// File:src/core/Face3.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Face3 = function ( a, b, c, normal, color, materialIndex ) {\r\n\r\n\tthis.a = a;\r\n\tthis.b = b;\r\n\tthis.c = c;\r\n\r\n\tthis.normal = normal instanceof THREE.Vector3 ? normal : new THREE.Vector3();\r\n\tthis.vertexNormals = Array.isArray( normal ) ? normal : [];\r\n\r\n\tthis.color = color instanceof THREE.Color ? color : new THREE.Color();\r\n\tthis.vertexColors = Array.isArray( color ) ? color : [];\r\n\r\n\tthis.materialIndex = materialIndex !== undefined ? materialIndex : 0;\r\n\r\n};\r\n\r\nTHREE.Face3.prototype = {\r\n\r\n\tconstructor: THREE.Face3,\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor().copy( this );\r\n\r\n\t},\r\n\r\n\tcopy: function ( source ) {\r\n\r\n\t\tthis.a = source.a;\r\n\t\tthis.b = source.b;\r\n\t\tthis.c = source.c;\r\n\r\n\t\tthis.normal.copy( source.normal );\r\n\t\tthis.color.copy( source.color );\r\n\r\n\t\tthis.materialIndex = source.materialIndex;\r\n\r\n\t\tfor ( var i = 0, il = source.vertexNormals.length; i < il; i ++ ) {\r\n\r\n\t\t\tthis.vertexNormals[ i ] = source.vertexNormals[ i ].clone();\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var i = 0, il = source.vertexColors.length; i < il; i ++ ) {\r\n\r\n\t\t\tthis.vertexColors[ i ] = source.vertexColors[ i ].clone();\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/core/BufferAttribute.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.BufferAttribute = function ( array, itemSize, normalized ) {\r\n\r\n\tthis.uuid = THREE.Math.generateUUID();\r\n\r\n\tthis.array = array;\r\n\tthis.itemSize = itemSize;\r\n\r\n\tthis.dynamic = false;\r\n\tthis.updateRange = { offset: 0, count: - 1 };\r\n\r\n\tthis.version = 0;\r\n\tthis.normalized = normalized === true;\r\n\r\n};\r\n\r\nTHREE.BufferAttribute.prototype = {\r\n\r\n\tconstructor: THREE.BufferAttribute,\r\n\r\n\tget count() {\r\n\r\n\t\treturn this.array.length / this.itemSize;\r\n\r\n\t},\r\n\r\n\tset needsUpdate( value ) {\r\n\r\n\t\tif ( value === true ) this.version ++;\r\n\r\n\t},\r\n\r\n\tsetDynamic: function ( value ) {\r\n\r\n\t\tthis.dynamic = value;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcopy: function ( source ) {\r\n\r\n\t\tthis.array = new source.array.constructor( source.array );\r\n\t\tthis.itemSize = source.itemSize;\r\n\r\n\t\tthis.dynamic = source.dynamic;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcopyAt: function ( index1, attribute, index2 ) {\r\n\r\n\t\tindex1 *= this.itemSize;\r\n\t\tindex2 *= attribute.itemSize;\r\n\r\n\t\tfor ( var i = 0, l = this.itemSize; i < l; i ++ ) {\r\n\r\n\t\t\tthis.array[ index1 + i ] = attribute.array[ index2 + i ];\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcopyArray: function ( array ) {\r\n\r\n\t\tthis.array.set( array );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcopyColorsArray: function ( colors ) {\r\n\r\n\t\tvar array = this.array, offset = 0;\r\n\r\n\t\tfor ( var i = 0, l = colors.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar color = colors[ i ];\r\n\r\n\t\t\tif ( color === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.BufferAttribute.copyColorsArray(): color is undefined', i );\r\n\t\t\t\tcolor = new THREE.Color();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tarray[ offset ++ ] = color.r;\r\n\t\t\tarray[ offset ++ ] = color.g;\r\n\t\t\tarray[ offset ++ ] = color.b;\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcopyIndicesArray: function ( indices ) {\r\n\r\n\t\tvar array = this.array, offset = 0;\r\n\r\n\t\tfor ( var i = 0, l = indices.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar index = indices[ i ];\r\n\r\n\t\t\tarray[ offset ++ ] = index.a;\r\n\t\t\tarray[ offset ++ ] = index.b;\r\n\t\t\tarray[ offset ++ ] = index.c;\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcopyVector2sArray: function ( vectors ) {\r\n\r\n\t\tvar array = this.array, offset = 0;\r\n\r\n\t\tfor ( var i = 0, l = vectors.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar vector = vectors[ i ];\r\n\r\n\t\t\tif ( vector === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.BufferAttribute.copyVector2sArray(): vector is undefined', i );\r\n\t\t\t\tvector = new THREE.Vector2();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tarray[ offset ++ ] = vector.x;\r\n\t\t\tarray[ offset ++ ] = vector.y;\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcopyVector3sArray: function ( vectors ) {\r\n\r\n\t\tvar array = this.array, offset = 0;\r\n\r\n\t\tfor ( var i = 0, l = vectors.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar vector = vectors[ i ];\r\n\r\n\t\t\tif ( vector === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.BufferAttribute.copyVector3sArray(): vector is undefined', i );\r\n\t\t\t\tvector = new THREE.Vector3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tarray[ offset ++ ] = vector.x;\r\n\t\t\tarray[ offset ++ ] = vector.y;\r\n\t\t\tarray[ offset ++ ] = vector.z;\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcopyVector4sArray: function ( vectors ) {\r\n\r\n\t\tvar array = this.array, offset = 0;\r\n\r\n\t\tfor ( var i = 0, l = vectors.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar vector = vectors[ i ];\r\n\r\n\t\t\tif ( vector === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.BufferAttribute.copyVector4sArray(): vector is undefined', i );\r\n\t\t\t\tvector = new THREE.Vector4();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tarray[ offset ++ ] = vector.x;\r\n\t\t\tarray[ offset ++ ] = vector.y;\r\n\t\t\tarray[ offset ++ ] = vector.z;\r\n\t\t\tarray[ offset ++ ] = vector.w;\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tset: function ( value, offset ) {\r\n\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tthis.array.set( value, offset );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tgetX: function ( index ) {\r\n\r\n\t\treturn this.array[ index * this.itemSize ];\r\n\r\n\t},\r\n\r\n\tsetX: function ( index, x ) {\r\n\r\n\t\tthis.array[ index * this.itemSize ] = x;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tgetY: function ( index ) {\r\n\r\n\t\treturn this.array[ index * this.itemSize + 1 ];\r\n\r\n\t},\r\n\r\n\tsetY: function ( index, y ) {\r\n\r\n\t\tthis.array[ index * this.itemSize + 1 ] = y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tgetZ: function ( index ) {\r\n\r\n\t\treturn this.array[ index * this.itemSize + 2 ];\r\n\r\n\t},\r\n\r\n\tsetZ: function ( index, z ) {\r\n\r\n\t\tthis.array[ index * this.itemSize + 2 ] = z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tgetW: function ( index ) {\r\n\r\n\t\treturn this.array[ index * this.itemSize + 3 ];\r\n\r\n\t},\r\n\r\n\tsetW: function ( index, w ) {\r\n\r\n\t\tthis.array[ index * this.itemSize + 3 ] = w;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetXY: function ( index, x, y ) {\r\n\r\n\t\tindex *= this.itemSize;\r\n\r\n\t\tthis.array[ index + 0 ] = x;\r\n\t\tthis.array[ index + 1 ] = y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetXYZ: function ( index, x, y, z ) {\r\n\r\n\t\tindex *= this.itemSize;\r\n\r\n\t\tthis.array[ index + 0 ] = x;\r\n\t\tthis.array[ index + 1 ] = y;\r\n\t\tthis.array[ index + 2 ] = z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetXYZW: function ( index, x, y, z, w ) {\r\n\r\n\t\tindex *= this.itemSize;\r\n\r\n\t\tthis.array[ index + 0 ] = x;\r\n\t\tthis.array[ index + 1 ] = y;\r\n\t\tthis.array[ index + 2 ] = z;\r\n\t\tthis.array[ index + 3 ] = w;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor().copy( this );\r\n\r\n\t}\r\n\r\n};\r\n\r\n//\r\n\r\nTHREE.Int8Attribute = function ( array, itemSize ) {\r\n\r\n\treturn new THREE.BufferAttribute( new Int8Array( array ), itemSize );\r\n\r\n};\r\n\r\nTHREE.Uint8Attribute = function ( array, itemSize ) {\r\n\r\n\treturn new THREE.BufferAttribute( new Uint8Array( array ), itemSize );\r\n\r\n};\r\n\r\nTHREE.Uint8ClampedAttribute = function ( array, itemSize ) {\r\n\r\n\treturn new THREE.BufferAttribute( new Uint8ClampedArray( array ), itemSize );\r\n\r\n};\r\n\r\nTHREE.Int16Attribute = function ( array, itemSize ) {\r\n\r\n\treturn new THREE.BufferAttribute( new Int16Array( array ), itemSize );\r\n\r\n};\r\n\r\nTHREE.Uint16Attribute = function ( array, itemSize ) {\r\n\r\n\treturn new THREE.BufferAttribute( new Uint16Array( array ), itemSize );\r\n\r\n};\r\n\r\nTHREE.Int32Attribute = function ( array, itemSize ) {\r\n\r\n\treturn new THREE.BufferAttribute( new Int32Array( array ), itemSize );\r\n\r\n};\r\n\r\nTHREE.Uint32Attribute = function ( array, itemSize ) {\r\n\r\n\treturn new THREE.BufferAttribute( new Uint32Array( array ), itemSize );\r\n\r\n};\r\n\r\nTHREE.Float32Attribute = function ( array, itemSize ) {\r\n\r\n\treturn new THREE.BufferAttribute( new Float32Array( array ), itemSize );\r\n\r\n};\r\n\r\nTHREE.Float64Attribute = function ( array, itemSize ) {\r\n\r\n\treturn new THREE.BufferAttribute( new Float64Array( array ), itemSize );\r\n\r\n};\r\n\r\n\r\n// Deprecated\r\n\r\nTHREE.DynamicBufferAttribute = function ( array, itemSize ) {\r\n\r\n\tconsole.warn( 'THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead.' );\r\n\treturn new THREE.BufferAttribute( array, itemSize ).setDynamic( true );\r\n\r\n};\r\n\r\n// File:src/core/InstancedBufferAttribute.js\r\n\r\n/**\r\n * @author benaadams / https://twitter.com/ben_a_adams\r\n */\r\n\r\nTHREE.InstancedBufferAttribute = function ( array, itemSize, meshPerAttribute ) {\r\n\r\n\tTHREE.BufferAttribute.call( this, array, itemSize );\r\n\r\n\tthis.meshPerAttribute = meshPerAttribute || 1;\r\n\r\n};\r\n\r\nTHREE.InstancedBufferAttribute.prototype = Object.create( THREE.BufferAttribute.prototype );\r\nTHREE.InstancedBufferAttribute.prototype.constructor = THREE.InstancedBufferAttribute;\r\n\r\nTHREE.InstancedBufferAttribute.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.BufferAttribute.prototype.copy.call( this, source );\r\n\r\n\tthis.meshPerAttribute = source.meshPerAttribute;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n// File:src/core/InterleavedBuffer.js\r\n\r\n/**\r\n * @author benaadams / https://twitter.com/ben_a_adams\r\n */\r\n\r\nTHREE.InterleavedBuffer = function ( array, stride ) {\r\n\r\n\tthis.uuid = THREE.Math.generateUUID();\r\n\r\n\tthis.array = array;\r\n\tthis.stride = stride;\r\n\r\n\tthis.dynamic = false;\r\n\tthis.updateRange = { offset: 0, count: - 1 };\r\n\r\n\tthis.version = 0;\r\n\r\n};\r\n\r\nTHREE.InterleavedBuffer.prototype = {\r\n\r\n\tconstructor: THREE.InterleavedBuffer,\r\n\r\n\tget length () {\r\n\r\n\t\treturn this.array.length;\r\n\r\n\t},\r\n\r\n\tget count () {\r\n\r\n\t\treturn this.array.length / this.stride;\r\n\r\n\t},\r\n\r\n\tset needsUpdate( value ) {\r\n\r\n\t\tif ( value === true ) this.version ++;\r\n\r\n\t},\r\n\r\n\tsetDynamic: function ( value ) {\r\n\r\n\t\tthis.dynamic = value;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcopy: function ( source ) {\r\n\r\n\t\tthis.array = new source.array.constructor( source.array );\r\n\t\tthis.stride = source.stride;\r\n\t\tthis.dynamic = source.dynamic;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcopyAt: function ( index1, attribute, index2 ) {\r\n\r\n\t\tindex1 *= this.stride;\r\n\t\tindex2 *= attribute.stride;\r\n\r\n\t\tfor ( var i = 0, l = this.stride; i < l; i ++ ) {\r\n\r\n\t\t\tthis.array[ index1 + i ] = attribute.array[ index2 + i ];\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tset: function ( value, offset ) {\r\n\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tthis.array.set( value, offset );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor().copy( this );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/core/InstancedInterleavedBuffer.js\r\n\r\n/**\r\n * @author benaadams / https://twitter.com/ben_a_adams\r\n */\r\n\r\nTHREE.InstancedInterleavedBuffer = function ( array, stride, meshPerAttribute ) {\r\n\r\n\tTHREE.InterleavedBuffer.call( this, array, stride );\r\n\r\n\tthis.meshPerAttribute = meshPerAttribute || 1;\r\n\r\n};\r\n\r\nTHREE.InstancedInterleavedBuffer.prototype = Object.create( THREE.InterleavedBuffer.prototype );\r\nTHREE.InstancedInterleavedBuffer.prototype.constructor = THREE.InstancedInterleavedBuffer;\r\n\r\nTHREE.InstancedInterleavedBuffer.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.InterleavedBuffer.prototype.copy.call( this, source );\r\n\r\n\tthis.meshPerAttribute = source.meshPerAttribute;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n// File:src/core/InterleavedBufferAttribute.js\r\n\r\n/**\r\n * @author benaadams / https://twitter.com/ben_a_adams\r\n */\r\n\r\nTHREE.InterleavedBufferAttribute = function ( interleavedBuffer, itemSize, offset ) {\r\n\r\n\tthis.uuid = THREE.Math.generateUUID();\r\n\r\n\tthis.data = interleavedBuffer;\r\n\tthis.itemSize = itemSize;\r\n\tthis.offset = offset;\r\n\r\n};\r\n\r\n\r\nTHREE.InterleavedBufferAttribute.prototype = {\r\n\r\n\tconstructor: THREE.InterleavedBufferAttribute,\r\n\r\n\tget length() {\r\n\r\n\t\tconsole.warn( 'THREE.BufferAttribute: .length has been deprecated. Please use .count.' );\r\n\t\treturn this.array.length;\r\n\r\n\t},\r\n\r\n\tget count() {\r\n\r\n\t\treturn this.data.count;\r\n\r\n\t},\r\n\r\n\tsetX: function ( index, x ) {\r\n\r\n\t\tthis.data.array[ index * this.data.stride + this.offset ] = x;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetY: function ( index, y ) {\r\n\r\n\t\tthis.data.array[ index * this.data.stride + this.offset + 1 ] = y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetZ: function ( index, z ) {\r\n\r\n\t\tthis.data.array[ index * this.data.stride + this.offset + 2 ] = z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetW: function ( index, w ) {\r\n\r\n\t\tthis.data.array[ index * this.data.stride + this.offset + 3 ] = w;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tgetX: function ( index ) {\r\n\r\n\t\treturn this.data.array[ index * this.data.stride + this.offset ];\r\n\r\n\t},\r\n\r\n\tgetY: function ( index ) {\r\n\r\n\t\treturn this.data.array[ index * this.data.stride + this.offset + 1 ];\r\n\r\n\t},\r\n\r\n\tgetZ: function ( index ) {\r\n\r\n\t\treturn this.data.array[ index * this.data.stride + this.offset + 2 ];\r\n\r\n\t},\r\n\r\n\tgetW: function ( index ) {\r\n\r\n\t\treturn this.data.array[ index * this.data.stride + this.offset + 3 ];\r\n\r\n\t},\r\n\r\n\tsetXY: function ( index, x, y ) {\r\n\r\n\t\tindex = index * this.data.stride + this.offset;\r\n\r\n\t\tthis.data.array[ index + 0 ] = x;\r\n\t\tthis.data.array[ index + 1 ] = y;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetXYZ: function ( index, x, y, z ) {\r\n\r\n\t\tindex = index * this.data.stride + this.offset;\r\n\r\n\t\tthis.data.array[ index + 0 ] = x;\r\n\t\tthis.data.array[ index + 1 ] = y;\r\n\t\tthis.data.array[ index + 2 ] = z;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetXYZW: function ( index, x, y, z, w ) {\r\n\r\n\t\tindex = index * this.data.stride + this.offset;\r\n\r\n\t\tthis.data.array[ index + 0 ] = x;\r\n\t\tthis.data.array[ index + 1 ] = y;\r\n\t\tthis.data.array[ index + 2 ] = z;\r\n\t\tthis.data.array[ index + 3 ] = w;\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/core/Geometry.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author kile / http://kile.stravaganza.org/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n * @author bhouston / http://clara.io\r\n */\r\n\r\nTHREE.Geometry = function () {\r\n\r\n\tObject.defineProperty( this, 'id', { value: THREE.GeometryIdCount ++ } );\r\n\r\n\tthis.uuid = THREE.Math.generateUUID();\r\n\r\n\tthis.name = '';\r\n\tthis.type = 'Geometry';\r\n\r\n\tthis.vertices = [];\r\n\tthis.colors = [];\r\n\tthis.faces = [];\r\n\tthis.faceVertexUvs = [ [] ];\r\n\r\n\tthis.morphTargets = [];\r\n\tthis.morphNormals = [];\r\n\r\n\tthis.skinWeights = [];\r\n\tthis.skinIndices = [];\r\n\r\n\tthis.lineDistances = [];\r\n\r\n\tthis.boundingBox = null;\r\n\tthis.boundingSphere = null;\r\n\r\n\t// update flags\r\n\r\n\tthis.verticesNeedUpdate = false;\r\n\tthis.elementsNeedUpdate = false;\r\n\tthis.uvsNeedUpdate = false;\r\n\tthis.normalsNeedUpdate = false;\r\n\tthis.colorsNeedUpdate = false;\r\n\tthis.lineDistancesNeedUpdate = false;\r\n\tthis.groupsNeedUpdate = false;\r\n\r\n};\r\n\r\nObject.assign( THREE.Geometry.prototype, THREE.EventDispatcher.prototype, {\r\n\r\n\tapplyMatrix: function ( matrix ) {\r\n\r\n\t\tvar normalMatrix = new THREE.Matrix3().getNormalMatrix( matrix );\r\n\r\n\t\tfor ( var i = 0, il = this.vertices.length; i < il; i ++ ) {\r\n\r\n\t\t\tvar vertex = this.vertices[ i ];\r\n\t\t\tvertex.applyMatrix4( matrix );\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var i = 0, il = this.faces.length; i < il; i ++ ) {\r\n\r\n\t\t\tvar face = this.faces[ i ];\r\n\t\t\tface.normal.applyMatrix3( normalMatrix ).normalize();\r\n\r\n\t\t\tfor ( var j = 0, jl = face.vertexNormals.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\tface.vertexNormals[ j ].applyMatrix3( normalMatrix ).normalize();\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.boundingBox !== null ) {\r\n\r\n\t\t\tthis.computeBoundingBox();\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.boundingSphere !== null ) {\r\n\r\n\t\t\tthis.computeBoundingSphere();\r\n\r\n\t\t}\r\n\r\n\t\tthis.verticesNeedUpdate = true;\r\n\t\tthis.normalsNeedUpdate = true;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\trotateX: function () {\r\n\r\n\t\t// rotate geometry around world x-axis\r\n\r\n\t\tvar m1;\r\n\r\n\t\treturn function rotateX( angle ) {\r\n\r\n\t\t\tif ( m1 === undefined ) m1 = new THREE.Matrix4();\r\n\r\n\t\t\tm1.makeRotationX( angle );\r\n\r\n\t\t\tthis.applyMatrix( m1 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\trotateY: function () {\r\n\r\n\t\t// rotate geometry around world y-axis\r\n\r\n\t\tvar m1;\r\n\r\n\t\treturn function rotateY( angle ) {\r\n\r\n\t\t\tif ( m1 === undefined ) m1 = new THREE.Matrix4();\r\n\r\n\t\t\tm1.makeRotationY( angle );\r\n\r\n\t\t\tthis.applyMatrix( m1 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\trotateZ: function () {\r\n\r\n\t\t// rotate geometry around world z-axis\r\n\r\n\t\tvar m1;\r\n\r\n\t\treturn function rotateZ( angle ) {\r\n\r\n\t\t\tif ( m1 === undefined ) m1 = new THREE.Matrix4();\r\n\r\n\t\t\tm1.makeRotationZ( angle );\r\n\r\n\t\t\tthis.applyMatrix( m1 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\ttranslate: function () {\r\n\r\n\t\t// translate geometry\r\n\r\n\t\tvar m1;\r\n\r\n\t\treturn function translate( x, y, z ) {\r\n\r\n\t\t\tif ( m1 === undefined ) m1 = new THREE.Matrix4();\r\n\r\n\t\t\tm1.makeTranslation( x, y, z );\r\n\r\n\t\t\tthis.applyMatrix( m1 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tscale: function () {\r\n\r\n\t\t// scale geometry\r\n\r\n\t\tvar m1;\r\n\r\n\t\treturn function scale( x, y, z ) {\r\n\r\n\t\t\tif ( m1 === undefined ) m1 = new THREE.Matrix4();\r\n\r\n\t\t\tm1.makeScale( x, y, z );\r\n\r\n\t\t\tthis.applyMatrix( m1 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tlookAt: function () {\r\n\r\n\t\tvar obj;\r\n\r\n\t\treturn function lookAt( vector ) {\r\n\r\n\t\t\tif ( obj === undefined ) obj = new THREE.Object3D();\r\n\r\n\t\t\tobj.lookAt( vector );\r\n\r\n\t\t\tobj.updateMatrix();\r\n\r\n\t\t\tthis.applyMatrix( obj.matrix );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tfromBufferGeometry: function ( geometry ) {\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tvar indices = geometry.index !== null ? geometry.index.array : undefined;\r\n\t\tvar attributes = geometry.attributes;\r\n\r\n\t\tvar positions = attributes.position.array;\r\n\t\tvar normals = attributes.normal !== undefined ? attributes.normal.array : undefined;\r\n\t\tvar colors = attributes.color !== undefined ? attributes.color.array : undefined;\r\n\t\tvar uvs = attributes.uv !== undefined ? attributes.uv.array : undefined;\r\n\t\tvar uvs2 = attributes.uv2 !== undefined ? attributes.uv2.array : undefined;\r\n\r\n\t\tif ( uvs2 !== undefined ) this.faceVertexUvs[ 1 ] = [];\r\n\r\n\t\tvar tempNormals = [];\r\n\t\tvar tempUVs = [];\r\n\t\tvar tempUVs2 = [];\r\n\r\n\t\tfor ( var i = 0, j = 0; i < positions.length; i += 3, j += 2 ) {\r\n\r\n\t\t\tscope.vertices.push( new THREE.Vector3( positions[ i ], positions[ i + 1 ], positions[ i + 2 ] ) );\r\n\r\n\t\t\tif ( normals !== undefined ) {\r\n\r\n\t\t\t\ttempNormals.push( new THREE.Vector3( normals[ i ], normals[ i + 1 ], normals[ i + 2 ] ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( colors !== undefined ) {\r\n\r\n\t\t\t\tscope.colors.push( new THREE.Color( colors[ i ], colors[ i + 1 ], colors[ i + 2 ] ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( uvs !== undefined ) {\r\n\r\n\t\t\t\ttempUVs.push( new THREE.Vector2( uvs[ j ], uvs[ j + 1 ] ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( uvs2 !== undefined ) {\r\n\r\n\t\t\t\ttempUVs2.push( new THREE.Vector2( uvs2[ j ], uvs2[ j + 1 ] ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction addFace( a, b, c, materialIndex ) {\r\n\r\n\t\t\tvar vertexNormals = normals !== undefined ? [ tempNormals[ a ].clone(), tempNormals[ b ].clone(), tempNormals[ c ].clone() ] : [];\r\n\t\t\tvar vertexColors = colors !== undefined ? [ scope.colors[ a ].clone(), scope.colors[ b ].clone(), scope.colors[ c ].clone() ] : [];\r\n\r\n\t\t\tvar face = new THREE.Face3( a, b, c, vertexNormals, vertexColors, materialIndex );\r\n\r\n\t\t\tscope.faces.push( face );\r\n\r\n\t\t\tif ( uvs !== undefined ) {\r\n\r\n\t\t\t\tscope.faceVertexUvs[ 0 ].push( [ tempUVs[ a ].clone(), tempUVs[ b ].clone(), tempUVs[ c ].clone() ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( uvs2 !== undefined ) {\r\n\r\n\t\t\t\tscope.faceVertexUvs[ 1 ].push( [ tempUVs2[ a ].clone(), tempUVs2[ b ].clone(), tempUVs2[ c ].clone() ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( indices !== undefined ) {\r\n\r\n\t\t\tvar groups = geometry.groups;\r\n\r\n\t\t\tif ( groups.length > 0 ) {\r\n\r\n\t\t\t\tfor ( var i = 0; i < groups.length; i ++ ) {\r\n\r\n\t\t\t\t\tvar group = groups[ i ];\r\n\r\n\t\t\t\t\tvar start = group.start;\r\n\t\t\t\t\tvar count = group.count;\r\n\r\n\t\t\t\t\tfor ( var j = start, jl = start + count; j < jl; j += 3 ) {\r\n\r\n\t\t\t\t\t\taddFace( indices[ j ], indices[ j + 1 ], indices[ j + 2 ], group.materialIndex  );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tfor ( var i = 0; i < indices.length; i += 3 ) {\r\n\r\n\t\t\t\t\taddFace( indices[ i ], indices[ i + 1 ], indices[ i + 2 ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tfor ( var i = 0; i < positions.length / 3; i += 3 ) {\r\n\r\n\t\t\t\taddFace( i, i + 1, i + 2 );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tthis.computeFaceNormals();\r\n\r\n\t\tif ( geometry.boundingBox !== null ) {\r\n\r\n\t\t\tthis.boundingBox = geometry.boundingBox.clone();\r\n\r\n\t\t}\r\n\r\n\t\tif ( geometry.boundingSphere !== null ) {\r\n\r\n\t\t\tthis.boundingSphere = geometry.boundingSphere.clone();\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcenter: function () {\r\n\r\n\t\tthis.computeBoundingBox();\r\n\r\n\t\tvar offset = this.boundingBox.center().negate();\r\n\r\n\t\tthis.translate( offset.x, offset.y, offset.z );\r\n\r\n\t\treturn offset;\r\n\r\n\t},\r\n\r\n\tnormalize: function () {\r\n\r\n\t\tthis.computeBoundingSphere();\r\n\r\n\t\tvar center = this.boundingSphere.center;\r\n\t\tvar radius = this.boundingSphere.radius;\r\n\r\n\t\tvar s = radius === 0 ? 1 : 1.0 / radius;\r\n\r\n\t\tvar matrix = new THREE.Matrix4();\r\n\t\tmatrix.set(\r\n\t\t\ts, 0, 0, - s * center.x,\r\n\t\t\t0, s, 0, - s * center.y,\r\n\t\t\t0, 0, s, - s * center.z,\r\n\t\t\t0, 0, 0, 1\r\n\t\t);\r\n\r\n\t\tthis.applyMatrix( matrix );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcomputeFaceNormals: function () {\r\n\r\n\t\tvar cb = new THREE.Vector3(), ab = new THREE.Vector3();\r\n\r\n\t\tfor ( var f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\tvar face = this.faces[ f ];\r\n\r\n\t\t\tvar vA = this.vertices[ face.a ];\r\n\t\t\tvar vB = this.vertices[ face.b ];\r\n\t\t\tvar vC = this.vertices[ face.c ];\r\n\r\n\t\t\tcb.subVectors( vC, vB );\r\n\t\t\tab.subVectors( vA, vB );\r\n\t\t\tcb.cross( ab );\r\n\r\n\t\t\tcb.normalize();\r\n\r\n\t\t\tface.normal.copy( cb );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tcomputeVertexNormals: function ( areaWeighted ) {\r\n\r\n\t\tif ( areaWeighted === undefined ) areaWeighted = true;\r\n\r\n\t\tvar v, vl, f, fl, face, vertices;\r\n\r\n\t\tvertices = new Array( this.vertices.length );\r\n\r\n\t\tfor ( v = 0, vl = this.vertices.length; v < vl; v ++ ) {\r\n\r\n\t\t\tvertices[ v ] = new THREE.Vector3();\r\n\r\n\t\t}\r\n\r\n\t\tif ( areaWeighted ) {\r\n\r\n\t\t\t// vertex normals weighted by triangle areas\r\n\t\t\t// http://www.iquilezles.org/www/articles/normals/normals.htm\r\n\r\n\t\t\tvar vA, vB, vC;\r\n\t\t\tvar cb = new THREE.Vector3(), ab = new THREE.Vector3();\r\n\r\n\t\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\tface = this.faces[ f ];\r\n\r\n\t\t\t\tvA = this.vertices[ face.a ];\r\n\t\t\t\tvB = this.vertices[ face.b ];\r\n\t\t\t\tvC = this.vertices[ face.c ];\r\n\r\n\t\t\t\tcb.subVectors( vC, vB );\r\n\t\t\t\tab.subVectors( vA, vB );\r\n\t\t\t\tcb.cross( ab );\r\n\r\n\t\t\t\tvertices[ face.a ].add( cb );\r\n\t\t\t\tvertices[ face.b ].add( cb );\r\n\t\t\t\tvertices[ face.c ].add( cb );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\tface = this.faces[ f ];\r\n\r\n\t\t\t\tvertices[ face.a ].add( face.normal );\r\n\t\t\t\tvertices[ face.b ].add( face.normal );\r\n\t\t\t\tvertices[ face.c ].add( face.normal );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfor ( v = 0, vl = this.vertices.length; v < vl; v ++ ) {\r\n\r\n\t\t\tvertices[ v ].normalize();\r\n\r\n\t\t}\r\n\r\n\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\tface = this.faces[ f ];\r\n\r\n\t\t\tvar vertexNormals = face.vertexNormals;\r\n\r\n\t\t\tif ( vertexNormals.length === 3 ) {\r\n\r\n\t\t\t\tvertexNormals[ 0 ].copy( vertices[ face.a ] );\r\n\t\t\t\tvertexNormals[ 1 ].copy( vertices[ face.b ] );\r\n\t\t\t\tvertexNormals[ 2 ].copy( vertices[ face.c ] );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tvertexNormals[ 0 ] = vertices[ face.a ].clone();\r\n\t\t\t\tvertexNormals[ 1 ] = vertices[ face.b ].clone();\r\n\t\t\t\tvertexNormals[ 2 ] = vertices[ face.c ].clone();\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.faces.length > 0 ) {\r\n\r\n\t\t\tthis.normalsNeedUpdate = true;\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tcomputeMorphNormals: function () {\r\n\r\n\t\tvar i, il, f, fl, face;\r\n\r\n\t\t// save original normals\r\n\t\t// - create temp variables on first access\r\n\t\t//   otherwise just copy (for faster repeated calls)\r\n\r\n\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\tface = this.faces[ f ];\r\n\r\n\t\t\tif ( ! face.__originalFaceNormal ) {\r\n\r\n\t\t\t\tface.__originalFaceNormal = face.normal.clone();\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tface.__originalFaceNormal.copy( face.normal );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( ! face.__originalVertexNormals ) face.__originalVertexNormals = [];\r\n\r\n\t\t\tfor ( i = 0, il = face.vertexNormals.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tif ( ! face.__originalVertexNormals[ i ] ) {\r\n\r\n\t\t\t\t\tface.__originalVertexNormals[ i ] = face.vertexNormals[ i ].clone();\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tface.__originalVertexNormals[ i ].copy( face.vertexNormals[ i ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// use temp geometry to compute face and vertex normals for each morph\r\n\r\n\t\tvar tmpGeo = new THREE.Geometry();\r\n\t\ttmpGeo.faces = this.faces;\r\n\r\n\t\tfor ( i = 0, il = this.morphTargets.length; i < il; i ++ ) {\r\n\r\n\t\t\t// create on first access\r\n\r\n\t\t\tif ( ! this.morphNormals[ i ] ) {\r\n\r\n\t\t\t\tthis.morphNormals[ i ] = {};\r\n\t\t\t\tthis.morphNormals[ i ].faceNormals = [];\r\n\t\t\t\tthis.morphNormals[ i ].vertexNormals = [];\r\n\r\n\t\t\t\tvar dstNormalsFace = this.morphNormals[ i ].faceNormals;\r\n\t\t\t\tvar dstNormalsVertex = this.morphNormals[ i ].vertexNormals;\r\n\r\n\t\t\t\tvar faceNormal, vertexNormals;\r\n\r\n\t\t\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\t\tfaceNormal = new THREE.Vector3();\r\n\t\t\t\t\tvertexNormals = { a: new THREE.Vector3(), b: new THREE.Vector3(), c: new THREE.Vector3() };\r\n\r\n\t\t\t\t\tdstNormalsFace.push( faceNormal );\r\n\t\t\t\t\tdstNormalsVertex.push( vertexNormals );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar morphNormals = this.morphNormals[ i ];\r\n\r\n\t\t\t// set vertices to morph target\r\n\r\n\t\t\ttmpGeo.vertices = this.morphTargets[ i ].vertices;\r\n\r\n\t\t\t// compute morph normals\r\n\r\n\t\t\ttmpGeo.computeFaceNormals();\r\n\t\t\ttmpGeo.computeVertexNormals();\r\n\r\n\t\t\t// store morph normals\r\n\r\n\t\t\tvar faceNormal, vertexNormals;\r\n\r\n\t\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\tface = this.faces[ f ];\r\n\r\n\t\t\t\tfaceNormal = morphNormals.faceNormals[ f ];\r\n\t\t\t\tvertexNormals = morphNormals.vertexNormals[ f ];\r\n\r\n\t\t\t\tfaceNormal.copy( face.normal );\r\n\r\n\t\t\t\tvertexNormals.a.copy( face.vertexNormals[ 0 ] );\r\n\t\t\t\tvertexNormals.b.copy( face.vertexNormals[ 1 ] );\r\n\t\t\t\tvertexNormals.c.copy( face.vertexNormals[ 2 ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// restore original normals\r\n\r\n\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\tface = this.faces[ f ];\r\n\r\n\t\t\tface.normal = face.__originalFaceNormal;\r\n\t\t\tface.vertexNormals = face.__originalVertexNormals;\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tcomputeTangents: function () {\r\n\r\n\t\tconsole.warn( 'THREE.Geometry: .computeTangents() has been removed.' );\r\n\r\n\t},\r\n\r\n\tcomputeLineDistances: function () {\r\n\r\n\t\tvar d = 0;\r\n\t\tvar vertices = this.vertices;\r\n\r\n\t\tfor ( var i = 0, il = vertices.length; i < il; i ++ ) {\r\n\r\n\t\t\tif ( i > 0 ) {\r\n\r\n\t\t\t\td += vertices[ i ].distanceTo( vertices[ i - 1 ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.lineDistances[ i ] = d;\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tcomputeBoundingBox: function () {\r\n\r\n\t\tif ( this.boundingBox === null ) {\r\n\r\n\t\t\tthis.boundingBox = new THREE.Box3();\r\n\r\n\t\t}\r\n\r\n\t\tthis.boundingBox.setFromPoints( this.vertices );\r\n\r\n\t},\r\n\r\n\tcomputeBoundingSphere: function () {\r\n\r\n\t\tif ( this.boundingSphere === null ) {\r\n\r\n\t\t\tthis.boundingSphere = new THREE.Sphere();\r\n\r\n\t\t}\r\n\r\n\t\tthis.boundingSphere.setFromPoints( this.vertices );\r\n\r\n\t},\r\n\r\n\tmerge: function ( geometry, matrix, materialIndexOffset ) {\r\n\r\n\t\tif ( geometry instanceof THREE.Geometry === false ) {\r\n\r\n\t\t\tconsole.error( 'THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.', geometry );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tvar normalMatrix,\r\n\t\tvertexOffset = this.vertices.length,\r\n\t\tvertices1 = this.vertices,\r\n\t\tvertices2 = geometry.vertices,\r\n\t\tfaces1 = this.faces,\r\n\t\tfaces2 = geometry.faces,\r\n\t\tuvs1 = this.faceVertexUvs[ 0 ],\r\n\t\tuvs2 = geometry.faceVertexUvs[ 0 ];\r\n\r\n\t\tif ( materialIndexOffset === undefined ) materialIndexOffset = 0;\r\n\r\n\t\tif ( matrix !== undefined ) {\r\n\r\n\t\t\tnormalMatrix = new THREE.Matrix3().getNormalMatrix( matrix );\r\n\r\n\t\t}\r\n\r\n\t\t// vertices\r\n\r\n\t\tfor ( var i = 0, il = vertices2.length; i < il; i ++ ) {\r\n\r\n\t\t\tvar vertex = vertices2[ i ];\r\n\r\n\t\t\tvar vertexCopy = vertex.clone();\r\n\r\n\t\t\tif ( matrix !== undefined ) vertexCopy.applyMatrix4( matrix );\r\n\r\n\t\t\tvertices1.push( vertexCopy );\r\n\r\n\t\t}\r\n\r\n\t\t// faces\r\n\r\n\t\tfor ( i = 0, il = faces2.length; i < il; i ++ ) {\r\n\r\n\t\t\tvar face = faces2[ i ], faceCopy, normal, color,\r\n\t\t\tfaceVertexNormals = face.vertexNormals,\r\n\t\t\tfaceVertexColors = face.vertexColors;\r\n\r\n\t\t\tfaceCopy = new THREE.Face3( face.a + vertexOffset, face.b + vertexOffset, face.c + vertexOffset );\r\n\t\t\tfaceCopy.normal.copy( face.normal );\r\n\r\n\t\t\tif ( normalMatrix !== undefined ) {\r\n\r\n\t\t\t\tfaceCopy.normal.applyMatrix3( normalMatrix ).normalize();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var j = 0, jl = faceVertexNormals.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\tnormal = faceVertexNormals[ j ].clone();\r\n\r\n\t\t\t\tif ( normalMatrix !== undefined ) {\r\n\r\n\t\t\t\t\tnormal.applyMatrix3( normalMatrix ).normalize();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfaceCopy.vertexNormals.push( normal );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfaceCopy.color.copy( face.color );\r\n\r\n\t\t\tfor ( var j = 0, jl = faceVertexColors.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\tcolor = faceVertexColors[ j ];\r\n\t\t\t\tfaceCopy.vertexColors.push( color.clone() );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfaceCopy.materialIndex = face.materialIndex + materialIndexOffset;\r\n\r\n\t\t\tfaces1.push( faceCopy );\r\n\r\n\t\t}\r\n\r\n\t\t// uvs\r\n\r\n\t\tfor ( i = 0, il = uvs2.length; i < il; i ++ ) {\r\n\r\n\t\t\tvar uv = uvs2[ i ], uvCopy = [];\r\n\r\n\t\t\tif ( uv === undefined ) {\r\n\r\n\t\t\t\tcontinue;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var j = 0, jl = uv.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\tuvCopy.push( uv[ j ].clone() );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tuvs1.push( uvCopy );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tmergeMesh: function ( mesh ) {\r\n\r\n\t\tif ( mesh instanceof THREE.Mesh === false ) {\r\n\r\n\t\t\tconsole.error( 'THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.', mesh );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tmesh.matrixAutoUpdate && mesh.updateMatrix();\r\n\r\n\t\tthis.merge( mesh.geometry, mesh.matrix );\r\n\r\n\t},\r\n\r\n\t/*\r\n\t * Checks for duplicate vertices with hashmap.\r\n\t * Duplicated vertices are removed\r\n\t * and faces' vertices are updated.\r\n\t */\r\n\r\n\tmergeVertices: function () {\r\n\r\n\t\tvar verticesMap = {}; // Hashmap for looking up vertices by position coordinates (and making sure they are unique)\r\n\t\tvar unique = [], changes = [];\r\n\r\n\t\tvar v, key;\r\n\t\tvar precisionPoints = 4; // number of decimal points, e.g. 4 for epsilon of 0.0001\r\n\t\tvar precision = Math.pow( 10, precisionPoints );\r\n\t\tvar i, il, face;\r\n\t\tvar indices, j, jl;\r\n\r\n\t\tfor ( i = 0, il = this.vertices.length; i < il; i ++ ) {\r\n\r\n\t\t\tv = this.vertices[ i ];\r\n\t\t\tkey = Math.round( v.x * precision ) + '_' + Math.round( v.y * precision ) + '_' + Math.round( v.z * precision );\r\n\r\n\t\t\tif ( verticesMap[ key ] === undefined ) {\r\n\r\n\t\t\t\tverticesMap[ key ] = i;\r\n\t\t\t\tunique.push( this.vertices[ i ] );\r\n\t\t\t\tchanges[ i ] = unique.length - 1;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t//console.log('Duplicate vertex found. ', i, ' could be using ', verticesMap[key]);\r\n\t\t\t\tchanges[ i ] = changes[ verticesMap[ key ] ];\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\r\n\t\t// if faces are completely degenerate after merging vertices, we\r\n\t\t// have to remove them from the geometry.\r\n\t\tvar faceIndicesToRemove = [];\r\n\r\n\t\tfor ( i = 0, il = this.faces.length; i < il; i ++ ) {\r\n\r\n\t\t\tface = this.faces[ i ];\r\n\r\n\t\t\tface.a = changes[ face.a ];\r\n\t\t\tface.b = changes[ face.b ];\r\n\t\t\tface.c = changes[ face.c ];\r\n\r\n\t\t\tindices = [ face.a, face.b, face.c ];\r\n\r\n\t\t\tvar dupIndex = - 1;\r\n\r\n\t\t\t// if any duplicate vertices are found in a Face3\r\n\t\t\t// we have to remove the face as nothing can be saved\r\n\t\t\tfor ( var n = 0; n < 3; n ++ ) {\r\n\r\n\t\t\t\tif ( indices[ n ] === indices[ ( n + 1 ) % 3 ] ) {\r\n\r\n\t\t\t\t\tdupIndex = n;\r\n\t\t\t\t\tfaceIndicesToRemove.push( i );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfor ( i = faceIndicesToRemove.length - 1; i >= 0; i -- ) {\r\n\r\n\t\t\tvar idx = faceIndicesToRemove[ i ];\r\n\r\n\t\t\tthis.faces.splice( idx, 1 );\r\n\r\n\t\t\tfor ( j = 0, jl = this.faceVertexUvs.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\tthis.faceVertexUvs[ j ].splice( idx, 1 );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// Use unique set of vertices\r\n\r\n\t\tvar diff = this.vertices.length - unique.length;\r\n\t\tthis.vertices = unique;\r\n\t\treturn diff;\r\n\r\n\t},\r\n\r\n\tsortFacesByMaterialIndex: function () {\r\n\r\n\t\tvar faces = this.faces;\r\n\t\tvar length = faces.length;\r\n\r\n\t\t// tag faces\r\n\r\n\t\tfor ( var i = 0; i < length; i ++ ) {\r\n\r\n\t\t\tfaces[ i ]._id = i;\r\n\r\n\t\t}\r\n\r\n\t\t// sort faces\r\n\r\n\t\tfunction materialIndexSort( a, b ) {\r\n\r\n\t\t\treturn a.materialIndex - b.materialIndex;\r\n\r\n\t\t}\r\n\r\n\t\tfaces.sort( materialIndexSort );\r\n\r\n\t\t// sort uvs\r\n\r\n\t\tvar uvs1 = this.faceVertexUvs[ 0 ];\r\n\t\tvar uvs2 = this.faceVertexUvs[ 1 ];\r\n\r\n\t\tvar newUvs1, newUvs2;\r\n\r\n\t\tif ( uvs1 && uvs1.length === length ) newUvs1 = [];\r\n\t\tif ( uvs2 && uvs2.length === length ) newUvs2 = [];\r\n\r\n\t\tfor ( var i = 0; i < length; i ++ ) {\r\n\r\n\t\t\tvar id = faces[ i ]._id;\r\n\r\n\t\t\tif ( newUvs1 ) newUvs1.push( uvs1[ id ] );\r\n\t\t\tif ( newUvs2 ) newUvs2.push( uvs2[ id ] );\r\n\r\n\t\t}\r\n\r\n\t\tif ( newUvs1 ) this.faceVertexUvs[ 0 ] = newUvs1;\r\n\t\tif ( newUvs2 ) this.faceVertexUvs[ 1 ] = newUvs2;\r\n\r\n\t},\r\n\r\n\ttoJSON: function () {\r\n\r\n\t\tvar data = {\r\n\t\t\tmetadata: {\r\n\t\t\t\tversion: 4.4,\r\n\t\t\t\ttype: 'Geometry',\r\n\t\t\t\tgenerator: 'Geometry.toJSON'\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\t// standard Geometry serialization\r\n\r\n\t\tdata.uuid = this.uuid;\r\n\t\tdata.type = this.type;\r\n\t\tif ( this.name !== '' ) data.name = this.name;\r\n\r\n\t\tif ( this.parameters !== undefined ) {\r\n\r\n\t\t\tvar parameters = this.parameters;\r\n\r\n\t\t\tfor ( var key in parameters ) {\r\n\r\n\t\t\t\tif ( parameters[ key ] !== undefined ) data[ key ] = parameters[ key ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t}\r\n\r\n\t\tvar vertices = [];\r\n\r\n\t\tfor ( var i = 0; i < this.vertices.length; i ++ ) {\r\n\r\n\t\t\tvar vertex = this.vertices[ i ];\r\n\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\r\n\r\n\t\t}\r\n\r\n\t\tvar faces = [];\r\n\t\tvar normals = [];\r\n\t\tvar normalsHash = {};\r\n\t\tvar colors = [];\r\n\t\tvar colorsHash = {};\r\n\t\tvar uvs = [];\r\n\t\tvar uvsHash = {};\r\n\r\n\t\tfor ( var i = 0; i < this.faces.length; i ++ ) {\r\n\r\n\t\t\tvar face = this.faces[ i ];\r\n\r\n\t\t\tvar hasMaterial = true;\r\n\t\t\tvar hasFaceUv = false; // deprecated\r\n\t\t\tvar hasFaceVertexUv = this.faceVertexUvs[ 0 ][ i ] !== undefined;\r\n\t\t\tvar hasFaceNormal = face.normal.length() > 0;\r\n\t\t\tvar hasFaceVertexNormal = face.vertexNormals.length > 0;\r\n\t\t\tvar hasFaceColor = face.color.r !== 1 || face.color.g !== 1 || face.color.b !== 1;\r\n\t\t\tvar hasFaceVertexColor = face.vertexColors.length > 0;\r\n\r\n\t\t\tvar faceType = 0;\r\n\r\n\t\t\tfaceType = setBit( faceType, 0, 0 ); // isQuad\r\n\t\t\tfaceType = setBit( faceType, 1, hasMaterial );\r\n\t\t\tfaceType = setBit( faceType, 2, hasFaceUv );\r\n\t\t\tfaceType = setBit( faceType, 3, hasFaceVertexUv );\r\n\t\t\tfaceType = setBit( faceType, 4, hasFaceNormal );\r\n\t\t\tfaceType = setBit( faceType, 5, hasFaceVertexNormal );\r\n\t\t\tfaceType = setBit( faceType, 6, hasFaceColor );\r\n\t\t\tfaceType = setBit( faceType, 7, hasFaceVertexColor );\r\n\r\n\t\t\tfaces.push( faceType );\r\n\t\t\tfaces.push( face.a, face.b, face.c );\r\n\t\t\tfaces.push( face.materialIndex );\r\n\r\n\t\t\tif ( hasFaceVertexUv ) {\r\n\r\n\t\t\t\tvar faceVertexUvs = this.faceVertexUvs[ 0 ][ i ];\r\n\r\n\t\t\t\tfaces.push(\r\n\t\t\t\t\tgetUvIndex( faceVertexUvs[ 0 ] ),\r\n\t\t\t\t\tgetUvIndex( faceVertexUvs[ 1 ] ),\r\n\t\t\t\t\tgetUvIndex( faceVertexUvs[ 2 ] )\r\n\t\t\t\t);\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( hasFaceNormal ) {\r\n\r\n\t\t\t\tfaces.push( getNormalIndex( face.normal ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( hasFaceVertexNormal ) {\r\n\r\n\t\t\t\tvar vertexNormals = face.vertexNormals;\r\n\r\n\t\t\t\tfaces.push(\r\n\t\t\t\t\tgetNormalIndex( vertexNormals[ 0 ] ),\r\n\t\t\t\t\tgetNormalIndex( vertexNormals[ 1 ] ),\r\n\t\t\t\t\tgetNormalIndex( vertexNormals[ 2 ] )\r\n\t\t\t\t);\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( hasFaceColor ) {\r\n\r\n\t\t\t\tfaces.push( getColorIndex( face.color ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( hasFaceVertexColor ) {\r\n\r\n\t\t\t\tvar vertexColors = face.vertexColors;\r\n\r\n\t\t\t\tfaces.push(\r\n\t\t\t\t\tgetColorIndex( vertexColors[ 0 ] ),\r\n\t\t\t\t\tgetColorIndex( vertexColors[ 1 ] ),\r\n\t\t\t\t\tgetColorIndex( vertexColors[ 2 ] )\r\n\t\t\t\t);\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction setBit( value, position, enabled ) {\r\n\r\n\t\t\treturn enabled ? value | ( 1 << position ) : value & ( ~ ( 1 << position ) );\r\n\r\n\t\t}\r\n\r\n\t\tfunction getNormalIndex( normal ) {\r\n\r\n\t\t\tvar hash = normal.x.toString() + normal.y.toString() + normal.z.toString();\r\n\r\n\t\t\tif ( normalsHash[ hash ] !== undefined ) {\r\n\r\n\t\t\t\treturn normalsHash[ hash ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tnormalsHash[ hash ] = normals.length / 3;\r\n\t\t\tnormals.push( normal.x, normal.y, normal.z );\r\n\r\n\t\t\treturn normalsHash[ hash ];\r\n\r\n\t\t}\r\n\r\n\t\tfunction getColorIndex( color ) {\r\n\r\n\t\t\tvar hash = color.r.toString() + color.g.toString() + color.b.toString();\r\n\r\n\t\t\tif ( colorsHash[ hash ] !== undefined ) {\r\n\r\n\t\t\t\treturn colorsHash[ hash ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tcolorsHash[ hash ] = colors.length;\r\n\t\t\tcolors.push( color.getHex() );\r\n\r\n\t\t\treturn colorsHash[ hash ];\r\n\r\n\t\t}\r\n\r\n\t\tfunction getUvIndex( uv ) {\r\n\r\n\t\t\tvar hash = uv.x.toString() + uv.y.toString();\r\n\r\n\t\t\tif ( uvsHash[ hash ] !== undefined ) {\r\n\r\n\t\t\t\treturn uvsHash[ hash ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tuvsHash[ hash ] = uvs.length / 2;\r\n\t\t\tuvs.push( uv.x, uv.y );\r\n\r\n\t\t\treturn uvsHash[ hash ];\r\n\r\n\t\t}\r\n\r\n\t\tdata.data = {};\r\n\r\n\t\tdata.data.vertices = vertices;\r\n\t\tdata.data.normals = normals;\r\n\t\tif ( colors.length > 0 ) data.data.colors = colors;\r\n\t\tif ( uvs.length > 0 ) data.data.uvs = [ uvs ]; // temporal backward compatibility\r\n\t\tdata.data.faces = faces;\r\n\r\n\t\treturn data;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\t/*\r\n\t\t// Handle primitives\r\n\r\n\t\tvar parameters = this.parameters;\r\n\r\n\t\tif ( parameters !== undefined ) {\r\n\r\n\t\t\tvar values = [];\r\n\r\n\t\t\tfor ( var key in parameters ) {\r\n\r\n\t\t\t\tvalues.push( parameters[ key ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar geometry = Object.create( this.constructor.prototype );\r\n\t\t\tthis.constructor.apply( geometry, values );\r\n\t\t\treturn geometry;\r\n\r\n\t\t}\r\n\r\n\t\treturn new this.constructor().copy( this );\r\n\t\t*/\r\n\r\n\t\treturn new THREE.Geometry().copy( this );\r\n\r\n\t},\r\n\r\n\tcopy: function ( source ) {\r\n\r\n\t\tthis.vertices = [];\r\n\t\tthis.faces = [];\r\n\t\tthis.faceVertexUvs = [ [] ];\r\n\r\n\t\tvar vertices = source.vertices;\r\n\r\n\t\tfor ( var i = 0, il = vertices.length; i < il; i ++ ) {\r\n\r\n\t\t\tthis.vertices.push( vertices[ i ].clone() );\r\n\r\n\t\t}\r\n\r\n\t\tvar faces = source.faces;\r\n\r\n\t\tfor ( var i = 0, il = faces.length; i < il; i ++ ) {\r\n\r\n\t\t\tthis.faces.push( faces[ i ].clone() );\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var i = 0, il = source.faceVertexUvs.length; i < il; i ++ ) {\r\n\r\n\t\t\tvar faceVertexUvs = source.faceVertexUvs[ i ];\r\n\r\n\t\t\tif ( this.faceVertexUvs[ i ] === undefined ) {\r\n\r\n\t\t\t\tthis.faceVertexUvs[ i ] = [];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var j = 0, jl = faceVertexUvs.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\tvar uvs = faceVertexUvs[ j ], uvsCopy = [];\r\n\r\n\t\t\t\tfor ( var k = 0, kl = uvs.length; k < kl; k ++ ) {\r\n\r\n\t\t\t\t\tvar uv = uvs[ k ];\r\n\r\n\t\t\t\t\tuvsCopy.push( uv.clone() );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.faceVertexUvs[ i ].push( uvsCopy );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdispose: function () {\r\n\r\n\t\tthis.dispatchEvent( { type: 'dispose' } );\r\n\r\n\t}\r\n\r\n} );\r\n\r\nTHREE.GeometryIdCount = 0;\r\n\r\n// File:src/core/DirectGeometry.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.DirectGeometry = function () {\r\n\r\n\tObject.defineProperty( this, 'id', { value: THREE.GeometryIdCount ++ } );\r\n\r\n\tthis.uuid = THREE.Math.generateUUID();\r\n\r\n\tthis.name = '';\r\n\tthis.type = 'DirectGeometry';\r\n\r\n\tthis.indices = [];\r\n\tthis.vertices = [];\r\n\tthis.normals = [];\r\n\tthis.colors = [];\r\n\tthis.uvs = [];\r\n\tthis.uvs2 = [];\r\n\r\n\tthis.groups = [];\r\n\r\n\tthis.morphTargets = {};\r\n\r\n\tthis.skinWeights = [];\r\n\tthis.skinIndices = [];\r\n\r\n\t// this.lineDistances = [];\r\n\r\n\tthis.boundingBox = null;\r\n\tthis.boundingSphere = null;\r\n\r\n\t// update flags\r\n\r\n\tthis.verticesNeedUpdate = false;\r\n\tthis.normalsNeedUpdate = false;\r\n\tthis.colorsNeedUpdate = false;\r\n\tthis.uvsNeedUpdate = false;\r\n\tthis.groupsNeedUpdate = false;\r\n\r\n};\r\n\r\nObject.assign( THREE.DirectGeometry.prototype, THREE.EventDispatcher.prototype, {\r\n\r\n\tcomputeBoundingBox: THREE.Geometry.prototype.computeBoundingBox,\r\n\tcomputeBoundingSphere: THREE.Geometry.prototype.computeBoundingSphere,\r\n\r\n\tcomputeFaceNormals: function () {\r\n\r\n\t\tconsole.warn( 'THREE.DirectGeometry: computeFaceNormals() is not a method of this type of geometry.' );\r\n\r\n\t},\r\n\r\n\tcomputeVertexNormals: function () {\r\n\r\n\t\tconsole.warn( 'THREE.DirectGeometry: computeVertexNormals() is not a method of this type of geometry.' );\r\n\r\n\t},\r\n\r\n\tcomputeGroups: function ( geometry ) {\r\n\r\n\t\tvar group;\r\n\t\tvar groups = [];\r\n\t\tvar materialIndex;\r\n\r\n\t\tvar faces = geometry.faces;\r\n\r\n\t\tfor ( var i = 0; i < faces.length; i ++ ) {\r\n\r\n\t\t\tvar face = faces[ i ];\r\n\r\n\t\t\t// materials\r\n\r\n\t\t\tif ( face.materialIndex !== materialIndex ) {\r\n\r\n\t\t\t\tmaterialIndex = face.materialIndex;\r\n\r\n\t\t\t\tif ( group !== undefined ) {\r\n\r\n\t\t\t\t\tgroup.count = ( i * 3 ) - group.start;\r\n\t\t\t\t\tgroups.push( group );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tgroup = {\r\n\t\t\t\t\tstart: i * 3,\r\n\t\t\t\t\tmaterialIndex: materialIndex\r\n\t\t\t\t};\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( group !== undefined ) {\r\n\r\n\t\t\tgroup.count = ( i * 3 ) - group.start;\r\n\t\t\tgroups.push( group );\r\n\r\n\t\t}\r\n\r\n\t\tthis.groups = groups;\r\n\r\n\t},\r\n\r\n\tfromGeometry: function ( geometry ) {\r\n\r\n\t\tvar faces = geometry.faces;\r\n\t\tvar vertices = geometry.vertices;\r\n\t\tvar faceVertexUvs = geometry.faceVertexUvs;\r\n\r\n\t\tvar hasFaceVertexUv = faceVertexUvs[ 0 ] && faceVertexUvs[ 0 ].length > 0;\r\n\t\tvar hasFaceVertexUv2 = faceVertexUvs[ 1 ] && faceVertexUvs[ 1 ].length > 0;\r\n\r\n\t\t// morphs\r\n\r\n\t\tvar morphTargets = geometry.morphTargets;\r\n\t\tvar morphTargetsLength = morphTargets.length;\r\n\r\n\t\tvar morphTargetsPosition;\r\n\r\n\t\tif ( morphTargetsLength > 0 ) {\r\n\r\n\t\t\tmorphTargetsPosition = [];\r\n\r\n\t\t\tfor ( var i = 0; i < morphTargetsLength; i ++ ) {\r\n\r\n\t\t\t\tmorphTargetsPosition[ i ] = [];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.morphTargets.position = morphTargetsPosition;\r\n\r\n\t\t}\r\n\r\n\t\tvar morphNormals = geometry.morphNormals;\r\n\t\tvar morphNormalsLength = morphNormals.length;\r\n\r\n\t\tvar morphTargetsNormal;\r\n\r\n\t\tif ( morphNormalsLength > 0 ) {\r\n\r\n\t\t\tmorphTargetsNormal = [];\r\n\r\n\t\t\tfor ( var i = 0; i < morphNormalsLength; i ++ ) {\r\n\r\n\t\t\t\tmorphTargetsNormal[ i ] = [];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.morphTargets.normal = morphTargetsNormal;\r\n\r\n\t\t}\r\n\r\n\t\t// skins\r\n\r\n\t\tvar skinIndices = geometry.skinIndices;\r\n\t\tvar skinWeights = geometry.skinWeights;\r\n\r\n\t\tvar hasSkinIndices = skinIndices.length === vertices.length;\r\n\t\tvar hasSkinWeights = skinWeights.length === vertices.length;\r\n\r\n\t\t//\r\n\r\n\t\tfor ( var i = 0; i < faces.length; i ++ ) {\r\n\r\n\t\t\tvar face = faces[ i ];\r\n\r\n\t\t\tthis.vertices.push( vertices[ face.a ], vertices[ face.b ], vertices[ face.c ] );\r\n\r\n\t\t\tvar vertexNormals = face.vertexNormals;\r\n\r\n\t\t\tif ( vertexNormals.length === 3 ) {\r\n\r\n\t\t\t\tthis.normals.push( vertexNormals[ 0 ], vertexNormals[ 1 ], vertexNormals[ 2 ] );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tvar normal = face.normal;\r\n\r\n\t\t\t\tthis.normals.push( normal, normal, normal );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar vertexColors = face.vertexColors;\r\n\r\n\t\t\tif ( vertexColors.length === 3 ) {\r\n\r\n\t\t\t\tthis.colors.push( vertexColors[ 0 ], vertexColors[ 1 ], vertexColors[ 2 ] );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tvar color = face.color;\r\n\r\n\t\t\t\tthis.colors.push( color, color, color );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( hasFaceVertexUv === true ) {\r\n\r\n\t\t\t\tvar vertexUvs = faceVertexUvs[ 0 ][ i ];\r\n\r\n\t\t\t\tif ( vertexUvs !== undefined ) {\r\n\r\n\t\t\t\t\tthis.uvs.push( vertexUvs[ 0 ], vertexUvs[ 1 ], vertexUvs[ 2 ] );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ', i );\r\n\r\n\t\t\t\t\tthis.uvs.push( new THREE.Vector2(), new THREE.Vector2(), new THREE.Vector2() );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( hasFaceVertexUv2 === true ) {\r\n\r\n\t\t\t\tvar vertexUvs = faceVertexUvs[ 1 ][ i ];\r\n\r\n\t\t\t\tif ( vertexUvs !== undefined ) {\r\n\r\n\t\t\t\t\tthis.uvs2.push( vertexUvs[ 0 ], vertexUvs[ 1 ], vertexUvs[ 2 ] );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ', i );\r\n\r\n\t\t\t\t\tthis.uvs2.push( new THREE.Vector2(), new THREE.Vector2(), new THREE.Vector2() );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// morphs\r\n\r\n\t\t\tfor ( var j = 0; j < morphTargetsLength; j ++ ) {\r\n\r\n\t\t\t\tvar morphTarget = morphTargets[ j ].vertices;\r\n\r\n\t\t\t\tmorphTargetsPosition[ j ].push( morphTarget[ face.a ], morphTarget[ face.b ], morphTarget[ face.c ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var j = 0; j < morphNormalsLength; j ++ ) {\r\n\r\n\t\t\t\tvar morphNormal = morphNormals[ j ].vertexNormals[ i ];\r\n\r\n\t\t\t\tmorphTargetsNormal[ j ].push( morphNormal.a, morphNormal.b, morphNormal.c );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// skins\r\n\r\n\t\t\tif ( hasSkinIndices ) {\r\n\r\n\t\t\t\tthis.skinIndices.push( skinIndices[ face.a ], skinIndices[ face.b ], skinIndices[ face.c ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( hasSkinWeights ) {\r\n\r\n\t\t\t\tthis.skinWeights.push( skinWeights[ face.a ], skinWeights[ face.b ], skinWeights[ face.c ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tthis.computeGroups( geometry );\r\n\r\n\t\tthis.verticesNeedUpdate = geometry.verticesNeedUpdate;\r\n\t\tthis.normalsNeedUpdate = geometry.normalsNeedUpdate;\r\n\t\tthis.colorsNeedUpdate = geometry.colorsNeedUpdate;\r\n\t\tthis.uvsNeedUpdate = geometry.uvsNeedUpdate;\r\n\t\tthis.groupsNeedUpdate = geometry.groupsNeedUpdate;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdispose: function () {\r\n\r\n\t\tthis.dispatchEvent( { type: 'dispose' } );\r\n\r\n\t}\r\n\r\n} );\r\n\r\n// File:src/core/BufferGeometry.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.BufferGeometry = function () {\r\n\r\n\tObject.defineProperty( this, 'id', { value: THREE.GeometryIdCount ++ } );\r\n\r\n\tthis.uuid = THREE.Math.generateUUID();\r\n\r\n\tthis.name = '';\r\n\tthis.type = 'BufferGeometry';\r\n\r\n\tthis.index = null;\r\n\tthis.attributes = {};\r\n\r\n\tthis.morphAttributes = {};\r\n\r\n\tthis.groups = [];\r\n\r\n\tthis.boundingBox = null;\r\n\tthis.boundingSphere = null;\r\n\r\n\tthis.drawRange = { start: 0, count: Infinity };\r\n\r\n};\r\n\r\nObject.assign( THREE.BufferGeometry.prototype, THREE.EventDispatcher.prototype, {\r\n\r\n\tgetIndex: function () {\r\n\r\n\t\treturn this.index;\r\n\r\n\t},\r\n\r\n\tsetIndex: function ( index ) {\r\n\r\n\t\tthis.index = index;\r\n\r\n\t},\r\n\r\n\taddAttribute: function ( name, attribute ) {\r\n\r\n\t\tif ( attribute instanceof THREE.BufferAttribute === false && attribute instanceof THREE.InterleavedBufferAttribute === false ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.BufferGeometry: .addAttribute() now expects ( name, attribute ).' );\r\n\r\n\t\t\tthis.addAttribute( name, new THREE.BufferAttribute( arguments[ 1 ], arguments[ 2 ] ) );\r\n\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tif ( name === 'index' ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute.' );\r\n\t\t\tthis.setIndex( attribute );\r\n\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tthis.attributes[ name ] = attribute;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tgetAttribute: function ( name ) {\r\n\r\n\t\treturn this.attributes[ name ];\r\n\r\n\t},\r\n\r\n\tremoveAttribute: function ( name ) {\r\n\r\n\t\tdelete this.attributes[ name ];\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\taddGroup: function ( start, count, materialIndex ) {\r\n\r\n\t\tthis.groups.push( {\r\n\r\n\t\t\tstart: start,\r\n\t\t\tcount: count,\r\n\t\t\tmaterialIndex: materialIndex !== undefined ? materialIndex : 0\r\n\r\n\t\t} );\r\n\r\n\t},\r\n\r\n\tclearGroups: function () {\r\n\r\n\t\tthis.groups = [];\r\n\r\n\t},\r\n\r\n\tsetDrawRange: function ( start, count ) {\r\n\r\n\t\tthis.drawRange.start = start;\r\n\t\tthis.drawRange.count = count;\r\n\r\n\t},\r\n\r\n\tapplyMatrix: function ( matrix ) {\r\n\r\n\t\tvar position = this.attributes.position;\r\n\r\n\t\tif ( position !== undefined ) {\r\n\r\n\t\t\tmatrix.applyToVector3Array( position.array );\r\n\t\t\tposition.needsUpdate = true;\r\n\r\n\t\t}\r\n\r\n\t\tvar normal = this.attributes.normal;\r\n\r\n\t\tif ( normal !== undefined ) {\r\n\r\n\t\t\tvar normalMatrix = new THREE.Matrix3().getNormalMatrix( matrix );\r\n\r\n\t\t\tnormalMatrix.applyToVector3Array( normal.array );\r\n\t\t\tnormal.needsUpdate = true;\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.boundingBox !== null ) {\r\n\r\n\t\t\tthis.computeBoundingBox();\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.boundingSphere !== null ) {\r\n\r\n\t\t\tthis.computeBoundingSphere();\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\trotateX: function () {\r\n\r\n\t\t// rotate geometry around world x-axis\r\n\r\n\t\tvar m1;\r\n\r\n\t\treturn function rotateX( angle ) {\r\n\r\n\t\t\tif ( m1 === undefined ) m1 = new THREE.Matrix4();\r\n\r\n\t\t\tm1.makeRotationX( angle );\r\n\r\n\t\t\tthis.applyMatrix( m1 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\trotateY: function () {\r\n\r\n\t\t// rotate geometry around world y-axis\r\n\r\n\t\tvar m1;\r\n\r\n\t\treturn function rotateY( angle ) {\r\n\r\n\t\t\tif ( m1 === undefined ) m1 = new THREE.Matrix4();\r\n\r\n\t\t\tm1.makeRotationY( angle );\r\n\r\n\t\t\tthis.applyMatrix( m1 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\trotateZ: function () {\r\n\r\n\t\t// rotate geometry around world z-axis\r\n\r\n\t\tvar m1;\r\n\r\n\t\treturn function rotateZ( angle ) {\r\n\r\n\t\t\tif ( m1 === undefined ) m1 = new THREE.Matrix4();\r\n\r\n\t\t\tm1.makeRotationZ( angle );\r\n\r\n\t\t\tthis.applyMatrix( m1 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\ttranslate: function () {\r\n\r\n\t\t// translate geometry\r\n\r\n\t\tvar m1;\r\n\r\n\t\treturn function translate( x, y, z ) {\r\n\r\n\t\t\tif ( m1 === undefined ) m1 = new THREE.Matrix4();\r\n\r\n\t\t\tm1.makeTranslation( x, y, z );\r\n\r\n\t\t\tthis.applyMatrix( m1 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tscale: function () {\r\n\r\n\t\t// scale geometry\r\n\r\n\t\tvar m1;\r\n\r\n\t\treturn function scale( x, y, z ) {\r\n\r\n\t\t\tif ( m1 === undefined ) m1 = new THREE.Matrix4();\r\n\r\n\t\t\tm1.makeScale( x, y, z );\r\n\r\n\t\t\tthis.applyMatrix( m1 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tlookAt: function () {\r\n\r\n\t\tvar obj;\r\n\r\n\t\treturn function lookAt( vector ) {\r\n\r\n\t\t\tif ( obj === undefined ) obj = new THREE.Object3D();\r\n\r\n\t\t\tobj.lookAt( vector );\r\n\r\n\t\t\tobj.updateMatrix();\r\n\r\n\t\t\tthis.applyMatrix( obj.matrix );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tcenter: function () {\r\n\r\n\t\tthis.computeBoundingBox();\r\n\r\n\t\tvar offset = this.boundingBox.center().negate();\r\n\r\n\t\tthis.translate( offset.x, offset.y, offset.z );\r\n\r\n\t\treturn offset;\r\n\r\n\t},\r\n\r\n\tsetFromObject: function ( object ) {\r\n\r\n\t\t// console.log( 'THREE.BufferGeometry.setFromObject(). Converting', object, this );\r\n\r\n\t\tvar geometry = object.geometry;\r\n\r\n\t\tif ( object instanceof THREE.Points || object instanceof THREE.Line ) {\r\n\r\n\t\t\tvar positions = new THREE.Float32Attribute( geometry.vertices.length * 3, 3 );\r\n\t\t\tvar colors = new THREE.Float32Attribute( geometry.colors.length * 3, 3 );\r\n\r\n\t\t\tthis.addAttribute( 'position', positions.copyVector3sArray( geometry.vertices ) );\r\n\t\t\tthis.addAttribute( 'color', colors.copyColorsArray( geometry.colors ) );\r\n\r\n\t\t\tif ( geometry.lineDistances && geometry.lineDistances.length === geometry.vertices.length ) {\r\n\r\n\t\t\t\tvar lineDistances = new THREE.Float32Attribute( geometry.lineDistances.length, 1 );\r\n\r\n\t\t\t\tthis.addAttribute( 'lineDistance', lineDistances.copyArray( geometry.lineDistances ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( geometry.boundingSphere !== null ) {\r\n\r\n\t\t\t\tthis.boundingSphere = geometry.boundingSphere.clone();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( geometry.boundingBox !== null ) {\r\n\r\n\t\t\t\tthis.boundingBox = geometry.boundingBox.clone();\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( object instanceof THREE.Mesh ) {\r\n\r\n\t\t\tif ( geometry instanceof THREE.Geometry ) {\r\n\r\n\t\t\t\tthis.fromGeometry( geometry );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tupdateFromObject: function ( object ) {\r\n\r\n\t\tvar geometry = object.geometry;\r\n\r\n\t\tif ( object instanceof THREE.Mesh ) {\r\n\r\n\t\t\tvar direct = geometry.__directGeometry;\r\n\r\n\t\t\tif ( direct === undefined ) {\r\n\r\n\t\t\t\treturn this.fromGeometry( geometry );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tdirect.verticesNeedUpdate = geometry.verticesNeedUpdate;\r\n\t\t\tdirect.normalsNeedUpdate = geometry.normalsNeedUpdate;\r\n\t\t\tdirect.colorsNeedUpdate = geometry.colorsNeedUpdate;\r\n\t\t\tdirect.uvsNeedUpdate = geometry.uvsNeedUpdate;\r\n\t\t\tdirect.groupsNeedUpdate = geometry.groupsNeedUpdate;\r\n\r\n\t\t\tgeometry.verticesNeedUpdate = false;\r\n\t\t\tgeometry.normalsNeedUpdate = false;\r\n\t\t\tgeometry.colorsNeedUpdate = false;\r\n\t\t\tgeometry.uvsNeedUpdate = false;\r\n\t\t\tgeometry.groupsNeedUpdate = false;\r\n\r\n\t\t\tgeometry = direct;\r\n\r\n\t\t}\r\n\r\n\t\tif ( geometry.verticesNeedUpdate === true ) {\r\n\r\n\t\t\tvar attribute = this.attributes.position;\r\n\r\n\t\t\tif ( attribute !== undefined ) {\r\n\r\n\t\t\t\tattribute.copyVector3sArray( geometry.vertices );\r\n\t\t\t\tattribute.needsUpdate = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgeometry.verticesNeedUpdate = false;\r\n\r\n\t\t}\r\n\r\n\t\tif ( geometry.normalsNeedUpdate === true ) {\r\n\r\n\t\t\tvar attribute = this.attributes.normal;\r\n\r\n\t\t\tif ( attribute !== undefined ) {\r\n\r\n\t\t\t\tattribute.copyVector3sArray( geometry.normals );\r\n\t\t\t\tattribute.needsUpdate = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgeometry.normalsNeedUpdate = false;\r\n\r\n\t\t}\r\n\r\n\t\tif ( geometry.colorsNeedUpdate === true ) {\r\n\r\n\t\t\tvar attribute = this.attributes.color;\r\n\r\n\t\t\tif ( attribute !== undefined ) {\r\n\r\n\t\t\t\tattribute.copyColorsArray( geometry.colors );\r\n\t\t\t\tattribute.needsUpdate = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgeometry.colorsNeedUpdate = false;\r\n\r\n\t\t}\r\n\r\n\t\tif ( geometry.uvsNeedUpdate ) {\r\n\r\n\t\t\tvar attribute = this.attributes.uv;\r\n\r\n\t\t\tif ( attribute !== undefined ) {\r\n\r\n\t\t\t\tattribute.copyVector2sArray( geometry.uvs );\r\n\t\t\t\tattribute.needsUpdate = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgeometry.uvsNeedUpdate = false;\r\n\r\n\t\t}\r\n\r\n\t\tif ( geometry.lineDistancesNeedUpdate ) {\r\n\r\n\t\t\tvar attribute = this.attributes.lineDistance;\r\n\r\n\t\t\tif ( attribute !== undefined ) {\r\n\r\n\t\t\t\tattribute.copyArray( geometry.lineDistances );\r\n\t\t\t\tattribute.needsUpdate = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgeometry.lineDistancesNeedUpdate = false;\r\n\r\n\t\t}\r\n\r\n\t\tif ( geometry.groupsNeedUpdate ) {\r\n\r\n\t\t\tgeometry.computeGroups( object.geometry );\r\n\t\t\tthis.groups = geometry.groups;\r\n\r\n\t\t\tgeometry.groupsNeedUpdate = false;\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tfromGeometry: function ( geometry ) {\r\n\r\n\t\tgeometry.__directGeometry = new THREE.DirectGeometry().fromGeometry( geometry );\r\n\r\n\t\treturn this.fromDirectGeometry( geometry.__directGeometry );\r\n\r\n\t},\r\n\r\n\tfromDirectGeometry: function ( geometry ) {\r\n\r\n\t\tvar positions = new Float32Array( geometry.vertices.length * 3 );\r\n\t\tthis.addAttribute( 'position', new THREE.BufferAttribute( positions, 3 ).copyVector3sArray( geometry.vertices ) );\r\n\r\n\t\tif ( geometry.normals.length > 0 ) {\r\n\r\n\t\t\tvar normals = new Float32Array( geometry.normals.length * 3 );\r\n\t\t\tthis.addAttribute( 'normal', new THREE.BufferAttribute( normals, 3 ).copyVector3sArray( geometry.normals ) );\r\n\r\n\t\t}\r\n\r\n\t\tif ( geometry.colors.length > 0 ) {\r\n\r\n\t\t\tvar colors = new Float32Array( geometry.colors.length * 3 );\r\n\t\t\tthis.addAttribute( 'color', new THREE.BufferAttribute( colors, 3 ).copyColorsArray( geometry.colors ) );\r\n\r\n\t\t}\r\n\r\n\t\tif ( geometry.uvs.length > 0 ) {\r\n\r\n\t\t\tvar uvs = new Float32Array( geometry.uvs.length * 2 );\r\n\t\t\tthis.addAttribute( 'uv', new THREE.BufferAttribute( uvs, 2 ).copyVector2sArray( geometry.uvs ) );\r\n\r\n\t\t}\r\n\r\n\t\tif ( geometry.uvs2.length > 0 ) {\r\n\r\n\t\t\tvar uvs2 = new Float32Array( geometry.uvs2.length * 2 );\r\n\t\t\tthis.addAttribute( 'uv2', new THREE.BufferAttribute( uvs2, 2 ).copyVector2sArray( geometry.uvs2 ) );\r\n\r\n\t\t}\r\n\r\n\t\tif ( geometry.indices.length > 0 ) {\r\n\r\n\t\t\tvar TypeArray = geometry.vertices.length > 65535 ? Uint32Array : Uint16Array;\r\n\t\t\tvar indices = new TypeArray( geometry.indices.length * 3 );\r\n\t\t\tthis.setIndex( new THREE.BufferAttribute( indices, 1 ).copyIndicesArray( geometry.indices ) );\r\n\r\n\t\t}\r\n\r\n\t\t// groups\r\n\r\n\t\tthis.groups = geometry.groups;\r\n\r\n\t\t// morphs\r\n\r\n\t\tfor ( var name in geometry.morphTargets ) {\r\n\r\n\t\t\tvar array = [];\r\n\t\t\tvar morphTargets = geometry.morphTargets[ name ];\r\n\r\n\t\t\tfor ( var i = 0, l = morphTargets.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar morphTarget = morphTargets[ i ];\r\n\r\n\t\t\t\tvar attribute = new THREE.Float32Attribute( morphTarget.length * 3, 3 );\r\n\r\n\t\t\t\tarray.push( attribute.copyVector3sArray( morphTarget ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.morphAttributes[ name ] = array;\r\n\r\n\t\t}\r\n\r\n\t\t// skinning\r\n\r\n\t\tif ( geometry.skinIndices.length > 0 ) {\r\n\r\n\t\t\tvar skinIndices = new THREE.Float32Attribute( geometry.skinIndices.length * 4, 4 );\r\n\t\t\tthis.addAttribute( 'skinIndex', skinIndices.copyVector4sArray( geometry.skinIndices ) );\r\n\r\n\t\t}\r\n\r\n\t\tif ( geometry.skinWeights.length > 0 ) {\r\n\r\n\t\t\tvar skinWeights = new THREE.Float32Attribute( geometry.skinWeights.length * 4, 4 );\r\n\t\t\tthis.addAttribute( 'skinWeight', skinWeights.copyVector4sArray( geometry.skinWeights ) );\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tif ( geometry.boundingSphere !== null ) {\r\n\r\n\t\t\tthis.boundingSphere = geometry.boundingSphere.clone();\r\n\r\n\t\t}\r\n\r\n\t\tif ( geometry.boundingBox !== null ) {\r\n\r\n\t\t\tthis.boundingBox = geometry.boundingBox.clone();\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcomputeBoundingBox: function () {\r\n\r\n\t\tif ( this.boundingBox === null ) {\r\n\r\n\t\t\tthis.boundingBox = new THREE.Box3();\r\n\r\n\t\t}\r\n\r\n\t\tvar positions = this.attributes.position.array;\r\n\r\n\t\tif ( positions !== undefined ) {\r\n\r\n\t\t\tthis.boundingBox.setFromArray( positions );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.boundingBox.makeEmpty();\r\n\r\n\t\t}\r\n\r\n\t\tif ( isNaN( this.boundingBox.min.x ) || isNaN( this.boundingBox.min.y ) || isNaN( this.boundingBox.min.z ) ) {\r\n\r\n\t\t\tconsole.error( 'THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The \"position\" attribute is likely to have NaN values.', this );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tcomputeBoundingSphere: function () {\r\n\r\n\t\tvar box = new THREE.Box3();\r\n\t\tvar vector = new THREE.Vector3();\r\n\r\n\t\treturn function computeBoundingSphere() {\r\n\r\n\t\t\tif ( this.boundingSphere === null ) {\r\n\r\n\t\t\t\tthis.boundingSphere = new THREE.Sphere();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar positions = this.attributes.position.array;\r\n\r\n\t\t\tif ( positions ) {\r\n\r\n\t\t\t\tvar center = this.boundingSphere.center;\r\n\r\n\t\t\t\tbox.setFromArray( positions );\r\n\t\t\t\tbox.center( center );\r\n\r\n\t\t\t\t// hoping to find a boundingSphere with a radius smaller than the\r\n\t\t\t\t// boundingSphere of the boundingBox: sqrt(3) smaller in the best case\r\n\r\n\t\t\t\tvar maxRadiusSq = 0;\r\n\r\n\t\t\t\tfor ( var i = 0, il = positions.length; i < il; i += 3 ) {\r\n\r\n\t\t\t\t\tvector.fromArray( positions, i );\r\n\t\t\t\t\tmaxRadiusSq = Math.max( maxRadiusSq, center.distanceToSquared( vector ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.boundingSphere.radius = Math.sqrt( maxRadiusSq );\r\n\r\n\t\t\t\tif ( isNaN( this.boundingSphere.radius ) ) {\r\n\r\n\t\t\t\t\tconsole.error( 'THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The \"position\" attribute is likely to have NaN values.', this );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tcomputeFaceNormals: function () {\r\n\r\n\t\t// backwards compatibility\r\n\r\n\t},\r\n\r\n\tcomputeVertexNormals: function () {\r\n\r\n\t\tvar index = this.index;\r\n\t\tvar attributes = this.attributes;\r\n\t\tvar groups = this.groups;\r\n\r\n\t\tif ( attributes.position ) {\r\n\r\n\t\t\tvar positions = attributes.position.array;\r\n\r\n\t\t\tif ( attributes.normal === undefined ) {\r\n\r\n\t\t\t\tthis.addAttribute( 'normal', new THREE.BufferAttribute( new Float32Array( positions.length ), 3 ) );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// reset existing normals to zero\r\n\r\n\t\t\t\tvar array = attributes.normal.array;\r\n\r\n\t\t\t\tfor ( var i = 0, il = array.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\tarray[ i ] = 0;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar normals = attributes.normal.array;\r\n\r\n\t\t\tvar vA, vB, vC,\r\n\r\n\t\t\tpA = new THREE.Vector3(),\r\n\t\t\tpB = new THREE.Vector3(),\r\n\t\t\tpC = new THREE.Vector3(),\r\n\r\n\t\t\tcb = new THREE.Vector3(),\r\n\t\t\tab = new THREE.Vector3();\r\n\r\n\t\t\t// indexed elements\r\n\r\n\t\t\tif ( index ) {\r\n\r\n\t\t\t\tvar indices = index.array;\r\n\r\n\t\t\t\tif ( groups.length === 0 ) {\r\n\r\n\t\t\t\t\tthis.addGroup( 0, indices.length );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor ( var j = 0, jl = groups.length; j < jl; ++ j ) {\r\n\r\n\t\t\t\t\tvar group = groups[ j ];\r\n\r\n\t\t\t\t\tvar start = group.start;\r\n\t\t\t\t\tvar count = group.count;\r\n\r\n\t\t\t\t\tfor ( var i = start, il = start + count; i < il; i += 3 ) {\r\n\r\n\t\t\t\t\t\tvA = indices[ i + 0 ] * 3;\r\n\t\t\t\t\t\tvB = indices[ i + 1 ] * 3;\r\n\t\t\t\t\t\tvC = indices[ i + 2 ] * 3;\r\n\r\n\t\t\t\t\t\tpA.fromArray( positions, vA );\r\n\t\t\t\t\t\tpB.fromArray( positions, vB );\r\n\t\t\t\t\t\tpC.fromArray( positions, vC );\r\n\r\n\t\t\t\t\t\tcb.subVectors( pC, pB );\r\n\t\t\t\t\t\tab.subVectors( pA, pB );\r\n\t\t\t\t\t\tcb.cross( ab );\r\n\r\n\t\t\t\t\t\tnormals[ vA ] += cb.x;\r\n\t\t\t\t\t\tnormals[ vA + 1 ] += cb.y;\r\n\t\t\t\t\t\tnormals[ vA + 2 ] += cb.z;\r\n\r\n\t\t\t\t\t\tnormals[ vB ] += cb.x;\r\n\t\t\t\t\t\tnormals[ vB + 1 ] += cb.y;\r\n\t\t\t\t\t\tnormals[ vB + 2 ] += cb.z;\r\n\r\n\t\t\t\t\t\tnormals[ vC ] += cb.x;\r\n\t\t\t\t\t\tnormals[ vC + 1 ] += cb.y;\r\n\t\t\t\t\t\tnormals[ vC + 2 ] += cb.z;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// non-indexed elements (unconnected triangle soup)\r\n\r\n\t\t\t\tfor ( var i = 0, il = positions.length; i < il; i += 9 ) {\r\n\r\n\t\t\t\t\tpA.fromArray( positions, i );\r\n\t\t\t\t\tpB.fromArray( positions, i + 3 );\r\n\t\t\t\t\tpC.fromArray( positions, i + 6 );\r\n\r\n\t\t\t\t\tcb.subVectors( pC, pB );\r\n\t\t\t\t\tab.subVectors( pA, pB );\r\n\t\t\t\t\tcb.cross( ab );\r\n\r\n\t\t\t\t\tnormals[ i ] = cb.x;\r\n\t\t\t\t\tnormals[ i + 1 ] = cb.y;\r\n\t\t\t\t\tnormals[ i + 2 ] = cb.z;\r\n\r\n\t\t\t\t\tnormals[ i + 3 ] = cb.x;\r\n\t\t\t\t\tnormals[ i + 4 ] = cb.y;\r\n\t\t\t\t\tnormals[ i + 5 ] = cb.z;\r\n\r\n\t\t\t\t\tnormals[ i + 6 ] = cb.x;\r\n\t\t\t\t\tnormals[ i + 7 ] = cb.y;\r\n\t\t\t\t\tnormals[ i + 8 ] = cb.z;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.normalizeNormals();\r\n\r\n\t\t\tattributes.normal.needsUpdate = true;\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tmerge: function ( geometry, offset ) {\r\n\r\n\t\tif ( geometry instanceof THREE.BufferGeometry === false ) {\r\n\r\n\t\t\tconsole.error( 'THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.', geometry );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\tvar attributes = this.attributes;\r\n\r\n\t\tfor ( var key in attributes ) {\r\n\r\n\t\t\tif ( geometry.attributes[ key ] === undefined ) continue;\r\n\r\n\t\t\tvar attribute1 = attributes[ key ];\r\n\t\t\tvar attributeArray1 = attribute1.array;\r\n\r\n\t\t\tvar attribute2 = geometry.attributes[ key ];\r\n\t\t\tvar attributeArray2 = attribute2.array;\r\n\r\n\t\t\tvar attributeSize = attribute2.itemSize;\r\n\r\n\t\t\tfor ( var i = 0, j = attributeSize * offset; i < attributeArray2.length; i ++, j ++ ) {\r\n\r\n\t\t\t\tattributeArray1[ j ] = attributeArray2[ i ];\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tnormalizeNormals: function () {\r\n\r\n\t\tvar normals = this.attributes.normal.array;\r\n\r\n\t\tvar x, y, z, n;\r\n\r\n\t\tfor ( var i = 0, il = normals.length; i < il; i += 3 ) {\r\n\r\n\t\t\tx = normals[ i ];\r\n\t\t\ty = normals[ i + 1 ];\r\n\t\t\tz = normals[ i + 2 ];\r\n\r\n\t\t\tn = 1.0 / Math.sqrt( x * x + y * y + z * z );\r\n\r\n\t\t\tnormals[ i ] *= n;\r\n\t\t\tnormals[ i + 1 ] *= n;\r\n\t\t\tnormals[ i + 2 ] *= n;\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\ttoNonIndexed: function () {\r\n\r\n\t\tif ( this.index === null ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed.' );\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t\tvar geometry2 = new THREE.BufferGeometry();\r\n\r\n\t\tvar indices = this.index.array;\r\n\t\tvar attributes = this.attributes;\r\n\r\n\t\tfor ( var name in attributes ) {\r\n\r\n\t\t\tvar attribute = attributes[ name ];\r\n\r\n\t\t\tvar array = attribute.array;\r\n\t\t\tvar itemSize = attribute.itemSize;\r\n\r\n\t\t\tvar array2 = new array.constructor( indices.length * itemSize );\r\n\r\n\t\t\tvar index = 0, index2 = 0;\r\n\r\n\t\t\tfor ( var i = 0, l = indices.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tindex = indices[ i ] * itemSize;\r\n\r\n\t\t\t\tfor ( var j = 0; j < itemSize; j ++ ) {\r\n\r\n\t\t\t\t\tarray2[ index2 ++ ] = array[ index ++ ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgeometry2.addAttribute( name, new THREE.BufferAttribute( array2, itemSize ) );\r\n\r\n\t\t}\r\n\r\n\t\treturn geometry2;\r\n\r\n\t},\r\n\r\n\ttoJSON: function () {\r\n\r\n\t\tvar data = {\r\n\t\t\tmetadata: {\r\n\t\t\t\tversion: 4.4,\r\n\t\t\t\ttype: 'BufferGeometry',\r\n\t\t\t\tgenerator: 'BufferGeometry.toJSON'\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\t// standard BufferGeometry serialization\r\n\r\n\t\tdata.uuid = this.uuid;\r\n\t\tdata.type = this.type;\r\n\t\tif ( this.name !== '' ) data.name = this.name;\r\n\r\n\t\tif ( this.parameters !== undefined ) {\r\n\r\n\t\t\tvar parameters = this.parameters;\r\n\r\n\t\t\tfor ( var key in parameters ) {\r\n\r\n\t\t\t\tif ( parameters[ key ] !== undefined ) data[ key ] = parameters[ key ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t}\r\n\r\n\t\tdata.data = { attributes: {} };\r\n\r\n\t\tvar index = this.index;\r\n\r\n\t\tif ( index !== null ) {\r\n\r\n\t\t\tvar array = Array.prototype.slice.call( index.array );\r\n\r\n\t\t\tdata.data.index = {\r\n\t\t\t\ttype: index.array.constructor.name,\r\n\t\t\t\tarray: array\r\n\t\t\t};\r\n\r\n\t\t}\r\n\r\n\t\tvar attributes = this.attributes;\r\n\r\n\t\tfor ( var key in attributes ) {\r\n\r\n\t\t\tvar attribute = attributes[ key ];\r\n\r\n\t\t\tvar array = Array.prototype.slice.call( attribute.array );\r\n\r\n\t\t\tdata.data.attributes[ key ] = {\r\n\t\t\t\titemSize: attribute.itemSize,\r\n\t\t\t\ttype: attribute.array.constructor.name,\r\n\t\t\t\tarray: array,\r\n\t\t\t\tnormalized: attribute.normalized\r\n\t\t\t};\r\n\r\n\t\t}\r\n\r\n\t\tvar groups = this.groups;\r\n\r\n\t\tif ( groups.length > 0 ) {\r\n\r\n\t\t\tdata.data.groups = JSON.parse( JSON.stringify( groups ) );\r\n\r\n\t\t}\r\n\r\n\t\tvar boundingSphere = this.boundingSphere;\r\n\r\n\t\tif ( boundingSphere !== null ) {\r\n\r\n\t\t\tdata.data.boundingSphere = {\r\n\t\t\t\tcenter: boundingSphere.center.toArray(),\r\n\t\t\t\tradius: boundingSphere.radius\r\n\t\t\t};\r\n\r\n\t\t}\r\n\r\n\t\treturn data;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\t/*\r\n\t\t// Handle primitives\r\n\r\n\t\tvar parameters = this.parameters;\r\n\r\n\t\tif ( parameters !== undefined ) {\r\n\r\n\t\t\tvar values = [];\r\n\r\n\t\t\tfor ( var key in parameters ) {\r\n\r\n\t\t\t\tvalues.push( parameters[ key ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar geometry = Object.create( this.constructor.prototype );\r\n\t\t\tthis.constructor.apply( geometry, values );\r\n\t\t\treturn geometry;\r\n\r\n\t\t}\r\n\r\n\t\treturn new this.constructor().copy( this );\r\n\t\t*/\r\n\r\n\t\treturn new THREE.BufferGeometry().copy( this );\r\n\r\n\t},\r\n\r\n\tcopy: function ( source ) {\r\n\r\n\t\tvar index = source.index;\r\n\r\n\t\tif ( index !== null ) {\r\n\r\n\t\t\tthis.setIndex( index.clone() );\r\n\r\n\t\t}\r\n\r\n\t\tvar attributes = source.attributes;\r\n\r\n\t\tfor ( var name in attributes ) {\r\n\r\n\t\t\tvar attribute = attributes[ name ];\r\n\t\t\tthis.addAttribute( name, attribute.clone() );\r\n\r\n\t\t}\r\n\r\n\t\tvar groups = source.groups;\r\n\r\n\t\tfor ( var i = 0, l = groups.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar group = groups[ i ];\r\n\t\t\tthis.addGroup( group.start, group.count, group.materialIndex );\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdispose: function () {\r\n\r\n\t\tthis.dispatchEvent( { type: 'dispose' } );\r\n\r\n\t}\r\n\r\n} );\r\n\r\nTHREE.BufferGeometry.MaxIndex = 65535;\r\n\r\n// File:src/core/InstancedBufferGeometry.js\r\n\r\n/**\r\n * @author benaadams / https://twitter.com/ben_a_adams\r\n */\r\n\r\nTHREE.InstancedBufferGeometry = function () {\r\n\r\n\tTHREE.BufferGeometry.call( this );\r\n\r\n\tthis.type = 'InstancedBufferGeometry';\r\n\tthis.maxInstancedCount = undefined;\r\n\r\n};\r\n\r\nTHREE.InstancedBufferGeometry.prototype = Object.create( THREE.BufferGeometry.prototype );\r\nTHREE.InstancedBufferGeometry.prototype.constructor = THREE.InstancedBufferGeometry;\r\n\r\nTHREE.InstancedBufferGeometry.prototype.addGroup = function ( start, count, instances ) {\r\n\r\n\tthis.groups.push( {\r\n\r\n\t\tstart: start,\r\n\t\tcount: count,\r\n\t\tinstances: instances\r\n\r\n\t} );\r\n\r\n};\r\n\r\nTHREE.InstancedBufferGeometry.prototype.copy = function ( source ) {\r\n\r\n\tvar index = source.index;\r\n\r\n\tif ( index !== null ) {\r\n\r\n\t\tthis.setIndex( index.clone() );\r\n\r\n\t}\r\n\r\n\tvar attributes = source.attributes;\r\n\r\n\tfor ( var name in attributes ) {\r\n\r\n\t\tvar attribute = attributes[ name ];\r\n\t\tthis.addAttribute( name, attribute.clone() );\r\n\r\n\t}\r\n\r\n\tvar groups = source.groups;\r\n\r\n\tfor ( var i = 0, l = groups.length; i < l; i ++ ) {\r\n\r\n\t\tvar group = groups[ i ];\r\n\t\tthis.addGroup( group.start, group.count, group.instances );\r\n\r\n\t}\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n// File:src/core/Uniform.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Uniform = function ( value ) {\r\n\r\n\tif ( typeof value === 'string' ) {\r\n\r\n\t\tconsole.warn( 'THREE.Uniform: Type parameter is no longer needed.' );\r\n\t\tvalue = arguments[ 1 ];\r\n\r\n\t}\r\n\r\n\tthis.value = value;\r\n\r\n\tthis.dynamic = false;\r\n\r\n};\r\n\r\nTHREE.Uniform.prototype = {\r\n\r\n\tconstructor: THREE.Uniform,\r\n\r\n\tonUpdate: function ( callback ) {\r\n\r\n\t\tthis.dynamic = true;\r\n\t\tthis.onUpdateCallback = callback;\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/animation/AnimationAction.js\r\n\r\n/**\r\n *\r\n * Action provided by AnimationMixer for scheduling clip playback on specific\r\n * objects.\r\n *\r\n * @author Ben Houston / http://clara.io/\r\n * @author David Sarno / http://lighthaus.us/\r\n * @author tschw\r\n *\r\n */\r\n\r\nTHREE.AnimationAction = function() {\r\n\r\n\tthrow new Error( \"THREE.AnimationAction: \" +\r\n\t\t\t\"Use mixer.clipAction for construction.\" );\r\n\r\n};\r\n\r\nTHREE.AnimationAction._new =\r\n\t\tfunction AnimationAction( mixer, clip, localRoot ) {\r\n\r\n\tthis._mixer = mixer;\r\n\tthis._clip = clip;\r\n\tthis._localRoot = localRoot || null;\r\n\r\n\tvar tracks = clip.tracks,\r\n\t\tnTracks = tracks.length,\r\n\t\tinterpolants = new Array( nTracks );\r\n\r\n\tvar interpolantSettings = {\r\n\t\t\tendingStart: \tTHREE.ZeroCurvatureEnding,\r\n\t\t\tendingEnd:\t\tTHREE.ZeroCurvatureEnding\r\n\t};\r\n\r\n\tfor ( var i = 0; i !== nTracks; ++ i ) {\r\n\r\n\t\tvar interpolant = tracks[ i ].createInterpolant( null );\r\n\t\tinterpolants[ i ] = interpolant;\r\n\t\tinterpolant.settings = interpolantSettings;\r\n\r\n\t}\r\n\r\n\tthis._interpolantSettings = interpolantSettings;\r\n\r\n\tthis._interpolants = interpolants;\t// bound by the mixer\r\n\r\n\t// inside: PropertyMixer (managed by the mixer)\r\n\tthis._propertyBindings = new Array( nTracks );\r\n\r\n\tthis._cacheIndex = null;\t\t\t// for the memory manager\r\n\tthis._byClipCacheIndex = null;\t\t// for the memory manager\r\n\r\n\tthis._timeScaleInterpolant = null;\r\n\tthis._weightInterpolant = null;\r\n\r\n\tthis.loop = THREE.LoopRepeat;\r\n\tthis._loopCount = -1;\r\n\r\n\t// global mixer time when the action is to be started\r\n\t// it's set back to 'null' upon start of the action\r\n\tthis._startTime = null;\r\n\r\n\t// scaled local time of the action\r\n\t// gets clamped or wrapped to 0..clip.duration according to loop\r\n\tthis.time = 0;\r\n\r\n\tthis.timeScale = 1;\r\n\tthis._effectiveTimeScale = 1;\r\n\r\n\tthis.weight = 1;\r\n\tthis._effectiveWeight = 1;\r\n\r\n\tthis.repetitions = Infinity; \t\t// no. of repetitions when looping\r\n\r\n\tthis.paused = false;\t\t\t\t// false -> zero effective time scale\r\n\tthis.enabled = true;\t\t\t\t// true -> zero effective weight\r\n\r\n\tthis.clampWhenFinished \t= false;\t// keep feeding the last frame?\r\n\r\n\tthis.zeroSlopeAtStart \t= true;\t\t// for smooth interpolation w/o separate\r\n\tthis.zeroSlopeAtEnd\t\t= true;\t\t// clips for start, loop and end\r\n\r\n};\r\n\r\nTHREE.AnimationAction._new.prototype = {\r\n\r\n\tconstructor: THREE.AnimationAction._new,\r\n\r\n\t// State & Scheduling\r\n\r\n\tplay: function() {\r\n\r\n\t\tthis._mixer._activateAction( this );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tstop: function() {\r\n\r\n\t\tthis._mixer._deactivateAction( this );\r\n\r\n\t\treturn this.reset();\r\n\r\n\t},\r\n\r\n\treset: function() {\r\n\r\n\t\tthis.paused = false;\r\n\t\tthis.enabled = true;\r\n\r\n\t\tthis.time = 0;\t\t\t// restart clip\r\n\t\tthis._loopCount = -1;\t// forget previous loops\r\n\t\tthis._startTime = null;\t// forget scheduling\r\n\r\n\t\treturn this.stopFading().stopWarping();\r\n\r\n\t},\r\n\r\n\tisRunning: function() {\r\n\r\n\t\tvar start = this._startTime;\r\n\r\n\t\treturn this.enabled && ! this.paused && this.timeScale !== 0 &&\r\n\t\t\t\tthis._startTime === null && this._mixer._isActiveAction( this );\r\n\r\n\t},\r\n\r\n\t// return true when play has been called\r\n\tisScheduled: function() {\r\n\r\n\t\treturn this._mixer._isActiveAction( this );\r\n\r\n\t},\r\n\r\n\tstartAt: function( time ) {\r\n\r\n\t\tthis._startTime = time;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetLoop: function( mode, repetitions ) {\r\n\r\n\t\tthis.loop = mode;\r\n\t\tthis.repetitions = repetitions;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\t// Weight\r\n\r\n\t// set the weight stopping any scheduled fading\r\n\t// although .enabled = false yields an effective weight of zero, this\r\n\t// method does *not* change .enabled, because it would be confusing\r\n\tsetEffectiveWeight: function( weight ) {\r\n\r\n\t\tthis.weight = weight;\r\n\r\n\t\t// note: same logic as when updated at runtime\r\n\t\tthis._effectiveWeight = this.enabled ? weight : 0;\r\n\r\n\t\treturn this.stopFading();\r\n\r\n\t},\r\n\r\n\t// return the weight considering fading and .enabled\r\n\tgetEffectiveWeight: function() {\r\n\r\n\t\treturn this._effectiveWeight;\r\n\r\n\t},\r\n\r\n\tfadeIn: function( duration ) {\r\n\r\n\t\treturn this._scheduleFading( duration, 0, 1 );\r\n\r\n\t},\r\n\r\n\tfadeOut: function( duration ) {\r\n\r\n\t\treturn this._scheduleFading( duration, 1, 0 );\r\n\r\n\t},\r\n\r\n\tcrossFadeFrom: function( fadeOutAction, duration, warp ) {\r\n\r\n\t\tvar mixer = this._mixer;\r\n\r\n\t\tfadeOutAction.fadeOut( duration );\r\n\t\tthis.fadeIn( duration );\r\n\r\n\t\tif( warp ) {\r\n\r\n\t\t\tvar fadeInDuration = this._clip.duration,\r\n\t\t\t\tfadeOutDuration = fadeOutAction._clip.duration,\r\n\r\n\t\t\t\tstartEndRatio = fadeOutDuration / fadeInDuration,\r\n\t\t\t\tendStartRatio = fadeInDuration / fadeOutDuration;\r\n\r\n\t\t\tfadeOutAction.warp( 1.0, startEndRatio, duration );\r\n\t\t\tthis.warp( endStartRatio, 1.0, duration );\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcrossFadeTo: function( fadeInAction, duration, warp ) {\r\n\r\n\t\treturn fadeInAction.crossFadeFrom( this, duration, warp );\r\n\r\n\t},\r\n\r\n\tstopFading: function() {\r\n\r\n\t\tvar weightInterpolant = this._weightInterpolant;\r\n\r\n\t\tif ( weightInterpolant !== null ) {\r\n\r\n\t\t\tthis._weightInterpolant = null;\r\n\t\t\tthis._mixer._takeBackControlInterpolant( weightInterpolant );\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\t// Time Scale Control\r\n\r\n\t// set the weight stopping any scheduled warping\r\n\t// although .paused = true yields an effective time scale of zero, this\r\n\t// method does *not* change .paused, because it would be confusing\r\n\tsetEffectiveTimeScale: function( timeScale ) {\r\n\r\n\t\tthis.timeScale = timeScale;\r\n\t\tthis._effectiveTimeScale = this.paused ? 0 :timeScale;\r\n\r\n\t\treturn this.stopWarping();\r\n\r\n\t},\r\n\r\n\t// return the time scale considering warping and .paused\r\n\tgetEffectiveTimeScale: function() {\r\n\r\n\t\treturn this._effectiveTimeScale;\r\n\r\n\t},\r\n\r\n\tsetDuration: function( duration ) {\r\n\r\n\t\tthis.timeScale = this._clip.duration / duration;\r\n\r\n\t\treturn this.stopWarping();\r\n\r\n\t},\r\n\r\n\tsyncWith: function( action ) {\r\n\r\n\t\tthis.time = action.time;\r\n\t\tthis.timeScale = action.timeScale;\r\n\r\n\t\treturn this.stopWarping();\r\n\r\n\t},\r\n\r\n\thalt: function( duration ) {\r\n\r\n\t\treturn this.warp( this._effectiveTimeScale, 0, duration );\r\n\r\n\t},\r\n\r\n\twarp: function( startTimeScale, endTimeScale, duration ) {\r\n\r\n\t\tvar mixer = this._mixer, now = mixer.time,\r\n\t\t\tinterpolant = this._timeScaleInterpolant,\r\n\r\n\t\t\ttimeScale = this.timeScale;\r\n\r\n\t\tif ( interpolant === null ) {\r\n\r\n\t\t\tinterpolant = mixer._lendControlInterpolant(),\r\n\t\t\tthis._timeScaleInterpolant = interpolant;\r\n\r\n\t\t}\r\n\r\n\t\tvar times = interpolant.parameterPositions,\r\n\t\t\tvalues = interpolant.sampleValues;\r\n\r\n\t\ttimes[ 0 ] = now;\r\n\t\ttimes[ 1 ] = now + duration;\r\n\r\n\t\tvalues[ 0 ] = startTimeScale / timeScale;\r\n\t\tvalues[ 1 ] = endTimeScale / timeScale;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tstopWarping: function() {\r\n\r\n\t\tvar timeScaleInterpolant = this._timeScaleInterpolant;\r\n\r\n\t\tif ( timeScaleInterpolant !== null ) {\r\n\r\n\t\t\tthis._timeScaleInterpolant = null;\r\n\t\t\tthis._mixer._takeBackControlInterpolant( timeScaleInterpolant );\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\t// Object Accessors\r\n\r\n\tgetMixer: function() {\r\n\r\n\t\treturn this._mixer;\r\n\r\n\t},\r\n\r\n\tgetClip: function() {\r\n\r\n\t\treturn this._clip;\r\n\r\n\t},\r\n\r\n\tgetRoot: function() {\r\n\r\n\t\treturn this._localRoot || this._mixer._root;\r\n\r\n\t},\r\n\r\n\t// Interna\r\n\r\n\t_update: function( time, deltaTime, timeDirection, accuIndex ) {\r\n\t\t// called by the mixer\r\n\r\n\t\tvar startTime = this._startTime;\r\n\r\n\t\tif ( startTime !== null ) {\r\n\r\n\t\t\t// check for scheduled start of action\r\n\r\n\t\t\tvar timeRunning = ( time - startTime ) * timeDirection;\r\n\t\t\tif ( timeRunning < 0 || timeDirection === 0 ) {\r\n\r\n\t\t\t\treturn; // yet to come / don't decide when delta = 0\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// start\r\n\r\n\t\t\tthis._startTime = null; // unschedule\r\n\t\t\tdeltaTime = timeDirection * timeRunning;\r\n\r\n\t\t}\r\n\r\n\t\t// apply time scale and advance time\r\n\r\n\t\tdeltaTime *= this._updateTimeScale( time );\r\n\t\tvar clipTime = this._updateTime( deltaTime );\r\n\r\n\t\t// note: _updateTime may disable the action resulting in\r\n\t\t// an effective weight of 0\r\n\r\n\t\tvar weight = this._updateWeight( time );\r\n\r\n\t\tif ( weight > 0 ) {\r\n\r\n\t\t\tvar interpolants = this._interpolants;\r\n\t\t\tvar propertyMixers = this._propertyBindings;\r\n\r\n\t\t\tfor ( var j = 0, m = interpolants.length; j !== m; ++ j ) {\r\n\r\n\t\t\t\tinterpolants[ j ].evaluate( clipTime );\r\n\t\t\t\tpropertyMixers[ j ].accumulate( accuIndex, weight );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\t_updateWeight: function( time ) {\r\n\r\n\t\tvar weight = 0;\r\n\r\n\t\tif ( this.enabled ) {\r\n\r\n\t\t\tweight = this.weight;\r\n\t\t\tvar interpolant = this._weightInterpolant;\r\n\r\n\t\t\tif ( interpolant !== null ) {\r\n\r\n\t\t\t\tvar interpolantValue = interpolant.evaluate( time )[ 0 ];\r\n\r\n\t\t\t\tweight *= interpolantValue;\r\n\r\n\t\t\t\tif ( time > interpolant.parameterPositions[ 1 ] ) {\r\n\r\n\t\t\t\t\tthis.stopFading();\r\n\r\n\t\t\t\t\tif ( interpolantValue === 0 ) {\r\n\r\n\t\t\t\t\t\t// faded out, disable\r\n\t\t\t\t\t\tthis.enabled = false;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tthis._effectiveWeight = weight;\r\n\t\treturn weight;\r\n\r\n\t},\r\n\r\n\t_updateTimeScale: function( time ) {\r\n\r\n\t\tvar timeScale = 0;\r\n\r\n\t\tif ( ! this.paused ) {\r\n\r\n\t\t\ttimeScale = this.timeScale;\r\n\r\n\t\t\tvar interpolant = this._timeScaleInterpolant;\r\n\r\n\t\t\tif ( interpolant !== null ) {\r\n\r\n\t\t\t\tvar interpolantValue = interpolant.evaluate( time )[ 0 ];\r\n\r\n\t\t\t\ttimeScale *= interpolantValue;\r\n\r\n\t\t\t\tif ( time > interpolant.parameterPositions[ 1 ] ) {\r\n\r\n\t\t\t\t\tthis.stopWarping();\r\n\r\n\t\t\t\t\tif ( timeScale === 0 ) {\r\n\r\n\t\t\t\t\t\t// motion has halted, pause\r\n\t\t\t\t\t\tthis.paused = true;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t// warp done - apply final time scale\r\n\t\t\t\t\t\tthis.timeScale = timeScale;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tthis._effectiveTimeScale = timeScale;\r\n\t\treturn timeScale;\r\n\r\n\t},\r\n\r\n\t_updateTime: function( deltaTime ) {\r\n\r\n\t\tvar time = this.time + deltaTime;\r\n\r\n\t\tif ( deltaTime === 0 ) return time;\r\n\r\n\t\tvar duration = this._clip.duration,\r\n\r\n\t\t\tloop = this.loop,\r\n\t\t\tloopCount = this._loopCount;\r\n\r\n\t\tif ( loop === THREE.LoopOnce ) {\r\n\r\n\t\t\tif ( loopCount === -1 ) {\r\n\t\t\t\t// just started\r\n\r\n\t\t\t\tthis.loopCount = 0;\r\n\t\t\t\tthis._setEndings( true, true, false );\r\n\r\n\t\t\t}\r\n\r\n\t\t\thandle_stop: {\r\n\r\n\t\t\t\tif ( time >= duration ) {\r\n\r\n\t\t\t\t\ttime = duration;\r\n\r\n\t\t\t\t} else if ( time < 0 ) {\r\n\r\n\t\t\t\t\ttime = 0;\r\n\r\n\t\t\t\t} else break handle_stop;\r\n\r\n\t\t\t\tif ( this.clampWhenFinished ) this.paused = true;\r\n\t\t\t\telse this.enabled = false;\r\n\r\n\t\t\t\tthis._mixer.dispatchEvent( {\r\n\t\t\t\t\ttype: 'finished', action: this,\r\n\t\t\t\t\tdirection: deltaTime < 0 ? -1 : 1\r\n\t\t\t\t} );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else { // repetitive Repeat or PingPong\r\n\r\n\t\t\tvar pingPong = ( loop === THREE.LoopPingPong );\r\n\r\n\t\t\tif ( loopCount === -1 ) {\r\n\t\t\t\t// just started\r\n\r\n\t\t\t\tif ( deltaTime >= 0 ) {\r\n\r\n\t\t\t\t\tloopCount = 0;\r\n\r\n\t\t\t\t\tthis._setEndings(\r\n\t\t\t\t\t\t\ttrue, this.repetitions === 0, pingPong );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t// when looping in reverse direction, the initial\r\n\t\t\t\t\t// transition through zero counts as a repetition,\r\n\t\t\t\t\t// so leave loopCount at -1\r\n\r\n\t\t\t\t\tthis._setEndings(\r\n\t\t\t\t\t\t\tthis.repetitions === 0, true, pingPong );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( time >= duration || time < 0 ) {\r\n\t\t\t\t// wrap around\r\n\r\n\t\t\t\tvar loopDelta = Math.floor( time / duration ); // signed\r\n\t\t\t\ttime -= duration * loopDelta;\r\n\r\n\t\t\t\tloopCount += Math.abs( loopDelta );\r\n\r\n\t\t\t\tvar pending = this.repetitions - loopCount;\r\n\r\n\t\t\t\tif ( pending < 0 ) {\r\n\t\t\t\t\t// have to stop (switch state, clamp time, fire event)\r\n\r\n\t\t\t\t\tif ( this.clampWhenFinished ) this.paused = true;\r\n\t\t\t\t\telse this.enabled = false;\r\n\r\n\t\t\t\t\ttime = deltaTime > 0 ? duration : 0;\r\n\r\n\t\t\t\t\tthis._mixer.dispatchEvent( {\r\n\t\t\t\t\t\ttype: 'finished', action: this,\r\n\t\t\t\t\t\tdirection: deltaTime > 0 ? 1 : -1\r\n\t\t\t\t\t} );\r\n\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// keep running\r\n\r\n\t\t\t\t\tif ( pending === 0 ) {\r\n\t\t\t\t\t\t// entering the last round\r\n\r\n\t\t\t\t\t\tvar atStart = deltaTime < 0;\r\n\t\t\t\t\t\tthis._setEndings( atStart, ! atStart, pingPong );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tthis._setEndings( false, false, pingPong );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis._loopCount = loopCount;\r\n\r\n\t\t\t\t\tthis._mixer.dispatchEvent( {\r\n\t\t\t\t\t\ttype: 'loop', action: this, loopDelta: loopDelta\r\n\t\t\t\t\t} );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( pingPong && ( loopCount & 1 ) === 1 ) {\r\n\t\t\t\t// invert time for the \"pong round\"\r\n\r\n\t\t\t\tthis.time = time;\r\n\t\t\t\treturn duration - time;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tthis.time = time;\r\n\t\treturn time;\r\n\r\n\t},\r\n\r\n\t_setEndings: function( atStart, atEnd, pingPong ) {\r\n\r\n\t\tvar settings = this._interpolantSettings;\r\n\r\n\t\tif ( pingPong ) {\r\n\r\n\t\t\tsettings.endingStart \t= THREE.ZeroSlopeEnding;\r\n\t\t\tsettings.endingEnd\t\t= THREE.ZeroSlopeEnding;\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// assuming for LoopOnce atStart == atEnd == true\r\n\r\n\t\t\tif ( atStart ) {\r\n\r\n\t\t\t\tsettings.endingStart = this.zeroSlopeAtStart ?\r\n\t\t\t\t\t\tTHREE.ZeroSlopeEnding : THREE.ZeroCurvatureEnding;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tsettings.endingStart = THREE.WrapAroundEnding;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( atEnd ) {\r\n\r\n\t\t\t\tsettings.endingEnd = this.zeroSlopeAtEnd ?\r\n\t\t\t\t\t\tTHREE.ZeroSlopeEnding : THREE.ZeroCurvatureEnding;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tsettings.endingEnd \t = THREE.WrapAroundEnding;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\t_scheduleFading: function( duration, weightNow, weightThen ) {\r\n\r\n\t\tvar mixer = this._mixer, now = mixer.time,\r\n\t\t\tinterpolant = this._weightInterpolant;\r\n\r\n\t\tif ( interpolant === null ) {\r\n\r\n\t\t\tinterpolant = mixer._lendControlInterpolant(),\r\n\t\t\tthis._weightInterpolant = interpolant;\r\n\r\n\t\t}\r\n\r\n\t\tvar times = interpolant.parameterPositions,\r\n\t\t\tvalues = interpolant.sampleValues;\r\n\r\n\t\ttimes[ 0 ] = now; \t\t\t\tvalues[ 0 ] = weightNow;\r\n\t\ttimes[ 1 ] = now + duration;\tvalues[ 1 ] = weightThen;\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n};\r\n\r\n\r\n// File:src/animation/AnimationClip.js\r\n\r\n/**\r\n *\r\n * Reusable set of Tracks that represent an animation.\r\n *\r\n * @author Ben Houston / http://clara.io/\r\n * @author David Sarno / http://lighthaus.us/\r\n */\r\n\r\nTHREE.AnimationClip = function ( name, duration, tracks ) {\r\n\r\n\tthis.name = name;\r\n\tthis.tracks = tracks;\r\n\tthis.duration = ( duration !== undefined ) ? duration : -1;\r\n\r\n\tthis.uuid = THREE.Math.generateUUID();\r\n\r\n\t// this means it should figure out its duration by scanning the tracks\r\n\tif ( this.duration < 0 ) {\r\n\r\n\t\tthis.resetDuration();\r\n\r\n\t}\r\n\r\n\t// maybe only do these on demand, as doing them here could potentially slow down loading\r\n\t// but leaving these here during development as this ensures a lot of testing of these functions\r\n\tthis.trim();\r\n\tthis.optimize();\r\n\r\n};\r\n\r\nTHREE.AnimationClip.prototype = {\r\n\r\n\tconstructor: THREE.AnimationClip,\r\n\r\n\tresetDuration: function() {\r\n\r\n\t\tvar tracks = this.tracks,\r\n\t\t\tduration = 0;\r\n\r\n\t\tfor ( var i = 0, n = tracks.length; i !== n; ++ i ) {\r\n\r\n\t\t\tvar track = this.tracks[ i ];\r\n\r\n\t\t\tduration = Math.max(\r\n\t\t\t\t\tduration, track.times[ track.times.length - 1 ] );\r\n\r\n\t\t}\r\n\r\n\t\tthis.duration = duration;\r\n\r\n\t},\r\n\r\n\ttrim: function() {\r\n\r\n\t\tfor ( var i = 0; i < this.tracks.length; i ++ ) {\r\n\r\n\t\t\tthis.tracks[ i ].trim( 0, this.duration );\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\toptimize: function() {\r\n\r\n\t\tfor ( var i = 0; i < this.tracks.length; i ++ ) {\r\n\r\n\t\t\tthis.tracks[ i ].optimize();\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// Static methods:\r\n\r\nObject.assign( THREE.AnimationClip, {\r\n\r\n\tparse: function( json ) {\r\n\r\n\t\tvar tracks = [],\r\n\t\t\tjsonTracks = json.tracks,\r\n\t\t\tframeTime = 1.0 / ( json.fps || 1.0 );\r\n\r\n\t\tfor ( var i = 0, n = jsonTracks.length; i !== n; ++ i ) {\r\n\r\n\t\t\ttracks.push( THREE.KeyframeTrack.parse( jsonTracks[ i ] ).scale( frameTime ) );\r\n\r\n\t\t}\r\n\r\n\t\treturn new THREE.AnimationClip( json.name, json.duration, tracks );\r\n\r\n\t},\r\n\r\n\r\n\ttoJSON: function( clip ) {\r\n\r\n\t\tvar tracks = [],\r\n\t\t\tclipTracks = clip.tracks;\r\n\r\n\t\tvar json = {\r\n\r\n\t\t\t'name': clip.name,\r\n\t\t\t'duration': clip.duration,\r\n\t\t\t'tracks': tracks\r\n\r\n\t\t};\r\n\r\n\t\tfor ( var i = 0, n = clipTracks.length; i !== n; ++ i ) {\r\n\r\n\t\t\ttracks.push( THREE.KeyframeTrack.toJSON( clipTracks[ i ] ) );\r\n\r\n\t\t}\r\n\r\n\t\treturn json;\r\n\r\n\t},\r\n\r\n\r\n\tCreateFromMorphTargetSequence: function( name, morphTargetSequence, fps, noLoop ) {\r\n\r\n\t\tvar numMorphTargets = morphTargetSequence.length;\r\n\t\tvar tracks = [];\r\n\r\n\t\tfor ( var i = 0; i < numMorphTargets; i ++ ) {\r\n\r\n\t\t\tvar times = [];\r\n\t\t\tvar values = [];\r\n\r\n\t\t\ttimes.push(\r\n\t\t\t\t\t( i + numMorphTargets - 1 ) % numMorphTargets,\r\n\t\t\t\t\ti,\r\n\t\t\t\t\t( i + 1 ) % numMorphTargets );\r\n\r\n\t\t\tvalues.push( 0, 1, 0 );\r\n\r\n\t\t\tvar order = THREE.AnimationUtils.getKeyframeOrder( times );\r\n\t\t\ttimes = THREE.AnimationUtils.sortedArray( times, 1, order );\r\n\t\t\tvalues = THREE.AnimationUtils.sortedArray( values, 1, order );\r\n\r\n\t\t\t// if there is a key at the first frame, duplicate it as the\r\n\t\t\t// last frame as well for perfect loop.\r\n\t\t\tif ( ! noLoop && times[ 0 ] === 0 ) {\r\n\r\n\t\t\t\ttimes.push( numMorphTargets );\r\n\t\t\t\tvalues.push( values[ 0 ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\ttracks.push(\r\n\t\t\t\t\tnew THREE.NumberKeyframeTrack(\r\n\t\t\t\t\t\t'.morphTargetInfluences[' + morphTargetSequence[ i ].name + ']',\r\n\t\t\t\t\t\ttimes, values\r\n\t\t\t\t\t).scale( 1.0 / fps ) );\r\n\t\t}\r\n\r\n\t\treturn new THREE.AnimationClip( name, -1, tracks );\r\n\r\n\t},\r\n\r\n\tfindByName: function( objectOrClipArray, name ) {\r\n\r\n\t\tvar clipArray = objectOrClipArray;\r\n\r\n\t\tif ( ! Array.isArray( objectOrClipArray ) ) {\r\n\r\n\t\t\tvar o = objectOrClipArray;\r\n\t\t\tclipArray = o.geometry && o.geometry.animations || o.animations;\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var i = 0; i < clipArray.length; i ++ ) {\r\n\r\n\t\t\tif ( clipArray[ i ].name === name ) {\r\n\r\n\t\t\t\treturn clipArray[ i ];\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\r\n\t},\r\n\r\n\tCreateClipsFromMorphTargetSequences: function( morphTargets, fps, noLoop ) {\r\n\r\n\t\tvar animationToMorphTargets = {};\r\n\r\n\t\t// tested with https://regex101.com/ on trick sequences\r\n\t\t// such flamingo_flyA_003, flamingo_run1_003, crdeath0059\r\n\t\tvar pattern = /^([\\w-]*?)([\\d]+)$/;\r\n\r\n\t\t// sort morph target names into animation groups based\r\n\t\t// patterns like Walk_001, Walk_002, Run_001, Run_002\r\n\t\tfor ( var i = 0, il = morphTargets.length; i < il; i ++ ) {\r\n\r\n\t\t\tvar morphTarget = morphTargets[ i ];\r\n\t\t\tvar parts = morphTarget.name.match( pattern );\r\n\r\n\t\t\tif ( parts && parts.length > 1 ) {\r\n\r\n\t\t\t\tvar name = parts[ 1 ];\r\n\r\n\t\t\t\tvar animationMorphTargets = animationToMorphTargets[ name ];\r\n\t\t\t\tif ( ! animationMorphTargets ) {\r\n\r\n\t\t\t\t\tanimationToMorphTargets[ name ] = animationMorphTargets = [];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tanimationMorphTargets.push( morphTarget );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar clips = [];\r\n\r\n\t\tfor ( var name in animationToMorphTargets ) {\r\n\r\n\t\t\tclips.push( THREE.AnimationClip.CreateFromMorphTargetSequence( name, animationToMorphTargets[ name ], fps, noLoop ) );\r\n\r\n\t\t}\r\n\r\n\t\treturn clips;\r\n\r\n\t},\r\n\r\n\t// parse the animation.hierarchy format\r\n\tparseAnimation: function( animation, bones, nodeName ) {\r\n\r\n\t\tif ( ! animation ) {\r\n\r\n\t\t\tconsole.error( \"  no animation in JSONLoader data\" );\r\n\t\t\treturn null;\r\n\r\n\t\t}\r\n\r\n\t\tvar addNonemptyTrack = function(\r\n\t\t\t\ttrackType, trackName, animationKeys, propertyName, destTracks ) {\r\n\r\n\t\t\t// only return track if there are actually keys.\r\n\t\t\tif ( animationKeys.length !== 0 ) {\r\n\r\n\t\t\t\tvar times = [];\r\n\t\t\t\tvar values = [];\r\n\r\n\t\t\t\tTHREE.AnimationUtils.flattenJSON(\r\n\t\t\t\t\t\tanimationKeys, times, values, propertyName );\r\n\r\n\t\t\t\t// empty keys are filtered out, so check again\r\n\t\t\t\tif ( times.length !== 0 ) {\r\n\r\n\t\t\t\t\tdestTracks.push( new trackType( trackName, times, values ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t\tvar tracks = [];\r\n\r\n\t\tvar clipName = animation.name || 'default';\r\n\t\t// automatic length determination in AnimationClip.\r\n\t\tvar duration = animation.length || -1;\r\n\t\tvar fps = animation.fps || 30;\r\n\r\n\t\tvar hierarchyTracks = animation.hierarchy || [];\r\n\r\n\t\tfor ( var h = 0; h < hierarchyTracks.length; h ++ ) {\r\n\r\n\t\t\tvar animationKeys = hierarchyTracks[ h ].keys;\r\n\r\n\t\t\t// skip empty tracks\r\n\t\t\tif ( ! animationKeys || animationKeys.length === 0 ) continue;\r\n\r\n\t\t\t// process morph targets in a way exactly compatible\r\n\t\t\t// with AnimationHandler.init( animation )\r\n\t\t\tif ( animationKeys[0].morphTargets ) {\r\n\r\n\t\t\t\t// figure out all morph targets used in this track\r\n\t\t\t\tvar morphTargetNames = {};\r\n\t\t\t\tfor ( var k = 0; k < animationKeys.length; k ++ ) {\r\n\r\n\t\t\t\t\tif ( animationKeys[k].morphTargets ) {\r\n\r\n\t\t\t\t\t\tfor ( var m = 0; m < animationKeys[k].morphTargets.length; m ++ ) {\r\n\r\n\t\t\t\t\t\t\tmorphTargetNames[ animationKeys[k].morphTargets[m] ] = -1;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// create a track for each morph target with all zero\r\n\t\t\t\t// morphTargetInfluences except for the keys in which\r\n\t\t\t\t// the morphTarget is named.\r\n\t\t\t\tfor ( var morphTargetName in morphTargetNames ) {\r\n\r\n\t\t\t\t\tvar times = [];\r\n\t\t\t\t\tvar values = [];\r\n\r\n\t\t\t\t\tfor ( var m = 0;\r\n\t\t\t\t\t\t\tm !== animationKeys[k].morphTargets.length; ++ m ) {\r\n\r\n\t\t\t\t\t\tvar animationKey = animationKeys[k];\r\n\r\n\t\t\t\t\t\ttimes.push( animationKey.time );\r\n\t\t\t\t\t\tvalues.push( ( animationKey.morphTarget === morphTargetName ) ? 1 : 0 );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\ttracks.push( new THREE.NumberKeyframeTrack(\r\n\t\t\t\t\t\t\t'.morphTargetInfluence[' + morphTargetName + ']', times, values ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tduration = morphTargetNames.length * ( fps || 1.0 );\r\n\r\n\t\t\t} else {\r\n\t\t\t\t// ...assume skeletal animation\r\n\r\n\t\t\t\tvar boneName = '.bones[' + bones[ h ].name + ']';\r\n\r\n\t\t\t\taddNonemptyTrack(\r\n\t\t\t\t\t\tTHREE.VectorKeyframeTrack, boneName + '.position',\r\n\t\t\t\t\t\tanimationKeys, 'pos', tracks );\r\n\r\n\t\t\t\taddNonemptyTrack(\r\n\t\t\t\t\t\tTHREE.QuaternionKeyframeTrack, boneName + '.quaternion',\r\n\t\t\t\t\t\tanimationKeys, 'rot', tracks );\r\n\r\n\t\t\t\taddNonemptyTrack(\r\n\t\t\t\t\t\tTHREE.VectorKeyframeTrack, boneName + '.scale',\r\n\t\t\t\t\t\tanimationKeys, 'scl', tracks );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( tracks.length === 0 ) {\r\n\r\n\t\t\treturn null;\r\n\r\n\t\t}\r\n\r\n\t\tvar clip = new THREE.AnimationClip( clipName, duration, tracks );\r\n\r\n\t\treturn clip;\r\n\r\n\t}\r\n\r\n} );\r\n\r\n// File:src/animation/AnimationMixer.js\r\n\r\n/**\r\n *\r\n * Player for AnimationClips.\r\n *\r\n *\r\n * @author Ben Houston / http://clara.io/\r\n * @author David Sarno / http://lighthaus.us/\r\n * @author tschw\r\n */\r\n\r\nTHREE.AnimationMixer = function( root ) {\r\n\r\n\tthis._root = root;\r\n\tthis._initMemoryManager();\r\n\tthis._accuIndex = 0;\r\n\r\n\tthis.time = 0;\r\n\r\n\tthis.timeScale = 1.0;\r\n\r\n};\r\n\r\nObject.assign( THREE.AnimationMixer.prototype, THREE.EventDispatcher.prototype, {\r\n\r\n\t// return an action for a clip optionally using a custom root target\r\n\t// object (this method allocates a lot of dynamic memory in case a\r\n\t// previously unknown clip/root combination is specified)\r\n\tclipAction: function( clip, optionalRoot ) {\r\n\r\n\t\tvar root = optionalRoot || this._root,\r\n\t\t\trootUuid = root.uuid,\r\n\r\n\t\t\tclipObject = typeof clip === 'string' ?\r\n\t\t\t\t\tTHREE.AnimationClip.findByName( root, clip ) : clip,\r\n\r\n\t\t\tclipUuid = clipObject !== null ? clipObject.uuid : clip,\r\n\r\n\t\t\tactionsForClip = this._actionsByClip[ clipUuid ],\r\n\t\t\tprototypeAction = null;\r\n\r\n\t\tif ( actionsForClip !== undefined ) {\r\n\r\n\t\t\tvar existingAction =\r\n\t\t\t\t\tactionsForClip.actionByRoot[ rootUuid ];\r\n\r\n\t\t\tif ( existingAction !== undefined ) {\r\n\r\n\t\t\t\treturn existingAction;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// we know the clip, so we don't have to parse all\r\n\t\t\t// the bindings again but can just copy\r\n\t\t\tprototypeAction = actionsForClip.knownActions[ 0 ];\r\n\r\n\t\t\t// also, take the clip from the prototype action\r\n\t\t\tif ( clipObject === null )\r\n\t\t\t\tclipObject = prototypeAction._clip;\r\n\r\n\t\t}\r\n\r\n\t\t// clip must be known when specified via string\r\n\t\tif ( clipObject === null ) return null;\r\n\r\n\t\t// allocate all resources required to run it\r\n\t\tvar newAction = new THREE.\r\n\t\t\t\tAnimationMixer._Action( this, clipObject, optionalRoot );\r\n\r\n\t\tthis._bindAction( newAction, prototypeAction );\r\n\r\n\t\t// and make the action known to the memory manager\r\n\t\tthis._addInactiveAction( newAction, clipUuid, rootUuid );\r\n\r\n\t\treturn newAction;\r\n\r\n\t},\r\n\r\n\t// get an existing action\r\n\texistingAction: function( clip, optionalRoot ) {\r\n\r\n\t\tvar root = optionalRoot || this._root,\r\n\t\t\trootUuid = root.uuid,\r\n\r\n\t\t\tclipObject = typeof clip === 'string' ?\r\n\t\t\t\t\tTHREE.AnimationClip.findByName( root, clip ) : clip,\r\n\r\n\t\t\tclipUuid = clipObject ? clipObject.uuid : clip,\r\n\r\n\t\t\tactionsForClip = this._actionsByClip[ clipUuid ];\r\n\r\n\t\tif ( actionsForClip !== undefined ) {\r\n\r\n\t\t\treturn actionsForClip.actionByRoot[ rootUuid ] || null;\r\n\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\r\n\t},\r\n\r\n\t// deactivates all previously scheduled actions\r\n\tstopAllAction: function() {\r\n\r\n\t\tvar actions = this._actions,\r\n\t\t\tnActions = this._nActiveActions,\r\n\t\t\tbindings = this._bindings,\r\n\t\t\tnBindings = this._nActiveBindings;\r\n\r\n\t\tthis._nActiveActions = 0;\r\n\t\tthis._nActiveBindings = 0;\r\n\r\n\t\tfor ( var i = 0; i !== nActions; ++ i ) {\r\n\r\n\t\t\tactions[ i ].reset();\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var i = 0; i !== nBindings; ++ i ) {\r\n\r\n\t\t\tbindings[ i ].useCount = 0;\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\t// advance the time and update apply the animation\r\n\tupdate: function( deltaTime ) {\r\n\r\n\t\tdeltaTime *= this.timeScale;\r\n\r\n\t\tvar actions = this._actions,\r\n\t\t\tnActions = this._nActiveActions,\r\n\r\n\t\t\ttime = this.time += deltaTime,\r\n\t\t\ttimeDirection = Math.sign( deltaTime ),\r\n\r\n\t\t\taccuIndex = this._accuIndex ^= 1;\r\n\r\n\t\t// run active actions\r\n\r\n\t\tfor ( var i = 0; i !== nActions; ++ i ) {\r\n\r\n\t\t\tvar action = actions[ i ];\r\n\r\n\t\t\tif ( action.enabled ) {\r\n\r\n\t\t\t\taction._update( time, deltaTime, timeDirection, accuIndex );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// update scene graph\r\n\r\n\t\tvar bindings = this._bindings,\r\n\t\t\tnBindings = this._nActiveBindings;\r\n\r\n\t\tfor ( var i = 0; i !== nBindings; ++ i ) {\r\n\r\n\t\t\tbindings[ i ].apply( accuIndex );\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\t// return this mixer's root target object\r\n\tgetRoot: function() {\r\n\r\n\t\treturn this._root;\r\n\r\n\t},\r\n\r\n\t// free all resources specific to a particular clip\r\n\tuncacheClip: function( clip ) {\r\n\r\n\t\tvar actions = this._actions,\r\n\t\t\tclipUuid = clip.uuid,\r\n\t\t\tactionsByClip = this._actionsByClip,\r\n\t\t\tactionsForClip = actionsByClip[ clipUuid ];\r\n\r\n\t\tif ( actionsForClip !== undefined ) {\r\n\r\n\t\t\t// note: just calling _removeInactiveAction would mess up the\r\n\t\t\t// iteration state and also require updating the state we can\r\n\t\t\t// just throw away\r\n\r\n\t\t\tvar actionsToRemove = actionsForClip.knownActions;\r\n\r\n\t\t\tfor ( var i = 0, n = actionsToRemove.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\tvar action = actionsToRemove[ i ];\r\n\r\n\t\t\t\tthis._deactivateAction( action );\r\n\r\n\t\t\t\tvar cacheIndex = action._cacheIndex,\r\n\t\t\t\t\tlastInactiveAction = actions[ actions.length - 1 ];\r\n\r\n\t\t\t\taction._cacheIndex = null;\r\n\t\t\t\taction._byClipCacheIndex = null;\r\n\r\n\t\t\t\tlastInactiveAction._cacheIndex = cacheIndex;\r\n\t\t\t\tactions[ cacheIndex ] = lastInactiveAction;\r\n\t\t\t\tactions.pop();\r\n\r\n\t\t\t\tthis._removeInactiveBindingsForAction( action );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tdelete actionsByClip[ clipUuid ];\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\t// free all resources specific to a particular root target object\r\n\tuncacheRoot: function( root ) {\r\n\r\n\t\tvar rootUuid = root.uuid,\r\n\t\t\tactionsByClip = this._actionsByClip;\r\n\r\n\t\tfor ( var clipUuid in actionsByClip ) {\r\n\r\n\t\t\tvar actionByRoot = actionsByClip[ clipUuid ].actionByRoot,\r\n\t\t\t\taction = actionByRoot[ rootUuid ];\r\n\r\n\t\t\tif ( action !== undefined ) {\r\n\r\n\t\t\t\tthis._deactivateAction( action );\r\n\t\t\t\tthis._removeInactiveAction( action );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar bindingsByRoot = this._bindingsByRootAndName,\r\n\t\t\tbindingByName = bindingsByRoot[ rootUuid ];\r\n\r\n\t\tif ( bindingByName !== undefined ) {\r\n\r\n\t\t\tfor ( var trackName in bindingByName ) {\r\n\r\n\t\t\t\tvar binding = bindingByName[ trackName ];\r\n\t\t\t\tbinding.restoreOriginalState();\r\n\t\t\t\tthis._removeInactiveBinding( binding );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\t// remove a targeted clip from the cache\r\n\tuncacheAction: function( clip, optionalRoot ) {\r\n\r\n\t\tvar action = this.existingAction( clip, optionalRoot );\r\n\r\n\t\tif ( action !== null ) {\r\n\r\n\t\t\tthis._deactivateAction( action );\r\n\t\t\tthis._removeInactiveAction( action );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n} );\r\n\r\nTHREE.AnimationMixer._Action = THREE.AnimationAction._new;\r\n\r\n// Implementation details:\r\n\r\nObject.assign( THREE.AnimationMixer.prototype, {\r\n\r\n\t_bindAction: function( action, prototypeAction ) {\r\n\r\n\t\tvar root = action._localRoot || this._root,\r\n\t\t\ttracks = action._clip.tracks,\r\n\t\t\tnTracks = tracks.length,\r\n\t\t\tbindings = action._propertyBindings,\r\n\t\t\tinterpolants = action._interpolants,\r\n\t\t\trootUuid = root.uuid,\r\n\t\t\tbindingsByRoot = this._bindingsByRootAndName,\r\n\t\t\tbindingsByName = bindingsByRoot[ rootUuid ];\r\n\r\n\t\tif ( bindingsByName === undefined ) {\r\n\r\n\t\t\tbindingsByName = {};\r\n\t\t\tbindingsByRoot[ rootUuid ] = bindingsByName;\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var i = 0; i !== nTracks; ++ i ) {\r\n\r\n\t\t\tvar track = tracks[ i ],\r\n\t\t\t\ttrackName = track.name,\r\n\t\t\t\tbinding = bindingsByName[ trackName ];\r\n\r\n\t\t\tif ( binding !== undefined ) {\r\n\r\n\t\t\t\tbindings[ i ] = binding;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tbinding = bindings[ i ];\r\n\r\n\t\t\t\tif ( binding !== undefined ) {\r\n\r\n\t\t\t\t\t// existing binding, make sure the cache knows\r\n\r\n\t\t\t\t\tif ( binding._cacheIndex === null ) {\r\n\r\n\t\t\t\t\t\t++ binding.referenceCount;\r\n\t\t\t\t\t\tthis._addInactiveBinding( binding, rootUuid, trackName );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tcontinue;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar path = prototypeAction && prototypeAction.\r\n\t\t\t\t\t\t_propertyBindings[ i ].binding.parsedPath;\r\n\r\n\t\t\t\tbinding = new THREE.PropertyMixer(\r\n\t\t\t\t\t\tTHREE.PropertyBinding.create( root, trackName, path ),\r\n\t\t\t\t\t\ttrack.ValueTypeName, track.getValueSize() );\r\n\r\n\t\t\t\t++ binding.referenceCount;\r\n\t\t\t\tthis._addInactiveBinding( binding, rootUuid, trackName );\r\n\r\n\t\t\t\tbindings[ i ] = binding;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tinterpolants[ i ].resultBuffer = binding.buffer;\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\t_activateAction: function( action ) {\r\n\r\n\t\tif ( ! this._isActiveAction( action ) ) {\r\n\r\n\t\t\tif ( action._cacheIndex === null ) {\r\n\r\n\t\t\t\t// this action has been forgotten by the cache, but the user\r\n\t\t\t\t// appears to be still using it -> rebind\r\n\r\n\t\t\t\tvar rootUuid = ( action._localRoot || this._root ).uuid,\r\n\t\t\t\t\tclipUuid = action._clip.uuid,\r\n\t\t\t\t\tactionsForClip = this._actionsByClip[ clipUuid ];\r\n\r\n\t\t\t\tthis._bindAction( action,\r\n\t\t\t\t\t\tactionsForClip && actionsForClip.knownActions[ 0 ] );\r\n\r\n\t\t\t\tthis._addInactiveAction( action, clipUuid, rootUuid );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar bindings = action._propertyBindings;\r\n\r\n\t\t\t// increment reference counts / sort out state\r\n\t\t\tfor ( var i = 0, n = bindings.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\tvar binding = bindings[ i ];\r\n\r\n\t\t\t\tif ( binding.useCount ++ === 0 ) {\r\n\r\n\t\t\t\t\tthis._lendBinding( binding );\r\n\t\t\t\t\tbinding.saveOriginalState();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis._lendAction( action );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\t_deactivateAction: function( action ) {\r\n\r\n\t\tif ( this._isActiveAction( action ) ) {\r\n\r\n\t\t\tvar bindings = action._propertyBindings;\r\n\r\n\t\t\t// decrement reference counts / sort out state\r\n\t\t\tfor ( var i = 0, n = bindings.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\tvar binding = bindings[ i ];\r\n\r\n\t\t\t\tif ( -- binding.useCount === 0 ) {\r\n\r\n\t\t\t\t\tbinding.restoreOriginalState();\r\n\t\t\t\t\tthis._takeBackBinding( binding );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis._takeBackAction( action );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\t// Memory manager\r\n\r\n\t_initMemoryManager: function() {\r\n\r\n\t\tthis._actions = []; // 'nActiveActions' followed by inactive ones\r\n\t\tthis._nActiveActions = 0;\r\n\r\n\t\tthis._actionsByClip = {};\r\n\t\t// inside:\r\n\t\t// {\r\n\t\t// \t\tknownActions: Array< _Action >\t- used as prototypes\r\n\t\t// \t\tactionByRoot: _Action\t\t\t- lookup\r\n\t\t// }\r\n\r\n\r\n\t\tthis._bindings = []; // 'nActiveBindings' followed by inactive ones\r\n\t\tthis._nActiveBindings = 0;\r\n\r\n\t\tthis._bindingsByRootAndName = {}; // inside: Map< name, PropertyMixer >\r\n\r\n\r\n\t\tthis._controlInterpolants = []; // same game as above\r\n\t\tthis._nActiveControlInterpolants = 0;\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tthis.stats = {\r\n\r\n\t\t\tactions: {\r\n\t\t\t\tget total() { return scope._actions.length; },\r\n\t\t\t\tget inUse() { return scope._nActiveActions; }\r\n\t\t\t},\r\n\t\t\tbindings: {\r\n\t\t\t\tget total() { return scope._bindings.length; },\r\n\t\t\t\tget inUse() { return scope._nActiveBindings; }\r\n\t\t\t},\r\n\t\t\tcontrolInterpolants: {\r\n\t\t\t\tget total() { return scope._controlInterpolants.length; },\r\n\t\t\t\tget inUse() { return scope._nActiveControlInterpolants; }\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t},\r\n\r\n\t// Memory management for _Action objects\r\n\r\n\t_isActiveAction: function( action ) {\r\n\r\n\t\tvar index = action._cacheIndex;\r\n\t\treturn index !== null && index < this._nActiveActions;\r\n\r\n\t},\r\n\r\n\t_addInactiveAction: function( action, clipUuid, rootUuid ) {\r\n\r\n\t\tvar actions = this._actions,\r\n\t\t\tactionsByClip = this._actionsByClip,\r\n\t\t\tactionsForClip = actionsByClip[ clipUuid ];\r\n\r\n\t\tif ( actionsForClip === undefined ) {\r\n\r\n\t\t\tactionsForClip = {\r\n\r\n\t\t\t\tknownActions: [ action ],\r\n\t\t\t\tactionByRoot: {}\r\n\r\n\t\t\t};\r\n\r\n\t\t\taction._byClipCacheIndex = 0;\r\n\r\n\t\t\tactionsByClip[ clipUuid ] = actionsForClip;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tvar knownActions = actionsForClip.knownActions;\r\n\r\n\t\t\taction._byClipCacheIndex = knownActions.length;\r\n\t\t\tknownActions.push( action );\r\n\r\n\t\t}\r\n\r\n\t\taction._cacheIndex = actions.length;\r\n\t\tactions.push( action );\r\n\r\n\t\tactionsForClip.actionByRoot[ rootUuid ] = action;\r\n\r\n\t},\r\n\r\n\t_removeInactiveAction: function( action ) {\r\n\r\n\t\tvar actions = this._actions,\r\n\t\t\tlastInactiveAction = actions[ actions.length - 1 ],\r\n\t\t\tcacheIndex = action._cacheIndex;\r\n\r\n\t\tlastInactiveAction._cacheIndex = cacheIndex;\r\n\t\tactions[ cacheIndex ] = lastInactiveAction;\r\n\t\tactions.pop();\r\n\r\n\t\taction._cacheIndex = null;\r\n\r\n\r\n\t\tvar clipUuid = action._clip.uuid,\r\n\t\t\tactionsByClip = this._actionsByClip,\r\n\t\t\tactionsForClip = actionsByClip[ clipUuid ],\r\n\t\t\tknownActionsForClip = actionsForClip.knownActions,\r\n\r\n\t\t\tlastKnownAction =\r\n\t\t\t\tknownActionsForClip[ knownActionsForClip.length - 1 ],\r\n\r\n\t\t\tbyClipCacheIndex = action._byClipCacheIndex;\r\n\r\n\t\tlastKnownAction._byClipCacheIndex = byClipCacheIndex;\r\n\t\tknownActionsForClip[ byClipCacheIndex ] = lastKnownAction;\r\n\t\tknownActionsForClip.pop();\r\n\r\n\t\taction._byClipCacheIndex = null;\r\n\r\n\r\n\t\tvar actionByRoot = actionsForClip.actionByRoot,\r\n\t\t\trootUuid = ( actions._localRoot || this._root ).uuid;\r\n\r\n\t\tdelete actionByRoot[ rootUuid ];\r\n\r\n\t\tif ( knownActionsForClip.length === 0 ) {\r\n\r\n\t\t\tdelete actionsByClip[ clipUuid ];\r\n\r\n\t\t}\r\n\r\n\t\tthis._removeInactiveBindingsForAction( action );\r\n\r\n\t},\r\n\r\n\t_removeInactiveBindingsForAction: function( action ) {\r\n\r\n\t\tvar bindings = action._propertyBindings;\r\n\t\tfor ( var i = 0, n = bindings.length; i !== n; ++ i ) {\r\n\r\n\t\t\tvar binding = bindings[ i ];\r\n\r\n\t\t\tif ( -- binding.referenceCount === 0 ) {\r\n\r\n\t\t\t\tthis._removeInactiveBinding( binding );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\t_lendAction: function( action ) {\r\n\r\n\t\t// [ active actions |  inactive actions  ]\r\n\t\t// [  active actions >| inactive actions ]\r\n\t\t//                 s        a\r\n\t\t//                  <-swap->\r\n\t\t//                 a        s\r\n\r\n\t\tvar actions = this._actions,\r\n\t\t\tprevIndex = action._cacheIndex,\r\n\r\n\t\t\tlastActiveIndex = this._nActiveActions ++,\r\n\r\n\t\t\tfirstInactiveAction = actions[ lastActiveIndex ];\r\n\r\n\t\taction._cacheIndex = lastActiveIndex;\r\n\t\tactions[ lastActiveIndex ] = action;\r\n\r\n\t\tfirstInactiveAction._cacheIndex = prevIndex;\r\n\t\tactions[ prevIndex ] = firstInactiveAction;\r\n\r\n\t},\r\n\r\n\t_takeBackAction: function( action ) {\r\n\r\n\t\t// [  active actions  | inactive actions ]\r\n\t\t// [ active actions |< inactive actions  ]\r\n\t\t//        a        s\r\n\t\t//         <-swap->\r\n\t\t//        s        a\r\n\r\n\t\tvar actions = this._actions,\r\n\t\t\tprevIndex = action._cacheIndex,\r\n\r\n\t\t\tfirstInactiveIndex = -- this._nActiveActions,\r\n\r\n\t\t\tlastActiveAction = actions[ firstInactiveIndex ];\r\n\r\n\t\taction._cacheIndex = firstInactiveIndex;\r\n\t\tactions[ firstInactiveIndex ] = action;\r\n\r\n\t\tlastActiveAction._cacheIndex = prevIndex;\r\n\t\tactions[ prevIndex ] = lastActiveAction;\r\n\r\n\t},\r\n\r\n\t// Memory management for PropertyMixer objects\r\n\r\n\t_addInactiveBinding: function( binding, rootUuid, trackName ) {\r\n\r\n\t\tvar bindingsByRoot = this._bindingsByRootAndName,\r\n\t\t\tbindingByName = bindingsByRoot[ rootUuid ],\r\n\r\n\t\t\tbindings = this._bindings;\r\n\r\n\t\tif ( bindingByName === undefined ) {\r\n\r\n\t\t\tbindingByName = {};\r\n\t\t\tbindingsByRoot[ rootUuid ] = bindingByName;\r\n\r\n\t\t}\r\n\r\n\t\tbindingByName[ trackName ] = binding;\r\n\r\n\t\tbinding._cacheIndex = bindings.length;\r\n\t\tbindings.push( binding );\r\n\r\n\t},\r\n\r\n\t_removeInactiveBinding: function( binding ) {\r\n\r\n\t\tvar bindings = this._bindings,\r\n\t\t\tpropBinding = binding.binding,\r\n\t\t\trootUuid = propBinding.rootNode.uuid,\r\n\t\t\ttrackName = propBinding.path,\r\n\t\t\tbindingsByRoot = this._bindingsByRootAndName,\r\n\t\t\tbindingByName = bindingsByRoot[ rootUuid ],\r\n\r\n\t\t\tlastInactiveBinding = bindings[ bindings.length - 1 ],\r\n\t\t\tcacheIndex = binding._cacheIndex;\r\n\r\n\t\tlastInactiveBinding._cacheIndex = cacheIndex;\r\n\t\tbindings[ cacheIndex ] = lastInactiveBinding;\r\n\t\tbindings.pop();\r\n\r\n\t\tdelete bindingByName[ trackName ];\r\n\r\n\t\tremove_empty_map: {\r\n\r\n\t\t\tfor ( var _ in bindingByName ) break remove_empty_map;\r\n\r\n\t\t\tdelete bindingsByRoot[ rootUuid ];\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\t_lendBinding: function( binding ) {\r\n\r\n\t\tvar bindings = this._bindings,\r\n\t\t\tprevIndex = binding._cacheIndex,\r\n\r\n\t\t\tlastActiveIndex = this._nActiveBindings ++,\r\n\r\n\t\t\tfirstInactiveBinding = bindings[ lastActiveIndex ];\r\n\r\n\t\tbinding._cacheIndex = lastActiveIndex;\r\n\t\tbindings[ lastActiveIndex ] = binding;\r\n\r\n\t\tfirstInactiveBinding._cacheIndex = prevIndex;\r\n\t\tbindings[ prevIndex ] = firstInactiveBinding;\r\n\r\n\t},\r\n\r\n\t_takeBackBinding: function( binding ) {\r\n\r\n\t\tvar bindings = this._bindings,\r\n\t\t\tprevIndex = binding._cacheIndex,\r\n\r\n\t\t\tfirstInactiveIndex = -- this._nActiveBindings,\r\n\r\n\t\t\tlastActiveBinding = bindings[ firstInactiveIndex ];\r\n\r\n\t\tbinding._cacheIndex = firstInactiveIndex;\r\n\t\tbindings[ firstInactiveIndex ] = binding;\r\n\r\n\t\tlastActiveBinding._cacheIndex = prevIndex;\r\n\t\tbindings[ prevIndex ] = lastActiveBinding;\r\n\r\n\t},\r\n\r\n\r\n\t// Memory management of Interpolants for weight and time scale\r\n\r\n\t_lendControlInterpolant: function() {\r\n\r\n\t\tvar interpolants = this._controlInterpolants,\r\n\t\t\tlastActiveIndex = this._nActiveControlInterpolants ++,\r\n\t\t\tinterpolant = interpolants[ lastActiveIndex ];\r\n\r\n\t\tif ( interpolant === undefined ) {\r\n\r\n\t\t\tinterpolant = new THREE.LinearInterpolant(\r\n\t\t\t\t\tnew Float32Array( 2 ), new Float32Array( 2 ),\r\n\t\t\t\t\t\t1, this._controlInterpolantsResultBuffer );\r\n\r\n\t\t\tinterpolant.__cacheIndex = lastActiveIndex;\r\n\t\t\tinterpolants[ lastActiveIndex ] = interpolant;\r\n\r\n\t\t}\r\n\r\n\t\treturn interpolant;\r\n\r\n\t},\r\n\r\n\t_takeBackControlInterpolant: function( interpolant ) {\r\n\r\n\t\tvar interpolants = this._controlInterpolants,\r\n\t\t\tprevIndex = interpolant.__cacheIndex,\r\n\r\n\t\t\tfirstInactiveIndex = -- this._nActiveControlInterpolants,\r\n\r\n\t\t\tlastActiveInterpolant = interpolants[ firstInactiveIndex ];\r\n\r\n\t\tinterpolant.__cacheIndex = firstInactiveIndex;\r\n\t\tinterpolants[ firstInactiveIndex ] = interpolant;\r\n\r\n\t\tlastActiveInterpolant.__cacheIndex = prevIndex;\r\n\t\tinterpolants[ prevIndex ] = lastActiveInterpolant;\r\n\r\n\t},\r\n\r\n\t_controlInterpolantsResultBuffer: new Float32Array( 1 )\r\n\r\n} );\r\n\r\n// File:src/animation/AnimationObjectGroup.js\r\n\r\n/**\r\n *\r\n * A group of objects that receives a shared animation state.\r\n *\r\n * Usage:\r\n *\r\n * \t-\tAdd objects you would otherwise pass as 'root' to the\r\n * \t\tconstructor or the .clipAction method of AnimationMixer.\r\n *\r\n * \t-\tInstead pass this object as 'root'.\r\n *\r\n * \t-\tYou can also add and remove objects later when the mixer\r\n * \t\tis running.\r\n *\r\n * Note:\r\n *\r\n *  \tObjects of this class appear as one object to the mixer,\r\n *  \tso cache control of the individual objects must be done\r\n *  \ton the group.\r\n *\r\n * Limitation:\r\n *\r\n * \t- \tThe animated properties must be compatible among the\r\n * \t\tall objects in the group.\r\n *\r\n *  -\tA single property can either be controlled through a\r\n *  \ttarget group or directly, but not both.\r\n *\r\n * @author tschw\r\n */\r\n\r\nTHREE.AnimationObjectGroup = function( var_args ) {\r\n\r\n\tthis.uuid = THREE.Math.generateUUID();\r\n\r\n\t// cached objects followed by the active ones\r\n\tthis._objects = Array.prototype.slice.call( arguments );\r\n\r\n\tthis.nCachedObjects_ = 0;\t\t\t// threshold\r\n\t// note: read by PropertyBinding.Composite\r\n\r\n\tvar indices = {};\r\n\tthis._indicesByUUID = indices;\t\t// for bookkeeping\r\n\r\n\tfor ( var i = 0, n = arguments.length; i !== n; ++ i ) {\r\n\r\n\t\tindices[ arguments[ i ].uuid ] = i;\r\n\r\n\t}\r\n\r\n\tthis._paths = [];\t\t\t\t\t// inside: string\r\n\tthis._parsedPaths = [];\t\t\t\t// inside: { we don't care, here }\r\n\tthis._bindings = []; \t\t\t\t// inside: Array< PropertyBinding >\r\n\tthis._bindingsIndicesByPath = {}; \t// inside: indices in these arrays\r\n\r\n\tvar scope = this;\r\n\r\n\tthis.stats = {\r\n\r\n\t\tobjects: {\r\n\t\t\tget total() { return scope._objects.length; },\r\n\t\t\tget inUse() { return this.total - scope.nCachedObjects_;  }\r\n\t\t},\r\n\r\n\t\tget bindingsPerObject() { return scope._bindings.length; }\r\n\r\n\t};\r\n\r\n};\r\n\r\nTHREE.AnimationObjectGroup.prototype = {\r\n\r\n\tconstructor: THREE.AnimationObjectGroup,\r\n\r\n\tadd: function( var_args ) {\r\n\r\n\t\tvar objects = this._objects,\r\n\t\t\tnObjects = objects.length,\r\n\t\t\tnCachedObjects = this.nCachedObjects_,\r\n\t\t\tindicesByUUID = this._indicesByUUID,\r\n\t\t\tpaths = this._paths,\r\n\t\t\tparsedPaths = this._parsedPaths,\r\n\t\t\tbindings = this._bindings,\r\n\t\t\tnBindings = bindings.length;\r\n\r\n\t\tfor ( var i = 0, n = arguments.length; i !== n; ++ i ) {\r\n\r\n\t\t\tvar object = arguments[ i ],\r\n\t\t\t\tuuid = object.uuid,\r\n\t\t\t\tindex = indicesByUUID[ uuid ];\r\n\r\n\t\t\tif ( index === undefined ) {\r\n\r\n\t\t\t\t// unknown object -> add it to the ACTIVE region\r\n\r\n\t\t\t\tindex = nObjects ++;\r\n\t\t\t\tindicesByUUID[ uuid ] = index;\r\n\t\t\t\tobjects.push( object );\r\n\r\n\t\t\t\t// accounting is done, now do the same for all bindings\r\n\r\n\t\t\t\tfor ( var j = 0, m = nBindings; j !== m; ++ j ) {\r\n\r\n\t\t\t\t\tbindings[ j ].push(\r\n\t\t\t\t\t\t\tnew THREE.PropertyBinding(\r\n\t\t\t\t\t\t\t\tobject, paths[ j ], parsedPaths[ j ] ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( index < nCachedObjects ) {\r\n\r\n\t\t\t\tvar knownObject = objects[ index ];\r\n\r\n\t\t\t\t// move existing object to the ACTIVE region\r\n\r\n\t\t\t\tvar firstActiveIndex = -- nCachedObjects,\r\n\t\t\t\t\tlastCachedObject = objects[ firstActiveIndex ];\r\n\r\n\t\t\t\tindicesByUUID[ lastCachedObject.uuid ] = index;\r\n\t\t\t\tobjects[ index ] = lastCachedObject;\r\n\r\n\t\t\t\tindicesByUUID[ uuid ] = firstActiveIndex;\r\n\t\t\t\tobjects[ firstActiveIndex ] = object;\r\n\r\n\t\t\t\t// accounting is done, now do the same for all bindings\r\n\r\n\t\t\t\tfor ( var j = 0, m = nBindings; j !== m; ++ j ) {\r\n\r\n\t\t\t\t\tvar bindingsForPath = bindings[ j ],\r\n\t\t\t\t\t\tlastCached = bindingsForPath[ firstActiveIndex ],\r\n\t\t\t\t\t\tbinding = bindingsForPath[ index ];\r\n\r\n\t\t\t\t\tbindingsForPath[ index ] = lastCached;\r\n\r\n\t\t\t\t\tif ( binding === undefined ) {\r\n\r\n\t\t\t\t\t\t// since we do not bother to create new bindings\r\n\t\t\t\t\t\t// for objects that are cached, the binding may\r\n\t\t\t\t\t\t// or may not exist\r\n\r\n\t\t\t\t\t\tbinding = new THREE.PropertyBinding(\r\n\t\t\t\t\t\t\t\tobject, paths[ j ], parsedPaths[ j ] );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tbindingsForPath[ firstActiveIndex ] = binding;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( objects[ index ] !== knownObject) {\r\n\r\n\t\t\t\tconsole.error( \"Different objects with the same UUID \" +\r\n\t\t\t\t\t\t\"detected. Clean the caches or recreate your \" +\r\n\t\t\t\t\t\t\"infrastructure when reloading scenes...\" );\r\n\r\n\t\t\t} // else the object is already where we want it to be\r\n\r\n\t\t} // for arguments\r\n\r\n\t\tthis.nCachedObjects_ = nCachedObjects;\r\n\r\n\t},\r\n\r\n\tremove: function( var_args ) {\r\n\r\n\t\tvar objects = this._objects,\r\n\t\t\tnObjects = objects.length,\r\n\t\t\tnCachedObjects = this.nCachedObjects_,\r\n\t\t\tindicesByUUID = this._indicesByUUID,\r\n\t\t\tbindings = this._bindings,\r\n\t\t\tnBindings = bindings.length;\r\n\r\n\t\tfor ( var i = 0, n = arguments.length; i !== n; ++ i ) {\r\n\r\n\t\t\tvar object = arguments[ i ],\r\n\t\t\t\tuuid = object.uuid,\r\n\t\t\t\tindex = indicesByUUID[ uuid ];\r\n\r\n\t\t\tif ( index !== undefined && index >= nCachedObjects ) {\r\n\r\n\t\t\t\t// move existing object into the CACHED region\r\n\r\n\t\t\t\tvar lastCachedIndex = nCachedObjects ++,\r\n\t\t\t\t\tfirstActiveObject = objects[ lastCachedIndex ];\r\n\r\n\t\t\t\tindicesByUUID[ firstActiveObject.uuid ] = index;\r\n\t\t\t\tobjects[ index ] = firstActiveObject;\r\n\r\n\t\t\t\tindicesByUUID[ uuid ] = lastCachedIndex;\r\n\t\t\t\tobjects[ lastCachedIndex ] = object;\r\n\r\n\t\t\t\t// accounting is done, now do the same for all bindings\r\n\r\n\t\t\t\tfor ( var j = 0, m = nBindings; j !== m; ++ j ) {\r\n\r\n\t\t\t\t\tvar bindingsForPath = bindings[ j ],\r\n\t\t\t\t\t\tfirstActive = bindingsForPath[ lastCachedIndex ],\r\n\t\t\t\t\t\tbinding = bindingsForPath[ index ];\r\n\r\n\t\t\t\t\tbindingsForPath[ index ] = firstActive;\r\n\t\t\t\t\tbindingsForPath[ lastCachedIndex ] = binding;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t} // for arguments\r\n\r\n\t\tthis.nCachedObjects_ = nCachedObjects;\r\n\r\n\t},\r\n\r\n\t// remove & forget\r\n\tuncache: function( var_args ) {\r\n\r\n\t\tvar objects = this._objects,\r\n\t\t\tnObjects = objects.length,\r\n\t\t\tnCachedObjects = this.nCachedObjects_,\r\n\t\t\tindicesByUUID = this._indicesByUUID,\r\n\t\t\tbindings = this._bindings,\r\n\t\t\tnBindings = bindings.length;\r\n\r\n\t\tfor ( var i = 0, n = arguments.length; i !== n; ++ i ) {\r\n\r\n\t\t\tvar object = arguments[ i ],\r\n\t\t\t\tuuid = object.uuid,\r\n\t\t\t\tindex = indicesByUUID[ uuid ];\r\n\r\n\t\t\tif ( index !== undefined ) {\r\n\r\n\t\t\t\tdelete indicesByUUID[ uuid ];\r\n\r\n\t\t\t\tif ( index < nCachedObjects ) {\r\n\r\n\t\t\t\t\t// object is cached, shrink the CACHED region\r\n\r\n\t\t\t\t\tvar firstActiveIndex = -- nCachedObjects,\r\n\t\t\t\t\t\tlastCachedObject = objects[ firstActiveIndex ],\r\n\t\t\t\t\t\tlastIndex = -- nObjects,\r\n\t\t\t\t\t\tlastObject = objects[ lastIndex ];\r\n\r\n\t\t\t\t\t// last cached object takes this object's place\r\n\t\t\t\t\tindicesByUUID[ lastCachedObject.uuid ] = index;\r\n\t\t\t\t\tobjects[ index ] = lastCachedObject;\r\n\r\n\t\t\t\t\t// last object goes to the activated slot and pop\r\n\t\t\t\t\tindicesByUUID[ lastObject.uuid ] = firstActiveIndex;\r\n\t\t\t\t\tobjects[ firstActiveIndex ] = lastObject;\r\n\t\t\t\t\tobjects.pop();\r\n\r\n\t\t\t\t\t// accounting is done, now do the same for all bindings\r\n\r\n\t\t\t\t\tfor ( var j = 0, m = nBindings; j !== m; ++ j ) {\r\n\r\n\t\t\t\t\t\tvar bindingsForPath = bindings[ j ],\r\n\t\t\t\t\t\t\tlastCached = bindingsForPath[ firstActiveIndex ],\r\n\t\t\t\t\t\t\tlast = bindingsForPath[ lastIndex ];\r\n\r\n\t\t\t\t\t\tbindingsForPath[ index ] = lastCached;\r\n\t\t\t\t\t\tbindingsForPath[ firstActiveIndex ] = last;\r\n\t\t\t\t\t\tbindingsForPath.pop();\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t// object is active, just swap with the last and pop\r\n\r\n\t\t\t\t\tvar lastIndex = -- nObjects,\r\n\t\t\t\t\t\tlastObject = objects[ lastIndex ];\r\n\r\n\t\t\t\t\tindicesByUUID[ lastObject.uuid ] = index;\r\n\t\t\t\t\tobjects[ index ] = lastObject;\r\n\t\t\t\t\tobjects.pop();\r\n\r\n\t\t\t\t\t// accounting is done, now do the same for all bindings\r\n\r\n\t\t\t\t\tfor ( var j = 0, m = nBindings; j !== m; ++ j ) {\r\n\r\n\t\t\t\t\t\tvar bindingsForPath = bindings[ j ];\r\n\r\n\t\t\t\t\t\tbindingsForPath[ index ] = bindingsForPath[ lastIndex ];\r\n\t\t\t\t\t\tbindingsForPath.pop();\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} // cached or active\r\n\r\n\t\t\t} // if object is known\r\n\r\n\t\t} // for arguments\r\n\r\n\t\tthis.nCachedObjects_ = nCachedObjects;\r\n\r\n\t},\r\n\r\n\t// Internal interface used by befriended PropertyBinding.Composite:\r\n\r\n\tsubscribe_: function( path, parsedPath ) {\r\n\t\t// returns an array of bindings for the given path that is changed\r\n\t\t// according to the contained objects in the group\r\n\r\n\t\tvar indicesByPath = this._bindingsIndicesByPath,\r\n\t\t\tindex = indicesByPath[ path ],\r\n\t\t\tbindings = this._bindings;\r\n\r\n\t\tif ( index !== undefined ) return bindings[ index ];\r\n\r\n\t\tvar paths = this._paths,\r\n\t\t\tparsedPaths = this._parsedPaths,\r\n\t\t\tobjects = this._objects,\r\n\t\t\tnObjects = objects.length,\r\n\t\t\tnCachedObjects = this.nCachedObjects_,\r\n\t\t\tbindingsForPath = new Array( nObjects );\r\n\r\n\t\tindex = bindings.length;\r\n\r\n\t\tindicesByPath[ path ] = index;\r\n\r\n\t\tpaths.push( path );\r\n\t\tparsedPaths.push( parsedPath );\r\n\t\tbindings.push( bindingsForPath );\r\n\r\n\t\tfor ( var i = nCachedObjects,\r\n\t\t\t\tn = objects.length; i !== n; ++ i ) {\r\n\r\n\t\t\tvar object = objects[ i ];\r\n\r\n\t\t\tbindingsForPath[ i ] =\r\n\t\t\t\t\tnew THREE.PropertyBinding( object, path, parsedPath );\r\n\r\n\t\t}\r\n\r\n\t\treturn bindingsForPath;\r\n\r\n\t},\r\n\r\n\tunsubscribe_: function( path ) {\r\n\t\t// tells the group to forget about a property path and no longer\r\n\t\t// update the array previously obtained with 'subscribe_'\r\n\r\n\t\tvar indicesByPath = this._bindingsIndicesByPath,\r\n\t\t\tindex = indicesByPath[ path ];\r\n\r\n\t\tif ( index !== undefined ) {\r\n\r\n\t\t\tvar paths = this._paths,\r\n\t\t\t\tparsedPaths = this._parsedPaths,\r\n\t\t\t\tbindings = this._bindings,\r\n\t\t\t\tlastBindingsIndex = bindings.length - 1,\r\n\t\t\t\tlastBindings = bindings[ lastBindingsIndex ],\r\n\t\t\t\tlastBindingsPath = path[ lastBindingsIndex ];\r\n\r\n\t\t\tindicesByPath[ lastBindingsPath ] = index;\r\n\r\n\t\t\tbindings[ index ] = lastBindings;\r\n\t\t\tbindings.pop();\r\n\r\n\t\t\tparsedPaths[ index ] = parsedPaths[ lastBindingsIndex ];\r\n\t\t\tparsedPaths.pop();\r\n\r\n\t\t\tpaths[ index ] = paths[ lastBindingsIndex ];\r\n\t\t\tpaths.pop();\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\n\r\n// File:src/animation/AnimationUtils.js\r\n\r\n/**\r\n * @author tschw\r\n * @author Ben Houston / http://clara.io/\r\n * @author David Sarno / http://lighthaus.us/\r\n */\r\n\r\nTHREE.AnimationUtils = {\r\n\r\n\t// same as Array.prototype.slice, but also works on typed arrays\r\n\tarraySlice: function( array, from, to ) {\r\n\r\n\t\tif ( THREE.AnimationUtils.isTypedArray( array ) ) {\r\n\r\n\t\t\treturn new array.constructor( array.subarray( from, to ) );\r\n\r\n\t\t}\r\n\r\n\t\treturn array.slice( from, to );\r\n\r\n\t},\r\n\r\n\t// converts an array to a specific type\r\n\tconvertArray: function( array, type, forceClone ) {\r\n\r\n\t\tif ( ! array || // let 'undefined' and 'null' pass\r\n\t\t\t\t! forceClone && array.constructor === type ) return array;\r\n\r\n\t\tif ( typeof type.BYTES_PER_ELEMENT === 'number' ) {\r\n\r\n\t\t\treturn new type( array ); // create typed array\r\n\r\n\t\t}\r\n\r\n\t\treturn Array.prototype.slice.call( array ); // create Array\r\n\r\n\t},\r\n\r\n\tisTypedArray: function( object ) {\r\n\r\n\t\treturn ArrayBuffer.isView( object ) &&\r\n\t\t\t\t! ( object instanceof DataView );\r\n\r\n\t},\r\n\r\n\t// returns an array by which times and values can be sorted\r\n\tgetKeyframeOrder: function( times ) {\r\n\r\n\t\tfunction compareTime( i, j ) {\r\n\r\n\t\t\treturn times[ i ] - times[ j ];\r\n\r\n\t\t}\r\n\r\n\t\tvar n = times.length;\r\n\t\tvar result = new Array( n );\r\n\t\tfor ( var i = 0; i !== n; ++ i ) result[ i ] = i;\r\n\r\n\t\tresult.sort( compareTime );\r\n\r\n\t\treturn result;\r\n\r\n\t},\r\n\r\n\t// uses the array previously returned by 'getKeyframeOrder' to sort data\r\n\tsortedArray: function( values, stride, order ) {\r\n\r\n\t\tvar nValues = values.length;\r\n\t\tvar result = new values.constructor( nValues );\r\n\r\n\t\tfor ( var i = 0, dstOffset = 0; dstOffset !== nValues; ++ i ) {\r\n\r\n\t\t\tvar srcOffset = order[ i ] * stride;\r\n\r\n\t\t\tfor ( var j = 0; j !== stride; ++ j ) {\r\n\r\n\t\t\t\tresult[ dstOffset ++ ] = values[ srcOffset + j ];\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\r\n\t},\r\n\r\n\t// function for parsing AOS keyframe formats\r\n\tflattenJSON: function( jsonKeys, times, values, valuePropertyName ) {\r\n\r\n\t\tvar i = 1, key = jsonKeys[ 0 ];\r\n\r\n\t\twhile ( key !== undefined && key[ valuePropertyName ] === undefined ) {\r\n\r\n\t\t\tkey = jsonKeys[ i ++ ];\r\n\r\n\t\t}\r\n\r\n\t\tif ( key === undefined ) return; // no data\r\n\r\n\t\tvar value = key[ valuePropertyName ];\r\n\t\tif ( value === undefined ) return; // no data\r\n\r\n\t\tif ( Array.isArray( value ) ) {\r\n\r\n\t\t\tdo {\r\n\r\n\t\t\t\tvalue = key[ valuePropertyName ];\r\n\r\n\t\t\t\tif ( value !== undefined ) {\r\n\r\n\t\t\t\t\ttimes.push( key.time );\r\n\t\t\t\t\tvalues.push.apply( values, value ); // push all elements\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tkey = jsonKeys[ i ++ ];\r\n\r\n\t\t\t} while ( key !== undefined );\r\n\r\n\t\t} else if ( value.toArray !== undefined ) {\r\n\t\t\t// ...assume THREE.Math-ish\r\n\r\n\t\t\tdo {\r\n\r\n\t\t\t\tvalue = key[ valuePropertyName ];\r\n\r\n\t\t\t\tif ( value !== undefined ) {\r\n\r\n\t\t\t\t\ttimes.push( key.time );\r\n\t\t\t\t\tvalue.toArray( values, values.length );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tkey = jsonKeys[ i ++ ];\r\n\r\n\t\t\t} while ( key !== undefined );\r\n\r\n\t\t} else {\r\n\t\t\t// otherwise push as-is\r\n\r\n\t\t\tdo {\r\n\r\n\t\t\t\tvalue = key[ valuePropertyName ];\r\n\r\n\t\t\t\tif ( value !== undefined ) {\r\n\r\n\t\t\t\t\ttimes.push( key.time );\r\n\t\t\t\t\tvalues.push( value );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tkey = jsonKeys[ i ++ ];\r\n\r\n\t\t\t} while ( key !== undefined );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/animation/KeyframeTrack.js\r\n\r\n/**\r\n *\r\n * A timed sequence of keyframes for a specific property.\r\n *\r\n *\r\n * @author Ben Houston / http://clara.io/\r\n * @author David Sarno / http://lighthaus.us/\r\n * @author tschw\r\n */\r\n\r\nTHREE.KeyframeTrack = function ( name, times, values, interpolation ) {\r\n\r\n\tif( name === undefined ) throw new Error( \"track name is undefined\" );\r\n\r\n\tif( times === undefined || times.length === 0 ) {\r\n\r\n\t\tthrow new Error( \"no keyframes in track named \" + name );\r\n\r\n\t}\r\n\r\n\tthis.name = name;\r\n\r\n\tthis.times = THREE.AnimationUtils.convertArray( times, this.TimeBufferType );\r\n\tthis.values = THREE.AnimationUtils.convertArray( values, this.ValueBufferType );\r\n\r\n\tthis.setInterpolation( interpolation || this.DefaultInterpolation );\r\n\r\n\tthis.validate();\r\n\tthis.optimize();\r\n\r\n};\r\n\r\nTHREE.KeyframeTrack.prototype = {\r\n\r\n\tconstructor: THREE.KeyframeTrack,\r\n\r\n\tTimeBufferType: Float32Array,\r\n\tValueBufferType: Float32Array,\r\n\r\n\tDefaultInterpolation: THREE.InterpolateLinear,\r\n\r\n\tInterpolantFactoryMethodDiscrete: function( result ) {\r\n\r\n\t\treturn new THREE.DiscreteInterpolant(\r\n\t\t\t\tthis.times, this.values, this.getValueSize(), result );\r\n\r\n\t},\r\n\r\n\tInterpolantFactoryMethodLinear: function( result ) {\r\n\r\n\t\treturn new THREE.LinearInterpolant(\r\n\t\t\t\tthis.times, this.values, this.getValueSize(), result );\r\n\r\n\t},\r\n\r\n\tInterpolantFactoryMethodSmooth: function( result ) {\r\n\r\n\t\treturn new THREE.CubicInterpolant(\r\n\t\t\t\tthis.times, this.values, this.getValueSize(), result );\r\n\r\n\t},\r\n\r\n\tsetInterpolation: function( interpolation ) {\r\n\r\n\t\tvar factoryMethod;\r\n\r\n\t\tswitch ( interpolation ) {\r\n\r\n\t\t\tcase THREE.InterpolateDiscrete:\r\n\r\n\t\t\t\tfactoryMethod = this.InterpolantFactoryMethodDiscrete;\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase THREE.InterpolateLinear:\r\n\r\n\t\t\t\tfactoryMethod = this.InterpolantFactoryMethodLinear;\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase THREE.InterpolateSmooth:\r\n\r\n\t\t\t\tfactoryMethod = this.InterpolantFactoryMethodSmooth;\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t\tif ( factoryMethod === undefined ) {\r\n\r\n\t\t\tvar message = \"unsupported interpolation for \" +\r\n\t\t\t\t\tthis.ValueTypeName + \" keyframe track named \" + this.name;\r\n\r\n\t\t\tif ( this.createInterpolant === undefined ) {\r\n\r\n\t\t\t\t// fall back to default, unless the default itself is messed up\r\n\t\t\t\tif ( interpolation !== this.DefaultInterpolation ) {\r\n\r\n\t\t\t\t\tthis.setInterpolation( this.DefaultInterpolation );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tthrow new Error( message ); // fatal, in this case\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tconsole.warn( message );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tthis.createInterpolant = factoryMethod;\r\n\r\n\t},\r\n\r\n\tgetInterpolation: function() {\r\n\r\n\t\tswitch ( this.createInterpolant ) {\r\n\r\n\t\t\tcase this.InterpolantFactoryMethodDiscrete:\r\n\r\n\t\t\t\treturn THREE.InterpolateDiscrete;\r\n\r\n\t\t\tcase this.InterpolantFactoryMethodLinear:\r\n\r\n\t\t\t\treturn THREE.InterpolateLinear;\r\n\r\n\t\t\tcase this.InterpolantFactoryMethodSmooth:\r\n\r\n\t\t\t\treturn THREE.InterpolateSmooth;\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tgetValueSize: function() {\r\n\r\n\t\treturn this.values.length / this.times.length;\r\n\r\n\t},\r\n\r\n\t// move all keyframes either forwards or backwards in time\r\n\tshift: function( timeOffset ) {\r\n\r\n\t\tif( timeOffset !== 0.0 ) {\r\n\r\n\t\t\tvar times = this.times;\r\n\r\n\t\t\tfor( var i = 0, n = times.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\ttimes[ i ] += timeOffset;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\t// scale all keyframe times by a factor (useful for frame <-> seconds conversions)\r\n\tscale: function( timeScale ) {\r\n\r\n\t\tif( timeScale !== 1.0 ) {\r\n\r\n\t\t\tvar times = this.times;\r\n\r\n\t\t\tfor( var i = 0, n = times.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\ttimes[ i ] *= timeScale;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\t// removes keyframes before and after animation without changing any values within the range [startTime, endTime].\r\n\t// IMPORTANT: We do not shift around keys to the start of the track time, because for interpolated keys this will change their values\r\n\ttrim: function( startTime, endTime ) {\r\n\r\n\t\tvar times = this.times,\r\n\t\t\tnKeys = times.length,\r\n\t\t\tfrom = 0,\r\n\t\t\tto = nKeys - 1;\r\n\r\n\t\twhile ( from !== nKeys && times[ from ] < startTime ) ++ from;\r\n\t\twhile ( to !== -1 && times[ to ] > endTime ) -- to;\r\n\r\n\t\t++ to; // inclusive -> exclusive bound\r\n\r\n\t\tif( from !== 0 || to !== nKeys ) {\r\n\r\n\t\t\t// empty tracks are forbidden, so keep at least one keyframe\r\n\t\t\tif ( from >= to ) to = Math.max( to , 1 ), from = to - 1;\r\n\r\n\t\t\tvar stride = this.getValueSize();\r\n\t\t\tthis.times = THREE.AnimationUtils.arraySlice( times, from, to );\r\n\t\t\tthis.values = THREE.AnimationUtils.\r\n\t\t\t\t\tarraySlice( this.values, from * stride, to * stride );\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\t// ensure we do not get a GarbageInGarbageOut situation, make sure tracks are at least minimally viable\r\n\tvalidate: function() {\r\n\r\n\t\tvar valid = true;\r\n\r\n\t\tvar valueSize = this.getValueSize();\r\n\t\tif ( valueSize - Math.floor( valueSize ) !== 0 ) {\r\n\r\n\t\t\tconsole.error( \"invalid value size in track\", this );\r\n\t\t\tvalid = false;\r\n\r\n\t\t}\r\n\r\n\t\tvar times = this.times,\r\n\t\t\tvalues = this.values,\r\n\r\n\t\t\tnKeys = times.length;\r\n\r\n\t\tif( nKeys === 0 ) {\r\n\r\n\t\t\tconsole.error( \"track is empty\", this );\r\n\t\t\tvalid = false;\r\n\r\n\t\t}\r\n\r\n\t\tvar prevTime = null;\r\n\r\n\t\tfor( var i = 0; i !== nKeys; i ++ ) {\r\n\r\n\t\t\tvar currTime = times[ i ];\r\n\r\n\t\t\tif ( typeof currTime === 'number' && isNaN( currTime ) ) {\r\n\r\n\t\t\t\tconsole.error( \"time is not a valid number\", this, i, currTime );\r\n\t\t\t\tvalid = false;\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif( prevTime !== null && prevTime > currTime ) {\r\n\r\n\t\t\t\tconsole.error( \"out of order keys\", this, i, currTime, prevTime );\r\n\t\t\t\tvalid = false;\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tprevTime = currTime;\r\n\r\n\t\t}\r\n\r\n\t\tif ( values !== undefined ) {\r\n\r\n\t\t\tif ( THREE.AnimationUtils.isTypedArray( values ) ) {\r\n\r\n\t\t\t\tfor ( var i = 0, n = values.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\t\tvar value = values[ i ];\r\n\r\n\t\t\t\t\tif ( isNaN( value ) ) {\r\n\r\n\t\t\t\t\t\tconsole.error( \"value is not a valid number\", this, i, value );\r\n\t\t\t\t\t\tvalid = false;\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn valid;\r\n\r\n\t},\r\n\r\n\t// removes equivalent sequential keys as common in morph target sequences\r\n\t// (0,0,0,0,1,1,1,0,0,0,0,0,0,0) --> (0,0,1,1,0,0)\r\n\toptimize: function() {\r\n\r\n\t\tvar times = this.times,\r\n\t\t\tvalues = this.values,\r\n\t\t\tstride = this.getValueSize(),\r\n\r\n\t\t\twriteIndex = 1;\r\n\r\n\t\tfor( var i = 1, n = times.length - 1; i <= n; ++ i ) {\r\n\r\n\t\t\tvar keep = false;\r\n\r\n\t\t\tvar time = times[ i ];\r\n\t\t\tvar timeNext = times[ i + 1 ];\r\n\r\n\t\t\t// remove adjacent keyframes scheduled at the same time\r\n\r\n\t\t\tif ( time !== timeNext && ( i !== 1 || time !== time[ 0 ] ) ) {\r\n\r\n\t\t\t\t// remove unnecessary keyframes same as their neighbors\r\n\t\t\t\tvar offset = i * stride,\r\n\t\t\t\t\toffsetP = offset - stride,\r\n\t\t\t\t\toffsetN = offset + stride;\r\n\r\n\t\t\t\tfor ( var j = 0; j !== stride; ++ j ) {\r\n\r\n\t\t\t\t\tvar value = values[ offset + j ];\r\n\r\n\t\t\t\t\tif ( value !== values[ offsetP + j ] ||\r\n\t\t\t\t\t\t\tvalue !== values[ offsetN + j ] ) {\r\n\r\n\t\t\t\t\t\tkeep = true;\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// in-place compaction\r\n\r\n\t\t\tif ( keep ) {\r\n\r\n\t\t\t\tif ( i !== writeIndex ) {\r\n\r\n\t\t\t\t\ttimes[ writeIndex ] = times[ i ];\r\n\r\n\t\t\t\t\tvar readOffset = i * stride,\r\n\t\t\t\t\t\twriteOffset = writeIndex * stride;\r\n\r\n\t\t\t\t\tfor ( var j = 0; j !== stride; ++ j ) {\r\n\r\n\t\t\t\t\t\tvalues[ writeOffset + j ] = values[ readOffset + j ];\r\n\r\n\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t++ writeIndex;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( writeIndex !== times.length ) {\r\n\r\n\t\t\tthis.times = THREE.AnimationUtils.arraySlice( times, 0, writeIndex );\r\n\t\t\tthis.values = THREE.AnimationUtils.arraySlice( values, 0, writeIndex * stride );\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// Static methods:\r\n\r\nObject.assign( THREE.KeyframeTrack, {\r\n\r\n\t// Serialization (in static context, because of constructor invocation\r\n\t// and automatic invocation of .toJSON):\r\n\r\n\tparse: function( json ) {\r\n\r\n\t\tif( json.type === undefined ) {\r\n\r\n\t\t\tthrow new Error( \"track type undefined, can not parse\" );\r\n\r\n\t\t}\r\n\r\n\t\tvar trackType = THREE.KeyframeTrack._getTrackTypeForValueTypeName( json.type );\r\n\r\n\t\tif ( json.times === undefined ) {\r\n\r\n\t\t\tvar times = [], values = [];\r\n\r\n\t\t\tTHREE.AnimationUtils.flattenJSON( json.keys, times, values, 'value' );\r\n\r\n\t\t\tjson.times = times;\r\n\t\t\tjson.values = values;\r\n\r\n\t\t}\r\n\r\n\t\t// derived classes can define a static parse method\r\n\t\tif ( trackType.parse !== undefined ) {\r\n\r\n\t\t\treturn trackType.parse( json );\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// by default, we asssume a constructor compatible with the base\r\n\t\t\treturn new trackType(\r\n\t\t\t\t\tjson.name, json.times, json.values, json.interpolation );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\ttoJSON: function( track ) {\r\n\r\n\t\tvar trackType = track.constructor;\r\n\r\n\t\tvar json;\r\n\r\n\t\t// derived classes can define a static toJSON method\r\n\t\tif ( trackType.toJSON !== undefined ) {\r\n\r\n\t\t\tjson = trackType.toJSON( track );\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// by default, we assume the data can be serialized as-is\r\n\t\t\tjson = {\r\n\r\n\t\t\t\t'name': track.name,\r\n\t\t\t\t'times': THREE.AnimationUtils.convertArray( track.times, Array ),\r\n\t\t\t\t'values': THREE.AnimationUtils.convertArray( track.values, Array )\r\n\r\n\t\t\t};\r\n\r\n\t\t\tvar interpolation = track.getInterpolation();\r\n\r\n\t\t\tif ( interpolation !== track.DefaultInterpolation ) {\r\n\r\n\t\t\t\tjson.interpolation = interpolation;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tjson.type = track.ValueTypeName; // mandatory\r\n\r\n\t\treturn json;\r\n\r\n\t},\r\n\r\n\t_getTrackTypeForValueTypeName: function( typeName ) {\r\n\r\n\t\tswitch( typeName.toLowerCase() ) {\r\n\r\n\t\t\tcase \"scalar\":\r\n\t\t\tcase \"double\":\r\n\t\t\tcase \"float\":\r\n\t\t\tcase \"number\":\r\n\t\t\tcase \"integer\":\r\n\r\n\t\t\t\treturn THREE.NumberKeyframeTrack;\r\n\r\n\t\t\tcase \"vector\":\r\n\t\t\tcase \"vector2\":\r\n\t\t\tcase \"vector3\":\r\n\t\t\tcase \"vector4\":\r\n\r\n\t\t\t\treturn THREE.VectorKeyframeTrack;\r\n\r\n\t\t\tcase \"color\":\r\n\r\n\t\t\t\treturn THREE.ColorKeyframeTrack;\r\n\r\n\t\t\tcase \"quaternion\":\r\n\r\n\t\t\t\treturn THREE.QuaternionKeyframeTrack;\r\n\r\n\t\t\tcase \"bool\":\r\n\t\t\tcase \"boolean\":\r\n\r\n\t\t\t\treturn THREE.BooleanKeyframeTrack;\r\n\r\n\t\t\tcase \"string\":\r\n\r\n\t\t\t\treturn THREE.StringKeyframeTrack;\r\n\r\n\t\t}\r\n\r\n\t\tthrow new Error( \"Unsupported typeName: \" + typeName );\r\n\r\n\t}\r\n\r\n} );\r\n\r\n// File:src/animation/PropertyBinding.js\r\n\r\n/**\r\n *\r\n * A reference to a real property in the scene graph.\r\n *\r\n *\r\n * @author Ben Houston / http://clara.io/\r\n * @author David Sarno / http://lighthaus.us/\r\n * @author tschw\r\n */\r\n\r\nTHREE.PropertyBinding = function ( rootNode, path, parsedPath ) {\r\n\r\n\tthis.path = path;\r\n\tthis.parsedPath = parsedPath ||\r\n\t\t\tTHREE.PropertyBinding.parseTrackName( path );\r\n\r\n\tthis.node = THREE.PropertyBinding.findNode(\r\n\t\t\trootNode, this.parsedPath.nodeName ) || rootNode;\r\n\r\n\tthis.rootNode = rootNode;\r\n\r\n};\r\n\r\nTHREE.PropertyBinding.prototype = {\r\n\r\n\tconstructor: THREE.PropertyBinding,\r\n\r\n\tgetValue: function getValue_unbound( targetArray, offset ) {\r\n\r\n\t\tthis.bind();\r\n\t\tthis.getValue( targetArray, offset );\r\n\r\n\t\t// Note: This class uses a State pattern on a per-method basis:\r\n\t\t// 'bind' sets 'this.getValue' / 'setValue' and shadows the\r\n\t\t// prototype version of these methods with one that represents\r\n\t\t// the bound state. When the property is not found, the methods\r\n\t\t// become no-ops.\r\n\r\n\t},\r\n\r\n\tsetValue: function getValue_unbound( sourceArray, offset ) {\r\n\r\n\t\tthis.bind();\r\n\t\tthis.setValue( sourceArray, offset );\r\n\r\n\t},\r\n\r\n\t// create getter / setter pair for a property in the scene graph\r\n\tbind: function() {\r\n\r\n\t\tvar targetObject = this.node,\r\n\t\t\tparsedPath = this.parsedPath,\r\n\r\n\t\t\tobjectName = parsedPath.objectName,\r\n\t\t\tpropertyName = parsedPath.propertyName,\r\n\t\t\tpropertyIndex = parsedPath.propertyIndex;\r\n\r\n\t\tif ( ! targetObject ) {\r\n\r\n\t\t\ttargetObject = THREE.PropertyBinding.findNode(\r\n\t\t\t\t\tthis.rootNode, parsedPath.nodeName ) || this.rootNode;\r\n\r\n\t\t\tthis.node = targetObject;\r\n\r\n\t\t}\r\n\r\n\t\t// set fail state so we can just 'return' on error\r\n\t\tthis.getValue = this._getValue_unavailable;\r\n\t\tthis.setValue = this._setValue_unavailable;\r\n\r\n \t\t// ensure there is a value node\r\n\t\tif ( ! targetObject ) {\r\n\r\n\t\t\tconsole.error( \"  trying to update node for track: \" + this.path + \" but it wasn't found.\" );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tif( objectName ) {\r\n\r\n\t\t\tvar objectIndex = parsedPath.objectIndex;\r\n\r\n\t\t\t// special cases were we need to reach deeper into the hierarchy to get the face materials....\r\n\t\t\tswitch ( objectName ) {\r\n\r\n\t\t\t\tcase 'materials':\r\n\r\n\t\t\t\t\tif( ! targetObject.material ) {\r\n\r\n\t\t\t\t\t\tconsole.error( '  can not bind to material as node does not have a material', this );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif( ! targetObject.material.materials ) {\r\n\r\n\t\t\t\t\t\tconsole.error( '  can not bind to material.materials as node.material does not have a materials array', this );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\ttargetObject = targetObject.material.materials;\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'bones':\r\n\r\n\t\t\t\t\tif( ! targetObject.skeleton ) {\r\n\r\n\t\t\t\t\t\tconsole.error( '  can not bind to bones as node does not have a skeleton', this );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// potential future optimization: skip this if propertyIndex is already an integer\r\n\t\t\t\t\t// and convert the integer string to a true integer.\r\n\r\n\t\t\t\t\ttargetObject = targetObject.skeleton.bones;\r\n\r\n\t\t\t\t\t// support resolving morphTarget names into indices.\r\n\t\t\t\t\tfor ( var i = 0; i < targetObject.length; i ++ ) {\r\n\r\n\t\t\t\t\t\tif ( targetObject[i].name === objectIndex ) {\r\n\r\n\t\t\t\t\t\t\tobjectIndex = i;\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\r\n\t\t\t\t\tif ( targetObject[ objectName ] === undefined ) {\r\n\r\n\t\t\t\t\t\tconsole.error( '  can not bind to objectName of node, undefined', this );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\ttargetObject = targetObject[ objectName ];\r\n\r\n\t\t\t}\r\n\r\n\r\n\t\t\tif ( objectIndex !== undefined ) {\r\n\r\n\t\t\t\tif( targetObject[ objectIndex ] === undefined ) {\r\n\r\n\t\t\t\t\tconsole.error( \"  trying to bind to objectIndex of objectName, but is undefined:\", this, targetObject );\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttargetObject = targetObject[ objectIndex ];\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// resolve property\r\n\t\tvar nodeProperty = targetObject[ propertyName ];\r\n\r\n\t\tif ( ! nodeProperty ) {\r\n\r\n\t\t\tvar nodeName = parsedPath.nodeName;\r\n\r\n\t\t\tconsole.error( \"  trying to update property for track: \" + nodeName +\r\n\t\t\t\t\t'.' + propertyName + \" but it wasn't found.\", targetObject );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\t// determine versioning scheme\r\n\t\tvar versioning = this.Versioning.None;\r\n\r\n\t\tif ( targetObject.needsUpdate !== undefined ) { // material\r\n\r\n\t\t\tversioning = this.Versioning.NeedsUpdate;\r\n\t\t\tthis.targetObject = targetObject;\r\n\r\n\t\t} else if ( targetObject.matrixWorldNeedsUpdate !== undefined ) { // node transform\r\n\r\n\t\t\tversioning = this.Versioning.MatrixWorldNeedsUpdate;\r\n\t\t\tthis.targetObject = targetObject;\r\n\r\n\t\t}\r\n\r\n\t\t// determine how the property gets bound\r\n\t\tvar bindingType = this.BindingType.Direct;\r\n\r\n\t\tif ( propertyIndex !== undefined ) {\r\n\t\t\t// access a sub element of the property array (only primitives are supported right now)\r\n\r\n\t\t\tif ( propertyName === \"morphTargetInfluences\" ) {\r\n\t\t\t\t// potential optimization, skip this if propertyIndex is already an integer, and convert the integer string to a true integer.\r\n\r\n\t\t\t\t// support resolving morphTarget names into indices.\r\n\t\t\t\tif ( ! targetObject.geometry ) {\r\n\r\n\t\t\t\t\tconsole.error( '  can not bind to morphTargetInfluences becasuse node does not have a geometry', this );\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( ! targetObject.geometry.morphTargets ) {\r\n\r\n\t\t\t\t\tconsole.error( '  can not bind to morphTargetInfluences becasuse node does not have a geometry.morphTargets', this );\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor ( var i = 0; i < this.node.geometry.morphTargets.length; i ++ ) {\r\n\r\n\t\t\t\t\tif ( targetObject.geometry.morphTargets[i].name === propertyIndex ) {\r\n\r\n\t\t\t\t\t\tpropertyIndex = i;\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tbindingType = this.BindingType.ArrayElement;\r\n\r\n\t\t\tthis.resolvedProperty = nodeProperty;\r\n\t\t\tthis.propertyIndex = propertyIndex;\r\n\r\n\t\t} else if ( nodeProperty.fromArray !== undefined && nodeProperty.toArray !== undefined ) {\r\n\t\t\t// must use copy for Object3D.Euler/Quaternion\r\n\r\n\t\t\tbindingType = this.BindingType.HasFromToArray;\r\n\r\n\t\t\tthis.resolvedProperty = nodeProperty;\r\n\r\n\t\t} else if ( nodeProperty.length !== undefined ) {\r\n\r\n\t\t\tbindingType = this.BindingType.EntireArray;\r\n\r\n\t\t\tthis.resolvedProperty = nodeProperty;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.propertyName = propertyName;\r\n\r\n\t\t}\r\n\r\n\t\t// select getter / setter\r\n\t\tthis.getValue = this.GetterByBindingType[ bindingType ];\r\n\t\tthis.setValue = this.SetterByBindingTypeAndVersioning[ bindingType ][ versioning ];\r\n\r\n\t},\r\n\r\n\tunbind: function() {\r\n\r\n\t\tthis.node = null;\r\n\r\n\t\t// back to the prototype version of getValue / setValue\r\n\t\t// note: avoiding to mutate the shape of 'this' via 'delete'\r\n\t\tthis.getValue = this._getValue_unbound;\r\n\t\tthis.setValue = this._setValue_unbound;\r\n\r\n\t}\r\n\r\n};\r\n\r\nObject.assign( THREE.PropertyBinding.prototype, { // prototype, continued\r\n\r\n\t// these are used to \"bind\" a nonexistent property\r\n\t_getValue_unavailable: function() {},\r\n\t_setValue_unavailable: function() {},\r\n\r\n\t// initial state of these methods that calls 'bind'\r\n\t_getValue_unbound: THREE.PropertyBinding.prototype.getValue,\r\n\t_setValue_unbound: THREE.PropertyBinding.prototype.setValue,\r\n\r\n\tBindingType: {\r\n\t\tDirect: 0,\r\n\t\tEntireArray: 1,\r\n\t\tArrayElement: 2,\r\n\t\tHasFromToArray: 3\r\n\t},\r\n\r\n\tVersioning: {\r\n\t\tNone: 0,\r\n\t\tNeedsUpdate: 1,\r\n\t\tMatrixWorldNeedsUpdate: 2\r\n\t},\r\n\r\n\tGetterByBindingType: [\r\n\r\n\t\tfunction getValue_direct( buffer, offset ) {\r\n\r\n\t\t\tbuffer[ offset ] = this.node[ this.propertyName ];\r\n\r\n\t\t},\r\n\r\n\t\tfunction getValue_array( buffer, offset ) {\r\n\r\n\t\t\tvar source = this.resolvedProperty;\r\n\r\n\t\t\tfor ( var i = 0, n = source.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\tbuffer[ offset ++ ] = source[ i ];\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tfunction getValue_arrayElement( buffer, offset ) {\r\n\r\n\t\t\tbuffer[ offset ] = this.resolvedProperty[ this.propertyIndex ];\r\n\r\n\t\t},\r\n\r\n\t\tfunction getValue_toArray( buffer, offset ) {\r\n\r\n\t\t\tthis.resolvedProperty.toArray( buffer, offset );\r\n\r\n\t\t}\r\n\r\n\t],\r\n\r\n\tSetterByBindingTypeAndVersioning: [\r\n\r\n\t\t[\r\n\t\t\t// Direct\r\n\r\n\t\t\tfunction setValue_direct( buffer, offset ) {\r\n\r\n\t\t\t\tthis.node[ this.propertyName ] = buffer[ offset ];\r\n\r\n\t\t\t},\r\n\r\n\t\t\tfunction setValue_direct_setNeedsUpdate( buffer, offset ) {\r\n\r\n\t\t\t\tthis.node[ this.propertyName ] = buffer[ offset ];\r\n\t\t\t\tthis.targetObject.needsUpdate = true;\r\n\r\n\t\t\t},\r\n\r\n\t\t\tfunction setValue_direct_setMatrixWorldNeedsUpdate( buffer, offset ) {\r\n\r\n\t\t\t\tthis.node[ this.propertyName ] = buffer[ offset ];\r\n\t\t\t\tthis.targetObject.matrixWorldNeedsUpdate = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t], [\r\n\r\n\t\t\t// EntireArray\r\n\r\n\t\t\tfunction setValue_array( buffer, offset ) {\r\n\r\n\t\t\t\tvar dest = this.resolvedProperty;\r\n\r\n\t\t\t\tfor ( var i = 0, n = dest.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\t\tdest[ i ] = buffer[ offset ++ ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t},\r\n\r\n\t\t\tfunction setValue_array_setNeedsUpdate( buffer, offset ) {\r\n\r\n\t\t\t\tvar dest = this.resolvedProperty;\r\n\r\n\t\t\t\tfor ( var i = 0, n = dest.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\t\tdest[ i ] = buffer[ offset ++ ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.targetObject.needsUpdate = true;\r\n\r\n\t\t\t},\r\n\r\n\t\t\tfunction setValue_array_setMatrixWorldNeedsUpdate( buffer, offset ) {\r\n\r\n\t\t\t\tvar dest = this.resolvedProperty;\r\n\r\n\t\t\t\tfor ( var i = 0, n = dest.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\t\tdest[ i ] = buffer[ offset ++ ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.targetObject.matrixWorldNeedsUpdate = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t], [\r\n\r\n\t\t\t// ArrayElement\r\n\r\n\t\t\tfunction setValue_arrayElement( buffer, offset ) {\r\n\r\n\t\t\t\tthis.resolvedProperty[ this.propertyIndex ] = buffer[ offset ];\r\n\r\n\t\t\t},\r\n\r\n\t\t\tfunction setValue_arrayElement_setNeedsUpdate( buffer, offset ) {\r\n\r\n\t\t\t\tthis.resolvedProperty[ this.propertyIndex ] = buffer[ offset ];\r\n\t\t\t\tthis.targetObject.needsUpdate = true;\r\n\r\n\t\t\t},\r\n\r\n\t\t\tfunction setValue_arrayElement_setMatrixWorldNeedsUpdate( buffer, offset ) {\r\n\r\n\t\t\t\tthis.resolvedProperty[ this.propertyIndex ] = buffer[ offset ];\r\n\t\t\t\tthis.targetObject.matrixWorldNeedsUpdate = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t], [\r\n\r\n\t\t\t// HasToFromArray\r\n\r\n\t\t\tfunction setValue_fromArray( buffer, offset ) {\r\n\r\n\t\t\t\tthis.resolvedProperty.fromArray( buffer, offset );\r\n\r\n\t\t\t},\r\n\r\n\t\t\tfunction setValue_fromArray_setNeedsUpdate( buffer, offset ) {\r\n\r\n\t\t\t\tthis.resolvedProperty.fromArray( buffer, offset );\r\n\t\t\t\tthis.targetObject.needsUpdate = true;\r\n\r\n\t\t\t},\r\n\r\n\t\t\tfunction setValue_fromArray_setMatrixWorldNeedsUpdate( buffer, offset ) {\r\n\r\n\t\t\t\tthis.resolvedProperty.fromArray( buffer, offset );\r\n\t\t\t\tthis.targetObject.matrixWorldNeedsUpdate = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t]\r\n\r\n\t]\r\n\r\n} );\r\n\r\nTHREE.PropertyBinding.Composite =\r\n\t\tfunction( targetGroup, path, optionalParsedPath ) {\r\n\r\n\tvar parsedPath = optionalParsedPath ||\r\n\t\t\tTHREE.PropertyBinding.parseTrackName( path );\r\n\r\n\tthis._targetGroup = targetGroup;\r\n\tthis._bindings = targetGroup.subscribe_( path, parsedPath );\r\n\r\n};\r\n\r\nTHREE.PropertyBinding.Composite.prototype = {\r\n\r\n\tconstructor: THREE.PropertyBinding.Composite,\r\n\r\n\tgetValue: function( array, offset ) {\r\n\r\n\t\tthis.bind(); // bind all binding\r\n\r\n\t\tvar firstValidIndex = this._targetGroup.nCachedObjects_,\r\n\t\t\tbinding = this._bindings[ firstValidIndex ];\r\n\r\n\t\t// and only call .getValue on the first\r\n\t\tif ( binding !== undefined ) binding.getValue( array, offset );\r\n\r\n\t},\r\n\r\n\tsetValue: function( array, offset ) {\r\n\r\n\t\tvar bindings = this._bindings;\r\n\r\n\t\tfor ( var i = this._targetGroup.nCachedObjects_,\r\n\t\t\t\tn = bindings.length; i !== n; ++ i ) {\r\n\r\n\t\t\tbindings[ i ].setValue( array, offset );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tbind: function() {\r\n\r\n\t\tvar bindings = this._bindings;\r\n\r\n\t\tfor ( var i = this._targetGroup.nCachedObjects_,\r\n\t\t\t\tn = bindings.length; i !== n; ++ i ) {\r\n\r\n\t\t\tbindings[ i ].bind();\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tunbind: function() {\r\n\r\n\t\tvar bindings = this._bindings;\r\n\r\n\t\tfor ( var i = this._targetGroup.nCachedObjects_,\r\n\t\t\t\tn = bindings.length; i !== n; ++ i ) {\r\n\r\n\t\t\tbindings[ i ].unbind();\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.PropertyBinding.create = function( root, path, parsedPath ) {\r\n\r\n\tif ( ! ( root instanceof THREE.AnimationObjectGroup ) ) {\r\n\r\n\t\treturn new THREE.PropertyBinding( root, path, parsedPath );\r\n\r\n\t} else {\r\n\r\n\t\treturn new THREE.PropertyBinding.Composite( root, path, parsedPath );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.PropertyBinding.parseTrackName = function( trackName ) {\r\n\r\n\t// matches strings in the form of:\r\n\t//    nodeName.property\r\n\t//    nodeName.property[accessor]\r\n\t//    nodeName.material.property[accessor]\r\n\t//    uuid.property[accessor]\r\n\t//    uuid.objectName[objectIndex].propertyName[propertyIndex]\r\n\t//    parentName/nodeName.property\r\n\t//    parentName/parentName/nodeName.property[index]\r\n\t//\t  .bone[Armature.DEF_cog].position\r\n\t// created and tested via https://regex101.com/#javascript\r\n\r\n\tvar re = /^(([\\w]+\\/)*)([\\w-\\d]+)?(\\.([\\w]+)(\\[([\\w\\d\\[\\]\\_.:\\- ]+)\\])?)?(\\.([\\w.]+)(\\[([\\w\\d\\[\\]\\_. ]+)\\])?)$/;\r\n\tvar matches = re.exec(trackName);\r\n\r\n\tif( ! matches ) {\r\n\t\tthrow new Error( \"cannot parse trackName at all: \" + trackName );\r\n\t}\r\n\r\n    if (matches.index === re.lastIndex) {\r\n        re.lastIndex++;\r\n    }\r\n\r\n\tvar results = {\r\n\t\t// directoryName: matches[1], // (tschw) currently unused\r\n\t\tnodeName: matches[3], \t// allowed to be null, specified root node.\r\n\t\tobjectName: matches[5],\r\n\t\tobjectIndex: matches[7],\r\n\t\tpropertyName: matches[9],\r\n\t\tpropertyIndex: matches[11]\t// allowed to be null, specifies that the whole property is set.\r\n\t};\r\n\r\n\tif( results.propertyName === null || results.propertyName.length === 0 ) {\r\n\t\tthrow new Error( \"can not parse propertyName from trackName: \" + trackName );\r\n\t}\r\n\r\n\treturn results;\r\n\r\n};\r\n\r\nTHREE.PropertyBinding.findNode = function( root, nodeName ) {\r\n\r\n\tif( ! nodeName || nodeName === \"\" || nodeName === \"root\" || nodeName === \".\" || nodeName === -1 || nodeName === root.name || nodeName === root.uuid ) {\r\n\r\n\t\treturn root;\r\n\r\n\t}\r\n\r\n\t// search into skeleton bones.\r\n\tif( root.skeleton ) {\r\n\r\n\t\tvar searchSkeleton = function( skeleton ) {\r\n\r\n\t\t\tfor( var i = 0; i < skeleton.bones.length; i ++ ) {\r\n\r\n\t\t\t\tvar bone = skeleton.bones[i];\r\n\r\n\t\t\t\tif( bone.name === nodeName ) {\r\n\r\n\t\t\t\t\treturn bone;\r\n\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn null;\r\n\r\n\t\t};\r\n\r\n\t\tvar bone = searchSkeleton( root.skeleton );\r\n\r\n\t\tif( bone ) {\r\n\r\n\t\t\treturn bone;\r\n\r\n\t\t}\r\n\t}\r\n\r\n\t// search into node subtree.\r\n\tif( root.children ) {\r\n\r\n\t\tvar searchNodeSubtree = function( children ) {\r\n\r\n\t\t\tfor( var i = 0; i < children.length; i ++ ) {\r\n\r\n\t\t\t\tvar childNode = children[i];\r\n\r\n\t\t\t\tif( childNode.name === nodeName || childNode.uuid === nodeName ) {\r\n\r\n\t\t\t\t\treturn childNode;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar result = searchNodeSubtree( childNode.children );\r\n\r\n\t\t\t\tif( result ) return result;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn null;\r\n\r\n\t\t};\r\n\r\n\t\tvar subTreeNode = searchNodeSubtree( root.children );\r\n\r\n\t\tif( subTreeNode ) {\r\n\r\n\t\t\treturn subTreeNode;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\treturn null;\r\n\r\n};\r\n\r\n// File:src/animation/PropertyMixer.js\r\n\r\n/**\r\n *\r\n * Buffered scene graph property that allows weighted accumulation.\r\n *\r\n *\r\n * @author Ben Houston / http://clara.io/\r\n * @author David Sarno / http://lighthaus.us/\r\n * @author tschw\r\n */\r\n\r\nTHREE.PropertyMixer = function ( binding, typeName, valueSize ) {\r\n\r\n\tthis.binding = binding;\r\n\tthis.valueSize = valueSize;\r\n\r\n\tvar bufferType = Float64Array,\r\n\t\tmixFunction;\r\n\r\n\tswitch ( typeName ) {\r\n\r\n\t\tcase 'quaternion':\t\t\tmixFunction = this._slerp;\t\tbreak;\r\n\r\n\t\tcase 'string':\r\n\t\tcase 'bool':\r\n\r\n\t\t\tbufferType = Array,\t\tmixFunction = this._select;\t\tbreak;\r\n\r\n\t\tdefault:\t\t\t\t\tmixFunction = this._lerp;\r\n\r\n\t}\r\n\r\n\tthis.buffer = new bufferType( valueSize * 4 );\r\n\t// layout: [ incoming | accu0 | accu1 | orig ]\r\n\t//\r\n\t// interpolators can use .buffer as their .result\r\n\t// the data then goes to 'incoming'\r\n\t//\r\n\t// 'accu0' and 'accu1' are used frame-interleaved for\r\n\t// the cumulative result and are compared to detect\r\n\t// changes\r\n\t//\r\n\t// 'orig' stores the original state of the property\r\n\r\n\tthis._mixBufferRegion = mixFunction;\r\n\r\n\tthis.cumulativeWeight = 0;\r\n\r\n\tthis.useCount = 0;\r\n\tthis.referenceCount = 0;\r\n\r\n};\r\n\r\nTHREE.PropertyMixer.prototype = {\r\n\r\n\tconstructor: THREE.PropertyMixer,\r\n\r\n\t// accumulate data in the 'incoming' region into 'accu<i>'\r\n\taccumulate: function( accuIndex, weight ) {\r\n\r\n\t\t// note: happily accumulating nothing when weight = 0, the caller knows\r\n\t\t// the weight and shouldn't have made the call in the first place\r\n\r\n\t\tvar buffer = this.buffer,\r\n\t\t\tstride = this.valueSize,\r\n\t\t\toffset = accuIndex * stride + stride,\r\n\r\n\t\t\tcurrentWeight = this.cumulativeWeight;\r\n\r\n\t\tif ( currentWeight === 0 ) {\r\n\r\n\t\t\t// accuN := incoming * weight\r\n\r\n\t\t\tfor ( var i = 0; i !== stride; ++ i ) {\r\n\r\n\t\t\t\tbuffer[ offset + i ] = buffer[ i ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tcurrentWeight = weight;\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// accuN := accuN + incoming * weight\r\n\r\n\t\t\tcurrentWeight += weight;\r\n\t\t\tvar mix = weight / currentWeight;\r\n\t\t\tthis._mixBufferRegion( buffer, offset, 0, mix, stride );\r\n\r\n\t\t}\r\n\r\n\t\tthis.cumulativeWeight = currentWeight;\r\n\r\n\t},\r\n\r\n\t// apply the state of 'accu<i>' to the binding when accus differ\r\n\tapply: function( accuIndex ) {\r\n\r\n\t\tvar stride = this.valueSize,\r\n\t\t\tbuffer = this.buffer,\r\n\t\t\toffset = accuIndex * stride + stride,\r\n\r\n\t\t\tweight = this.cumulativeWeight,\r\n\r\n\t\t\tbinding = this.binding;\r\n\r\n\t\tthis.cumulativeWeight = 0;\r\n\r\n\t\tif ( weight < 1 ) {\r\n\r\n\t\t\t// accuN := accuN + original * ( 1 - cumulativeWeight )\r\n\r\n\t\t\tvar originalValueOffset = stride * 3;\r\n\r\n\t\t\tthis._mixBufferRegion(\r\n\t\t\t\t\tbuffer, offset, originalValueOffset, 1 - weight, stride );\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var i = stride, e = stride + stride; i !== e; ++ i ) {\r\n\r\n\t\t\tif ( buffer[ i ] !== buffer[ i + stride ] ) {\r\n\r\n\t\t\t\t// value has changed -> update scene graph\r\n\r\n\t\t\t\tbinding.setValue( buffer, offset );\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\t// remember the state of the bound property and copy it to both accus\r\n\tsaveOriginalState: function() {\r\n\r\n\t\tvar binding = this.binding;\r\n\r\n\t\tvar buffer = this.buffer,\r\n\t\t\tstride = this.valueSize,\r\n\r\n\t\t\toriginalValueOffset = stride * 3;\r\n\r\n\t\tbinding.getValue( buffer, originalValueOffset );\r\n\r\n\t\t// accu[0..1] := orig -- initially detect changes against the original\r\n\t\tfor ( var i = stride, e = originalValueOffset; i !== e; ++ i ) {\r\n\r\n\t\t\tbuffer[ i ] = buffer[ originalValueOffset + ( i % stride ) ];\r\n\r\n\t\t}\r\n\r\n\t\tthis.cumulativeWeight = 0;\r\n\r\n\t},\r\n\r\n\t// apply the state previously taken via 'saveOriginalState' to the binding\r\n\trestoreOriginalState: function() {\r\n\r\n\t\tvar originalValueOffset = this.valueSize * 3;\r\n\t\tthis.binding.setValue( this.buffer, originalValueOffset );\r\n\r\n\t},\r\n\r\n\r\n\t// mix functions\r\n\r\n\t_select: function( buffer, dstOffset, srcOffset, t, stride ) {\r\n\r\n\t\tif ( t >= 0.5 ) {\r\n\r\n\t\t\tfor ( var i = 0; i !== stride; ++ i ) {\r\n\r\n\t\t\t\tbuffer[ dstOffset + i ] = buffer[ srcOffset + i ];\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\t_slerp: function( buffer, dstOffset, srcOffset, t, stride ) {\r\n\r\n\t\tTHREE.Quaternion.slerpFlat( buffer, dstOffset,\r\n\t\t\t\tbuffer, dstOffset, buffer, srcOffset, t );\r\n\r\n\t},\r\n\r\n\t_lerp: function( buffer, dstOffset, srcOffset, t, stride ) {\r\n\r\n\t\tvar s = 1 - t;\r\n\r\n\t\tfor ( var i = 0; i !== stride; ++ i ) {\r\n\r\n\t\t\tvar j = dstOffset + i;\r\n\r\n\t\t\tbuffer[ j ] = buffer[ j ] * s + buffer[ srcOffset + i ] * t;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/animation/tracks/BooleanKeyframeTrack.js\r\n\r\n/**\r\n *\r\n * A Track of Boolean keyframe values.\r\n *\r\n *\r\n * @author Ben Houston / http://clara.io/\r\n * @author David Sarno / http://lighthaus.us/\r\n * @author tschw\r\n */\r\n\r\nTHREE.BooleanKeyframeTrack = function ( name, times, values ) {\r\n\r\n\tTHREE.KeyframeTrack.call( this, name, times, values );\r\n\r\n};\r\n\r\nTHREE.BooleanKeyframeTrack.prototype =\r\n\t\tObject.assign( Object.create( THREE.KeyframeTrack.prototype ), {\r\n\r\n\tconstructor: THREE.BooleanKeyframeTrack,\r\n\r\n\tValueTypeName: 'bool',\r\n\tValueBufferType: Array,\r\n\r\n\tDefaultInterpolation: THREE.InterpolateDiscrete,\r\n\r\n\tInterpolantFactoryMethodLinear: undefined,\r\n\tInterpolantFactoryMethodSmooth: undefined\r\n\r\n\t// Note: Actually this track could have a optimized / compressed\r\n\t// representation of a single value and a custom interpolant that\r\n\t// computes \"firstValue ^ isOdd( index )\".\r\n\r\n} );\r\n\r\n// File:src/animation/tracks/ColorKeyframeTrack.js\r\n\r\n/**\r\n *\r\n * A Track of keyframe values that represent color.\r\n *\r\n *\r\n * @author Ben Houston / http://clara.io/\r\n * @author David Sarno / http://lighthaus.us/\r\n * @author tschw\r\n */\r\n\r\nTHREE.ColorKeyframeTrack = function ( name, times, values, interpolation ) {\r\n\r\n\tTHREE.KeyframeTrack.call( this, name, times, values, interpolation );\r\n\r\n};\r\n\r\nTHREE.ColorKeyframeTrack.prototype =\r\n\t\tObject.assign( Object.create( THREE.KeyframeTrack.prototype ), {\r\n\r\n\tconstructor: THREE.ColorKeyframeTrack,\r\n\r\n\tValueTypeName: 'color'\r\n\r\n\t// ValueBufferType is inherited\r\n\r\n\t// DefaultInterpolation is inherited\r\n\r\n\r\n\t// Note: Very basic implementation and nothing special yet.\r\n\t// However, this is the place for color space parameterization.\r\n\r\n} );\r\n\r\n// File:src/animation/tracks/NumberKeyframeTrack.js\r\n\r\n/**\r\n *\r\n * A Track of numeric keyframe values.\r\n *\r\n * @author Ben Houston / http://clara.io/\r\n * @author David Sarno / http://lighthaus.us/\r\n * @author tschw\r\n */\r\n\r\nTHREE.NumberKeyframeTrack = function ( name, times, values, interpolation ) {\r\n\r\n\tTHREE.KeyframeTrack.call( this, name, times, values, interpolation );\r\n\r\n};\r\n\r\nTHREE.NumberKeyframeTrack.prototype =\r\n\t\tObject.assign( Object.create( THREE.KeyframeTrack.prototype ), {\r\n\r\n\tconstructor: THREE.NumberKeyframeTrack,\r\n\r\n\tValueTypeName: 'number',\r\n\r\n\t// ValueBufferType is inherited\r\n\r\n\t// DefaultInterpolation is inherited\r\n\r\n} );\r\n\r\n// File:src/animation/tracks/QuaternionKeyframeTrack.js\r\n\r\n/**\r\n *\r\n * A Track of quaternion keyframe values.\r\n *\r\n * @author Ben Houston / http://clara.io/\r\n * @author David Sarno / http://lighthaus.us/\r\n * @author tschw\r\n */\r\n\r\nTHREE.QuaternionKeyframeTrack = function ( name, times, values, interpolation ) {\r\n\r\n\tTHREE.KeyframeTrack.call( this, name, times, values, interpolation );\r\n\r\n};\r\n\r\nTHREE.QuaternionKeyframeTrack.prototype =\r\n\t\tObject.assign( Object.create( THREE.KeyframeTrack.prototype ), {\r\n\r\n\tconstructor: THREE.QuaternionKeyframeTrack,\r\n\r\n\tValueTypeName: 'quaternion',\r\n\r\n\t// ValueBufferType is inherited\r\n\r\n\tDefaultInterpolation: THREE.InterpolateLinear,\r\n\r\n\tInterpolantFactoryMethodLinear: function( result ) {\r\n\r\n\t\treturn new THREE.QuaternionLinearInterpolant(\r\n\t\t\t\tthis.times, this.values, this.getValueSize(), result );\r\n\r\n\t},\r\n\r\n\tInterpolantFactoryMethodSmooth: undefined // not yet implemented\r\n\r\n} );\r\n\r\n// File:src/animation/tracks/StringKeyframeTrack.js\r\n\r\n/**\r\n *\r\n * A Track that interpolates Strings\r\n *\r\n *\r\n * @author Ben Houston / http://clara.io/\r\n * @author David Sarno / http://lighthaus.us/\r\n * @author tschw\r\n */\r\n\r\nTHREE.StringKeyframeTrack = function ( name, times, values, interpolation ) {\r\n\r\n\tTHREE.KeyframeTrack.call( this, name, times, values, interpolation );\r\n\r\n};\r\n\r\nTHREE.StringKeyframeTrack.prototype =\r\n\t\tObject.assign( Object.create( THREE.KeyframeTrack.prototype ), {\r\n\r\n\tconstructor: THREE.StringKeyframeTrack,\r\n\r\n\tValueTypeName: 'string',\r\n\tValueBufferType: Array,\r\n\r\n\tDefaultInterpolation: THREE.InterpolateDiscrete,\r\n\r\n\tInterpolantFactoryMethodLinear: undefined,\r\n\r\n\tInterpolantFactoryMethodSmooth: undefined\r\n\r\n} );\r\n\r\n// File:src/animation/tracks/VectorKeyframeTrack.js\r\n\r\n/**\r\n *\r\n * A Track of vectored keyframe values.\r\n *\r\n *\r\n * @author Ben Houston / http://clara.io/\r\n * @author David Sarno / http://lighthaus.us/\r\n * @author tschw\r\n */\r\n\r\nTHREE.VectorKeyframeTrack = function ( name, times, values, interpolation ) {\r\n\r\n\tTHREE.KeyframeTrack.call( this, name, times, values, interpolation );\r\n\r\n};\r\n\r\nTHREE.VectorKeyframeTrack.prototype =\r\n\t\tObject.assign( Object.create( THREE.KeyframeTrack.prototype ), {\r\n\r\n\tconstructor: THREE.VectorKeyframeTrack,\r\n\r\n\tValueTypeName: 'vector'\r\n\r\n\t// ValueBufferType is inherited\r\n\r\n\t// DefaultInterpolation is inherited\r\n\r\n} );\r\n\r\n// File:src/audio/Audio.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author Reece Aaron Lecrivain / http://reecenotes.com/\r\n */\r\n\r\nTHREE.Audio = function ( listener ) {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.type = 'Audio';\r\n\r\n\tthis.context = listener.context;\r\n\tthis.source = this.context.createBufferSource();\r\n\tthis.source.onended = this.onEnded.bind( this );\r\n\r\n\tthis.gain = this.context.createGain();\r\n\tthis.gain.connect( listener.getInput() );\r\n\r\n\tthis.autoplay = false;\r\n\r\n\tthis.startTime = 0;\r\n\tthis.playbackRate = 1;\r\n\tthis.isPlaying = false;\r\n\tthis.hasPlaybackControl = true;\r\n\tthis.sourceType = 'empty';\r\n\r\n\tthis.filters = [];\r\n\r\n};\r\n\r\nTHREE.Audio.prototype = Object.assign( Object.create( THREE.Object3D.prototype ), {\r\n\r\n\tconstructor: THREE.Audio,\r\n\r\n\tgetOutput: function () {\r\n\r\n\t\treturn this.gain;\r\n\r\n\t},\r\n\r\n\tsetNodeSource: function ( audioNode ) {\r\n\r\n\t\tthis.hasPlaybackControl = false;\r\n\t\tthis.sourceType = 'audioNode';\r\n\t\tthis.source = audioNode;\r\n\t\tthis.connect();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetBuffer: function ( audioBuffer ) {\r\n\r\n\t\tthis.source.buffer = audioBuffer;\r\n\t\tthis.sourceType = 'buffer';\r\n\r\n\t\tif ( this.autoplay ) this.play();\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tplay: function () {\r\n\r\n\t\tif ( this.isPlaying === true ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Audio: Audio is already playing.' );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.hasPlaybackControl === false ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Audio: this Audio has no playback control.' );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tvar source = this.context.createBufferSource();\r\n\r\n\t\tsource.buffer = this.source.buffer;\r\n\t\tsource.loop = this.source.loop;\r\n\t\tsource.onended = this.source.onended;\r\n\t\tsource.start( 0, this.startTime );\r\n\t\tsource.playbackRate.value = this.playbackRate;\r\n\r\n\t\tthis.isPlaying = true;\r\n\r\n\t\tthis.source = source;\r\n\r\n\t\treturn this.connect();\r\n\r\n\t},\r\n\r\n\tpause: function () {\r\n\r\n\t\tif ( this.hasPlaybackControl === false ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Audio: this Audio has no playback control.' );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tthis.source.stop();\r\n\t\tthis.startTime = this.context.currentTime;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tstop: function () {\r\n\r\n\t\tif ( this.hasPlaybackControl === false ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Audio: this Audio has no playback control.' );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tthis.source.stop();\r\n\t\tthis.startTime = 0;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tconnect: function () {\r\n\r\n\t\tif ( this.filters.length > 0 ) {\r\n\r\n\t\t\tthis.source.connect( this.filters[ 0 ] );\r\n\r\n\t\t\tfor ( var i = 1, l = this.filters.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tthis.filters[ i - 1 ].connect( this.filters[ i ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.filters[ this.filters.length - 1 ].connect( this.getOutput() );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.source.connect( this.getOutput() );\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdisconnect: function () {\r\n\r\n\t\tif ( this.filters.length > 0 ) {\r\n\r\n\t\t\tthis.source.disconnect( this.filters[ 0 ] );\r\n\r\n\t\t\tfor ( var i = 1, l = this.filters.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tthis.filters[ i - 1 ].disconnect( this.filters[ i ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.filters[ this.filters.length - 1 ].disconnect( this.getOutput() );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.source.disconnect( this.getOutput() );\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tgetFilters: function () {\r\n\r\n\t\treturn this.filters;\r\n\r\n\t},\r\n\r\n\tsetFilters: function ( value ) {\r\n\r\n\t\tif ( ! value ) value = [];\r\n\r\n\t\tif ( this.isPlaying === true ) {\r\n\r\n\t\t\tthis.disconnect();\r\n\t\t\tthis.filters = value;\r\n\t\t\tthis.connect();\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.filters = value;\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tgetFilter: function () {\r\n\r\n\t\treturn this.getFilters()[ 0 ];\r\n\r\n\t},\r\n\r\n\tsetFilter: function ( filter ) {\r\n\r\n\t\treturn this.setFilters( filter ? [ filter ] : [] );\r\n\r\n\t},\r\n\r\n\tsetPlaybackRate: function ( value ) {\r\n\r\n\t\tif ( this.hasPlaybackControl === false ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Audio: this Audio has no playback control.' );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tthis.playbackRate = value;\r\n\r\n\t\tif ( this.isPlaying === true ) {\r\n\r\n\t\t\tthis.source.playbackRate.value = this.playbackRate;\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tgetPlaybackRate: function () {\r\n\r\n\t\treturn this.playbackRate;\r\n\r\n\t},\r\n\r\n\tonEnded: function () {\r\n\r\n\t\tthis.isPlaying = false;\r\n\r\n\t},\r\n\r\n\tgetLoop: function () {\r\n\r\n\t\tif ( this.hasPlaybackControl === false ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Audio: this Audio has no playback control.' );\r\n\t\t\treturn false;\r\n\r\n\t\t}\r\n\r\n\t\treturn this.source.loop;\r\n\r\n\t},\r\n\r\n\tsetLoop: function ( value ) {\r\n\r\n\t\tif ( this.hasPlaybackControl === false ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Audio: this Audio has no playback control.' );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tthis.source.loop = value;\r\n\r\n\t},\r\n\r\n\tgetVolume: function () {\r\n\r\n\t\treturn this.gain.gain.value;\r\n\r\n\t},\r\n\r\n\r\n\tsetVolume: function ( value ) {\r\n\r\n\t\tthis.gain.gain.value = value;\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n} );\r\n\r\n// File:src/audio/AudioAnalyser.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.AudioAnalyser = function ( audio, fftSize ) {\r\n\r\n\tthis.analyser = audio.context.createAnalyser();\r\n\tthis.analyser.fftSize = fftSize !== undefined ? fftSize : 2048;\r\n\r\n\tthis.data = new Uint8Array( this.analyser.frequencyBinCount );\r\n\r\n\taudio.getOutput().connect( this.analyser );\r\n\r\n};\r\n\r\nObject.assign( THREE.AudioAnalyser.prototype, {\r\n\r\n\tgetFrequencyData: function () {\r\n\r\n\t\tthis.analyser.getByteFrequencyData( this.data );\r\n\r\n\t\treturn this.data;\r\n\r\n\t},\r\n\r\n\tgetAverageFrequency: function () {\r\n\r\n\t\tvar value = 0, data = this.getFrequencyData();\r\n\r\n\t\tfor ( var i = 0; i < data.length; i ++ ) {\r\n\r\n\t\t\tvalue += data[ i ];\r\n\r\n\t\t}\r\n\r\n\t\treturn value / data.length;\r\n\r\n\t}\r\n\r\n} );\r\n\r\n// File:src/audio/AudioContext.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nObject.defineProperty( THREE, 'AudioContext', {\r\n\r\n\tget: ( function () {\r\n\r\n\t\tvar context;\r\n\r\n\t\treturn function () {\r\n\r\n\t\t\tif ( context === undefined ) {\r\n\r\n\t\t\t\tcontext = new ( window.AudioContext || window.webkitAudioContext )();\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn context;\r\n\r\n\t\t};\r\n\r\n\t} )()\r\n\r\n} );\r\n\r\n// File:src/audio/PositionalAudio.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.PositionalAudio = function ( listener ) {\r\n\r\n\tTHREE.Audio.call( this, listener );\r\n\r\n\tthis.panner = this.context.createPanner();\r\n\tthis.panner.connect( this.gain );\r\n\r\n};\r\n\r\nTHREE.PositionalAudio.prototype = Object.assign( Object.create( THREE.Audio.prototype ), {\r\n\r\n\tconstructor: THREE.PositionalAudio,\r\n\r\n\tgetOutput: function () {\r\n\r\n\t\treturn this.panner;\r\n\r\n\t},\r\n\r\n\tgetRefDistance: function () {\r\n\r\n\t\treturn this.panner.refDistance;\r\n\r\n\t},\r\n\r\n\tsetRefDistance: function ( value ) {\r\n\r\n\t\tthis.panner.refDistance = value;\r\n\r\n\t},\r\n\r\n\tgetRolloffFactor: function () {\r\n\r\n\t\treturn this.panner.rolloffFactor;\r\n\r\n\t},\r\n\r\n\tsetRolloffFactor: function ( value ) {\r\n\r\n\t\tthis.panner.rolloffFactor = value;\r\n\r\n\t},\r\n\r\n\tgetDistanceModel: function () {\r\n\r\n\t\treturn this.panner.distanceModel;\r\n\r\n\t},\r\n\r\n\tsetDistanceModel: function ( value ) {\r\n\r\n\t\tthis.panner.distanceModel = value;\r\n\r\n\t},\r\n\r\n\tgetMaxDistance: function () {\r\n\r\n\t\treturn this.panner.maxDistance;\r\n\r\n\t},\r\n\r\n\tsetMaxDistance: function ( value ) {\r\n\r\n\t\tthis.panner.maxDistance = value;\r\n\r\n\t},\r\n\r\n\tupdateMatrixWorld: ( function () {\r\n\r\n\t\tvar position = new THREE.Vector3();\r\n\r\n\t\treturn function updateMatrixWorld( force ) {\r\n\r\n\t\t\tTHREE.Object3D.prototype.updateMatrixWorld.call( this, force );\r\n\r\n\t\t\tposition.setFromMatrixPosition( this.matrixWorld );\r\n\r\n\t\t\tthis.panner.setPosition( position.x, position.y, position.z );\r\n\r\n\t\t};\r\n\r\n\t} )()\r\n\r\n\r\n} );\r\n\r\n// File:src/audio/AudioListener.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.AudioListener = function () {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.type = 'AudioListener';\r\n\r\n\tthis.context = THREE.AudioContext;\r\n\r\n\tthis.gain = this.context.createGain();\r\n\tthis.gain.connect( this.context.destination );\r\n\r\n\tthis.filter = null;\r\n\r\n};\r\n\r\nTHREE.AudioListener.prototype = Object.assign( Object.create( THREE.Object3D.prototype ), {\r\n\r\n\tconstructor: THREE.AudioListener,\r\n\r\n\tgetInput: function () {\r\n\r\n\t\treturn this.gain;\r\n\r\n\t},\r\n\r\n\tremoveFilter: function ( ) {\r\n\r\n\t\tif ( this.filter !== null ) {\r\n\r\n\t\t\tthis.gain.disconnect( this.filter );\r\n\t\t\tthis.filter.disconnect( this.context.destination );\r\n\t\t\tthis.gain.connect( this.context.destination );\r\n\t\t\tthis.filter = null;\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tgetFilter: function () {\r\n\r\n\t\treturn this.filter;\r\n\r\n\t},\r\n\r\n\tsetFilter: function ( value ) {\r\n\r\n\t\tif ( this.filter !== null ) {\r\n\r\n\t\t\tthis.gain.disconnect( this.filter );\r\n\t\t\tthis.filter.disconnect( this.context.destination );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.gain.disconnect( this.context.destination );\r\n\r\n\t\t}\r\n\r\n\t\tthis.filter = value;\r\n\t\tthis.gain.connect( this.filter );\r\n\t\tthis.filter.connect( this.context.destination );\r\n\r\n\t},\r\n\r\n\tgetMasterVolume: function () {\r\n\r\n\t\treturn this.gain.gain.value;\r\n\r\n\t},\r\n\r\n\tsetMasterVolume: function ( value ) {\r\n\r\n\t\tthis.gain.gain.value = value;\r\n\r\n\t},\r\n\r\n\tupdateMatrixWorld: ( function () {\r\n\r\n\t\tvar position = new THREE.Vector3();\r\n\t\tvar quaternion = new THREE.Quaternion();\r\n\t\tvar scale = new THREE.Vector3();\r\n\r\n\t\tvar orientation = new THREE.Vector3();\r\n\r\n\t\treturn function updateMatrixWorld( force ) {\r\n\r\n\t\t\tTHREE.Object3D.prototype.updateMatrixWorld.call( this, force );\r\n\r\n\t\t\tvar listener = this.context.listener;\r\n\t\t\tvar up = this.up;\r\n\r\n\t\t\tthis.matrixWorld.decompose( position, quaternion, scale );\r\n\r\n\t\t\torientation.set( 0, 0, - 1 ).applyQuaternion( quaternion );\r\n\r\n\t\t\tlistener.setPosition( position.x, position.y, position.z );\r\n\t\t\tlistener.setOrientation( orientation.x, orientation.y, orientation.z, up.x, up.y, up.z );\r\n\r\n\t\t};\r\n\r\n\t} )()\r\n\r\n} );\r\n\r\n// File:src/cameras/Camera.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author WestLangley / http://github.com/WestLangley\r\n*/\r\n\r\nTHREE.Camera = function () {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.type = 'Camera';\r\n\r\n\tthis.matrixWorldInverse = new THREE.Matrix4();\r\n\tthis.projectionMatrix = new THREE.Matrix4();\r\n\r\n};\r\n\r\nTHREE.Camera.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.Camera.prototype.constructor = THREE.Camera;\r\n\r\nTHREE.Camera.prototype.getWorldDirection = function () {\r\n\r\n\tvar quaternion = new THREE.Quaternion();\r\n\r\n\treturn function ( optionalTarget ) {\r\n\r\n\t\tvar result = optionalTarget || new THREE.Vector3();\r\n\r\n\t\tthis.getWorldQuaternion( quaternion );\r\n\r\n\t\treturn result.set( 0, 0, - 1 ).applyQuaternion( quaternion );\r\n\r\n\t};\r\n\r\n}();\r\n\r\nTHREE.Camera.prototype.lookAt = function () {\r\n\r\n\t// This routine does not support cameras with rotated and/or translated parent(s)\r\n\r\n\tvar m1 = new THREE.Matrix4();\r\n\r\n\treturn function ( vector ) {\r\n\r\n\t\tm1.lookAt( this.position, vector, this.up );\r\n\r\n\t\tthis.quaternion.setFromRotationMatrix( m1 );\r\n\r\n\t};\r\n\r\n}();\r\n\r\nTHREE.Camera.prototype.clone = function () {\r\n\r\n\treturn new this.constructor().copy( this );\r\n\r\n};\r\n\r\nTHREE.Camera.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.Object3D.prototype.copy.call( this, source );\r\n\r\n\tthis.matrixWorldInverse.copy( source.matrixWorldInverse );\r\n\tthis.projectionMatrix.copy( source.projectionMatrix );\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n// File:src/cameras/CubeCamera.js\r\n\r\n/**\r\n * Camera for rendering cube maps\r\n *\t- renders scene into axis-aligned cube\r\n *\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.CubeCamera = function ( near, far, cubeResolution ) {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.type = 'CubeCamera';\r\n\r\n\tvar fov = 90, aspect = 1;\r\n\r\n\tvar cameraPX = new THREE.PerspectiveCamera( fov, aspect, near, far );\r\n\tcameraPX.up.set( 0, - 1, 0 );\r\n\tcameraPX.lookAt( new THREE.Vector3( 1, 0, 0 ) );\r\n\tthis.add( cameraPX );\r\n\r\n\tvar cameraNX = new THREE.PerspectiveCamera( fov, aspect, near, far );\r\n\tcameraNX.up.set( 0, - 1, 0 );\r\n\tcameraNX.lookAt( new THREE.Vector3( - 1, 0, 0 ) );\r\n\tthis.add( cameraNX );\r\n\r\n\tvar cameraPY = new THREE.PerspectiveCamera( fov, aspect, near, far );\r\n\tcameraPY.up.set( 0, 0, 1 );\r\n\tcameraPY.lookAt( new THREE.Vector3( 0, 1, 0 ) );\r\n\tthis.add( cameraPY );\r\n\r\n\tvar cameraNY = new THREE.PerspectiveCamera( fov, aspect, near, far );\r\n\tcameraNY.up.set( 0, 0, - 1 );\r\n\tcameraNY.lookAt( new THREE.Vector3( 0, - 1, 0 ) );\r\n\tthis.add( cameraNY );\r\n\r\n\tvar cameraPZ = new THREE.PerspectiveCamera( fov, aspect, near, far );\r\n\tcameraPZ.up.set( 0, - 1, 0 );\r\n\tcameraPZ.lookAt( new THREE.Vector3( 0, 0, 1 ) );\r\n\tthis.add( cameraPZ );\r\n\r\n\tvar cameraNZ = new THREE.PerspectiveCamera( fov, aspect, near, far );\r\n\tcameraNZ.up.set( 0, - 1, 0 );\r\n\tcameraNZ.lookAt( new THREE.Vector3( 0, 0, - 1 ) );\r\n\tthis.add( cameraNZ );\r\n\r\n\tvar options = { format: THREE.RGBFormat, magFilter: THREE.LinearFilter, minFilter: THREE.LinearFilter };\r\n\r\n\tthis.renderTarget = new THREE.WebGLRenderTargetCube( cubeResolution, cubeResolution, options );\r\n\r\n\tthis.updateCubeMap = function ( renderer, scene ) {\r\n\r\n\t\tif ( this.parent === null ) this.updateMatrixWorld();\r\n\r\n\t\tvar renderTarget = this.renderTarget;\r\n\t\tvar generateMipmaps = renderTarget.texture.generateMipmaps;\r\n\r\n\t\trenderTarget.texture.generateMipmaps = false;\r\n\r\n\t\trenderTarget.activeCubeFace = 0;\r\n\t\trenderer.render( scene, cameraPX, renderTarget );\r\n\r\n\t\trenderTarget.activeCubeFace = 1;\r\n\t\trenderer.render( scene, cameraNX, renderTarget );\r\n\r\n\t\trenderTarget.activeCubeFace = 2;\r\n\t\trenderer.render( scene, cameraPY, renderTarget );\r\n\r\n\t\trenderTarget.activeCubeFace = 3;\r\n\t\trenderer.render( scene, cameraNY, renderTarget );\r\n\r\n\t\trenderTarget.activeCubeFace = 4;\r\n\t\trenderer.render( scene, cameraPZ, renderTarget );\r\n\r\n\t\trenderTarget.texture.generateMipmaps = generateMipmaps;\r\n\r\n\t\trenderTarget.activeCubeFace = 5;\r\n\t\trenderer.render( scene, cameraNZ, renderTarget );\r\n\r\n\t\trenderer.setRenderTarget( null );\r\n\r\n\t};\r\n\r\n};\r\n\r\nTHREE.CubeCamera.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.CubeCamera.prototype.constructor = THREE.CubeCamera;\r\n\r\n// File:src/cameras/OrthographicCamera.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.OrthographicCamera = function ( left, right, top, bottom, near, far ) {\r\n\r\n\tTHREE.Camera.call( this );\r\n\r\n\tthis.type = 'OrthographicCamera';\r\n\r\n\tthis.zoom = 1;\r\n\r\n\tthis.left = left;\r\n\tthis.right = right;\r\n\tthis.top = top;\r\n\tthis.bottom = bottom;\r\n\r\n\tthis.near = ( near !== undefined ) ? near : 0.1;\r\n\tthis.far = ( far !== undefined ) ? far : 2000;\r\n\r\n\tthis.updateProjectionMatrix();\r\n\r\n};\r\n\r\nTHREE.OrthographicCamera.prototype = Object.assign( Object.create( THREE.Camera.prototype ), {\r\n\r\n\tconstructor: THREE.OrthographicCamera,\r\n\r\n\tcopy: function ( source ) {\r\n\r\n\t\tTHREE.Camera.prototype.copy.call( this, source );\r\n\r\n\t\tthis.left = source.left;\r\n\t\tthis.right = source.right;\r\n\t\tthis.top = source.top;\r\n\t\tthis.bottom = source.bottom;\r\n\t\tthis.near = source.near;\r\n\t\tthis.far = source.far;\r\n\r\n\t\tthis.zoom = source.zoom;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tupdateProjectionMatrix: function () {\r\n\r\n\t\tvar dx = ( this.right - this.left ) / ( 2 * this.zoom );\r\n\t\tvar dy = ( this.top - this.bottom ) / ( 2 * this.zoom );\r\n\t\tvar cx = ( this.right + this.left ) / 2;\r\n\t\tvar cy = ( this.top + this.bottom ) / 2;\r\n\r\n\t\tthis.projectionMatrix.makeOrthographic( cx - dx, cx + dx, cy + dy, cy - dy, this.near, this.far );\r\n\r\n\t},\r\n\r\n\ttoJSON: function ( meta ) {\r\n\r\n\t\tvar data = THREE.Object3D.prototype.toJSON.call( this, meta );\r\n\r\n\t\tdata.object.zoom = this.zoom;\r\n\t\tdata.object.left = this.left;\r\n\t\tdata.object.right = this.right;\r\n\t\tdata.object.top = this.top;\r\n\t\tdata.object.bottom = this.bottom;\r\n\t\tdata.object.near = this.near;\r\n\t\tdata.object.far = this.far;\r\n\r\n\t\treturn data;\r\n\r\n\t}\r\n\r\n} );\r\n\r\n// File:src/cameras/PerspectiveCamera.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author greggman / http://games.greggman.com/\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n * @author tschw\r\n */\r\n\r\nTHREE.PerspectiveCamera = function( fov, aspect, near, far ) {\r\n\r\n\tTHREE.Camera.call( this );\r\n\r\n\tthis.type = 'PerspectiveCamera';\r\n\r\n\tthis.fov = fov !== undefined ? fov : 50;\r\n\tthis.zoom = 1;\r\n\r\n\tthis.near = near !== undefined ? near : 0.1;\r\n\tthis.far = far !== undefined ? far : 2000;\r\n\tthis.focus = 10;\r\n\r\n\tthis.aspect = aspect !== undefined ? aspect : 1;\r\n\tthis.view = null;\r\n\r\n\tthis.filmGauge = 35;\t// width of the film (default in millimeters)\r\n\tthis.filmOffset = 0;\t// horizontal film offset (same unit as gauge)\r\n\r\n\tthis.updateProjectionMatrix();\r\n\r\n};\r\n\r\nTHREE.PerspectiveCamera.prototype = Object.assign( Object.create( THREE.Camera.prototype ), {\r\n\r\n\tconstructor: THREE.PerspectiveCamera,\r\n\r\n\tcopy: function ( source ) {\r\n\r\n\t\tTHREE.Camera.prototype.copy.call( this, source );\r\n\r\n\t\tthis.fov = source.fov;\r\n\t\tthis.zoom = source.zoom;\r\n\r\n\t\tthis.near = source.near;\r\n\t\tthis.far = source.far;\r\n\t\tthis.focus = source.focus;\r\n\r\n\t\tthis.aspect = source.aspect;\r\n\t\tthis.view = source.view === null ? null : Object.assign( {}, source.view );\r\n\r\n\t\tthis.filmGauge = source.filmGauge;\r\n\t\tthis.filmOffset = source.filmOffset;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\t/**\r\n\t * Sets the FOV by focal length in respect to the current .filmGauge.\r\n\t *\r\n\t * The default film gauge is 35, so that the focal length can be specified for\r\n\t * a 35mm (full frame) camera.\r\n\t *\r\n\t * Values for focal length and film gauge must have the same unit.\r\n\t */\r\n\tsetFocalLength: function ( focalLength ) {\r\n\r\n\t\t// see http://www.bobatkins.com/photography/technical/field_of_view.html\r\n\t\tvar vExtentSlope = 0.5 * this.getFilmHeight() / focalLength;\r\n\r\n\t\tthis.fov = THREE.Math.RAD2DEG * 2 * Math.atan( vExtentSlope );\r\n\t\tthis.updateProjectionMatrix();\r\n\r\n\t},\r\n\r\n\t/**\r\n\t * Calculates the focal length from the current .fov and .filmGauge.\r\n\t */\r\n\tgetFocalLength: function () {\r\n\r\n\t\tvar vExtentSlope = Math.tan( THREE.Math.DEG2RAD * 0.5 * this.fov );\r\n\r\n\t\treturn 0.5 * this.getFilmHeight() / vExtentSlope;\r\n\r\n\t},\r\n\r\n\tgetEffectiveFOV: function () {\r\n\r\n\t\treturn THREE.Math.RAD2DEG * 2 * Math.atan(\r\n\t\t\t\tMath.tan( THREE.Math.DEG2RAD * 0.5 * this.fov ) / this.zoom );\r\n\r\n\t},\r\n\r\n\tgetFilmWidth: function () {\r\n\r\n\t\t// film not completely covered in portrait format (aspect < 1)\r\n\t\treturn this.filmGauge * Math.min( this.aspect, 1 );\r\n\r\n\t},\r\n\r\n\tgetFilmHeight: function () {\r\n\r\n\t\t// film not completely covered in landscape format (aspect > 1)\r\n\t\treturn this.filmGauge / Math.max( this.aspect, 1 );\r\n\r\n\t},\r\n\r\n\t/**\r\n\t * Sets an offset in a larger frustum. This is useful for multi-window or\r\n\t * multi-monitor/multi-machine setups.\r\n\t *\r\n\t * For example, if you have 3x2 monitors and each monitor is 1920x1080 and\r\n\t * the monitors are in grid like this\r\n\t *\r\n\t *   +---+---+---+\r\n\t *   | A | B | C |\r\n\t *   +---+---+---+\r\n\t *   | D | E | F |\r\n\t *   +---+---+---+\r\n\t *\r\n\t * then for each monitor you would call it like this\r\n\t *\r\n\t *   var w = 1920;\r\n\t *   var h = 1080;\r\n\t *   var fullWidth = w * 3;\r\n\t *   var fullHeight = h * 2;\r\n\t *\r\n\t *   --A--\r\n\t *   camera.setOffset( fullWidth, fullHeight, w * 0, h * 0, w, h );\r\n\t *   --B--\r\n\t *   camera.setOffset( fullWidth, fullHeight, w * 1, h * 0, w, h );\r\n\t *   --C--\r\n\t *   camera.setOffset( fullWidth, fullHeight, w * 2, h * 0, w, h );\r\n\t *   --D--\r\n\t *   camera.setOffset( fullWidth, fullHeight, w * 0, h * 1, w, h );\r\n\t *   --E--\r\n\t *   camera.setOffset( fullWidth, fullHeight, w * 1, h * 1, w, h );\r\n\t *   --F--\r\n\t *   camera.setOffset( fullWidth, fullHeight, w * 2, h * 1, w, h );\r\n\t *\r\n\t *   Note there is no reason monitors have to be the same size or in a grid.\r\n\t */\r\n\tsetViewOffset: function ( fullWidth, fullHeight, x, y, width, height ) {\r\n\r\n\t\tthis.aspect = fullWidth / fullHeight;\r\n\r\n\t\tthis.view = {\r\n\t\t\tfullWidth: fullWidth,\r\n\t\t\tfullHeight: fullHeight,\r\n\t\t\toffsetX: x,\r\n\t\t\toffsetY: y,\r\n\t\t\twidth: width,\r\n\t\t\theight: height\r\n\t\t};\r\n\r\n\t\tthis.updateProjectionMatrix();\r\n\r\n\t},\r\n\r\n\tclearViewOffset: function() {\r\n\r\n\t\tthis.view = null;\r\n\t\tthis.updateProjectionMatrix();\r\n\r\n\t},\r\n\r\n\tupdateProjectionMatrix: function () {\r\n\r\n\t\tvar near = this.near,\r\n\t\t\ttop = near * Math.tan(\r\n\t\t\t\t\tTHREE.Math.DEG2RAD * 0.5 * this.fov ) / this.zoom,\r\n\t\t\theight = 2 * top,\r\n\t\t\twidth = this.aspect * height,\r\n\t\t\tleft = - 0.5 * width,\r\n\t\t\tview = this.view;\r\n\r\n\t\tif ( view !== null ) {\r\n\r\n\t\t\tvar fullWidth = view.fullWidth,\r\n\t\t\t\tfullHeight = view.fullHeight;\r\n\r\n\t\t\tleft += view.offsetX * width / fullWidth;\r\n\t\t\ttop -= view.offsetY * height / fullHeight;\r\n\t\t\twidth *= view.width / fullWidth;\r\n\t\t\theight *= view.height / fullHeight;\r\n\r\n\t\t}\r\n\r\n\t\tvar skew = this.filmOffset;\r\n\t\tif ( skew !== 0 ) left += near * skew / this.getFilmWidth();\r\n\r\n\t\tthis.projectionMatrix.makeFrustum(\r\n\t\t\t\tleft, left + width, top - height, top, near, this.far );\r\n\r\n\t},\r\n\r\n\ttoJSON: function ( meta ) {\r\n\r\n\t\tvar data = THREE.Object3D.prototype.toJSON.call( this, meta );\r\n\r\n\t\tdata.object.fov = this.fov;\r\n\t\tdata.object.zoom = this.zoom;\r\n\r\n\t\tdata.object.near = this.near;\r\n\t\tdata.object.far = this.far;\r\n\t\tdata.object.focus = this.focus;\r\n\r\n\t\tdata.object.aspect = this.aspect;\r\n\r\n\t\tif ( this.view !== null ) data.object.view = Object.assign( {}, this.view );\r\n\r\n\t\tdata.object.filmGauge = this.filmGauge;\r\n\t\tdata.object.filmOffset = this.filmOffset;\r\n\r\n\t\treturn data;\r\n\r\n\t}\r\n\r\n} );\r\n\r\n// File:src/cameras/StereoCamera.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.StereoCamera = function () {\r\n\r\n\tthis.type = 'StereoCamera';\r\n\r\n\tthis.aspect = 1;\r\n\r\n\tthis.cameraL = new THREE.PerspectiveCamera();\r\n\tthis.cameraL.layers.enable( 1 );\r\n\tthis.cameraL.matrixAutoUpdate = false;\r\n\r\n\tthis.cameraR = new THREE.PerspectiveCamera();\r\n\tthis.cameraR.layers.enable( 2 );\r\n\tthis.cameraR.matrixAutoUpdate = false;\r\n\r\n};\r\n\r\nObject.assign( THREE.StereoCamera.prototype, {\r\n\r\n\tupdate: ( function () {\r\n\r\n\t\tvar focus, fov, aspect, near, far;\r\n\r\n\t\tvar eyeRight = new THREE.Matrix4();\r\n\t\tvar eyeLeft = new THREE.Matrix4();\r\n\r\n\t\treturn function update ( camera ) {\r\n\r\n\t\t\tvar needsUpdate = focus !== camera.focus || fov !== camera.fov ||\r\n\t\t\t\t\t\t\t\t\t\t\t\taspect !== camera.aspect * this.aspect || near !== camera.near ||\r\n\t\t\t\t\t\t\t\t\t\t\t\tfar !== camera.far;\r\n\r\n\t\t\tif ( needsUpdate ) {\r\n\r\n\t\t\t\tfocus = camera.focus;\r\n\t\t\t\tfov = camera.fov;\r\n\t\t\t\taspect = camera.aspect * this.aspect;\r\n\t\t\t\tnear = camera.near;\r\n\t\t\t\tfar = camera.far;\r\n\r\n\t\t\t\t// Off-axis stereoscopic effect based on\r\n\t\t\t\t// http://paulbourke.net/stereographics/stereorender/\r\n\r\n\t\t\t\tvar projectionMatrix = camera.projectionMatrix.clone();\r\n\t\t\t\tvar eyeSep = 0.064 / 2;\r\n\t\t\t\tvar eyeSepOnProjection = eyeSep * near / focus;\r\n\t\t\t\tvar ymax = near * Math.tan( THREE.Math.DEG2RAD * fov * 0.5 );\r\n\t\t\t\tvar xmin, xmax;\r\n\r\n\t\t\t\t// translate xOffset\r\n\r\n\t\t\t\teyeLeft.elements[ 12 ] = - eyeSep;\r\n\t\t\t\teyeRight.elements[ 12 ] = eyeSep;\r\n\r\n\t\t\t\t// for left eye\r\n\r\n\t\t\t\txmin = - ymax * aspect + eyeSepOnProjection;\r\n\t\t\t\txmax = ymax * aspect + eyeSepOnProjection;\r\n\r\n\t\t\t\tprojectionMatrix.elements[ 0 ] = 2 * near / ( xmax - xmin );\r\n\t\t\t\tprojectionMatrix.elements[ 8 ] = ( xmax + xmin ) / ( xmax - xmin );\r\n\r\n\t\t\t\tthis.cameraL.projectionMatrix.copy( projectionMatrix );\r\n\r\n\t\t\t\t// for right eye\r\n\r\n\t\t\t\txmin = - ymax * aspect - eyeSepOnProjection;\r\n\t\t\t\txmax = ymax * aspect - eyeSepOnProjection;\r\n\r\n\t\t\t\tprojectionMatrix.elements[ 0 ] = 2 * near / ( xmax - xmin );\r\n\t\t\t\tprojectionMatrix.elements[ 8 ] = ( xmax + xmin ) / ( xmax - xmin );\r\n\r\n\t\t\t\tthis.cameraR.projectionMatrix.copy( projectionMatrix );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.cameraL.matrixWorld.copy( camera.matrixWorld ).multiply( eyeLeft );\r\n\t\t\tthis.cameraR.matrixWorld.copy( camera.matrixWorld ).multiply( eyeRight );\r\n\r\n\t\t};\r\n\r\n\t} )()\r\n\r\n} );\r\n\r\n// File:src/lights/Light.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Light = function ( color, intensity ) {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.type = 'Light';\r\n\r\n\tthis.color = new THREE.Color( color );\r\n\tthis.intensity = intensity !== undefined ? intensity : 1;\r\n\r\n\tthis.receiveShadow = undefined;\r\n\r\n};\r\n\r\nTHREE.Light.prototype = Object.assign( Object.create( THREE.Object3D.prototype ), {\r\n\r\n\tconstructor: THREE.Light,\r\n\r\n\tcopy: function ( source ) {\r\n\r\n\t\tTHREE.Object3D.prototype.copy.call( this, source );\r\n\r\n\t\tthis.color.copy( source.color );\r\n\t\tthis.intensity = source.intensity;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\ttoJSON: function ( meta ) {\r\n\r\n\t\tvar data = THREE.Object3D.prototype.toJSON.call( this, meta );\r\n\r\n\t\tdata.object.color = this.color.getHex();\r\n\t\tdata.object.intensity = this.intensity;\r\n\r\n\t\tif ( this.groundColor !== undefined ) data.object.groundColor = this.groundColor.getHex();\r\n\r\n\t\tif ( this.distance !== undefined ) data.object.distance = this.distance;\r\n\t\tif ( this.angle !== undefined ) data.object.angle = this.angle;\r\n\t\tif ( this.decay !== undefined ) data.object.decay = this.decay;\r\n\t\tif ( this.penumbra !== undefined ) data.object.penumbra = this.penumbra;\r\n\r\n\t\treturn data;\r\n\r\n\t}\r\n\r\n} );\r\n\r\n// File:src/lights/LightShadow.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.LightShadow = function ( camera ) {\r\n\r\n\tthis.camera = camera;\r\n\r\n\tthis.bias = 0;\r\n\tthis.radius = 1;\r\n\r\n\tthis.mapSize = new THREE.Vector2( 512, 512 );\r\n\r\n\tthis.map = null;\r\n\tthis.matrix = new THREE.Matrix4();\r\n\r\n};\r\n\r\nObject.assign( THREE.LightShadow.prototype, {\r\n\r\n\tcopy: function ( source ) {\r\n\r\n\t\tthis.camera = source.camera.clone();\r\n\r\n\t\tthis.bias = source.bias;\r\n\t\tthis.radius = source.radius;\r\n\r\n\t\tthis.mapSize.copy( source.mapSize );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor().copy( this );\r\n\r\n\t}\r\n\r\n} );\r\n\r\n// File:src/lights/AmbientLight.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.AmbientLight = function ( color, intensity ) {\r\n\r\n\tTHREE.Light.call( this, color, intensity );\r\n\r\n\tthis.type = 'AmbientLight';\r\n\r\n\tthis.castShadow = undefined;\r\n\r\n};\r\n\r\nTHREE.AmbientLight.prototype = Object.assign( Object.create( THREE.Light.prototype ), {\r\n\r\n\tconstructor: THREE.AmbientLight\r\n\r\n} );\r\n\r\n// File:src/lights/DirectionalLight.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.DirectionalLight = function ( color, intensity ) {\r\n\r\n\tTHREE.Light.call( this, color, intensity );\r\n\r\n\tthis.type = 'DirectionalLight';\r\n\r\n\tthis.position.set( 0, 1, 0 );\r\n\tthis.updateMatrix();\r\n\r\n\tthis.target = new THREE.Object3D();\r\n\r\n\tthis.shadow = new THREE.DirectionalLightShadow();\r\n\r\n};\r\n\r\nTHREE.DirectionalLight.prototype = Object.assign( Object.create( THREE.Light.prototype ), {\r\n\r\n\tconstructor: THREE.DirectionalLight,\r\n\r\n\tcopy: function ( source ) {\r\n\r\n\t\tTHREE.Light.prototype.copy.call( this, source );\r\n\r\n\t\tthis.target = source.target.clone();\r\n\r\n\t\tthis.shadow = source.shadow.clone();\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n} );\r\n\r\n// File:src/lights/DirectionalLightShadow.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.DirectionalLightShadow = function ( light ) {\r\n\r\n\tTHREE.LightShadow.call( this, new THREE.OrthographicCamera( - 5, 5, 5, - 5, 0.5, 500 ) );\r\n\r\n};\r\n\r\nTHREE.DirectionalLightShadow.prototype = Object.assign( Object.create( THREE.LightShadow.prototype ), {\r\n\r\n\tconstructor: THREE.DirectionalLightShadow\r\n\r\n} );\r\n\r\n// File:src/lights/HemisphereLight.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.HemisphereLight = function ( skyColor, groundColor, intensity ) {\r\n\r\n\tTHREE.Light.call( this, skyColor, intensity );\r\n\r\n\tthis.type = 'HemisphereLight';\r\n\r\n\tthis.castShadow = undefined;\r\n\r\n\tthis.position.set( 0, 1, 0 );\r\n\tthis.updateMatrix();\r\n\r\n\tthis.groundColor = new THREE.Color( groundColor );\r\n\r\n};\r\n\r\nTHREE.HemisphereLight.prototype = Object.assign( Object.create( THREE.Light.prototype ), {\r\n\r\n\tconstructor: THREE.HemisphereLight,\r\n\r\n\tcopy: function ( source ) {\r\n\r\n\t\tTHREE.Light.prototype.copy.call( this, source );\r\n\r\n\t\tthis.groundColor.copy( source.groundColor );\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n} );\r\n\r\n// File:src/lights/PointLight.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\n\r\nTHREE.PointLight = function ( color, intensity, distance, decay ) {\r\n\r\n\tTHREE.Light.call( this, color, intensity );\r\n\r\n\tthis.type = 'PointLight';\r\n\r\n\tObject.defineProperty( this, 'power', {\r\n\t\tget: function () {\r\n\t\t\t// intensity = power per solid angle.\r\n\t\t\t// ref: equation (15) from http://www.frostbite.com/wp-content/uploads/2014/11/course_notes_moving_frostbite_to_pbr.pdf\r\n\t\t\treturn this.intensity * 4 * Math.PI;\r\n\r\n\t\t},\r\n\t\tset: function ( power ) {\r\n\t\t\t// intensity = power per solid angle.\r\n\t\t\t// ref: equation (15) from http://www.frostbite.com/wp-content/uploads/2014/11/course_notes_moving_frostbite_to_pbr.pdf\r\n\t\t\tthis.intensity = power / ( 4 * Math.PI );\r\n\t\t}\r\n\t} );\r\n\r\n\tthis.distance = ( distance !== undefined ) ? distance : 0;\r\n\tthis.decay = ( decay !== undefined ) ? decay : 1;\t// for physically correct lights, should be 2.\r\n\r\n\tthis.shadow = new THREE.LightShadow( new THREE.PerspectiveCamera( 90, 1, 0.5, 500 ) );\r\n\r\n};\r\n\r\nTHREE.PointLight.prototype = Object.assign( Object.create( THREE.Light.prototype ), {\r\n\r\n\tconstructor: THREE.PointLight,\r\n\r\n\tcopy: function ( source ) {\r\n\r\n\t\tTHREE.Light.prototype.copy.call( this, source );\r\n\r\n\t\tthis.distance = source.distance;\r\n\t\tthis.decay = source.decay;\r\n\r\n\t\tthis.shadow = source.shadow.clone();\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n} );\r\n\r\n// File:src/lights/SpotLight.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.SpotLight = function ( color, intensity, distance, angle, penumbra, decay ) {\r\n\r\n\tTHREE.Light.call( this, color, intensity );\r\n\r\n\tthis.type = 'SpotLight';\r\n\r\n\tthis.position.set( 0, 1, 0 );\r\n\tthis.updateMatrix();\r\n\r\n\tthis.target = new THREE.Object3D();\r\n\r\n\tObject.defineProperty( this, 'power', {\r\n\t\tget: function () {\r\n\t\t\t// intensity = power per solid angle.\r\n\t\t\t// ref: equation (17) from http://www.frostbite.com/wp-content/uploads/2014/11/course_notes_moving_frostbite_to_pbr.pdf\r\n\t\t\treturn this.intensity * Math.PI;\r\n\t\t},\r\n\t\tset: function ( power ) {\r\n\t\t\t// intensity = power per solid angle.\r\n\t\t\t// ref: equation (17) from http://www.frostbite.com/wp-content/uploads/2014/11/course_notes_moving_frostbite_to_pbr.pdf\r\n\t\t\tthis.intensity = power / Math.PI;\r\n\t\t}\r\n\t} );\r\n\r\n\tthis.distance = ( distance !== undefined ) ? distance : 0;\r\n\tthis.angle = ( angle !== undefined ) ? angle : Math.PI / 3;\r\n\tthis.penumbra = ( penumbra !== undefined ) ? penumbra : 0;\r\n\tthis.decay = ( decay !== undefined ) ? decay : 1;\t// for physically correct lights, should be 2.\r\n\r\n\tthis.shadow = new THREE.SpotLightShadow();\r\n\r\n};\r\n\r\nTHREE.SpotLight.prototype = Object.assign( Object.create( THREE.Light.prototype ), {\r\n\r\n\tconstructor: THREE.SpotLight,\r\n\r\n\tcopy: function ( source ) {\r\n\r\n\t\tTHREE.Light.prototype.copy.call( this, source );\r\n\r\n\t\tthis.distance = source.distance;\r\n\t\tthis.angle = source.angle;\r\n\t\tthis.penumbra = source.penumbra;\r\n\t\tthis.decay = source.decay;\r\n\r\n\t\tthis.target = source.target.clone();\r\n\r\n\t\tthis.shadow = source.shadow.clone();\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n} );\r\n\r\n// File:src/lights/SpotLightShadow.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.SpotLightShadow = function () {\r\n\r\n\tTHREE.LightShadow.call( this, new THREE.PerspectiveCamera( 50, 1, 0.5, 500 ) );\r\n\r\n};\r\n\r\nTHREE.SpotLightShadow.prototype = Object.assign( Object.create( THREE.LightShadow.prototype ), {\r\n\r\n\tconstructor: THREE.SpotLightShadow,\r\n\r\n\tupdate: function ( light ) {\r\n\r\n\t\tvar fov = THREE.Math.RAD2DEG * 2 * light.angle;\r\n\t\tvar aspect = this.mapSize.width / this.mapSize.height;\r\n\t\tvar far = light.distance || 500;\r\n\r\n\t\tvar camera = this.camera;\r\n\r\n\t\tif ( fov !== camera.fov || aspect !== camera.aspect || far !== camera.far ) {\r\n\r\n\t\t\tcamera.fov = fov;\r\n\t\t\tcamera.aspect = aspect;\r\n\t\t\tcamera.far = far;\r\n\t\t\tcamera.updateProjectionMatrix();\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n} );\r\n\r\n// File:src/loaders/AudioLoader.js\r\n\r\n/**\r\n * @author Reece Aaron Lecrivain / http://reecenotes.com/\r\n */\r\n\r\nTHREE.AudioLoader = function ( manager ) {\r\n\r\n\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\r\n\r\n};\r\n\r\nTHREE.AudioLoader.prototype = {\r\n\r\n\tconstructor: THREE.AudioLoader,\r\n\r\n\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\tvar loader = new THREE.XHRLoader( this.manager );\r\n\t\tloader.setResponseType( 'arraybuffer' );\r\n\t\tloader.load( url, function ( buffer ) {\r\n\r\n\t\t\tvar context = THREE.AudioContext;\r\n\r\n\t\t\tcontext.decodeAudioData( buffer, function ( audioBuffer ) {\r\n\r\n\t\t\t\tonLoad( audioBuffer );\r\n\r\n\t\t\t} );\r\n\r\n\t\t}, onProgress, onError );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/loaders/Cache.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Cache = {\r\n\r\n\tenabled: false,\r\n\r\n\tfiles: {},\r\n\r\n\tadd: function ( key, file ) {\r\n\r\n\t\tif ( this.enabled === false ) return;\r\n\r\n\t\t// console.log( 'THREE.Cache', 'Adding key:', key );\r\n\r\n\t\tthis.files[ key ] = file;\r\n\r\n\t},\r\n\r\n\tget: function ( key ) {\r\n\r\n\t\tif ( this.enabled === false ) return;\r\n\r\n\t\t// console.log( 'THREE.Cache', 'Checking key:', key );\r\n\r\n\t\treturn this.files[ key ];\r\n\r\n\t},\r\n\r\n\tremove: function ( key ) {\r\n\r\n\t\tdelete this.files[ key ];\r\n\r\n\t},\r\n\r\n\tclear: function () {\r\n\r\n\t\tthis.files = {};\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/loaders/Loader.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Loader = function () {\r\n\r\n\tthis.onLoadStart = function () {};\r\n\tthis.onLoadProgress = function () {};\r\n\tthis.onLoadComplete = function () {};\r\n\r\n};\r\n\r\nTHREE.Loader.prototype = {\r\n\r\n\tconstructor: THREE.Loader,\r\n\r\n\tcrossOrigin: undefined,\r\n\r\n\textractUrlBase: function ( url ) {\r\n\r\n\t\tvar parts = url.split( '/' );\r\n\r\n\t\tif ( parts.length === 1 ) return './';\r\n\r\n\t\tparts.pop();\r\n\r\n\t\treturn parts.join( '/' ) + '/';\r\n\r\n\t},\r\n\r\n\tinitMaterials: function ( materials, texturePath, crossOrigin ) {\r\n\r\n\t\tvar array = [];\r\n\r\n\t\tfor ( var i = 0; i < materials.length; ++ i ) {\r\n\r\n\t\t\tarray[ i ] = this.createMaterial( materials[ i ], texturePath, crossOrigin );\r\n\r\n\t\t}\r\n\r\n\t\treturn array;\r\n\r\n\t},\r\n\r\n\tcreateMaterial: ( function () {\r\n\r\n\t\tvar color, textureLoader, materialLoader;\r\n\r\n\t\treturn function ( m, texturePath, crossOrigin ) {\r\n\r\n\t\t\tif ( color === undefined ) color = new THREE.Color();\r\n\t\t\tif ( textureLoader === undefined ) textureLoader = new THREE.TextureLoader();\r\n\t\t\tif ( materialLoader === undefined ) materialLoader = new THREE.MaterialLoader();\r\n\r\n\t\t\t// convert from old material format\r\n\r\n\t\t\tvar textures = {};\r\n\r\n\t\t\tfunction loadTexture( path, repeat, offset, wrap, anisotropy ) {\r\n\r\n\t\t\t\tvar fullPath = texturePath + path;\r\n\t\t\t\tvar loader = THREE.Loader.Handlers.get( fullPath );\r\n\r\n\t\t\t\tvar texture;\r\n\r\n\t\t\t\tif ( loader !== null ) {\r\n\r\n\t\t\t\t\ttexture = loader.load( fullPath );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\ttextureLoader.setCrossOrigin( crossOrigin );\r\n\t\t\t\t\ttexture = textureLoader.load( fullPath );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( repeat !== undefined ) {\r\n\r\n\t\t\t\t\ttexture.repeat.fromArray( repeat );\r\n\r\n\t\t\t\t\tif ( repeat[ 0 ] !== 1 ) texture.wrapS = THREE.RepeatWrapping;\r\n\t\t\t\t\tif ( repeat[ 1 ] !== 1 ) texture.wrapT = THREE.RepeatWrapping;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( offset !== undefined ) {\r\n\r\n\t\t\t\t\ttexture.offset.fromArray( offset );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( wrap !== undefined ) {\r\n\r\n\t\t\t\t\tif ( wrap[ 0 ] === 'repeat' ) texture.wrapS = THREE.RepeatWrapping;\r\n\t\t\t\t\tif ( wrap[ 0 ] === 'mirror' ) texture.wrapS = THREE.MirroredRepeatWrapping;\r\n\r\n\t\t\t\t\tif ( wrap[ 1 ] === 'repeat' ) texture.wrapT = THREE.RepeatWrapping;\r\n\t\t\t\t\tif ( wrap[ 1 ] === 'mirror' ) texture.wrapT = THREE.MirroredRepeatWrapping;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( anisotropy !== undefined ) {\r\n\r\n\t\t\t\t\ttexture.anisotropy = anisotropy;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar uuid = THREE.Math.generateUUID();\r\n\r\n\t\t\t\ttextures[ uuid ] = texture;\r\n\r\n\t\t\t\treturn uuid;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//\r\n\r\n\t\t\tvar json = {\r\n\t\t\t\tuuid: THREE.Math.generateUUID(),\r\n\t\t\t\ttype: 'MeshLambertMaterial'\r\n\t\t\t};\r\n\r\n\t\t\tfor ( var name in m ) {\r\n\r\n\t\t\t\tvar value = m[ name ];\r\n\r\n\t\t\t\tswitch ( name ) {\r\n\t\t\t\t\tcase 'DbgColor':\r\n\t\t\t\t\tcase 'DbgIndex':\r\n\t\t\t\t\tcase 'opticalDensity':\r\n\t\t\t\t\tcase 'illumination':\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'DbgName':\r\n\t\t\t\t\t\tjson.name = value;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'blending':\r\n\t\t\t\t\t\tjson.blending = THREE[ value ];\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'colorAmbient':\r\n\t\t\t\t\tcase 'mapAmbient':\r\n\t\t\t\t\t\tconsole.warn( 'THREE.Loader.createMaterial:', name, 'is no longer supported.' );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'colorDiffuse':\r\n\t\t\t\t\t\tjson.color = color.fromArray( value ).getHex();\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'colorSpecular':\r\n\t\t\t\t\t\tjson.specular = color.fromArray( value ).getHex();\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'colorEmissive':\r\n\t\t\t\t\t\tjson.emissive = color.fromArray( value ).getHex();\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'specularCoef':\r\n\t\t\t\t\t\tjson.shininess = value;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'shading':\r\n\t\t\t\t\t\tif ( value.toLowerCase() === 'basic' ) json.type = 'MeshBasicMaterial';\r\n\t\t\t\t\t\tif ( value.toLowerCase() === 'phong' ) json.type = 'MeshPhongMaterial';\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'mapDiffuse':\r\n\t\t\t\t\t\tjson.map = loadTexture( value, m.mapDiffuseRepeat, m.mapDiffuseOffset, m.mapDiffuseWrap, m.mapDiffuseAnisotropy );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'mapDiffuseRepeat':\r\n\t\t\t\t\tcase 'mapDiffuseOffset':\r\n\t\t\t\t\tcase 'mapDiffuseWrap':\r\n\t\t\t\t\tcase 'mapDiffuseAnisotropy':\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'mapLight':\r\n\t\t\t\t\t\tjson.lightMap = loadTexture( value, m.mapLightRepeat, m.mapLightOffset, m.mapLightWrap, m.mapLightAnisotropy );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'mapLightRepeat':\r\n\t\t\t\t\tcase 'mapLightOffset':\r\n\t\t\t\t\tcase 'mapLightWrap':\r\n\t\t\t\t\tcase 'mapLightAnisotropy':\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'mapAO':\r\n\t\t\t\t\t\tjson.aoMap = loadTexture( value, m.mapAORepeat, m.mapAOOffset, m.mapAOWrap, m.mapAOAnisotropy );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'mapAORepeat':\r\n\t\t\t\t\tcase 'mapAOOffset':\r\n\t\t\t\t\tcase 'mapAOWrap':\r\n\t\t\t\t\tcase 'mapAOAnisotropy':\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'mapBump':\r\n\t\t\t\t\t\tjson.bumpMap = loadTexture( value, m.mapBumpRepeat, m.mapBumpOffset, m.mapBumpWrap, m.mapBumpAnisotropy );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'mapBumpScale':\r\n\t\t\t\t\t\tjson.bumpScale = value;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'mapBumpRepeat':\r\n\t\t\t\t\tcase 'mapBumpOffset':\r\n\t\t\t\t\tcase 'mapBumpWrap':\r\n\t\t\t\t\tcase 'mapBumpAnisotropy':\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'mapNormal':\r\n\t\t\t\t\t\tjson.normalMap = loadTexture( value, m.mapNormalRepeat, m.mapNormalOffset, m.mapNormalWrap, m.mapNormalAnisotropy );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'mapNormalFactor':\r\n\t\t\t\t\t\tjson.normalScale = [ value, value ];\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'mapNormalRepeat':\r\n\t\t\t\t\tcase 'mapNormalOffset':\r\n\t\t\t\t\tcase 'mapNormalWrap':\r\n\t\t\t\t\tcase 'mapNormalAnisotropy':\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'mapSpecular':\r\n\t\t\t\t\t\tjson.specularMap = loadTexture( value, m.mapSpecularRepeat, m.mapSpecularOffset, m.mapSpecularWrap, m.mapSpecularAnisotropy );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'mapSpecularRepeat':\r\n\t\t\t\t\tcase 'mapSpecularOffset':\r\n\t\t\t\t\tcase 'mapSpecularWrap':\r\n\t\t\t\t\tcase 'mapSpecularAnisotropy':\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'mapAlpha':\r\n\t\t\t\t\t\tjson.alphaMap = loadTexture( value, m.mapAlphaRepeat, m.mapAlphaOffset, m.mapAlphaWrap, m.mapAlphaAnisotropy );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'mapAlphaRepeat':\r\n\t\t\t\t\tcase 'mapAlphaOffset':\r\n\t\t\t\t\tcase 'mapAlphaWrap':\r\n\t\t\t\t\tcase 'mapAlphaAnisotropy':\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'flipSided':\r\n\t\t\t\t\t\tjson.side = THREE.BackSide;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'doubleSided':\r\n\t\t\t\t\t\tjson.side = THREE.DoubleSide;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'transparency':\r\n\t\t\t\t\t\tconsole.warn( 'THREE.Loader.createMaterial: transparency has been renamed to opacity' );\r\n\t\t\t\t\t\tjson.opacity = value;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'depthTest':\r\n\t\t\t\t\tcase 'depthWrite':\r\n\t\t\t\t\tcase 'colorWrite':\r\n\t\t\t\t\tcase 'opacity':\r\n\t\t\t\t\tcase 'reflectivity':\r\n\t\t\t\t\tcase 'transparent':\r\n\t\t\t\t\tcase 'visible':\r\n\t\t\t\t\tcase 'wireframe':\r\n\t\t\t\t\t\tjson[ name ] = value;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'vertexColors':\r\n\t\t\t\t\t\tif ( value === true ) json.vertexColors = THREE.VertexColors;\r\n\t\t\t\t\t\tif ( value === 'face' ) json.vertexColors = THREE.FaceColors;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tconsole.error( 'THREE.Loader.createMaterial: Unsupported', name, value );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( json.type === 'MeshBasicMaterial' ) delete json.emissive;\r\n\t\t\tif ( json.type !== 'MeshPhongMaterial' ) delete json.specular;\r\n\r\n\t\t\tif ( json.opacity < 1 ) json.transparent = true;\r\n\r\n\t\t\tmaterialLoader.setTextures( textures );\r\n\r\n\t\t\treturn materialLoader.parse( json );\r\n\r\n\t\t};\r\n\r\n\t} )()\r\n\r\n};\r\n\r\nTHREE.Loader.Handlers = {\r\n\r\n\thandlers: [],\r\n\r\n\tadd: function ( regex, loader ) {\r\n\r\n\t\tthis.handlers.push( regex, loader );\r\n\r\n\t},\r\n\r\n\tget: function ( file ) {\r\n\r\n\t\tvar handlers = this.handlers;\r\n\r\n\t\tfor ( var i = 0, l = handlers.length; i < l; i += 2 ) {\r\n\r\n\t\t\tvar regex = handlers[ i ];\r\n\t\t\tvar loader  = handlers[ i + 1 ];\r\n\r\n\t\t\tif ( regex.test( file ) ) {\r\n\r\n\t\t\t\treturn loader;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/loaders/XHRLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.XHRLoader = function ( manager ) {\r\n\r\n\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\r\n\r\n};\r\n\r\nTHREE.XHRLoader.prototype = {\r\n\r\n\tconstructor: THREE.XHRLoader,\r\n\r\n\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\tif ( this.path !== undefined ) url = this.path + url;\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tvar cached = THREE.Cache.get( url );\r\n\r\n\t\tif ( cached !== undefined ) {\r\n\r\n\t\t\tif ( onLoad ) {\r\n\r\n\t\t\t\tsetTimeout( function () {\r\n\r\n\t\t\t\t\tonLoad( cached );\r\n\r\n\t\t\t\t}, 0 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn cached;\r\n\r\n\t\t}\r\n\r\n\t\tvar request = new XMLHttpRequest();\r\n\t\trequest.overrideMimeType( 'text/plain' );\r\n\t\trequest.open( 'GET', url, true );\r\n\r\n\t\trequest.addEventListener( 'load', function ( event ) {\r\n\r\n\t\t\tvar response = event.target.response;\r\n\r\n\t\t\tTHREE.Cache.add( url, response );\r\n\r\n\t\t\tif ( this.status === 200 ) {\r\n\r\n\t\t\t\tif ( onLoad ) onLoad( response );\r\n\r\n\t\t\t\tscope.manager.itemEnd( url );\r\n\r\n\t\t\t} else if ( this.status === 0 ) {\r\n\r\n\t\t\t\t// Some browsers return HTTP Status 0 when using non-http protocol\r\n\t\t\t\t// e.g. 'file://' or 'data://'. Handle as success.\r\n\r\n\t\t\t\tconsole.warn( 'THREE.XHRLoader: HTTP Status 0 received.' );\r\n\r\n\t\t\t\tif ( onLoad ) onLoad( response );\r\n\r\n\t\t\t\tscope.manager.itemEnd( url );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tif ( onError ) onError( event );\r\n\r\n\t\t\t\tscope.manager.itemError( url );\r\n\r\n\t\t\t}\r\n\r\n\t\t}, false );\r\n\r\n\t\tif ( onProgress !== undefined ) {\r\n\r\n\t\t\trequest.addEventListener( 'progress', function ( event ) {\r\n\r\n\t\t\t\tonProgress( event );\r\n\r\n\t\t\t}, false );\r\n\r\n\t\t}\r\n\r\n\t\trequest.addEventListener( 'error', function ( event ) {\r\n\r\n\t\t\tif ( onError ) onError( event );\r\n\r\n\t\t\tscope.manager.itemError( url );\r\n\r\n\t\t}, false );\r\n\r\n\t\tif ( this.responseType !== undefined ) request.responseType = this.responseType;\r\n\t\tif ( this.withCredentials !== undefined ) request.withCredentials = this.withCredentials;\r\n\r\n\t\trequest.send( null );\r\n\r\n\t\tscope.manager.itemStart( url );\r\n\r\n\t\treturn request;\r\n\r\n\t},\r\n\r\n\tsetPath: function ( value ) {\r\n\r\n\t\tthis.path = value;\r\n\r\n\t},\r\n\r\n\tsetResponseType: function ( value ) {\r\n\r\n\t\tthis.responseType = value;\r\n\r\n\t},\r\n\r\n\tsetWithCredentials: function ( value ) {\r\n\r\n\t\tthis.withCredentials = value;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/loaders/FontLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.FontLoader = function ( manager ) {\r\n\r\n\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\r\n\r\n};\r\n\r\nTHREE.FontLoader.prototype = {\r\n\r\n\tconstructor: THREE.FontLoader,\r\n\r\n\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tvar loader = new THREE.XHRLoader( this.manager );\r\n\t\tloader.load( url, function ( text ) {\r\n\r\n\t\t\tvar json;\r\n\r\n\t\t\ttry {\r\n\r\n\t\t\t\tjson = JSON.parse( text );\r\n\r\n\t\t\t} catch ( e ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead.' );\r\n\t\t\t\tjson = JSON.parse( text.substring( 65, text.length - 2 ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar font = scope.parse( json );\r\n\r\n\t\t\tif ( onLoad ) onLoad( font );\r\n\r\n\t\t}, onProgress, onError );\r\n\r\n\t},\r\n\r\n\tparse: function ( json ) {\r\n\r\n\t\treturn new THREE.Font( json );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/loaders/ImageLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.ImageLoader = function ( manager ) {\r\n\r\n\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\r\n\r\n};\r\n\r\nTHREE.ImageLoader.prototype = {\r\n\r\n\tconstructor: THREE.ImageLoader,\r\n\r\n\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\tif ( this.path !== undefined ) url = this.path + url;\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tvar cached = THREE.Cache.get( url );\r\n\r\n\t\tif ( cached !== undefined ) {\r\n\r\n\t\t\tscope.manager.itemStart( url );\r\n\r\n\t\t\tif ( onLoad ) {\r\n\r\n\t\t\t\tsetTimeout( function () {\r\n\r\n\t\t\t\t\tonLoad( cached );\r\n\r\n\t\t\t\t\tscope.manager.itemEnd( url );\r\n\r\n\t\t\t\t}, 0 );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tscope.manager.itemEnd( url );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn cached;\r\n\r\n\t\t}\r\n\r\n\t\tvar image = document.createElement( 'img' );\r\n\r\n\t\timage.addEventListener( 'load', function ( event ) {\r\n\r\n\t\t\tTHREE.Cache.add( url, this );\r\n\r\n\t\t\tif ( onLoad ) onLoad( this );\r\n\r\n\t\t\tscope.manager.itemEnd( url );\r\n\r\n\t\t}, false );\r\n\r\n\t\tif ( onProgress !== undefined ) {\r\n\r\n\t\t\timage.addEventListener( 'progress', function ( event ) {\r\n\r\n\t\t\t\tonProgress( event );\r\n\r\n\t\t\t}, false );\r\n\r\n\t\t}\r\n\r\n\t\timage.addEventListener( 'error', function ( event ) {\r\n\r\n\t\t\tif ( onError ) onError( event );\r\n\r\n\t\t\tscope.manager.itemError( url );\r\n\r\n\t\t}, false );\r\n\r\n\t\tif ( this.crossOrigin !== undefined ) image.crossOrigin = this.crossOrigin;\r\n\r\n\t\tscope.manager.itemStart( url );\r\n\r\n\t\timage.src = url;\r\n\r\n\t\treturn image;\r\n\r\n\t},\r\n\r\n\tsetCrossOrigin: function ( value ) {\r\n\r\n\t\tthis.crossOrigin = value;\r\n\r\n\t},\r\n\r\n\tsetPath: function ( value ) {\r\n\r\n\t\tthis.path = value;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/loaders/JSONLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.JSONLoader = function ( manager ) {\r\n\r\n\tif ( typeof manager === 'boolean' ) {\r\n\r\n\t\tconsole.warn( 'THREE.JSONLoader: showStatus parameter has been removed from constructor.' );\r\n\t\tmanager = undefined;\r\n\r\n\t}\r\n\r\n\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\r\n\r\n\tthis.withCredentials = false;\r\n\r\n};\r\n\r\nTHREE.JSONLoader.prototype = {\r\n\r\n\tconstructor: THREE.JSONLoader,\r\n\r\n\t// Deprecated\r\n\r\n\tget statusDomElement () {\r\n\r\n\t\tif ( this._statusDomElement === undefined ) {\r\n\r\n\t\t\tthis._statusDomElement = document.createElement( 'div' );\r\n\r\n\t\t}\r\n\r\n\t\tconsole.warn( 'THREE.JSONLoader: .statusDomElement has been removed.' );\r\n\t\treturn this._statusDomElement;\r\n\r\n\t},\r\n\r\n\tload: function( url, onLoad, onProgress, onError ) {\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tvar texturePath = this.texturePath && ( typeof this.texturePath === \"string\" ) ? this.texturePath : THREE.Loader.prototype.extractUrlBase( url );\r\n\r\n\t\tvar loader = new THREE.XHRLoader( this.manager );\r\n\t\tloader.setWithCredentials( this.withCredentials );\r\n\t\tloader.load( url, function ( text ) {\r\n\r\n\t\t\tvar json = JSON.parse( text );\r\n\t\t\tvar metadata = json.metadata;\r\n\r\n\t\t\tif ( metadata !== undefined ) {\r\n\r\n\t\t\t\tvar type = metadata.type;\r\n\r\n\t\t\t\tif ( type !== undefined ) {\r\n\r\n\t\t\t\t\tif ( type.toLowerCase() === 'object' ) {\r\n\r\n\t\t\t\t\t\tconsole.error( 'THREE.JSONLoader: ' + url + ' should be loaded with THREE.ObjectLoader instead.' );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( type.toLowerCase() === 'scene' ) {\r\n\r\n\t\t\t\t\t\tconsole.error( 'THREE.JSONLoader: ' + url + ' should be loaded with THREE.SceneLoader instead.' );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar object = scope.parse( json, texturePath );\r\n\t\t\tonLoad( object.geometry, object.materials );\r\n\r\n\t\t}, onProgress, onError );\r\n\r\n\t},\r\n\r\n\tsetTexturePath: function ( value ) {\r\n\r\n\t\tthis.texturePath = value;\r\n\r\n\t},\r\n\r\n\tparse: function ( json, texturePath ) {\r\n\r\n\t\tvar geometry = new THREE.Geometry(),\r\n\t\tscale = ( json.scale !== undefined ) ? 1.0 / json.scale : 1.0;\r\n\r\n\t\tparseModel( scale );\r\n\r\n\t\tparseSkin();\r\n\t\tparseMorphing( scale );\r\n\t\tparseAnimations();\r\n\r\n\t\tgeometry.computeFaceNormals();\r\n\t\tgeometry.computeBoundingSphere();\r\n\r\n\t\tfunction parseModel( scale ) {\r\n\r\n\t\t\tfunction isBitSet( value, position ) {\r\n\r\n\t\t\t\treturn value & ( 1 << position );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar i, j, fi,\r\n\r\n\t\t\toffset, zLength,\r\n\r\n\t\tcolorIndex, normalIndex, uvIndex, materialIndex,\r\n\r\n\t\t\ttype,\r\n\t\t\tisQuad,\r\n\t\t\thasMaterial,\r\n\t\t\thasFaceVertexUv,\r\n\t\t\thasFaceNormal, hasFaceVertexNormal,\r\n\t\t\thasFaceColor, hasFaceVertexColor,\r\n\r\n\t\tvertex, face, faceA, faceB, hex, normal,\r\n\r\n\t\t\tuvLayer, uv, u, v,\r\n\r\n\t\t\tfaces = json.faces,\r\n\t\t\tvertices = json.vertices,\r\n\t\t\tnormals = json.normals,\r\n\t\t\tcolors = json.colors,\r\n\r\n\t\t\tnUvLayers = 0;\r\n\r\n\t\t\tif ( json.uvs !== undefined ) {\r\n\r\n\t\t\t\t// disregard empty arrays\r\n\r\n\t\t\t\tfor ( i = 0; i < json.uvs.length; i ++ ) {\r\n\r\n\t\t\t\t\tif ( json.uvs[ i ].length ) nUvLayers ++;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor ( i = 0; i < nUvLayers; i ++ ) {\r\n\r\n\t\t\t\t\tgeometry.faceVertexUvs[ i ] = [];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\toffset = 0;\r\n\t\t\tzLength = vertices.length;\r\n\r\n\t\t\twhile ( offset < zLength ) {\r\n\r\n\t\t\t\tvertex = new THREE.Vector3();\r\n\r\n\t\t\t\tvertex.x = vertices[ offset ++ ] * scale;\r\n\t\t\t\tvertex.y = vertices[ offset ++ ] * scale;\r\n\t\t\t\tvertex.z = vertices[ offset ++ ] * scale;\r\n\r\n\t\t\t\tgeometry.vertices.push( vertex );\r\n\r\n\t\t\t}\r\n\r\n\t\t\toffset = 0;\r\n\t\t\tzLength = faces.length;\r\n\r\n\t\t\twhile ( offset < zLength ) {\r\n\r\n\t\t\t\ttype = faces[ offset ++ ];\r\n\r\n\r\n\t\t\t\tisQuad              = isBitSet( type, 0 );\r\n\t\t\t\thasMaterial         = isBitSet( type, 1 );\r\n\t\t\t\thasFaceVertexUv     = isBitSet( type, 3 );\r\n\t\t\t\thasFaceNormal       = isBitSet( type, 4 );\r\n\t\t\t\thasFaceVertexNormal = isBitSet( type, 5 );\r\n\t\t\t\thasFaceColor\t     = isBitSet( type, 6 );\r\n\t\t\t\thasFaceVertexColor  = isBitSet( type, 7 );\r\n\r\n\t\t\t\t// console.log(\"type\", type, \"bits\", isQuad, hasMaterial, hasFaceVertexUv, hasFaceNormal, hasFaceVertexNormal, hasFaceColor, hasFaceVertexColor);\r\n\r\n\t\t\t\tif ( isQuad ) {\r\n\r\n\t\t\t\t\tfaceA = new THREE.Face3();\r\n\t\t\t\t\tfaceA.a = faces[ offset ];\r\n\t\t\t\t\tfaceA.b = faces[ offset + 1 ];\r\n\t\t\t\t\tfaceA.c = faces[ offset + 3 ];\r\n\r\n\t\t\t\t\tfaceB = new THREE.Face3();\r\n\t\t\t\t\tfaceB.a = faces[ offset + 1 ];\r\n\t\t\t\t\tfaceB.b = faces[ offset + 2 ];\r\n\t\t\t\t\tfaceB.c = faces[ offset + 3 ];\r\n\r\n\t\t\t\t\toffset += 4;\r\n\r\n\t\t\t\t\tif ( hasMaterial ) {\r\n\r\n\t\t\t\t\t\tmaterialIndex = faces[ offset ++ ];\r\n\t\t\t\t\t\tfaceA.materialIndex = materialIndex;\r\n\t\t\t\t\t\tfaceB.materialIndex = materialIndex;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// to get face <=> uv index correspondence\r\n\r\n\t\t\t\t\tfi = geometry.faces.length;\r\n\r\n\t\t\t\t\tif ( hasFaceVertexUv ) {\r\n\r\n\t\t\t\t\t\tfor ( i = 0; i < nUvLayers; i ++ ) {\r\n\r\n\t\t\t\t\t\t\tuvLayer = json.uvs[ i ];\r\n\r\n\t\t\t\t\t\t\tgeometry.faceVertexUvs[ i ][ fi ] = [];\r\n\t\t\t\t\t\t\tgeometry.faceVertexUvs[ i ][ fi + 1 ] = [];\r\n\r\n\t\t\t\t\t\t\tfor ( j = 0; j < 4; j ++ ) {\r\n\r\n\t\t\t\t\t\t\t\tuvIndex = faces[ offset ++ ];\r\n\r\n\t\t\t\t\t\t\t\tu = uvLayer[ uvIndex * 2 ];\r\n\t\t\t\t\t\t\t\tv = uvLayer[ uvIndex * 2 + 1 ];\r\n\r\n\t\t\t\t\t\t\t\tuv = new THREE.Vector2( u, v );\r\n\r\n\t\t\t\t\t\t\t\tif ( j !== 2 ) geometry.faceVertexUvs[ i ][ fi ].push( uv );\r\n\t\t\t\t\t\t\t\tif ( j !== 0 ) geometry.faceVertexUvs[ i ][ fi + 1 ].push( uv );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( hasFaceNormal ) {\r\n\r\n\t\t\t\t\t\tnormalIndex = faces[ offset ++ ] * 3;\r\n\r\n\t\t\t\t\t\tfaceA.normal.set(\r\n\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\r\n\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\r\n\t\t\t\t\t\t\tnormals[ normalIndex ]\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tfaceB.normal.copy( faceA.normal );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( hasFaceVertexNormal ) {\r\n\r\n\t\t\t\t\t\tfor ( i = 0; i < 4; i ++ ) {\r\n\r\n\t\t\t\t\t\t\tnormalIndex = faces[ offset ++ ] * 3;\r\n\r\n\t\t\t\t\t\t\tnormal = new THREE.Vector3(\r\n\t\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\r\n\t\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\r\n\t\t\t\t\t\t\t\tnormals[ normalIndex ]\r\n\t\t\t\t\t\t\t);\r\n\r\n\r\n\t\t\t\t\t\t\tif ( i !== 2 ) faceA.vertexNormals.push( normal );\r\n\t\t\t\t\t\t\tif ( i !== 0 ) faceB.vertexNormals.push( normal );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\tif ( hasFaceColor ) {\r\n\r\n\t\t\t\t\t\tcolorIndex = faces[ offset ++ ];\r\n\t\t\t\t\t\thex = colors[ colorIndex ];\r\n\r\n\t\t\t\t\t\tfaceA.color.setHex( hex );\r\n\t\t\t\t\t\tfaceB.color.setHex( hex );\r\n\r\n\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\tif ( hasFaceVertexColor ) {\r\n\r\n\t\t\t\t\t\tfor ( i = 0; i < 4; i ++ ) {\r\n\r\n\t\t\t\t\t\t\tcolorIndex = faces[ offset ++ ];\r\n\t\t\t\t\t\t\thex = colors[ colorIndex ];\r\n\r\n\t\t\t\t\t\t\tif ( i !== 2 ) faceA.vertexColors.push( new THREE.Color( hex ) );\r\n\t\t\t\t\t\t\tif ( i !== 0 ) faceB.vertexColors.push( new THREE.Color( hex ) );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tgeometry.faces.push( faceA );\r\n\t\t\t\t\tgeometry.faces.push( faceB );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tface = new THREE.Face3();\r\n\t\t\t\t\tface.a = faces[ offset ++ ];\r\n\t\t\t\t\tface.b = faces[ offset ++ ];\r\n\t\t\t\t\tface.c = faces[ offset ++ ];\r\n\r\n\t\t\t\t\tif ( hasMaterial ) {\r\n\r\n\t\t\t\t\t\tmaterialIndex = faces[ offset ++ ];\r\n\t\t\t\t\t\tface.materialIndex = materialIndex;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// to get face <=> uv index correspondence\r\n\r\n\t\t\t\t\tfi = geometry.faces.length;\r\n\r\n\t\t\t\t\tif ( hasFaceVertexUv ) {\r\n\r\n\t\t\t\t\t\tfor ( i = 0; i < nUvLayers; i ++ ) {\r\n\r\n\t\t\t\t\t\t\tuvLayer = json.uvs[ i ];\r\n\r\n\t\t\t\t\t\t\tgeometry.faceVertexUvs[ i ][ fi ] = [];\r\n\r\n\t\t\t\t\t\t\tfor ( j = 0; j < 3; j ++ ) {\r\n\r\n\t\t\t\t\t\t\t\tuvIndex = faces[ offset ++ ];\r\n\r\n\t\t\t\t\t\t\t\tu = uvLayer[ uvIndex * 2 ];\r\n\t\t\t\t\t\t\t\tv = uvLayer[ uvIndex * 2 + 1 ];\r\n\r\n\t\t\t\t\t\t\t\tuv = new THREE.Vector2( u, v );\r\n\r\n\t\t\t\t\t\t\t\tgeometry.faceVertexUvs[ i ][ fi ].push( uv );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( hasFaceNormal ) {\r\n\r\n\t\t\t\t\t\tnormalIndex = faces[ offset ++ ] * 3;\r\n\r\n\t\t\t\t\t\tface.normal.set(\r\n\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\r\n\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\r\n\t\t\t\t\t\t\tnormals[ normalIndex ]\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( hasFaceVertexNormal ) {\r\n\r\n\t\t\t\t\t\tfor ( i = 0; i < 3; i ++ ) {\r\n\r\n\t\t\t\t\t\t\tnormalIndex = faces[ offset ++ ] * 3;\r\n\r\n\t\t\t\t\t\t\tnormal = new THREE.Vector3(\r\n\t\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\r\n\t\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\r\n\t\t\t\t\t\t\t\tnormals[ normalIndex ]\r\n\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\tface.vertexNormals.push( normal );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\tif ( hasFaceColor ) {\r\n\r\n\t\t\t\t\t\tcolorIndex = faces[ offset ++ ];\r\n\t\t\t\t\t\tface.color.setHex( colors[ colorIndex ] );\r\n\r\n\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\tif ( hasFaceVertexColor ) {\r\n\r\n\t\t\t\t\t\tfor ( i = 0; i < 3; i ++ ) {\r\n\r\n\t\t\t\t\t\t\tcolorIndex = faces[ offset ++ ];\r\n\t\t\t\t\t\t\tface.vertexColors.push( new THREE.Color( colors[ colorIndex ] ) );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tgeometry.faces.push( face );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseSkin() {\r\n\r\n\t\t\tvar influencesPerVertex = ( json.influencesPerVertex !== undefined ) ? json.influencesPerVertex : 2;\r\n\r\n\t\t\tif ( json.skinWeights ) {\r\n\r\n\t\t\t\tfor ( var i = 0, l = json.skinWeights.length; i < l; i += influencesPerVertex ) {\r\n\r\n\t\t\t\t\tvar x =                               json.skinWeights[ i ];\r\n\t\t\t\t\tvar y = ( influencesPerVertex > 1 ) ? json.skinWeights[ i + 1 ] : 0;\r\n\t\t\t\t\tvar z = ( influencesPerVertex > 2 ) ? json.skinWeights[ i + 2 ] : 0;\r\n\t\t\t\t\tvar w = ( influencesPerVertex > 3 ) ? json.skinWeights[ i + 3 ] : 0;\r\n\r\n\t\t\t\t\tgeometry.skinWeights.push( new THREE.Vector4( x, y, z, w ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( json.skinIndices ) {\r\n\r\n\t\t\t\tfor ( var i = 0, l = json.skinIndices.length; i < l; i += influencesPerVertex ) {\r\n\r\n\t\t\t\t\tvar a =                               json.skinIndices[ i ];\r\n\t\t\t\t\tvar b = ( influencesPerVertex > 1 ) ? json.skinIndices[ i + 1 ] : 0;\r\n\t\t\t\t\tvar c = ( influencesPerVertex > 2 ) ? json.skinIndices[ i + 2 ] : 0;\r\n\t\t\t\t\tvar d = ( influencesPerVertex > 3 ) ? json.skinIndices[ i + 3 ] : 0;\r\n\r\n\t\t\t\t\tgeometry.skinIndices.push( new THREE.Vector4( a, b, c, d ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgeometry.bones = json.bones;\r\n\r\n\t\t\tif ( geometry.bones && geometry.bones.length > 0 && ( geometry.skinWeights.length !== geometry.skinIndices.length || geometry.skinIndices.length !== geometry.vertices.length ) ) {\r\n\r\n\t\t\t\tconsole.warn( 'When skinning, number of vertices (' + geometry.vertices.length + '), skinIndices (' +\r\n\t\t\t\t\tgeometry.skinIndices.length + '), and skinWeights (' + geometry.skinWeights.length + ') should match.' );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseMorphing( scale ) {\r\n\r\n\t\t\tif ( json.morphTargets !== undefined ) {\r\n\r\n\t\t\t\tfor ( var i = 0, l = json.morphTargets.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\tgeometry.morphTargets[ i ] = {};\r\n\t\t\t\t\tgeometry.morphTargets[ i ].name = json.morphTargets[ i ].name;\r\n\t\t\t\t\tgeometry.morphTargets[ i ].vertices = [];\r\n\r\n\t\t\t\t\tvar dstVertices = geometry.morphTargets[ i ].vertices;\r\n\t\t\t\t\tvar srcVertices = json.morphTargets[ i ].vertices;\r\n\r\n\t\t\t\t\tfor ( var v = 0, vl = srcVertices.length; v < vl; v += 3 ) {\r\n\r\n\t\t\t\t\t\tvar vertex = new THREE.Vector3();\r\n\t\t\t\t\t\tvertex.x = srcVertices[ v ] * scale;\r\n\t\t\t\t\t\tvertex.y = srcVertices[ v + 1 ] * scale;\r\n\t\t\t\t\t\tvertex.z = srcVertices[ v + 2 ] * scale;\r\n\r\n\t\t\t\t\t\tdstVertices.push( vertex );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( json.morphColors !== undefined && json.morphColors.length > 0 ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.JSONLoader: \"morphColors\" no longer supported. Using them as face colors.' );\r\n\r\n\t\t\t\tvar faces = geometry.faces;\r\n\t\t\t\tvar morphColors = json.morphColors[ 0 ].colors;\r\n\r\n\t\t\t\tfor ( var i = 0, l = faces.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\tfaces[ i ].color.fromArray( morphColors, i * 3 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseAnimations() {\r\n\r\n\t\t\tvar outputAnimations = [];\r\n\r\n\t\t\t// parse old style Bone/Hierarchy animations\r\n\t\t\tvar animations = [];\r\n\r\n\t\t\tif ( json.animation !== undefined ) {\r\n\r\n\t\t\t\tanimations.push( json.animation );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( json.animations !== undefined ) {\r\n\r\n\t\t\t\tif ( json.animations.length ) {\r\n\r\n\t\t\t\t\tanimations = animations.concat( json.animations );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tanimations.push( json.animations );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var i = 0; i < animations.length; i ++ ) {\r\n\r\n\t\t\t\tvar clip = THREE.AnimationClip.parseAnimation( animations[ i ], geometry.bones );\r\n\t\t\t\tif ( clip ) outputAnimations.push( clip );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// parse implicit morph animations\r\n\t\t\tif ( geometry.morphTargets ) {\r\n\r\n\t\t\t\t// TODO: Figure out what an appropraite FPS is for morph target animations -- defaulting to 10, but really it is completely arbitrary.\r\n\t\t\t\tvar morphAnimationClips = THREE.AnimationClip.CreateClipsFromMorphTargetSequences( geometry.morphTargets, 10 );\r\n\t\t\t\toutputAnimations = outputAnimations.concat( morphAnimationClips );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( outputAnimations.length > 0 ) geometry.animations = outputAnimations;\r\n\r\n\t\t}\r\n\r\n\t\tif ( json.materials === undefined || json.materials.length === 0 ) {\r\n\r\n\t\t\treturn { geometry: geometry };\r\n\r\n\t\t} else {\r\n\r\n\t\t\tvar materials = THREE.Loader.prototype.initMaterials( json.materials, texturePath, this.crossOrigin );\r\n\r\n\t\t\treturn { geometry: geometry, materials: materials };\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/loaders/LoadingManager.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.LoadingManager = function ( onLoad, onProgress, onError ) {\r\n\r\n\tvar scope = this;\r\n\r\n\tvar isLoading = false, itemsLoaded = 0, itemsTotal = 0;\r\n\r\n\tthis.onStart = undefined;\r\n\tthis.onLoad = onLoad;\r\n\tthis.onProgress = onProgress;\r\n\tthis.onError = onError;\r\n\r\n\tthis.itemStart = function ( url ) {\r\n\r\n\t\titemsTotal ++;\r\n\r\n\t\tif ( isLoading === false ) {\r\n\r\n\t\t\tif ( scope.onStart !== undefined ) {\r\n\r\n\t\t\t\tscope.onStart( url, itemsLoaded, itemsTotal );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tisLoading = true;\r\n\r\n\t};\r\n\r\n\tthis.itemEnd = function ( url ) {\r\n\r\n\t\titemsLoaded ++;\r\n\r\n\t\tif ( scope.onProgress !== undefined ) {\r\n\r\n\t\t\tscope.onProgress( url, itemsLoaded, itemsTotal );\r\n\r\n\t\t}\r\n\r\n\t\tif ( itemsLoaded === itemsTotal ) {\r\n\r\n\t\t\tisLoading = false;\r\n\r\n\t\t\tif ( scope.onLoad !== undefined ) {\r\n\r\n\t\t\t\tscope.onLoad();\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.itemError = function ( url ) {\r\n\r\n\t\tif ( scope.onError !== undefined ) {\r\n\r\n\t\t\tscope.onError( url );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n};\r\n\r\nTHREE.DefaultLoadingManager = new THREE.LoadingManager();\r\n\r\n// File:src/loaders/BufferGeometryLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.BufferGeometryLoader = function ( manager ) {\r\n\r\n\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\r\n\r\n};\r\n\r\nTHREE.BufferGeometryLoader.prototype = {\r\n\r\n\tconstructor: THREE.BufferGeometryLoader,\r\n\r\n\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tvar loader = new THREE.XHRLoader( scope.manager );\r\n\t\tloader.load( url, function ( text ) {\r\n\r\n\t\t\tonLoad( scope.parse( JSON.parse( text ) ) );\r\n\r\n\t\t}, onProgress, onError );\r\n\r\n\t},\r\n\r\n\tparse: function ( json ) {\r\n\r\n\t\tvar geometry = new THREE.BufferGeometry();\r\n\r\n\t\tvar index = json.data.index;\r\n\r\n\t\tvar TYPED_ARRAYS = {\r\n\t\t\t'Int8Array': Int8Array,\r\n\t\t\t'Uint8Array': Uint8Array,\r\n\t\t\t'Uint8ClampedArray': Uint8ClampedArray,\r\n\t\t\t'Int16Array': Int16Array,\r\n\t\t\t'Uint16Array': Uint16Array,\r\n\t\t\t'Int32Array': Int32Array,\r\n\t\t\t'Uint32Array': Uint32Array,\r\n\t\t\t'Float32Array': Float32Array,\r\n\t\t\t'Float64Array': Float64Array\r\n\t\t};\r\n\r\n\t\tif ( index !== undefined ) {\r\n\r\n\t\t\tvar typedArray = new TYPED_ARRAYS[ index.type ]( index.array );\r\n\t\t\tgeometry.setIndex( new THREE.BufferAttribute( typedArray, 1 ) );\r\n\r\n\t\t}\r\n\r\n\t\tvar attributes = json.data.attributes;\r\n\r\n\t\tfor ( var key in attributes ) {\r\n\r\n\t\t\tvar attribute = attributes[ key ];\r\n\t\t\tvar typedArray = new TYPED_ARRAYS[ attribute.type ]( attribute.array );\r\n\r\n\t\t\tgeometry.addAttribute( key, new THREE.BufferAttribute( typedArray, attribute.itemSize, attribute.normalized ) );\r\n\r\n\t\t}\r\n\r\n\t\tvar groups = json.data.groups || json.data.drawcalls || json.data.offsets;\r\n\r\n\t\tif ( groups !== undefined ) {\r\n\r\n\t\t\tfor ( var i = 0, n = groups.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\tvar group = groups[ i ];\r\n\r\n\t\t\t\tgeometry.addGroup( group.start, group.count, group.materialIndex );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar boundingSphere = json.data.boundingSphere;\r\n\r\n\t\tif ( boundingSphere !== undefined ) {\r\n\r\n\t\t\tvar center = new THREE.Vector3();\r\n\r\n\t\t\tif ( boundingSphere.center !== undefined ) {\r\n\r\n\t\t\t\tcenter.fromArray( boundingSphere.center );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgeometry.boundingSphere = new THREE.Sphere( center, boundingSphere.radius );\r\n\r\n\t\t}\r\n\r\n\t\treturn geometry;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/loaders/MaterialLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.MaterialLoader = function ( manager ) {\r\n\r\n\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\r\n\tthis.textures = {};\r\n\r\n};\r\n\r\nTHREE.MaterialLoader.prototype = {\r\n\r\n\tconstructor: THREE.MaterialLoader,\r\n\r\n\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tvar loader = new THREE.XHRLoader( scope.manager );\r\n\t\tloader.load( url, function ( text ) {\r\n\r\n\t\t\tonLoad( scope.parse( JSON.parse( text ) ) );\r\n\r\n\t\t}, onProgress, onError );\r\n\r\n\t},\r\n\r\n\tsetTextures: function ( value ) {\r\n\r\n\t\tthis.textures = value;\r\n\r\n\t},\r\n\r\n\tgetTexture: function ( name ) {\r\n\r\n\t\tvar textures = this.textures;\r\n\r\n\t\tif ( textures[ name ] === undefined ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.MaterialLoader: Undefined texture', name );\r\n\r\n\t\t}\r\n\r\n\t\treturn textures[ name ];\r\n\r\n\t},\r\n\r\n\tparse: function ( json ) {\r\n\r\n\t\tvar material = new THREE[ json.type ];\r\n\r\n\t\tif ( json.uuid !== undefined ) material.uuid = json.uuid;\r\n\t\tif ( json.name !== undefined ) material.name = json.name;\r\n\t\tif ( json.color !== undefined ) material.color.setHex( json.color );\r\n\t\tif ( json.roughness !== undefined ) material.roughness = json.roughness;\r\n\t\tif ( json.metalness !== undefined ) material.metalness = json.metalness;\r\n\t\tif ( json.emissive !== undefined ) material.emissive.setHex( json.emissive );\r\n\t\tif ( json.specular !== undefined ) material.specular.setHex( json.specular );\r\n\t\tif ( json.shininess !== undefined ) material.shininess = json.shininess;\r\n\t\tif ( json.uniforms !== undefined ) material.uniforms = json.uniforms;\r\n\t\tif ( json.vertexShader !== undefined ) material.vertexShader = json.vertexShader;\r\n\t\tif ( json.fragmentShader !== undefined ) material.fragmentShader = json.fragmentShader;\r\n\t\tif ( json.vertexColors !== undefined ) material.vertexColors = json.vertexColors;\r\n\t\tif ( json.shading !== undefined ) material.shading = json.shading;\r\n\t\tif ( json.blending !== undefined ) material.blending = json.blending;\r\n\t\tif ( json.side !== undefined ) material.side = json.side;\r\n\t\tif ( json.opacity !== undefined ) material.opacity = json.opacity;\r\n\t\tif ( json.transparent !== undefined ) material.transparent = json.transparent;\r\n\t\tif ( json.alphaTest !== undefined ) material.alphaTest = json.alphaTest;\r\n\t\tif ( json.depthTest !== undefined ) material.depthTest = json.depthTest;\r\n\t\tif ( json.depthWrite !== undefined ) material.depthWrite = json.depthWrite;\r\n\t\tif ( json.colorWrite !== undefined ) material.colorWrite = json.colorWrite;\r\n\t\tif ( json.wireframe !== undefined ) material.wireframe = json.wireframe;\r\n\t\tif ( json.wireframeLinewidth !== undefined ) material.wireframeLinewidth = json.wireframeLinewidth;\r\n\r\n\t\t// for PointsMaterial\r\n\t\tif ( json.size !== undefined ) material.size = json.size;\r\n\t\tif ( json.sizeAttenuation !== undefined ) material.sizeAttenuation = json.sizeAttenuation;\r\n\r\n\t\t// maps\r\n\r\n\t\tif ( json.map !== undefined ) material.map = this.getTexture( json.map );\r\n\r\n\t\tif ( json.alphaMap !== undefined ) {\r\n\r\n\t\t\tmaterial.alphaMap = this.getTexture( json.alphaMap );\r\n\t\t\tmaterial.transparent = true;\r\n\r\n\t\t}\r\n\r\n\t\tif ( json.bumpMap !== undefined ) material.bumpMap = this.getTexture( json.bumpMap );\r\n\t\tif ( json.bumpScale !== undefined ) material.bumpScale = json.bumpScale;\r\n\r\n\t\tif ( json.normalMap !== undefined ) material.normalMap = this.getTexture( json.normalMap );\r\n\t\tif ( json.normalScale !== undefined ) {\r\n\r\n\t\t\tvar normalScale = json.normalScale;\r\n\r\n\t\t\tif ( Array.isArray( normalScale ) === false ) {\r\n\r\n\t\t\t\t// Blender exporter used to export a scalar. See #7459\r\n\r\n\t\t\t\tnormalScale = [ normalScale, normalScale ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tmaterial.normalScale = new THREE.Vector2().fromArray( normalScale );\r\n\r\n\t\t}\r\n\r\n\t\tif ( json.displacementMap !== undefined ) material.displacementMap = this.getTexture( json.displacementMap );\r\n\t\tif ( json.displacementScale !== undefined ) material.displacementScale = json.displacementScale;\r\n\t\tif ( json.displacementBias !== undefined ) material.displacementBias = json.displacementBias;\r\n\r\n\t\tif ( json.roughnessMap !== undefined ) material.roughnessMap = this.getTexture( json.roughnessMap );\r\n\t\tif ( json.metalnessMap !== undefined ) material.metalnessMap = this.getTexture( json.metalnessMap );\r\n\r\n\t\tif ( json.emissiveMap !== undefined ) material.emissiveMap = this.getTexture( json.emissiveMap );\r\n\t\tif ( json.emissiveIntensity !== undefined ) material.emissiveIntensity = json.emissiveIntensity;\r\n\r\n\t\tif ( json.specularMap !== undefined ) material.specularMap = this.getTexture( json.specularMap );\r\n\r\n\t\tif ( json.envMap !== undefined ) {\r\n\r\n\t\t\tmaterial.envMap = this.getTexture( json.envMap );\r\n\t\t\tmaterial.combine = THREE.MultiplyOperation;\r\n\r\n\t\t}\r\n\r\n\t\tif ( json.reflectivity ) material.reflectivity = json.reflectivity;\r\n\r\n\t\tif ( json.lightMap !== undefined ) material.lightMap = this.getTexture( json.lightMap );\r\n\t\tif ( json.lightMapIntensity !== undefined ) material.lightMapIntensity = json.lightMapIntensity;\r\n\r\n\t\tif ( json.aoMap !== undefined ) material.aoMap = this.getTexture( json.aoMap );\r\n\t\tif ( json.aoMapIntensity !== undefined ) material.aoMapIntensity = json.aoMapIntensity;\r\n\r\n\t\t// MultiMaterial\r\n\r\n\t\tif ( json.materials !== undefined ) {\r\n\r\n\t\t\tfor ( var i = 0, l = json.materials.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tmaterial.materials.push( this.parse( json.materials[ i ] ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn material;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/loaders/ObjectLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.ObjectLoader = function ( manager ) {\r\n\r\n\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\r\n\tthis.texturePath = '';\r\n\r\n};\r\n\r\nTHREE.ObjectLoader.prototype = {\r\n\r\n\tconstructor: THREE.ObjectLoader,\r\n\r\n\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\tif ( this.texturePath === '' ) {\r\n\r\n\t\t\tthis.texturePath = url.substring( 0, url.lastIndexOf( '/' ) + 1 );\r\n\r\n\t\t}\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tvar loader = new THREE.XHRLoader( scope.manager );\r\n\t\tloader.load( url, function ( text ) {\r\n\r\n\t\t\tscope.parse( JSON.parse( text ), onLoad );\r\n\r\n\t\t}, onProgress, onError );\r\n\r\n\t},\r\n\r\n\tsetTexturePath: function ( value ) {\r\n\r\n\t\tthis.texturePath = value;\r\n\r\n\t},\r\n\r\n\tsetCrossOrigin: function ( value ) {\r\n\r\n\t\tthis.crossOrigin = value;\r\n\r\n\t},\r\n\r\n\tparse: function ( json, onLoad ) {\r\n\r\n\t\tvar geometries = this.parseGeometries( json.geometries );\r\n\r\n\t\tvar images = this.parseImages( json.images, function () {\r\n\r\n\t\t\tif ( onLoad !== undefined ) onLoad( object );\r\n\r\n\t\t} );\r\n\r\n\t\tvar textures  = this.parseTextures( json.textures, images );\r\n\t\tvar materials = this.parseMaterials( json.materials, textures );\r\n\r\n\t\tvar object = this.parseObject( json.object, geometries, materials );\r\n\r\n\t\tif ( json.animations ) {\r\n\r\n\t\t\tobject.animations = this.parseAnimations( json.animations );\r\n\r\n\t\t}\r\n\r\n\t\tif ( json.images === undefined || json.images.length === 0 ) {\r\n\r\n\t\t\tif ( onLoad !== undefined ) onLoad( object );\r\n\r\n\t\t}\r\n\r\n\t\treturn object;\r\n\r\n\t},\r\n\r\n\tparseGeometries: function ( json ) {\r\n\r\n\t\tvar geometries = {};\r\n\r\n\t\tif ( json !== undefined ) {\r\n\r\n\t\t\tvar geometryLoader = new THREE.JSONLoader();\r\n\t\t\tvar bufferGeometryLoader = new THREE.BufferGeometryLoader();\r\n\r\n\t\t\tfor ( var i = 0, l = json.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar geometry;\r\n\t\t\t\tvar data = json[ i ];\r\n\r\n\t\t\t\tswitch ( data.type ) {\r\n\r\n\t\t\t\t\tcase 'PlaneGeometry':\r\n\t\t\t\t\tcase 'PlaneBufferGeometry':\r\n\r\n\t\t\t\t\t\tgeometry = new THREE[ data.type ](\r\n\t\t\t\t\t\t\tdata.width,\r\n\t\t\t\t\t\t\tdata.height,\r\n\t\t\t\t\t\t\tdata.widthSegments,\r\n\t\t\t\t\t\t\tdata.heightSegments\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'BoxGeometry':\r\n\t\t\t\t\tcase 'BoxBufferGeometry':\r\n\t\t\t\t\tcase 'CubeGeometry': // backwards compatible\r\n\r\n\t\t\t\t\t\tgeometry = new THREE[ data.type ](\r\n\t\t\t\t\t\t\tdata.width,\r\n\t\t\t\t\t\t\tdata.height,\r\n\t\t\t\t\t\t\tdata.depth,\r\n\t\t\t\t\t\t\tdata.widthSegments,\r\n\t\t\t\t\t\t\tdata.heightSegments,\r\n\t\t\t\t\t\t\tdata.depthSegments\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'CircleGeometry':\r\n\t\t\t\t\tcase 'CircleBufferGeometry':\r\n\r\n\t\t\t\t\t\tgeometry = new THREE[ data.type ](\r\n\t\t\t\t\t\t\tdata.radius,\r\n\t\t\t\t\t\t\tdata.segments,\r\n\t\t\t\t\t\t\tdata.thetaStart,\r\n\t\t\t\t\t\t\tdata.thetaLength\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'CylinderGeometry':\r\n\t\t\t\t\tcase 'CylinderBufferGeometry':\r\n\r\n\t\t\t\t\t\tgeometry = new THREE[ data.type ](\r\n\t\t\t\t\t\t\tdata.radiusTop,\r\n\t\t\t\t\t\t\tdata.radiusBottom,\r\n\t\t\t\t\t\t\tdata.height,\r\n\t\t\t\t\t\t\tdata.radialSegments,\r\n\t\t\t\t\t\t\tdata.heightSegments,\r\n\t\t\t\t\t\t\tdata.openEnded,\r\n\t\t\t\t\t\t\tdata.thetaStart,\r\n\t\t\t\t\t\t\tdata.thetaLength\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'ConeGeometry':\r\n\t\t\t\t\tcase 'ConeBufferGeometry':\r\n\r\n\t\t\t\t\t\tgeometry = new THREE [ data.type ](\r\n\t\t\t\t\t\t\tdata.radius,\r\n\t\t\t\t\t\t\tdata.height,\r\n\t\t\t\t\t\t\tdata.radialSegments,\r\n\t\t\t\t\t\t\tdata.heightSegments,\r\n\t\t\t\t\t\t\tdata.openEnded,\r\n\t\t\t\t\t\t\tdata.thetaStart,\r\n\t\t\t\t\t\t\tdata.thetaLength\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'SphereGeometry':\r\n\t\t\t\t\tcase 'SphereBufferGeometry':\r\n\r\n\t\t\t\t\t\tgeometry = new THREE[ data.type ](\r\n\t\t\t\t\t\t\tdata.radius,\r\n\t\t\t\t\t\t\tdata.widthSegments,\r\n\t\t\t\t\t\t\tdata.heightSegments,\r\n\t\t\t\t\t\t\tdata.phiStart,\r\n\t\t\t\t\t\t\tdata.phiLength,\r\n\t\t\t\t\t\t\tdata.thetaStart,\r\n\t\t\t\t\t\t\tdata.thetaLength\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'DodecahedronGeometry':\r\n\t\t\t\t\tcase 'IcosahedronGeometry':\r\n\t\t\t\t\tcase 'OctahedronGeometry':\r\n\t\t\t\t\tcase 'TetrahedronGeometry':\r\n\r\n\t\t\t\t\t\tgeometry = new THREE[ data.type ](\r\n\t\t\t\t\t\t\tdata.radius,\r\n\t\t\t\t\t\t\tdata.detail\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'RingGeometry':\r\n\t\t\t\t\tcase 'RingBufferGeometry':\r\n\r\n\t\t\t\t\t\tgeometry = new THREE[ data.type ](\r\n\t\t\t\t\t\t\tdata.innerRadius,\r\n\t\t\t\t\t\t\tdata.outerRadius,\r\n\t\t\t\t\t\t\tdata.thetaSegments,\r\n\t\t\t\t\t\t\tdata.phiSegments,\r\n\t\t\t\t\t\t\tdata.thetaStart,\r\n\t\t\t\t\t\t\tdata.thetaLength\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'TorusGeometry':\r\n\t\t\t\t\tcase 'TorusBufferGeometry':\r\n\r\n\t\t\t\t\t\tgeometry = new THREE[ data.type ](\r\n\t\t\t\t\t\t\tdata.radius,\r\n\t\t\t\t\t\t\tdata.tube,\r\n\t\t\t\t\t\t\tdata.radialSegments,\r\n\t\t\t\t\t\t\tdata.tubularSegments,\r\n\t\t\t\t\t\t\tdata.arc\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'TorusKnotGeometry':\r\n\t\t\t\t\tcase 'TorusKnotBufferGeometry':\r\n\r\n\t\t\t\t\t\tgeometry = new THREE[ data.type ](\r\n\t\t\t\t\t\t\tdata.radius,\r\n\t\t\t\t\t\t\tdata.tube,\r\n\t\t\t\t\t\t\tdata.tubularSegments,\r\n\t\t\t\t\t\t\tdata.radialSegments,\r\n\t\t\t\t\t\t\tdata.p,\r\n\t\t\t\t\t\t\tdata.q\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'LatheGeometry':\r\n\t\t\t\t\tcase 'LatheBufferGeometry':\r\n\r\n\t\t\t\t\t\tgeometry = new THREE[ data.type ](\r\n\t\t\t\t\t\t\tdata.points,\r\n\t\t\t\t\t\t\tdata.segments,\r\n\t\t\t\t\t\t\tdata.phiStart,\r\n\t\t\t\t\t\t\tdata.phiLength\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'BufferGeometry':\r\n\r\n\t\t\t\t\t\tgeometry = bufferGeometryLoader.parse( data );\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'Geometry':\r\n\r\n\t\t\t\t\t\tgeometry = geometryLoader.parse( data.data, this.texturePath ).geometry;\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tdefault:\r\n\r\n\t\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: Unsupported geometry type \"' + data.type + '\"' );\r\n\r\n\t\t\t\t\t\tcontinue;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tgeometry.uuid = data.uuid;\r\n\r\n\t\t\t\tif ( data.name !== undefined ) geometry.name = data.name;\r\n\r\n\t\t\t\tgeometries[ data.uuid ] = geometry;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn geometries;\r\n\r\n\t},\r\n\r\n\tparseMaterials: function ( json, textures ) {\r\n\r\n\t\tvar materials = {};\r\n\r\n\t\tif ( json !== undefined ) {\r\n\r\n\t\t\tvar loader = new THREE.MaterialLoader();\r\n\t\t\tloader.setTextures( textures );\r\n\r\n\t\t\tfor ( var i = 0, l = json.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar material = loader.parse( json[ i ] );\r\n\t\t\t\tmaterials[ material.uuid ] = material;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn materials;\r\n\r\n\t},\r\n\r\n\tparseAnimations: function ( json ) {\r\n\r\n\t\tvar animations = [];\r\n\r\n\t\tfor ( var i = 0; i < json.length; i ++ ) {\r\n\r\n\t\t\tvar clip = THREE.AnimationClip.parse( json[ i ] );\r\n\r\n\t\t\tanimations.push( clip );\r\n\r\n\t\t}\r\n\r\n\t\treturn animations;\r\n\r\n\t},\r\n\r\n\tparseImages: function ( json, onLoad ) {\r\n\r\n\t\tvar scope = this;\r\n\t\tvar images = {};\r\n\r\n\t\tfunction loadImage( url ) {\r\n\r\n\t\t\tscope.manager.itemStart( url );\r\n\r\n\t\t\treturn loader.load( url, function () {\r\n\r\n\t\t\t\tscope.manager.itemEnd( url );\r\n\r\n\t\t\t} );\r\n\r\n\t\t}\r\n\r\n\t\tif ( json !== undefined && json.length > 0 ) {\r\n\r\n\t\t\tvar manager = new THREE.LoadingManager( onLoad );\r\n\r\n\t\t\tvar loader = new THREE.ImageLoader( manager );\r\n\t\t\tloader.setCrossOrigin( this.crossOrigin );\r\n\r\n\t\t\tfor ( var i = 0, l = json.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar image = json[ i ];\r\n\t\t\t\tvar path = /^(\\/\\/)|([a-z]+:(\\/\\/)?)/i.test( image.url ) ? image.url : scope.texturePath + image.url;\r\n\r\n\t\t\t\timages[ image.uuid ] = loadImage( path );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn images;\r\n\r\n\t},\r\n\r\n\tparseTextures: function ( json, images ) {\r\n\r\n\t\tfunction parseConstant( value ) {\r\n\r\n\t\t\tif ( typeof( value ) === 'number' ) return value;\r\n\r\n\t\t\tconsole.warn( 'THREE.ObjectLoader.parseTexture: Constant should be in numeric form.', value );\r\n\r\n\t\t\treturn THREE[ value ];\r\n\r\n\t\t}\r\n\r\n\t\tvar textures = {};\r\n\r\n\t\tif ( json !== undefined ) {\r\n\r\n\t\t\tfor ( var i = 0, l = json.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar data = json[ i ];\r\n\r\n\t\t\t\tif ( data.image === undefined ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: No \"image\" specified for', data.uuid );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( images[ data.image ] === undefined ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: Undefined image', data.image );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar texture = new THREE.Texture( images[ data.image ] );\r\n\t\t\t\ttexture.needsUpdate = true;\r\n\r\n\t\t\t\ttexture.uuid = data.uuid;\r\n\r\n\t\t\t\tif ( data.name !== undefined ) texture.name = data.name;\r\n\t\t\t\tif ( data.mapping !== undefined ) texture.mapping = parseConstant( data.mapping );\r\n\t\t\t\tif ( data.offset !== undefined ) texture.offset = new THREE.Vector2( data.offset[ 0 ], data.offset[ 1 ] );\r\n\t\t\t\tif ( data.repeat !== undefined ) texture.repeat = new THREE.Vector2( data.repeat[ 0 ], data.repeat[ 1 ] );\r\n\t\t\t\tif ( data.minFilter !== undefined ) texture.minFilter = parseConstant( data.minFilter );\r\n\t\t\t\tif ( data.magFilter !== undefined ) texture.magFilter = parseConstant( data.magFilter );\r\n\t\t\t\tif ( data.anisotropy !== undefined ) texture.anisotropy = data.anisotropy;\r\n\t\t\t\tif ( Array.isArray( data.wrap ) ) {\r\n\r\n\t\t\t\t\ttexture.wrapS = parseConstant( data.wrap[ 0 ] );\r\n\t\t\t\t\ttexture.wrapT = parseConstant( data.wrap[ 1 ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttextures[ data.uuid ] = texture;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn textures;\r\n\r\n\t},\r\n\r\n\tparseObject: function () {\r\n\r\n\t\tvar matrix = new THREE.Matrix4();\r\n\r\n\t\treturn function ( data, geometries, materials ) {\r\n\r\n\t\t\tvar object;\r\n\r\n\t\t\tfunction getGeometry( name ) {\r\n\r\n\t\t\t\tif ( geometries[ name ] === undefined ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: Undefined geometry', name );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn geometries[ name ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfunction getMaterial( name ) {\r\n\r\n\t\t\t\tif ( name === undefined ) return undefined;\r\n\r\n\t\t\t\tif ( materials[ name ] === undefined ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: Undefined material', name );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn materials[ name ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tswitch ( data.type ) {\r\n\r\n\t\t\t\tcase 'Scene':\r\n\r\n\t\t\t\t\tobject = new THREE.Scene();\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'PerspectiveCamera':\r\n\r\n\t\t\t\t\tobject = new THREE.PerspectiveCamera( data.fov, data.aspect, data.near, data.far );\r\n\r\n\t\t\t\t\tif ( data.focus !== undefined ) object.focus = data.focus;\r\n\t\t\t\t\tif ( data.zoom !== undefined ) object.zoom = data.zoom;\r\n\t\t\t\t\tif ( data.filmGauge !== undefined ) object.filmGauge = data.filmGauge;\r\n\t\t\t\t\tif ( data.filmOffset !== undefined ) object.filmOffset = data.filmOffset;\r\n\t\t\t\t\tif ( data.view !== undefined ) object.view = Object.assign( {}, data.view );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'OrthographicCamera':\r\n\r\n\t\t\t\t\tobject = new THREE.OrthographicCamera( data.left, data.right, data.top, data.bottom, data.near, data.far );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'AmbientLight':\r\n\r\n\t\t\t\t\tobject = new THREE.AmbientLight( data.color, data.intensity );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'DirectionalLight':\r\n\r\n\t\t\t\t\tobject = new THREE.DirectionalLight( data.color, data.intensity );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'PointLight':\r\n\r\n\t\t\t\t\tobject = new THREE.PointLight( data.color, data.intensity, data.distance, data.decay );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'SpotLight':\r\n\r\n\t\t\t\t\tobject = new THREE.SpotLight( data.color, data.intensity, data.distance, data.angle, data.penumbra, data.decay );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'HemisphereLight':\r\n\r\n\t\t\t\t\tobject = new THREE.HemisphereLight( data.color, data.groundColor, data.intensity );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'Mesh':\r\n\r\n\t\t\t\t\tvar geometry = getGeometry( data.geometry );\r\n\t\t\t\t\tvar material = getMaterial( data.material );\r\n\r\n\t\t\t\t\tif ( geometry.bones && geometry.bones.length > 0 ) {\r\n\r\n\t\t\t\t\t\tobject = new THREE.SkinnedMesh( geometry, material );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tobject = new THREE.Mesh( geometry, material );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'LOD':\r\n\r\n\t\t\t\t\tobject = new THREE.LOD();\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'Line':\r\n\r\n\t\t\t\t\tobject = new THREE.Line( getGeometry( data.geometry ), getMaterial( data.material ), data.mode );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'PointCloud':\r\n\t\t\t\tcase 'Points':\r\n\r\n\t\t\t\t\tobject = new THREE.Points( getGeometry( data.geometry ), getMaterial( data.material ) );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'Sprite':\r\n\r\n\t\t\t\t\tobject = new THREE.Sprite( getMaterial( data.material ) );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'Group':\r\n\r\n\t\t\t\t\tobject = new THREE.Group();\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\r\n\t\t\t\t\tobject = new THREE.Object3D();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tobject.uuid = data.uuid;\r\n\r\n\t\t\tif ( data.name !== undefined ) object.name = data.name;\r\n\t\t\tif ( data.matrix !== undefined ) {\r\n\r\n\t\t\t\tmatrix.fromArray( data.matrix );\r\n\t\t\t\tmatrix.decompose( object.position, object.quaternion, object.scale );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tif ( data.position !== undefined ) object.position.fromArray( data.position );\r\n\t\t\t\tif ( data.rotation !== undefined ) object.rotation.fromArray( data.rotation );\r\n\t\t\t\tif ( data.scale !== undefined ) object.scale.fromArray( data.scale );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( data.castShadow !== undefined ) object.castShadow = data.castShadow;\r\n\t\t\tif ( data.receiveShadow !== undefined ) object.receiveShadow = data.receiveShadow;\r\n\r\n\t\t\tif ( data.visible !== undefined ) object.visible = data.visible;\r\n\t\t\tif ( data.userData !== undefined ) object.userData = data.userData;\r\n\r\n\t\t\tif ( data.children !== undefined ) {\r\n\r\n\t\t\t\tfor ( var child in data.children ) {\r\n\r\n\t\t\t\t\tobject.add( this.parseObject( data.children[ child ], geometries, materials ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( data.type === 'LOD' ) {\r\n\r\n\t\t\t\tvar levels = data.levels;\r\n\r\n\t\t\t\tfor ( var l = 0; l < levels.length; l ++ ) {\r\n\r\n\t\t\t\t\tvar level = levels[ l ];\r\n\t\t\t\t\tvar child = object.getObjectByProperty( 'uuid', level.object );\r\n\r\n\t\t\t\t\tif ( child !== undefined ) {\r\n\r\n\t\t\t\t\t\tobject.addLevel( child, level.distance );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn object;\r\n\r\n\t\t};\r\n\r\n\t}()\r\n\r\n};\r\n\r\n// File:src/loaders/TextureLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.TextureLoader = function ( manager ) {\r\n\r\n\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\r\n\r\n};\r\n\r\nTHREE.TextureLoader.prototype = {\r\n\r\n\tconstructor: THREE.TextureLoader,\r\n\r\n\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\tvar texture = new THREE.Texture();\r\n\r\n\t\tvar loader = new THREE.ImageLoader( this.manager );\r\n\t\tloader.setCrossOrigin( this.crossOrigin );\r\n\t\tloader.setPath( this.path );\r\n\t\tloader.load( url, function ( image ) {\r\n\r\n\t\t\ttexture.image = image;\r\n\t\t\ttexture.needsUpdate = true;\r\n\r\n\t\t\tif ( onLoad !== undefined ) {\r\n\r\n\t\t\t\tonLoad( texture );\r\n\r\n\t\t\t}\r\n\r\n\t\t}, onProgress, onError );\r\n\r\n\t\treturn texture;\r\n\r\n\t},\r\n\r\n\tsetCrossOrigin: function ( value ) {\r\n\r\n\t\tthis.crossOrigin = value;\r\n\r\n\t},\r\n\r\n\tsetPath: function ( value ) {\r\n\r\n\t\tthis.path = value;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/loaders/CubeTextureLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.CubeTextureLoader = function ( manager ) {\r\n\r\n\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\r\n\r\n};\r\n\r\nTHREE.CubeTextureLoader.prototype = {\r\n\r\n\tconstructor: THREE.CubeTextureLoader,\r\n\r\n\tload: function ( urls, onLoad, onProgress, onError ) {\r\n\r\n\t\tvar texture = new THREE.CubeTexture();\r\n\r\n\t\tvar loader = new THREE.ImageLoader( this.manager );\r\n\t\tloader.setCrossOrigin( this.crossOrigin );\r\n\t\tloader.setPath( this.path );\r\n\r\n\t\tvar loaded = 0;\r\n\r\n\t\tfunction loadTexture( i ) {\r\n\r\n\t\t\tloader.load( urls[ i ], function ( image ) {\r\n\r\n\t\t\t\ttexture.images[ i ] = image;\r\n\r\n\t\t\t\tloaded ++;\r\n\r\n\t\t\t\tif ( loaded === 6 ) {\r\n\r\n\t\t\t\t\ttexture.needsUpdate = true;\r\n\r\n\t\t\t\t\tif ( onLoad ) onLoad( texture );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}, undefined, onError );\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var i = 0; i < urls.length; ++ i ) {\r\n\r\n\t\t\tloadTexture( i );\r\n\r\n\t\t}\r\n\r\n\t\treturn texture;\r\n\r\n\t},\r\n\r\n\tsetCrossOrigin: function ( value ) {\r\n\r\n\t\tthis.crossOrigin = value;\r\n\r\n\t},\r\n\r\n\tsetPath: function ( value ) {\r\n\r\n\t\tthis.path = value;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/loaders/BinaryTextureLoader.js\r\n\r\n/**\r\n * @author Nikos M. / https://github.com/foo123/\r\n *\r\n * Abstract Base class to load generic binary textures formats (rgbe, hdr, ...)\r\n */\r\n\r\nTHREE.DataTextureLoader = THREE.BinaryTextureLoader = function ( manager ) {\r\n\r\n\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\r\n\r\n\t// override in sub classes\r\n\tthis._parser = null;\r\n\r\n};\r\n\r\nTHREE.BinaryTextureLoader.prototype = {\r\n\r\n\tconstructor: THREE.BinaryTextureLoader,\r\n\r\n\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tvar texture = new THREE.DataTexture();\r\n\r\n\t\tvar loader = new THREE.XHRLoader( this.manager );\r\n\t\tloader.setResponseType( 'arraybuffer' );\r\n\r\n\t\tloader.load( url, function ( buffer ) {\r\n\r\n\t\t\tvar texData = scope._parser( buffer );\r\n\r\n\t\t\tif ( ! texData ) return;\r\n\r\n\t\t\tif ( undefined !== texData.image ) {\r\n\r\n\t\t\t\ttexture.image = texData.image;\r\n\r\n\t\t\t} else if ( undefined !== texData.data ) {\r\n\r\n\t\t\t\ttexture.image.width = texData.width;\r\n\t\t\t\ttexture.image.height = texData.height;\r\n\t\t\t\ttexture.image.data = texData.data;\r\n\r\n\t\t\t}\r\n\r\n\t\t\ttexture.wrapS = undefined !== texData.wrapS ? texData.wrapS : THREE.ClampToEdgeWrapping;\r\n\t\t\ttexture.wrapT = undefined !== texData.wrapT ? texData.wrapT : THREE.ClampToEdgeWrapping;\r\n\r\n\t\t\ttexture.magFilter = undefined !== texData.magFilter ? texData.magFilter : THREE.LinearFilter;\r\n\t\t\ttexture.minFilter = undefined !== texData.minFilter ? texData.minFilter : THREE.LinearMipMapLinearFilter;\r\n\r\n\t\t\ttexture.anisotropy = undefined !== texData.anisotropy ? texData.anisotropy : 1;\r\n\r\n\t\t\tif ( undefined !== texData.format ) {\r\n\r\n\t\t\t\ttexture.format = texData.format;\r\n\r\n\t\t\t}\r\n\t\t\tif ( undefined !== texData.type ) {\r\n\r\n\t\t\t\ttexture.type = texData.type;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( undefined !== texData.mipmaps ) {\r\n\r\n\t\t\t\ttexture.mipmaps = texData.mipmaps;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( 1 === texData.mipmapCount ) {\r\n\r\n\t\t\t\ttexture.minFilter = THREE.LinearFilter;\r\n\r\n\t\t\t}\r\n\r\n\t\t\ttexture.needsUpdate = true;\r\n\r\n\t\t\tif ( onLoad ) onLoad( texture, texData );\r\n\r\n\t\t}, onProgress, onError );\r\n\r\n\r\n\t\treturn texture;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/loaders/CompressedTextureLoader.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n *\r\n * Abstract Base class to block based textures loader (dds, pvr, ...)\r\n */\r\n\r\nTHREE.CompressedTextureLoader = function ( manager ) {\r\n\r\n\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\r\n\r\n\t// override in sub classes\r\n\tthis._parser = null;\r\n\r\n};\r\n\r\n\r\nTHREE.CompressedTextureLoader.prototype = {\r\n\r\n\tconstructor: THREE.CompressedTextureLoader,\r\n\r\n\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tvar images = [];\r\n\r\n\t\tvar texture = new THREE.CompressedTexture();\r\n\t\ttexture.image = images;\r\n\r\n\t\tvar loader = new THREE.XHRLoader( this.manager );\r\n\t\tloader.setPath( this.path );\r\n\t\tloader.setResponseType( 'arraybuffer' );\r\n\r\n\t\tfunction loadTexture( i ) {\r\n\r\n\t\t\tloader.load( url[ i ], function ( buffer ) {\r\n\r\n\t\t\t\tvar texDatas = scope._parser( buffer, true );\r\n\r\n\t\t\t\timages[ i ] = {\r\n\t\t\t\t\twidth: texDatas.width,\r\n\t\t\t\t\theight: texDatas.height,\r\n\t\t\t\t\tformat: texDatas.format,\r\n\t\t\t\t\tmipmaps: texDatas.mipmaps\r\n\t\t\t\t};\r\n\r\n\t\t\t\tloaded += 1;\r\n\r\n\t\t\t\tif ( loaded === 6 ) {\r\n\r\n\t\t\t\t\tif ( texDatas.mipmapCount === 1 )\r\n\t\t\t\t\t\ttexture.minFilter = THREE.LinearFilter;\r\n\r\n\t\t\t\t\ttexture.format = texDatas.format;\r\n\t\t\t\t\ttexture.needsUpdate = true;\r\n\r\n\t\t\t\t\tif ( onLoad ) onLoad( texture );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}, onProgress, onError );\r\n\r\n\t\t}\r\n\r\n\t\tif ( Array.isArray( url ) ) {\r\n\r\n\t\t\tvar loaded = 0;\r\n\r\n\t\t\tfor ( var i = 0, il = url.length; i < il; ++ i ) {\r\n\r\n\t\t\t\tloadTexture( i );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// compressed cubemap texture stored in a single DDS file\r\n\r\n\t\t\tloader.load( url, function ( buffer ) {\r\n\r\n\t\t\t\tvar texDatas = scope._parser( buffer, true );\r\n\r\n\t\t\t\tif ( texDatas.isCubemap ) {\r\n\r\n\t\t\t\t\tvar faces = texDatas.mipmaps.length / texDatas.mipmapCount;\r\n\r\n\t\t\t\t\tfor ( var f = 0; f < faces; f ++ ) {\r\n\r\n\t\t\t\t\t\timages[ f ] = { mipmaps : [] };\r\n\r\n\t\t\t\t\t\tfor ( var i = 0; i < texDatas.mipmapCount; i ++ ) {\r\n\r\n\t\t\t\t\t\t\timages[ f ].mipmaps.push( texDatas.mipmaps[ f * texDatas.mipmapCount + i ] );\r\n\t\t\t\t\t\t\timages[ f ].format = texDatas.format;\r\n\t\t\t\t\t\t\timages[ f ].width = texDatas.width;\r\n\t\t\t\t\t\t\timages[ f ].height = texDatas.height;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\ttexture.image.width = texDatas.width;\r\n\t\t\t\t\ttexture.image.height = texDatas.height;\r\n\t\t\t\t\ttexture.mipmaps = texDatas.mipmaps;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( texDatas.mipmapCount === 1 ) {\r\n\r\n\t\t\t\t\ttexture.minFilter = THREE.LinearFilter;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttexture.format = texDatas.format;\r\n\t\t\t\ttexture.needsUpdate = true;\r\n\r\n\t\t\t\tif ( onLoad ) onLoad( texture );\r\n\r\n\t\t\t}, onProgress, onError );\r\n\r\n\t\t}\r\n\r\n\t\treturn texture;\r\n\r\n\t},\r\n\r\n\tsetPath: function ( value ) {\r\n\r\n\t\tthis.path = value;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/materials/Material.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Material = function () {\r\n\r\n\tObject.defineProperty( this, 'id', { value: THREE.MaterialIdCount ++ } );\r\n\r\n\tthis.uuid = THREE.Math.generateUUID();\r\n\r\n\tthis.name = '';\r\n\tthis.type = 'Material';\r\n\r\n\tthis.fog = true;\r\n\tthis.lights = true;\r\n\r\n\tthis.blending = THREE.NormalBlending;\r\n\tthis.side = THREE.FrontSide;\r\n\tthis.shading = THREE.SmoothShading; // THREE.FlatShading, THREE.SmoothShading\r\n\tthis.vertexColors = THREE.NoColors; // THREE.NoColors, THREE.VertexColors, THREE.FaceColors\r\n\r\n\tthis.opacity = 1;\r\n\tthis.transparent = false;\r\n\r\n\tthis.blendSrc = THREE.SrcAlphaFactor;\r\n\tthis.blendDst = THREE.OneMinusSrcAlphaFactor;\r\n\tthis.blendEquation = THREE.AddEquation;\r\n\tthis.blendSrcAlpha = null;\r\n\tthis.blendDstAlpha = null;\r\n\tthis.blendEquationAlpha = null;\r\n\r\n\tthis.depthFunc = THREE.LessEqualDepth;\r\n\tthis.depthTest = true;\r\n\tthis.depthWrite = true;\r\n\r\n\tthis.clippingPlanes = null;\r\n\tthis.clipShadows = false;\r\n\r\n\tthis.colorWrite = true;\r\n\r\n\tthis.precision = null; // override the renderer's default precision for this material\r\n\r\n\tthis.polygonOffset = false;\r\n\tthis.polygonOffsetFactor = 0;\r\n\tthis.polygonOffsetUnits = 0;\r\n\r\n\tthis.alphaTest = 0;\r\n\tthis.premultipliedAlpha = false;\r\n\r\n\tthis.overdraw = 0; // Overdrawn pixels (typically between 0 and 1) for fixing antialiasing gaps in CanvasRenderer\r\n\r\n\tthis.visible = true;\r\n\r\n\tthis._needsUpdate = true;\r\n\r\n};\r\n\r\nTHREE.Material.prototype = {\r\n\r\n\tconstructor: THREE.Material,\r\n\r\n\tget needsUpdate() {\r\n\r\n\t\treturn this._needsUpdate;\r\n\r\n\t},\r\n\r\n\tset needsUpdate( value ) {\r\n\r\n\t\tif ( value === true ) this.update();\r\n\t\tthis._needsUpdate = value;\r\n\r\n\t},\r\n\r\n\tsetValues: function ( values ) {\r\n\r\n\t\tif ( values === undefined ) return;\r\n\r\n\t\tfor ( var key in values ) {\r\n\r\n\t\t\tvar newValue = values[ key ];\r\n\r\n\t\t\tif ( newValue === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( \"THREE.Material: '\" + key + \"' parameter is undefined.\" );\r\n\t\t\t\tcontinue;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar currentValue = this[ key ];\r\n\r\n\t\t\tif ( currentValue === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( \"THREE.\" + this.type + \": '\" + key + \"' is not a property of this material.\" );\r\n\t\t\t\tcontinue;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( currentValue instanceof THREE.Color ) {\r\n\r\n\t\t\t\tcurrentValue.set( newValue );\r\n\r\n\t\t\t} else if ( currentValue instanceof THREE.Vector3 && newValue instanceof THREE.Vector3 ) {\r\n\r\n\t\t\t\tcurrentValue.copy( newValue );\r\n\r\n\t\t\t} else if ( key === 'overdraw' ) {\r\n\r\n\t\t\t\t// ensure overdraw is backwards-compatible with legacy boolean type\r\n\t\t\t\tthis[ key ] = Number( newValue );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis[ key ] = newValue;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\ttoJSON: function ( meta ) {\r\n\r\n\t\tvar isRoot = meta === undefined;\r\n\r\n\t\tif ( isRoot ) {\r\n\r\n\t\t\tmeta = {\r\n\t\t\t\ttextures: {},\r\n\t\t\t\timages: {}\r\n\t\t\t};\r\n\r\n\t\t}\r\n\r\n\t\tvar data = {\r\n\t\t\tmetadata: {\r\n\t\t\t\tversion: 4.4,\r\n\t\t\t\ttype: 'Material',\r\n\t\t\t\tgenerator: 'Material.toJSON'\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\t// standard Material serialization\r\n\t\tdata.uuid = this.uuid;\r\n\t\tdata.type = this.type;\r\n\r\n\t\tif ( this.name !== '' ) data.name = this.name;\r\n\r\n\t\tif ( this.color instanceof THREE.Color ) data.color = this.color.getHex();\r\n\r\n\t\tif ( this.roughness !== 0.5 ) data.roughness = this.roughness;\r\n\t\tif ( this.metalness !== 0.5 ) data.metalness = this.metalness;\r\n\r\n\t\tif ( this.emissive instanceof THREE.Color ) data.emissive = this.emissive.getHex();\r\n\t\tif ( this.specular instanceof THREE.Color ) data.specular = this.specular.getHex();\r\n\t\tif ( this.shininess !== undefined ) data.shininess = this.shininess;\r\n\r\n\t\tif ( this.map instanceof THREE.Texture ) data.map = this.map.toJSON( meta ).uuid;\r\n\t\tif ( this.alphaMap instanceof THREE.Texture ) data.alphaMap = this.alphaMap.toJSON( meta ).uuid;\r\n\t\tif ( this.lightMap instanceof THREE.Texture ) data.lightMap = this.lightMap.toJSON( meta ).uuid;\r\n\t\tif ( this.bumpMap instanceof THREE.Texture ) {\r\n\r\n\t\t\tdata.bumpMap = this.bumpMap.toJSON( meta ).uuid;\r\n\t\t\tdata.bumpScale = this.bumpScale;\r\n\r\n\t\t}\r\n\t\tif ( this.normalMap instanceof THREE.Texture ) {\r\n\r\n\t\t\tdata.normalMap = this.normalMap.toJSON( meta ).uuid;\r\n\t\t\tdata.normalScale = this.normalScale.toArray();\r\n\r\n\t\t}\r\n\t\tif ( this.displacementMap instanceof THREE.Texture ) {\r\n\r\n\t\t\tdata.displacementMap = this.displacementMap.toJSON( meta ).uuid;\r\n\t\t\tdata.displacementScale = this.displacementScale;\r\n\t\t\tdata.displacementBias = this.displacementBias;\r\n\r\n\t\t}\r\n\t\tif ( this.roughnessMap instanceof THREE.Texture ) data.roughnessMap = this.roughnessMap.toJSON( meta ).uuid;\r\n\t\tif ( this.metalnessMap instanceof THREE.Texture ) data.metalnessMap = this.metalnessMap.toJSON( meta ).uuid;\r\n\r\n\t\tif ( this.emissiveMap instanceof THREE.Texture ) data.emissiveMap = this.emissiveMap.toJSON( meta ).uuid;\r\n\t\tif ( this.specularMap instanceof THREE.Texture ) data.specularMap = this.specularMap.toJSON( meta ).uuid;\r\n\r\n\t\tif ( this.envMap instanceof THREE.Texture ) {\r\n\r\n\t\t\tdata.envMap = this.envMap.toJSON( meta ).uuid;\r\n\t\t\tdata.reflectivity = this.reflectivity; // Scale behind envMap\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.size !== undefined ) data.size = this.size;\r\n\t\tif ( this.sizeAttenuation !== undefined ) data.sizeAttenuation = this.sizeAttenuation;\r\n\r\n\t\tif ( this.blending !== THREE.NormalBlending ) data.blending = this.blending;\r\n\t\tif ( this.shading !== THREE.SmoothShading ) data.shading = this.shading;\r\n\t\tif ( this.side !== THREE.FrontSide ) data.side = this.side;\r\n\t\tif ( this.vertexColors !== THREE.NoColors ) data.vertexColors = this.vertexColors;\r\n\r\n\t\tif ( this.opacity < 1 ) data.opacity = this.opacity;\r\n\t\tif ( this.transparent === true ) data.transparent = this.transparent;\r\n\t\tif ( this.alphaTest > 0 ) data.alphaTest = this.alphaTest;\r\n\t\tif ( this.premultipliedAlpha === true ) data.premultipliedAlpha = this.premultipliedAlpha;\r\n\t\tif ( this.wireframe === true ) data.wireframe = this.wireframe;\r\n\t\tif ( this.wireframeLinewidth > 1 ) data.wireframeLinewidth = this.wireframeLinewidth;\r\n\r\n\t\t// TODO: Copied from Object3D.toJSON\r\n\r\n\t\tfunction extractFromCache ( cache ) {\r\n\r\n\t\t\tvar values = [];\r\n\r\n\t\t\tfor ( var key in cache ) {\r\n\r\n\t\t\t\tvar data = cache[ key ];\r\n\t\t\t\tdelete data.metadata;\r\n\t\t\t\tvalues.push( data );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn values;\r\n\r\n\t\t}\r\n\r\n\t\tif ( isRoot ) {\r\n\r\n\t\t\tvar textures = extractFromCache( meta.textures );\r\n\t\t\tvar images = extractFromCache( meta.images );\r\n\r\n\t\t\tif ( textures.length > 0 ) data.textures = textures;\r\n\t\t\tif ( images.length > 0 ) data.images = images;\r\n\r\n\t\t}\r\n\r\n\t\treturn data;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor().copy( this );\r\n\r\n\t},\r\n\r\n\tcopy: function ( source ) {\r\n\r\n\t\tthis.name = source.name;\r\n\r\n\t\tthis.fog = source.fog;\r\n\t\tthis.lights = source.lights;\r\n\r\n\t\tthis.blending = source.blending;\r\n\t\tthis.side = source.side;\r\n\t\tthis.vertexColors = source.vertexColors;\r\n\r\n\t\tthis.opacity = source.opacity;\r\n\t\tthis.transparent = source.transparent;\r\n\r\n\t\tthis.blendSrc = source.blendSrc;\r\n\t\tthis.blendDst = source.blendDst;\r\n\t\tthis.blendEquation = source.blendEquation;\r\n\t\tthis.blendSrcAlpha = source.blendSrcAlpha;\r\n\t\tthis.blendDstAlpha = source.blendDstAlpha;\r\n\t\tthis.blendEquationAlpha = source.blendEquationAlpha;\r\n\r\n\t\tthis.depthFunc = source.depthFunc;\r\n\t\tthis.depthTest = source.depthTest;\r\n\t\tthis.depthWrite = source.depthWrite;\r\n\r\n\t\tthis.colorWrite = source.colorWrite;\r\n\r\n\t\tthis.precision = source.precision;\r\n\r\n\t\tthis.polygonOffset = source.polygonOffset;\r\n\t\tthis.polygonOffsetFactor = source.polygonOffsetFactor;\r\n\t\tthis.polygonOffsetUnits = source.polygonOffsetUnits;\r\n\r\n\t\tthis.alphaTest = source.alphaTest;\r\n\r\n\t\tthis.premultipliedAlpha = source.premultipliedAlpha;\r\n\r\n\t\tthis.overdraw = source.overdraw;\r\n\r\n\t\tthis.visible = source.visible;\r\n\t\tthis.clipShadows = source.clipShadows;\r\n\r\n\t\tvar srcPlanes = source.clippingPlanes,\r\n\t\t\tdstPlanes = null;\r\n\r\n\t\tif ( srcPlanes !== null ) {\r\n\r\n\t\t\tvar n = srcPlanes.length;\r\n\t\t\tdstPlanes = new Array( n );\r\n\r\n\t\t\tfor ( var i = 0; i !== n; ++ i )\r\n\t\t\t\tdstPlanes[ i ] = srcPlanes[ i ].clone();\r\n\r\n\t\t}\r\n\r\n\t\tthis.clippingPlanes = dstPlanes;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tupdate: function () {\r\n\r\n\t\tthis.dispatchEvent( { type: 'update' } );\r\n\r\n\t},\r\n\r\n\tdispose: function () {\r\n\r\n\t\tthis.dispatchEvent( { type: 'dispose' } );\r\n\r\n\t}\r\n\r\n};\r\n\r\nObject.assign( THREE.Material.prototype, THREE.EventDispatcher.prototype );\r\n\r\nTHREE.MaterialIdCount = 0;\r\n\r\n// File:src/materials/LineBasicMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  color: <hex>,\r\n *  opacity: <float>,\r\n *\r\n *  linewidth: <float>,\r\n *  linecap: \"round\",\r\n *  linejoin: \"round\"\r\n * }\r\n */\r\n\r\nTHREE.LineBasicMaterial = function ( parameters ) {\r\n\r\n\tTHREE.Material.call( this );\r\n\r\n\tthis.type = 'LineBasicMaterial';\r\n\r\n\tthis.color = new THREE.Color( 0xffffff );\r\n\r\n\tthis.linewidth = 1;\r\n\tthis.linecap = 'round';\r\n\tthis.linejoin = 'round';\r\n\r\n\tthis.lights = false;\r\n\r\n\tthis.setValues( parameters );\r\n\r\n};\r\n\r\nTHREE.LineBasicMaterial.prototype = Object.create( THREE.Material.prototype );\r\nTHREE.LineBasicMaterial.prototype.constructor = THREE.LineBasicMaterial;\r\n\r\nTHREE.LineBasicMaterial.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.Material.prototype.copy.call( this, source );\r\n\r\n\tthis.color.copy( source.color );\r\n\r\n\tthis.linewidth = source.linewidth;\r\n\tthis.linecap = source.linecap;\r\n\tthis.linejoin = source.linejoin;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n// File:src/materials/LineDashedMaterial.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  color: <hex>,\r\n *  opacity: <float>,\r\n *\r\n *  linewidth: <float>,\r\n *\r\n *  scale: <float>,\r\n *  dashSize: <float>,\r\n *  gapSize: <float>\r\n * }\r\n */\r\n\r\nTHREE.LineDashedMaterial = function ( parameters ) {\r\n\r\n\tTHREE.Material.call( this );\r\n\r\n\tthis.type = 'LineDashedMaterial';\r\n\r\n\tthis.color = new THREE.Color( 0xffffff );\r\n\r\n\tthis.linewidth = 1;\r\n\r\n\tthis.scale = 1;\r\n\tthis.dashSize = 3;\r\n\tthis.gapSize = 1;\r\n\r\n\tthis.lights = false;\r\n\r\n\tthis.setValues( parameters );\r\n\r\n};\r\n\r\nTHREE.LineDashedMaterial.prototype = Object.create( THREE.Material.prototype );\r\nTHREE.LineDashedMaterial.prototype.constructor = THREE.LineDashedMaterial;\r\n\r\nTHREE.LineDashedMaterial.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.Material.prototype.copy.call( this, source );\r\n\r\n\tthis.color.copy( source.color );\r\n\r\n\tthis.linewidth = source.linewidth;\r\n\r\n\tthis.scale = source.scale;\r\n\tthis.dashSize = source.dashSize;\r\n\tthis.gapSize = source.gapSize;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n// File:src/materials/MeshBasicMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  color: <hex>,\r\n *  opacity: <float>,\r\n *  map: new THREE.Texture( <Image> ),\r\n *\r\n *  aoMap: new THREE.Texture( <Image> ),\r\n *  aoMapIntensity: <float>\r\n *\r\n *  specularMap: new THREE.Texture( <Image> ),\r\n *\r\n *  alphaMap: new THREE.Texture( <Image> ),\r\n *\r\n *  envMap: new THREE.TextureCube( [posx, negx, posy, negy, posz, negz] ),\r\n *  combine: THREE.Multiply,\r\n *  reflectivity: <float>,\r\n *  refractionRatio: <float>,\r\n *\r\n *  shading: THREE.SmoothShading,\r\n *  depthTest: <bool>,\r\n *  depthWrite: <bool>,\r\n *\r\n *  wireframe: <boolean>,\r\n *  wireframeLinewidth: <float>,\r\n *\r\n *  skinning: <bool>,\r\n *  morphTargets: <bool>\r\n * }\r\n */\r\n\r\nTHREE.MeshBasicMaterial = function ( parameters ) {\r\n\r\n\tTHREE.Material.call( this );\r\n\r\n\tthis.type = 'MeshBasicMaterial';\r\n\r\n\tthis.color = new THREE.Color( 0xffffff ); // emissive\r\n\r\n\tthis.map = null;\r\n\r\n\tthis.aoMap = null;\r\n\tthis.aoMapIntensity = 1.0;\r\n\r\n\tthis.specularMap = null;\r\n\r\n\tthis.alphaMap = null;\r\n\r\n\tthis.envMap = null;\r\n\tthis.combine = THREE.MultiplyOperation;\r\n\tthis.reflectivity = 1;\r\n\tthis.refractionRatio = 0.98;\r\n\r\n\tthis.wireframe = false;\r\n\tthis.wireframeLinewidth = 1;\r\n\tthis.wireframeLinecap = 'round';\r\n\tthis.wireframeLinejoin = 'round';\r\n\r\n\tthis.skinning = false;\r\n\tthis.morphTargets = false;\r\n\r\n\tthis.lights = false;\r\n\r\n\tthis.setValues( parameters );\r\n\r\n};\r\n\r\nTHREE.MeshBasicMaterial.prototype = Object.create( THREE.Material.prototype );\r\nTHREE.MeshBasicMaterial.prototype.constructor = THREE.MeshBasicMaterial;\r\n\r\nTHREE.MeshBasicMaterial.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.Material.prototype.copy.call( this, source );\r\n\r\n\tthis.color.copy( source.color );\r\n\r\n\tthis.map = source.map;\r\n\r\n\tthis.aoMap = source.aoMap;\r\n\tthis.aoMapIntensity = source.aoMapIntensity;\r\n\r\n\tthis.specularMap = source.specularMap;\r\n\r\n\tthis.alphaMap = source.alphaMap;\r\n\r\n\tthis.envMap = source.envMap;\r\n\tthis.combine = source.combine;\r\n\tthis.reflectivity = source.reflectivity;\r\n\tthis.refractionRatio = source.refractionRatio;\r\n\r\n\tthis.wireframe = source.wireframe;\r\n\tthis.wireframeLinewidth = source.wireframeLinewidth;\r\n\tthis.wireframeLinecap = source.wireframeLinecap;\r\n\tthis.wireframeLinejoin = source.wireframeLinejoin;\r\n\r\n\tthis.skinning = source.skinning;\r\n\tthis.morphTargets = source.morphTargets;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n// File:src/materials/MeshDepthMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author bhouston / https://clara.io\r\n * @author WestLangley / http://github.com/WestLangley\r\n *\r\n * parameters = {\r\n *\r\n *  opacity: <float>,\r\n *\r\n *  map: new THREE.Texture( <Image> ),\r\n *\r\n *  alphaMap: new THREE.Texture( <Image> ),\r\n *\r\n *  displacementMap: new THREE.Texture( <Image> ),\r\n *  displacementScale: <float>,\r\n *  displacementBias: <float>,\r\n *\r\n *  wireframe: <boolean>,\r\n *  wireframeLinewidth: <float>\r\n * }\r\n */\r\n\r\nTHREE.MeshDepthMaterial = function ( parameters ) {\r\n\r\n\tTHREE.Material.call( this );\r\n\r\n\tthis.type = 'MeshDepthMaterial';\r\n\r\n\tthis.depthPacking = THREE.BasicDepthPacking;\r\n\r\n\tthis.skinning = false;\r\n\tthis.morphTargets = false;\r\n\r\n\tthis.map = null;\r\n\r\n\tthis.alphaMap = null;\r\n\r\n\tthis.displacementMap = null;\r\n\tthis.displacementScale = 1;\r\n\tthis.displacementBias = 0;\r\n\r\n\tthis.wireframe = false;\r\n\tthis.wireframeLinewidth = 1;\r\n\r\n\tthis.fog = false;\r\n\tthis.lights = false;\r\n\r\n\tthis.setValues( parameters );\r\n\r\n};\r\n\r\nTHREE.MeshDepthMaterial.prototype = Object.create( THREE.Material.prototype );\r\nTHREE.MeshDepthMaterial.prototype.constructor = THREE.MeshDepthMaterial;\r\n\r\nTHREE.MeshDepthMaterial.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.Material.prototype.copy.call( this, source );\r\n\r\n\tthis.depthPacking = source.depthPacking;\r\n\r\n\tthis.skinning = source.skinning;\r\n\tthis.morphTargets = source.morphTargets;\r\n\r\n\tthis.map = source.map;\r\n\r\n\tthis.alphaMap = source.alphaMap;\r\n\r\n\tthis.displacementMap = source.displacementMap;\r\n\tthis.displacementScale = source.displacementScale;\r\n\tthis.displacementBias = source.displacementBias;\r\n\r\n\tthis.wireframe = source.wireframe;\r\n\tthis.wireframeLinewidth = source.wireframeLinewidth;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n// File:src/materials/MeshLambertMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  color: <hex>,\r\n *  opacity: <float>,\r\n *\r\n *  map: new THREE.Texture( <Image> ),\r\n *\r\n *  lightMap: new THREE.Texture( <Image> ),\r\n *  lightMapIntensity: <float>\r\n *\r\n *  aoMap: new THREE.Texture( <Image> ),\r\n *  aoMapIntensity: <float>\r\n *\r\n *  emissive: <hex>,\r\n *  emissiveIntensity: <float>\r\n *  emissiveMap: new THREE.Texture( <Image> ),\r\n *\r\n *  specularMap: new THREE.Texture( <Image> ),\r\n *\r\n *  alphaMap: new THREE.Texture( <Image> ),\r\n *\r\n *  envMap: new THREE.TextureCube( [posx, negx, posy, negy, posz, negz] ),\r\n *  combine: THREE.Multiply,\r\n *  reflectivity: <float>,\r\n *  refractionRatio: <float>,\r\n *\r\n *  wireframe: <boolean>,\r\n *  wireframeLinewidth: <float>,\r\n *\r\n *  skinning: <bool>,\r\n *  morphTargets: <bool>,\r\n *  morphNormals: <bool>\r\n * }\r\n */\r\n\r\nTHREE.MeshLambertMaterial = function ( parameters ) {\r\n\r\n\tTHREE.Material.call( this );\r\n\r\n\tthis.type = 'MeshLambertMaterial';\r\n\r\n\tthis.color = new THREE.Color( 0xffffff ); // diffuse\r\n\r\n\tthis.map = null;\r\n\r\n\tthis.lightMap = null;\r\n\tthis.lightMapIntensity = 1.0;\r\n\r\n\tthis.aoMap = null;\r\n\tthis.aoMapIntensity = 1.0;\r\n\r\n\tthis.emissive = new THREE.Color( 0x000000 );\r\n\tthis.emissiveIntensity = 1.0;\r\n\tthis.emissiveMap = null;\r\n\r\n\tthis.specularMap = null;\r\n\r\n\tthis.alphaMap = null;\r\n\r\n\tthis.envMap = null;\r\n\tthis.combine = THREE.MultiplyOperation;\r\n\tthis.reflectivity = 1;\r\n\tthis.refractionRatio = 0.98;\r\n\r\n\tthis.wireframe = false;\r\n\tthis.wireframeLinewidth = 1;\r\n\tthis.wireframeLinecap = 'round';\r\n\tthis.wireframeLinejoin = 'round';\r\n\r\n\tthis.skinning = false;\r\n\tthis.morphTargets = false;\r\n\tthis.morphNormals = false;\r\n\r\n\tthis.setValues( parameters );\r\n\r\n};\r\n\r\nTHREE.MeshLambertMaterial.prototype = Object.create( THREE.Material.prototype );\r\nTHREE.MeshLambertMaterial.prototype.constructor = THREE.MeshLambertMaterial;\r\n\r\nTHREE.MeshLambertMaterial.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.Material.prototype.copy.call( this, source );\r\n\r\n\tthis.color.copy( source.color );\r\n\r\n\tthis.map = source.map;\r\n\r\n\tthis.lightMap = source.lightMap;\r\n\tthis.lightMapIntensity = source.lightMapIntensity;\r\n\r\n\tthis.aoMap = source.aoMap;\r\n\tthis.aoMapIntensity = source.aoMapIntensity;\r\n\r\n\tthis.emissive.copy( source.emissive );\r\n\tthis.emissiveMap = source.emissiveMap;\r\n\tthis.emissiveIntensity = source.emissiveIntensity;\r\n\r\n\tthis.specularMap = source.specularMap;\r\n\r\n\tthis.alphaMap = source.alphaMap;\r\n\r\n\tthis.envMap = source.envMap;\r\n\tthis.combine = source.combine;\r\n\tthis.reflectivity = source.reflectivity;\r\n\tthis.refractionRatio = source.refractionRatio;\r\n\r\n\tthis.wireframe = source.wireframe;\r\n\tthis.wireframeLinewidth = source.wireframeLinewidth;\r\n\tthis.wireframeLinecap = source.wireframeLinecap;\r\n\tthis.wireframeLinejoin = source.wireframeLinejoin;\r\n\r\n\tthis.skinning = source.skinning;\r\n\tthis.morphTargets = source.morphTargets;\r\n\tthis.morphNormals = source.morphNormals;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n// File:src/materials/MeshNormalMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n *\r\n * parameters = {\r\n *  opacity: <float>,\r\n *\r\n *  wireframe: <boolean>,\r\n *  wireframeLinewidth: <float>\r\n * }\r\n */\r\n\r\nTHREE.MeshNormalMaterial = function ( parameters ) {\r\n\r\n\tTHREE.Material.call( this, parameters );\r\n\r\n\tthis.type = 'MeshNormalMaterial';\r\n\r\n\tthis.wireframe = false;\r\n\tthis.wireframeLinewidth = 1;\r\n\r\n\tthis.fog = false;\r\n\tthis.lights = false;\r\n\tthis.morphTargets = false;\r\n\r\n\tthis.setValues( parameters );\r\n\r\n};\r\n\r\nTHREE.MeshNormalMaterial.prototype = Object.create( THREE.Material.prototype );\r\nTHREE.MeshNormalMaterial.prototype.constructor = THREE.MeshNormalMaterial;\r\n\r\nTHREE.MeshNormalMaterial.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.Material.prototype.copy.call( this, source );\r\n\r\n\tthis.wireframe = source.wireframe;\r\n\tthis.wireframeLinewidth = source.wireframeLinewidth;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n// File:src/materials/MeshPhongMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  color: <hex>,\r\n *  specular: <hex>,\r\n *  shininess: <float>,\r\n *  opacity: <float>,\r\n *\r\n *  map: new THREE.Texture( <Image> ),\r\n *\r\n *  lightMap: new THREE.Texture( <Image> ),\r\n *  lightMapIntensity: <float>\r\n *\r\n *  aoMap: new THREE.Texture( <Image> ),\r\n *  aoMapIntensity: <float>\r\n *\r\n *  emissive: <hex>,\r\n *  emissiveIntensity: <float>\r\n *  emissiveMap: new THREE.Texture( <Image> ),\r\n *\r\n *  bumpMap: new THREE.Texture( <Image> ),\r\n *  bumpScale: <float>,\r\n *\r\n *  normalMap: new THREE.Texture( <Image> ),\r\n *  normalScale: <Vector2>,\r\n *\r\n *  displacementMap: new THREE.Texture( <Image> ),\r\n *  displacementScale: <float>,\r\n *  displacementBias: <float>,\r\n *\r\n *  specularMap: new THREE.Texture( <Image> ),\r\n *\r\n *  alphaMap: new THREE.Texture( <Image> ),\r\n *\r\n *  envMap: new THREE.TextureCube( [posx, negx, posy, negy, posz, negz] ),\r\n *  combine: THREE.Multiply,\r\n *  reflectivity: <float>,\r\n *  refractionRatio: <float>,\r\n *\r\n *  wireframe: <boolean>,\r\n *  wireframeLinewidth: <float>,\r\n *\r\n *  skinning: <bool>,\r\n *  morphTargets: <bool>,\r\n *  morphNormals: <bool>\r\n * }\r\n */\r\n\r\nTHREE.MeshPhongMaterial = function ( parameters ) {\r\n\r\n\tTHREE.Material.call( this );\r\n\r\n\tthis.type = 'MeshPhongMaterial';\r\n\r\n\tthis.color = new THREE.Color( 0xffffff ); // diffuse\r\n\tthis.specular = new THREE.Color( 0x111111 );\r\n\tthis.shininess = 30;\r\n\r\n\tthis.map = null;\r\n\r\n\tthis.lightMap = null;\r\n\tthis.lightMapIntensity = 1.0;\r\n\r\n\tthis.aoMap = null;\r\n\tthis.aoMapIntensity = 1.0;\r\n\r\n\tthis.emissive = new THREE.Color( 0x000000 );\r\n\tthis.emissiveIntensity = 1.0;\r\n\tthis.emissiveMap = null;\r\n\r\n\tthis.bumpMap = null;\r\n\tthis.bumpScale = 1;\r\n\r\n\tthis.normalMap = null;\r\n\tthis.normalScale = new THREE.Vector2( 1, 1 );\r\n\r\n\tthis.displacementMap = null;\r\n\tthis.displacementScale = 1;\r\n\tthis.displacementBias = 0;\r\n\r\n\tthis.specularMap = null;\r\n\r\n\tthis.alphaMap = null;\r\n\r\n\tthis.envMap = null;\r\n\tthis.combine = THREE.MultiplyOperation;\r\n\tthis.reflectivity = 1;\r\n\tthis.refractionRatio = 0.98;\r\n\r\n\tthis.wireframe = false;\r\n\tthis.wireframeLinewidth = 1;\r\n\tthis.wireframeLinecap = 'round';\r\n\tthis.wireframeLinejoin = 'round';\r\n\r\n\tthis.skinning = false;\r\n\tthis.morphTargets = false;\r\n\tthis.morphNormals = false;\r\n\r\n\tthis.setValues( parameters );\r\n\r\n};\r\n\r\nTHREE.MeshPhongMaterial.prototype = Object.create( THREE.Material.prototype );\r\nTHREE.MeshPhongMaterial.prototype.constructor = THREE.MeshPhongMaterial;\r\n\r\nTHREE.MeshPhongMaterial.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.Material.prototype.copy.call( this, source );\r\n\r\n\tthis.color.copy( source.color );\r\n\tthis.specular.copy( source.specular );\r\n\tthis.shininess = source.shininess;\r\n\r\n\tthis.map = source.map;\r\n\r\n\tthis.lightMap = source.lightMap;\r\n\tthis.lightMapIntensity = source.lightMapIntensity;\r\n\r\n\tthis.aoMap = source.aoMap;\r\n\tthis.aoMapIntensity = source.aoMapIntensity;\r\n\r\n\tthis.emissive.copy( source.emissive );\r\n\tthis.emissiveMap = source.emissiveMap;\r\n\tthis.emissiveIntensity = source.emissiveIntensity;\r\n\r\n\tthis.bumpMap = source.bumpMap;\r\n\tthis.bumpScale = source.bumpScale;\r\n\r\n\tthis.normalMap = source.normalMap;\r\n\tthis.normalScale.copy( source.normalScale );\r\n\r\n\tthis.displacementMap = source.displacementMap;\r\n\tthis.displacementScale = source.displacementScale;\r\n\tthis.displacementBias = source.displacementBias;\r\n\r\n\tthis.specularMap = source.specularMap;\r\n\r\n\tthis.alphaMap = source.alphaMap;\r\n\r\n\tthis.envMap = source.envMap;\r\n\tthis.combine = source.combine;\r\n\tthis.reflectivity = source.reflectivity;\r\n\tthis.refractionRatio = source.refractionRatio;\r\n\r\n\tthis.wireframe = source.wireframe;\r\n\tthis.wireframeLinewidth = source.wireframeLinewidth;\r\n\tthis.wireframeLinecap = source.wireframeLinecap;\r\n\tthis.wireframeLinejoin = source.wireframeLinejoin;\r\n\r\n\tthis.skinning = source.skinning;\r\n\tthis.morphTargets = source.morphTargets;\r\n\tthis.morphNormals = source.morphNormals;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n// File:src/materials/MeshStandardMaterial.js\r\n\r\n/**\r\n * @author WestLangley / http://github.com/WestLangley\r\n *\r\n * parameters = {\r\n *  color: <hex>,\r\n *  roughness: <float>,\r\n *  metalness: <float>,\r\n *  opacity: <float>,\r\n *\r\n *  map: new THREE.Texture( <Image> ),\r\n *\r\n *  lightMap: new THREE.Texture( <Image> ),\r\n *  lightMapIntensity: <float>\r\n *\r\n *  aoMap: new THREE.Texture( <Image> ),\r\n *  aoMapIntensity: <float>\r\n *\r\n *  emissive: <hex>,\r\n *  emissiveIntensity: <float>\r\n *  emissiveMap: new THREE.Texture( <Image> ),\r\n *\r\n *  bumpMap: new THREE.Texture( <Image> ),\r\n *  bumpScale: <float>,\r\n *\r\n *  normalMap: new THREE.Texture( <Image> ),\r\n *  normalScale: <Vector2>,\r\n *\r\n *  displacementMap: new THREE.Texture( <Image> ),\r\n *  displacementScale: <float>,\r\n *  displacementBias: <float>,\r\n *\r\n *  roughnessMap: new THREE.Texture( <Image> ),\r\n *\r\n *  metalnessMap: new THREE.Texture( <Image> ),\r\n *\r\n *  alphaMap: new THREE.Texture( <Image> ),\r\n *\r\n *  envMap: new THREE.CubeTexture( [posx, negx, posy, negy, posz, negz] ),\r\n *  envMapIntensity: <float>\r\n *\r\n *  refractionRatio: <float>,\r\n *\r\n *  wireframe: <boolean>,\r\n *  wireframeLinewidth: <float>,\r\n *\r\n *  skinning: <bool>,\r\n *  morphTargets: <bool>,\r\n *  morphNormals: <bool>\r\n * }\r\n */\r\n\r\nTHREE.MeshStandardMaterial = function ( parameters ) {\r\n\r\n\tTHREE.Material.call( this );\r\n\r\n\tthis.defines = { 'STANDARD': '' };\r\n\r\n\tthis.type = 'MeshStandardMaterial';\r\n\r\n\tthis.color = new THREE.Color( 0xffffff ); // diffuse\r\n\tthis.roughness = 0.5;\r\n\tthis.metalness = 0.5;\r\n\r\n\tthis.map = null;\r\n\r\n\tthis.lightMap = null;\r\n\tthis.lightMapIntensity = 1.0;\r\n\r\n\tthis.aoMap = null;\r\n\tthis.aoMapIntensity = 1.0;\r\n\r\n\tthis.emissive = new THREE.Color( 0x000000 );\r\n\tthis.emissiveIntensity = 1.0;\r\n\tthis.emissiveMap = null;\r\n\r\n\tthis.bumpMap = null;\r\n\tthis.bumpScale = 1;\r\n\r\n\tthis.normalMap = null;\r\n\tthis.normalScale = new THREE.Vector2( 1, 1 );\r\n\r\n\tthis.displacementMap = null;\r\n\tthis.displacementScale = 1;\r\n\tthis.displacementBias = 0;\r\n\r\n\tthis.roughnessMap = null;\r\n\r\n\tthis.metalnessMap = null;\r\n\r\n\tthis.alphaMap = null;\r\n\r\n\tthis.envMap = null;\r\n\tthis.envMapIntensity = 1.0;\r\n\r\n\tthis.refractionRatio = 0.98;\r\n\r\n\tthis.wireframe = false;\r\n\tthis.wireframeLinewidth = 1;\r\n\tthis.wireframeLinecap = 'round';\r\n\tthis.wireframeLinejoin = 'round';\r\n\r\n\tthis.skinning = false;\r\n\tthis.morphTargets = false;\r\n\tthis.morphNormals = false;\r\n\r\n\tthis.setValues( parameters );\r\n\r\n};\r\n\r\nTHREE.MeshStandardMaterial.prototype = Object.create( THREE.Material.prototype );\r\nTHREE.MeshStandardMaterial.prototype.constructor = THREE.MeshStandardMaterial;\r\n\r\nTHREE.MeshStandardMaterial.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.Material.prototype.copy.call( this, source );\r\n\r\n\tthis.defines = { 'STANDARD': '' };\r\n\r\n\tthis.color.copy( source.color );\r\n\tthis.roughness = source.roughness;\r\n\tthis.metalness = source.metalness;\r\n\r\n\tthis.map = source.map;\r\n\r\n\tthis.lightMap = source.lightMap;\r\n\tthis.lightMapIntensity = source.lightMapIntensity;\r\n\r\n\tthis.aoMap = source.aoMap;\r\n\tthis.aoMapIntensity = source.aoMapIntensity;\r\n\r\n\tthis.emissive.copy( source.emissive );\r\n\tthis.emissiveMap = source.emissiveMap;\r\n\tthis.emissiveIntensity = source.emissiveIntensity;\r\n\r\n\tthis.bumpMap = source.bumpMap;\r\n\tthis.bumpScale = source.bumpScale;\r\n\r\n\tthis.normalMap = source.normalMap;\r\n\tthis.normalScale.copy( source.normalScale );\r\n\r\n\tthis.displacementMap = source.displacementMap;\r\n\tthis.displacementScale = source.displacementScale;\r\n\tthis.displacementBias = source.displacementBias;\r\n\r\n\tthis.roughnessMap = source.roughnessMap;\r\n\r\n\tthis.metalnessMap = source.metalnessMap;\r\n\r\n\tthis.alphaMap = source.alphaMap;\r\n\r\n\tthis.envMap = source.envMap;\r\n\tthis.envMapIntensity = source.envMapIntensity;\r\n\r\n\tthis.refractionRatio = source.refractionRatio;\r\n\r\n\tthis.wireframe = source.wireframe;\r\n\tthis.wireframeLinewidth = source.wireframeLinewidth;\r\n\tthis.wireframeLinecap = source.wireframeLinecap;\r\n\tthis.wireframeLinejoin = source.wireframeLinejoin;\r\n\r\n\tthis.skinning = source.skinning;\r\n\tthis.morphTargets = source.morphTargets;\r\n\tthis.morphNormals = source.morphNormals;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n// File:src/materials/MeshPhysicalMaterial.js\r\n\r\n/**\r\n * @author WestLangley / http://github.com/WestLangley\r\n *\r\n * parameters = {\r\n *  reflectivity: <float>\r\n * }\r\n */\r\n\r\nTHREE.MeshPhysicalMaterial = function ( parameters ) {\r\n\r\n\tTHREE.MeshStandardMaterial.call( this );\r\n\r\n\tthis.defines = { 'PHYSICAL': '' };\r\n\r\n\tthis.type = 'MeshPhysicalMaterial';\r\n\r\n\tthis.reflectivity = 0.5; // maps to F0 = 0.04\r\n\r\n\tthis.setValues( parameters );\r\n\r\n};\r\n\r\nTHREE.MeshPhysicalMaterial.prototype = Object.create( THREE.MeshStandardMaterial.prototype );\r\nTHREE.MeshPhysicalMaterial.prototype.constructor = THREE.MeshPhysicalMaterial;\r\n\r\nTHREE.MeshPhysicalMaterial.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.MeshStandardMaterial.prototype.copy.call( this, source );\r\n\r\n\tthis.defines = { 'PHYSICAL': '' };\r\n\r\n\tthis.reflectivity = source.reflectivity;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n// File:src/materials/MultiMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.MultiMaterial = function ( materials ) {\r\n\r\n\tthis.uuid = THREE.Math.generateUUID();\r\n\r\n\tthis.type = 'MultiMaterial';\r\n\r\n\tthis.materials = materials instanceof Array ? materials : [];\r\n\r\n\tthis.visible = true;\r\n\r\n};\r\n\r\nTHREE.MultiMaterial.prototype = {\r\n\r\n\tconstructor: THREE.MultiMaterial,\r\n\r\n\ttoJSON: function ( meta ) {\r\n\r\n\t\tvar output = {\r\n\t\t\tmetadata: {\r\n\t\t\t\tversion: 4.2,\r\n\t\t\t\ttype: 'material',\r\n\t\t\t\tgenerator: 'MaterialExporter'\r\n\t\t\t},\r\n\t\t\tuuid: this.uuid,\r\n\t\t\ttype: this.type,\r\n\t\t\tmaterials: []\r\n\t\t};\r\n\r\n\t\tvar materials = this.materials;\r\n\r\n\t\tfor ( var i = 0, l = materials.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar material = materials[ i ].toJSON( meta );\r\n\t\t\tdelete material.metadata;\r\n\r\n\t\t\toutput.materials.push( material );\r\n\r\n\t\t}\r\n\r\n\t\toutput.visible = this.visible;\r\n\r\n\t\treturn output;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\tvar material = new this.constructor();\r\n\r\n\t\tfor ( var i = 0; i < this.materials.length; i ++ ) {\r\n\r\n\t\t\tmaterial.materials.push( this.materials[ i ].clone() );\r\n\r\n\t\t}\r\n\r\n\t\tmaterial.visible = this.visible;\r\n\r\n\t\treturn material;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/materials/PointsMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  color: <hex>,\r\n *  opacity: <float>,\r\n *  map: new THREE.Texture( <Image> ),\r\n *\r\n *  size: <float>,\r\n *  sizeAttenuation: <bool>\r\n * }\r\n */\r\n\r\nTHREE.PointsMaterial = function ( parameters ) {\r\n\r\n\tTHREE.Material.call( this );\r\n\r\n\tthis.type = 'PointsMaterial';\r\n\r\n\tthis.color = new THREE.Color( 0xffffff );\r\n\r\n\tthis.map = null;\r\n\r\n\tthis.size = 1;\r\n\tthis.sizeAttenuation = true;\r\n\r\n\tthis.lights = false;\r\n\r\n\tthis.setValues( parameters );\r\n\r\n};\r\n\r\nTHREE.PointsMaterial.prototype = Object.create( THREE.Material.prototype );\r\nTHREE.PointsMaterial.prototype.constructor = THREE.PointsMaterial;\r\n\r\nTHREE.PointsMaterial.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.Material.prototype.copy.call( this, source );\r\n\r\n\tthis.color.copy( source.color );\r\n\r\n\tthis.map = source.map;\r\n\r\n\tthis.size = source.size;\r\n\tthis.sizeAttenuation = source.sizeAttenuation;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n// File:src/materials/ShaderMaterial.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  defines: { \"label\" : \"value\" },\r\n *  uniforms: { \"parameter1\": { type: \"1f\", value: 1.0 }, \"parameter2\": { type: \"1i\" value2: 2 } },\r\n *\r\n *  fragmentShader: <string>,\r\n *  vertexShader: <string>,\r\n *\r\n *  wireframe: <boolean>,\r\n *  wireframeLinewidth: <float>,\r\n *\r\n *  lights: <bool>,\r\n *\r\n *  skinning: <bool>,\r\n *  morphTargets: <bool>,\r\n *  morphNormals: <bool>\r\n * }\r\n */\r\n\r\nTHREE.ShaderMaterial = function ( parameters ) {\r\n\r\n\tTHREE.Material.call( this );\r\n\r\n\tthis.type = 'ShaderMaterial';\r\n\r\n\tthis.defines = {};\r\n\tthis.uniforms = {};\r\n\r\n\tthis.vertexShader = 'void main() {\\n\\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\\n}';\r\n\tthis.fragmentShader = 'void main() {\\n\\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\\n}';\r\n\r\n\tthis.linewidth = 1;\r\n\r\n\tthis.wireframe = false;\r\n\tthis.wireframeLinewidth = 1;\r\n\r\n\tthis.fog = false; // set to use scene fog\r\n\tthis.lights = false; // set to use scene lights\r\n\tthis.clipping = false; // set to use user-defined clipping planes\r\n\r\n\tthis.skinning = false; // set to use skinning attribute streams\r\n\tthis.morphTargets = false; // set to use morph targets\r\n\tthis.morphNormals = false; // set to use morph normals\r\n\r\n\tthis.extensions = {\r\n\t\tderivatives: false, // set to use derivatives\r\n\t\tfragDepth: false, // set to use fragment depth values\r\n\t\tdrawBuffers: false, // set to use draw buffers\r\n\t\tshaderTextureLOD: false // set to use shader texture LOD\r\n\t};\r\n\r\n\t// When rendered geometry doesn't include these attributes but the material does,\r\n\t// use these default values in WebGL. This avoids errors when buffer data is missing.\r\n\tthis.defaultAttributeValues = {\r\n\t\t'color': [ 1, 1, 1 ],\r\n\t\t'uv': [ 0, 0 ],\r\n\t\t'uv2': [ 0, 0 ]\r\n\t};\r\n\r\n\tthis.index0AttributeName = undefined;\r\n\r\n\tif ( parameters !== undefined ) {\r\n\r\n\t\tif ( parameters.attributes !== undefined ) {\r\n\r\n\t\t\tconsole.error( 'THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead.' );\r\n\r\n\t\t}\r\n\r\n\t\tthis.setValues( parameters );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.ShaderMaterial.prototype = Object.create( THREE.Material.prototype );\r\nTHREE.ShaderMaterial.prototype.constructor = THREE.ShaderMaterial;\r\n\r\nTHREE.ShaderMaterial.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.Material.prototype.copy.call( this, source );\r\n\r\n\tthis.fragmentShader = source.fragmentShader;\r\n\tthis.vertexShader = source.vertexShader;\r\n\r\n\tthis.uniforms = THREE.UniformsUtils.clone( source.uniforms );\r\n\r\n\tthis.defines = source.defines;\r\n\r\n\tthis.wireframe = source.wireframe;\r\n\tthis.wireframeLinewidth = source.wireframeLinewidth;\r\n\r\n\tthis.lights = source.lights;\r\n\tthis.clipping = source.clipping;\r\n\r\n\tthis.skinning = source.skinning;\r\n\r\n\tthis.morphTargets = source.morphTargets;\r\n\tthis.morphNormals = source.morphNormals;\r\n\r\n\tthis.extensions = source.extensions;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nTHREE.ShaderMaterial.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = THREE.Material.prototype.toJSON.call( this, meta );\r\n\r\n\tdata.uniforms = this.uniforms;\r\n\tdata.vertexShader = this.vertexShader;\r\n\tdata.fragmentShader = this.fragmentShader;\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\n// File:src/materials/RawShaderMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.RawShaderMaterial = function ( parameters ) {\r\n\r\n\tTHREE.ShaderMaterial.call( this, parameters );\r\n\r\n\tthis.type = 'RawShaderMaterial';\r\n\r\n};\r\n\r\nTHREE.RawShaderMaterial.prototype = Object.create( THREE.ShaderMaterial.prototype );\r\nTHREE.RawShaderMaterial.prototype.constructor = THREE.RawShaderMaterial;\r\n\r\n// File:src/materials/SpriteMaterial.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * parameters = {\r\n *  color: <hex>,\r\n *  opacity: <float>,\r\n *  map: new THREE.Texture( <Image> ),\r\n *\r\n *\tuvOffset: new THREE.Vector2(),\r\n *\tuvScale: new THREE.Vector2()\r\n * }\r\n */\r\n\r\nTHREE.SpriteMaterial = function ( parameters ) {\r\n\r\n\tTHREE.Material.call( this );\r\n\r\n\tthis.type = 'SpriteMaterial';\r\n\r\n\tthis.color = new THREE.Color( 0xffffff );\r\n\tthis.map = null;\r\n\r\n\tthis.rotation = 0;\r\n\r\n\tthis.fog = false;\r\n\tthis.lights = false;\r\n\r\n\tthis.setValues( parameters );\r\n\r\n};\r\n\r\nTHREE.SpriteMaterial.prototype = Object.create( THREE.Material.prototype );\r\nTHREE.SpriteMaterial.prototype.constructor = THREE.SpriteMaterial;\r\n\r\nTHREE.SpriteMaterial.prototype.copy = function ( source ) {\r\n\r\n\tTHREE.Material.prototype.copy.call( this, source );\r\n\r\n\tthis.color.copy( source.color );\r\n\tthis.map = source.map;\r\n\r\n\tthis.rotation = source.rotation;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n// File:src/materials/ShadowMaterial.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.ShadowMaterial = function () {\r\n\r\n\tTHREE.ShaderMaterial.call( this, {\r\n\t\tuniforms: THREE.UniformsUtils.merge( [\r\n\t\t\tTHREE.UniformsLib[ \"lights\" ],\r\n\t\t\t{\r\n\t\t\t\topacity: { value: 1.0 }\r\n\t\t\t}\r\n\t\t] ),\r\n\t\tvertexShader: THREE.ShaderChunk[ 'shadow_vert' ],\r\n\t\tfragmentShader: THREE.ShaderChunk[ 'shadow_frag' ]\r\n\t} );\r\n\r\n\tthis.lights = true;\r\n\tthis.transparent = true;\r\n\r\n\tObject.defineProperties( this, {\r\n\t\topacity: {\r\n\t\t\tenumerable: true,\r\n\t\t\tget: function () {\r\n\t\t\t\treturn this.uniforms.opacity.value;\r\n\t\t\t},\r\n\t\t\tset: function ( value ) {\r\n\t\t\t\tthis.uniforms.opacity.value = value;\r\n\t\t\t}\r\n\t\t}\r\n\t} );\r\n\r\n};\r\n\r\nTHREE.ShadowMaterial.prototype = Object.create( THREE.ShaderMaterial.prototype );\r\nTHREE.ShadowMaterial.prototype.constructor = THREE.ShadowMaterial;\r\n\r\n// File:src/textures/Texture.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author szimek / https://github.com/szimek/\r\n */\r\n\r\nTHREE.Texture = function ( image, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy, encoding ) {\r\n\r\n\tObject.defineProperty( this, 'id', { value: THREE.TextureIdCount ++ } );\r\n\r\n\tthis.uuid = THREE.Math.generateUUID();\r\n\r\n\tthis.name = '';\r\n\tthis.sourceFile = '';\r\n\r\n\tthis.image = image !== undefined ? image : THREE.Texture.DEFAULT_IMAGE;\r\n\tthis.mipmaps = [];\r\n\r\n\tthis.mapping = mapping !== undefined ? mapping : THREE.Texture.DEFAULT_MAPPING;\r\n\r\n\tthis.wrapS = wrapS !== undefined ? wrapS : THREE.ClampToEdgeWrapping;\r\n\tthis.wrapT = wrapT !== undefined ? wrapT : THREE.ClampToEdgeWrapping;\r\n\r\n\tthis.magFilter = magFilter !== undefined ? magFilter : THREE.LinearFilter;\r\n\tthis.minFilter = minFilter !== undefined ? minFilter : THREE.LinearMipMapLinearFilter;\r\n\r\n\tthis.anisotropy = anisotropy !== undefined ? anisotropy : 1;\r\n\r\n\tthis.format = format !== undefined ? format : THREE.RGBAFormat;\r\n\tthis.type = type !== undefined ? type : THREE.UnsignedByteType;\r\n\r\n\tthis.offset = new THREE.Vector2( 0, 0 );\r\n\tthis.repeat = new THREE.Vector2( 1, 1 );\r\n\r\n\tthis.generateMipmaps = true;\r\n\tthis.premultiplyAlpha = false;\r\n\tthis.flipY = true;\r\n\tthis.unpackAlignment = 4;\t// valid values: 1, 2, 4, 8 (see http://www.khronos.org/opengles/sdk/docs/man/xhtml/glPixelStorei.xml)\r\n\r\n\r\n\t// Values of encoding !== THREE.LinearEncoding only supported on map, envMap and emissiveMap.\r\n\t//\r\n\t// Also changing the encoding after already used by a Material will not automatically make the Material\r\n\t// update.  You need to explicitly call Material.needsUpdate to trigger it to recompile.\r\n\tthis.encoding = encoding !== undefined ? encoding :  THREE.LinearEncoding;\r\n\r\n\tthis.version = 0;\r\n\tthis.onUpdate = null;\r\n\r\n};\r\n\r\nTHREE.Texture.DEFAULT_IMAGE = undefined;\r\nTHREE.Texture.DEFAULT_MAPPING = THREE.UVMapping;\r\n\r\nTHREE.Texture.prototype = {\r\n\r\n\tconstructor: THREE.Texture,\r\n\r\n\tset needsUpdate( value ) {\r\n\r\n\t\tif ( value === true ) this.version ++;\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor().copy( this );\r\n\r\n\t},\r\n\r\n\tcopy: function ( source ) {\r\n\r\n\t\tthis.image = source.image;\r\n\t\tthis.mipmaps = source.mipmaps.slice( 0 );\r\n\r\n\t\tthis.mapping = source.mapping;\r\n\r\n\t\tthis.wrapS = source.wrapS;\r\n\t\tthis.wrapT = source.wrapT;\r\n\r\n\t\tthis.magFilter = source.magFilter;\r\n\t\tthis.minFilter = source.minFilter;\r\n\r\n\t\tthis.anisotropy = source.anisotropy;\r\n\r\n\t\tthis.format = source.format;\r\n\t\tthis.type = source.type;\r\n\r\n\t\tthis.offset.copy( source.offset );\r\n\t\tthis.repeat.copy( source.repeat );\r\n\r\n\t\tthis.generateMipmaps = source.generateMipmaps;\r\n\t\tthis.premultiplyAlpha = source.premultiplyAlpha;\r\n\t\tthis.flipY = source.flipY;\r\n\t\tthis.unpackAlignment = source.unpackAlignment;\r\n\t\tthis.encoding = source.encoding;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\ttoJSON: function ( meta ) {\r\n\r\n\t\tif ( meta.textures[ this.uuid ] !== undefined ) {\r\n\r\n\t\t\treturn meta.textures[ this.uuid ];\r\n\r\n\t\t}\r\n\r\n\t\tfunction getDataURL( image ) {\r\n\r\n\t\t\tvar canvas;\r\n\r\n\t\t\tif ( image.toDataURL !== undefined ) {\r\n\r\n\t\t\t\tcanvas = image;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tcanvas = document.createElement( 'canvas' );\r\n\t\t\t\tcanvas.width = image.width;\r\n\t\t\t\tcanvas.height = image.height;\r\n\r\n\t\t\t\tcanvas.getContext( '2d' ).drawImage( image, 0, 0, image.width, image.height );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( canvas.width > 2048 || canvas.height > 2048 ) {\r\n\r\n\t\t\t\treturn canvas.toDataURL( 'image/jpeg', 0.6 );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\treturn canvas.toDataURL( 'image/png' );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar output = {\r\n\t\t\tmetadata: {\r\n\t\t\t\tversion: 4.4,\r\n\t\t\t\ttype: 'Texture',\r\n\t\t\t\tgenerator: 'Texture.toJSON'\r\n\t\t\t},\r\n\r\n\t\t\tuuid: this.uuid,\r\n\t\t\tname: this.name,\r\n\r\n\t\t\tmapping: this.mapping,\r\n\r\n\t\t\trepeat: [ this.repeat.x, this.repeat.y ],\r\n\t\t\toffset: [ this.offset.x, this.offset.y ],\r\n\t\t\twrap: [ this.wrapS, this.wrapT ],\r\n\r\n\t\t\tminFilter: this.minFilter,\r\n\t\t\tmagFilter: this.magFilter,\r\n\t\t\tanisotropy: this.anisotropy\r\n\t\t};\r\n\r\n\t\tif ( this.image !== undefined ) {\r\n\r\n\t\t\t// TODO: Move to THREE.Image\r\n\r\n\t\t\tvar image = this.image;\r\n\r\n\t\t\tif ( image.uuid === undefined ) {\r\n\r\n\t\t\t\timage.uuid = THREE.Math.generateUUID(); // UGH\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( meta.images[ image.uuid ] === undefined ) {\r\n\r\n\t\t\t\tmeta.images[ image.uuid ] = {\r\n\t\t\t\t\tuuid: image.uuid,\r\n\t\t\t\t\turl: getDataURL( image )\r\n\t\t\t\t};\r\n\r\n\t\t\t}\r\n\r\n\t\t\toutput.image = image.uuid;\r\n\r\n\t\t}\r\n\r\n\t\tmeta.textures[ this.uuid ] = output;\r\n\r\n\t\treturn output;\r\n\r\n\t},\r\n\r\n\tdispose: function () {\r\n\r\n\t\tthis.dispatchEvent( { type: 'dispose' } );\r\n\r\n\t},\r\n\r\n\ttransformUv: function ( uv ) {\r\n\r\n\t\tif ( this.mapping !== THREE.UVMapping )  return;\r\n\r\n\t\tuv.multiply( this.repeat );\r\n\t\tuv.add( this.offset );\r\n\r\n\t\tif ( uv.x < 0 || uv.x > 1 ) {\r\n\r\n\t\t\tswitch ( this.wrapS ) {\r\n\r\n\t\t\t\tcase THREE.RepeatWrapping:\r\n\r\n\t\t\t\t\tuv.x = uv.x - Math.floor( uv.x );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase THREE.ClampToEdgeWrapping:\r\n\r\n\t\t\t\t\tuv.x = uv.x < 0 ? 0 : 1;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase THREE.MirroredRepeatWrapping:\r\n\r\n\t\t\t\t\tif ( Math.abs( Math.floor( uv.x ) % 2 ) === 1 ) {\r\n\r\n\t\t\t\t\t\tuv.x = Math.ceil( uv.x ) - uv.x;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tuv.x = uv.x - Math.floor( uv.x );\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( uv.y < 0 || uv.y > 1 ) {\r\n\r\n\t\t\tswitch ( this.wrapT ) {\r\n\r\n\t\t\t\tcase THREE.RepeatWrapping:\r\n\r\n\t\t\t\t\tuv.y = uv.y - Math.floor( uv.y );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase THREE.ClampToEdgeWrapping:\r\n\r\n\t\t\t\t\tuv.y = uv.y < 0 ? 0 : 1;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase THREE.MirroredRepeatWrapping:\r\n\r\n\t\t\t\t\tif ( Math.abs( Math.floor( uv.y ) % 2 ) === 1 ) {\r\n\r\n\t\t\t\t\t\tuv.y = Math.ceil( uv.y ) - uv.y;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tuv.y = uv.y - Math.floor( uv.y );\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.flipY ) {\r\n\r\n\t\t\tuv.y = 1 - uv.y;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\nObject.assign( THREE.Texture.prototype, THREE.EventDispatcher.prototype );\r\n\r\nTHREE.TextureIdCount = 0;\r\n\r\n// File:src/textures/DepthTexture.js\r\n\r\n/**\r\n * @author Matt DesLauriers / @mattdesl\r\n */\r\n\r\nTHREE.DepthTexture = function ( width, height, type, mapping, wrapS, wrapT, magFilter, minFilter, anisotropy ) {\r\n\r\n  THREE.Texture.call( this, null, mapping, wrapS, wrapT, magFilter, minFilter, THREE.DepthFormat, type, anisotropy );\r\n\r\n  this.image = { width: width, height: height };\r\n\r\n  this.type = type !== undefined ? type : THREE.UnsignedShortType;\r\n\r\n  this.magFilter = magFilter !== undefined ? magFilter : THREE.NearestFilter;\r\n  this.minFilter = minFilter !== undefined ? minFilter : THREE.NearestFilter;\r\n\r\n  this.flipY = false;\r\n  this.generateMipmaps  = false;\r\n\r\n};\r\n\r\nTHREE.DepthTexture.prototype = Object.create( THREE.Texture.prototype );\r\nTHREE.DepthTexture.prototype.constructor = THREE.DepthTexture;\r\n\r\n// File:src/textures/CanvasTexture.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.CanvasTexture = function ( canvas, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy ) {\r\n\r\n\tTHREE.Texture.call( this, canvas, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy );\r\n\r\n\tthis.needsUpdate = true;\r\n\r\n};\r\n\r\nTHREE.CanvasTexture.prototype = Object.create( THREE.Texture.prototype );\r\nTHREE.CanvasTexture.prototype.constructor = THREE.CanvasTexture;\r\n\r\n// File:src/textures/CubeTexture.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.CubeTexture = function ( images, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy, encoding ) {\r\n\r\n\timages = images !== undefined ? images : [];\r\n\tmapping = mapping !== undefined ? mapping : THREE.CubeReflectionMapping;\r\n\r\n\tTHREE.Texture.call( this, images, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy, encoding );\r\n\r\n\tthis.flipY = false;\r\n\r\n};\r\n\r\nTHREE.CubeTexture.prototype = Object.create( THREE.Texture.prototype );\r\nTHREE.CubeTexture.prototype.constructor = THREE.CubeTexture;\r\n\r\nObject.defineProperty( THREE.CubeTexture.prototype, 'images', {\r\n\r\n\tget: function () {\r\n\r\n\t\treturn this.image;\r\n\r\n\t},\r\n\r\n\tset: function ( value ) {\r\n\r\n\t\tthis.image = value;\r\n\r\n\t}\r\n\r\n} );\r\n\r\n// File:src/textures/CompressedTexture.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.CompressedTexture = function ( mipmaps, width, height, format, type, mapping, wrapS, wrapT, magFilter, minFilter, anisotropy, encoding ) {\r\n\r\n\tTHREE.Texture.call( this, null, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy, encoding );\r\n\r\n\tthis.image = { width: width, height: height };\r\n\tthis.mipmaps = mipmaps;\r\n\r\n\t// no flipping for cube textures\r\n\t// (also flipping doesn't work for compressed textures )\r\n\r\n\tthis.flipY = false;\r\n\r\n\t// can't generate mipmaps for compressed textures\r\n\t// mips must be embedded in DDS files\r\n\r\n\tthis.generateMipmaps = false;\r\n\r\n};\r\n\r\nTHREE.CompressedTexture.prototype = Object.create( THREE.Texture.prototype );\r\nTHREE.CompressedTexture.prototype.constructor = THREE.CompressedTexture;\r\n\r\n// File:src/textures/DataTexture.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.DataTexture = function ( data, width, height, format, type, mapping, wrapS, wrapT, magFilter, minFilter, anisotropy, encoding ) {\r\n\r\n\tTHREE.Texture.call( this, null, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy, encoding );\r\n\r\n\tthis.image = { data: data, width: width, height: height };\r\n\r\n\tthis.magFilter = magFilter !== undefined ? magFilter : THREE.NearestFilter;\r\n\tthis.minFilter = minFilter !== undefined ? minFilter : THREE.NearestFilter;\r\n\r\n\tthis.flipY = false;\r\n\tthis.generateMipmaps  = false;\r\n\r\n};\r\n\r\nTHREE.DataTexture.prototype = Object.create( THREE.Texture.prototype );\r\nTHREE.DataTexture.prototype.constructor = THREE.DataTexture;\r\n\r\n// File:src/textures/VideoTexture.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.VideoTexture = function ( video, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy ) {\r\n\r\n\tTHREE.Texture.call( this, video, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy );\r\n\r\n\tthis.generateMipmaps = false;\r\n\r\n\tvar scope = this;\r\n\r\n\tfunction update() {\r\n\r\n\t\trequestAnimationFrame( update );\r\n\r\n\t\tif ( video.readyState >= video.HAVE_CURRENT_DATA ) {\r\n\r\n\t\t\tscope.needsUpdate = true;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tupdate();\r\n\r\n};\r\n\r\nTHREE.VideoTexture.prototype = Object.create( THREE.Texture.prototype );\r\nTHREE.VideoTexture.prototype.constructor = THREE.VideoTexture;\r\n\r\n// File:src/objects/Group.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Group = function () {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.type = 'Group';\r\n\r\n};\r\n\r\nTHREE.Group.prototype = Object.assign( Object.create( THREE.Object3D.prototype ), {\r\n\r\n\tconstructor: THREE.Group\r\n\r\n} );\r\n\r\n// File:src/objects/Points.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Points = function ( geometry, material ) {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.type = 'Points';\r\n\r\n\tthis.geometry = geometry !== undefined ? geometry : new THREE.BufferGeometry();\r\n\tthis.material = material !== undefined ? material : new THREE.PointsMaterial( { color: Math.random() * 0xffffff } );\r\n\r\n};\r\n\r\nTHREE.Points.prototype = Object.assign( Object.create( THREE.Object3D.prototype ), {\r\n\r\n\tconstructor: THREE.Points,\r\n\r\n\traycast: ( function () {\r\n\r\n\t\tvar inverseMatrix = new THREE.Matrix4();\r\n\t\tvar ray = new THREE.Ray();\r\n\t\tvar sphere = new THREE.Sphere();\r\n\r\n\t\treturn function raycast( raycaster, intersects ) {\r\n\r\n\t\t\tvar object = this;\r\n\t\t\tvar geometry = this.geometry;\r\n\t\t\tvar matrixWorld = this.matrixWorld;\r\n\t\t\tvar threshold = raycaster.params.Points.threshold;\r\n\r\n\t\t\t// Checking boundingSphere distance to ray\r\n\r\n\t\t\tif ( geometry.boundingSphere === null ) geometry.computeBoundingSphere();\r\n\r\n\t\t\tsphere.copy( geometry.boundingSphere );\r\n\t\t\tsphere.applyMatrix4( matrixWorld );\r\n\r\n\t\t\tif ( raycaster.ray.intersectsSphere( sphere ) === false ) return;\r\n\r\n\t\t\t//\r\n\r\n\t\t\tinverseMatrix.getInverse( matrixWorld );\r\n\t\t\tray.copy( raycaster.ray ).applyMatrix4( inverseMatrix );\r\n\r\n\t\t\tvar localThreshold = threshold / ( ( this.scale.x + this.scale.y + this.scale.z ) / 3 );\r\n\t\t\tvar localThresholdSq = localThreshold * localThreshold;\r\n\t\t\tvar position = new THREE.Vector3();\r\n\r\n\t\t\tfunction testPoint( point, index ) {\r\n\r\n\t\t\t\tvar rayPointDistanceSq = ray.distanceSqToPoint( point );\r\n\r\n\t\t\t\tif ( rayPointDistanceSq < localThresholdSq ) {\r\n\r\n\t\t\t\t\tvar intersectPoint = ray.closestPointToPoint( point );\r\n\t\t\t\t\tintersectPoint.applyMatrix4( matrixWorld );\r\n\r\n\t\t\t\t\tvar distance = raycaster.ray.origin.distanceTo( intersectPoint );\r\n\r\n\t\t\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) return;\r\n\r\n\t\t\t\t\tintersects.push( {\r\n\r\n\t\t\t\t\t\tdistance: distance,\r\n\t\t\t\t\t\tdistanceToRay: Math.sqrt( rayPointDistanceSq ),\r\n\t\t\t\t\t\tpoint: intersectPoint.clone(),\r\n\t\t\t\t\t\tindex: index,\r\n\t\t\t\t\t\tface: null,\r\n\t\t\t\t\t\tobject: object\r\n\r\n\t\t\t\t\t} );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( geometry instanceof THREE.BufferGeometry ) {\r\n\r\n\t\t\t\tvar index = geometry.index;\r\n\t\t\t\tvar attributes = geometry.attributes;\r\n\t\t\t\tvar positions = attributes.position.array;\r\n\r\n\t\t\t\tif ( index !== null ) {\r\n\r\n\t\t\t\t\tvar indices = index.array;\r\n\r\n\t\t\t\t\tfor ( var i = 0, il = indices.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\t\tvar a = indices[ i ];\r\n\r\n\t\t\t\t\t\tposition.fromArray( positions, a * 3 );\r\n\r\n\t\t\t\t\t\ttestPoint( position, a );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tfor ( var i = 0, l = positions.length / 3; i < l; i ++ ) {\r\n\r\n\t\t\t\t\t\tposition.fromArray( positions, i * 3 );\r\n\r\n\t\t\t\t\t\ttestPoint( position, i );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tvar vertices = geometry.vertices;\r\n\r\n\t\t\t\tfor ( var i = 0, l = vertices.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\ttestPoint( vertices[ i ], i );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t}() ),\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor( this.geometry, this.material ).copy( this );\r\n\r\n\t}\r\n\r\n} );\r\n\r\n// File:src/objects/Line.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Line = function ( geometry, material, mode ) {\r\n\r\n\tif ( mode === 1 ) {\r\n\r\n\t\tconsole.warn( 'THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead.' );\r\n\t\treturn new THREE.LineSegments( geometry, material );\r\n\r\n\t}\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.type = 'Line';\r\n\r\n\tthis.geometry = geometry !== undefined ? geometry : new THREE.BufferGeometry();\r\n\tthis.material = material !== undefined ? material : new THREE.LineBasicMaterial( { color: Math.random() * 0xffffff } );\r\n\r\n};\r\n\r\nTHREE.Line.prototype = Object.assign( Object.create( THREE.Object3D.prototype ), {\r\n\r\n\tconstructor: THREE.Line,\r\n\r\n\traycast: ( function () {\r\n\r\n\t\tvar inverseMatrix = new THREE.Matrix4();\r\n\t\tvar ray = new THREE.Ray();\r\n\t\tvar sphere = new THREE.Sphere();\r\n\r\n\t\treturn function raycast( raycaster, intersects ) {\r\n\r\n\t\t\tvar precision = raycaster.linePrecision;\r\n\t\t\tvar precisionSq = precision * precision;\r\n\r\n\t\t\tvar geometry = this.geometry;\r\n\t\t\tvar matrixWorld = this.matrixWorld;\r\n\r\n\t\t\t// Checking boundingSphere distance to ray\r\n\r\n\t\t\tif ( geometry.boundingSphere === null ) geometry.computeBoundingSphere();\r\n\r\n\t\t\tsphere.copy( geometry.boundingSphere );\r\n\t\t\tsphere.applyMatrix4( matrixWorld );\r\n\r\n\t\t\tif ( raycaster.ray.intersectsSphere( sphere ) === false ) return;\r\n\r\n\t\t\t//\r\n\r\n\t\t\tinverseMatrix.getInverse( matrixWorld );\r\n\t\t\tray.copy( raycaster.ray ).applyMatrix4( inverseMatrix );\r\n\r\n\t\t\tvar vStart = new THREE.Vector3();\r\n\t\t\tvar vEnd = new THREE.Vector3();\r\n\t\t\tvar interSegment = new THREE.Vector3();\r\n\t\t\tvar interRay = new THREE.Vector3();\r\n\t\t\tvar step = this instanceof THREE.LineSegments ? 2 : 1;\r\n\r\n\t\t\tif ( geometry instanceof THREE.BufferGeometry ) {\r\n\r\n\t\t\t\tvar index = geometry.index;\r\n\t\t\t\tvar attributes = geometry.attributes;\r\n\t\t\t\tvar positions = attributes.position.array;\r\n\r\n\t\t\t\tif ( index !== null ) {\r\n\r\n\t\t\t\t\tvar indices = index.array;\r\n\r\n\t\t\t\t\tfor ( var i = 0, l = indices.length - 1; i < l; i += step ) {\r\n\r\n\t\t\t\t\t\tvar a = indices[ i ];\r\n\t\t\t\t\t\tvar b = indices[ i + 1 ];\r\n\r\n\t\t\t\t\t\tvStart.fromArray( positions, a * 3 );\r\n\t\t\t\t\t\tvEnd.fromArray( positions, b * 3 );\r\n\r\n\t\t\t\t\t\tvar distSq = ray.distanceSqToSegment( vStart, vEnd, interRay, interSegment );\r\n\r\n\t\t\t\t\t\tif ( distSq > precisionSq ) continue;\r\n\r\n\t\t\t\t\t\tinterRay.applyMatrix4( this.matrixWorld ); //Move back to world space for distance calculation\r\n\r\n\t\t\t\t\t\tvar distance = raycaster.ray.origin.distanceTo( interRay );\r\n\r\n\t\t\t\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) continue;\r\n\r\n\t\t\t\t\t\tintersects.push( {\r\n\r\n\t\t\t\t\t\t\tdistance: distance,\r\n\t\t\t\t\t\t\t// What do we want? intersection point on the ray or on the segment??\r\n\t\t\t\t\t\t\t// point: raycaster.ray.at( distance ),\r\n\t\t\t\t\t\t\tpoint: interSegment.clone().applyMatrix4( this.matrixWorld ),\r\n\t\t\t\t\t\t\tindex: i,\r\n\t\t\t\t\t\t\tface: null,\r\n\t\t\t\t\t\t\tfaceIndex: null,\r\n\t\t\t\t\t\t\tobject: this\r\n\r\n\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tfor ( var i = 0, l = positions.length / 3 - 1; i < l; i += step ) {\r\n\r\n\t\t\t\t\t\tvStart.fromArray( positions, 3 * i );\r\n\t\t\t\t\t\tvEnd.fromArray( positions, 3 * i + 3 );\r\n\r\n\t\t\t\t\t\tvar distSq = ray.distanceSqToSegment( vStart, vEnd, interRay, interSegment );\r\n\r\n\t\t\t\t\t\tif ( distSq > precisionSq ) continue;\r\n\r\n\t\t\t\t\t\tinterRay.applyMatrix4( this.matrixWorld ); //Move back to world space for distance calculation\r\n\r\n\t\t\t\t\t\tvar distance = raycaster.ray.origin.distanceTo( interRay );\r\n\r\n\t\t\t\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) continue;\r\n\r\n\t\t\t\t\t\tintersects.push( {\r\n\r\n\t\t\t\t\t\t\tdistance: distance,\r\n\t\t\t\t\t\t\t// What do we want? intersection point on the ray or on the segment??\r\n\t\t\t\t\t\t\t// point: raycaster.ray.at( distance ),\r\n\t\t\t\t\t\t\tpoint: interSegment.clone().applyMatrix4( this.matrixWorld ),\r\n\t\t\t\t\t\t\tindex: i,\r\n\t\t\t\t\t\t\tface: null,\r\n\t\t\t\t\t\t\tfaceIndex: null,\r\n\t\t\t\t\t\t\tobject: this\r\n\r\n\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( geometry instanceof THREE.Geometry ) {\r\n\r\n\t\t\t\tvar vertices = geometry.vertices;\r\n\t\t\t\tvar nbVertices = vertices.length;\r\n\r\n\t\t\t\tfor ( var i = 0; i < nbVertices - 1; i += step ) {\r\n\r\n\t\t\t\t\tvar distSq = ray.distanceSqToSegment( vertices[ i ], vertices[ i + 1 ], interRay, interSegment );\r\n\r\n\t\t\t\t\tif ( distSq > precisionSq ) continue;\r\n\r\n\t\t\t\t\tinterRay.applyMatrix4( this.matrixWorld ); //Move back to world space for distance calculation\r\n\r\n\t\t\t\t\tvar distance = raycaster.ray.origin.distanceTo( interRay );\r\n\r\n\t\t\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) continue;\r\n\r\n\t\t\t\t\tintersects.push( {\r\n\r\n\t\t\t\t\t\tdistance: distance,\r\n\t\t\t\t\t\t// What do we want? intersection point on the ray or on the segment??\r\n\t\t\t\t\t\t// point: raycaster.ray.at( distance ),\r\n\t\t\t\t\t\tpoint: interSegment.clone().applyMatrix4( this.matrixWorld ),\r\n\t\t\t\t\t\tindex: i,\r\n\t\t\t\t\t\tface: null,\r\n\t\t\t\t\t\tfaceIndex: null,\r\n\t\t\t\t\t\tobject: this\r\n\r\n\t\t\t\t\t} );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t}() ),\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor( this.geometry, this.material ).copy( this );\r\n\r\n\t}\r\n\r\n} );\r\n\r\n// File:src/objects/LineSegments.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.LineSegments = function ( geometry, material ) {\r\n\r\n\tTHREE.Line.call( this, geometry, material );\r\n\r\n\tthis.type = 'LineSegments';\r\n\r\n};\r\n\r\nTHREE.LineSegments.prototype = Object.assign( Object.create( THREE.Line.prototype ), {\r\n\r\n\tconstructor: THREE.LineSegments\r\n\r\n} );\r\n\r\n// File:src/objects/Mesh.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author jonobr1 / http://jonobr1.com/\r\n */\r\n\r\nTHREE.Mesh = function ( geometry, material ) {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.type = 'Mesh';\r\n\r\n\tthis.geometry = geometry !== undefined ? geometry : new THREE.BufferGeometry();\r\n\tthis.material = material !== undefined ? material : new THREE.MeshBasicMaterial( { color: Math.random() * 0xffffff } );\r\n\r\n\tthis.drawMode = THREE.TrianglesDrawMode;\r\n\r\n\tthis.updateMorphTargets();\r\n\r\n};\r\n\r\nTHREE.Mesh.prototype = Object.assign( Object.create( THREE.Object3D.prototype ), {\r\n\r\n\tconstructor: THREE.Mesh,\r\n\r\n\tsetDrawMode: function ( value ) {\r\n\r\n\t\tthis.drawMode = value;\r\n\r\n\t},\r\n\r\n\tupdateMorphTargets: function () {\r\n\r\n\t\tif ( this.geometry.morphTargets !== undefined && this.geometry.morphTargets.length > 0 ) {\r\n\r\n\t\t\tthis.morphTargetBase = - 1;\r\n\t\t\tthis.morphTargetInfluences = [];\r\n\t\t\tthis.morphTargetDictionary = {};\r\n\r\n\t\t\tfor ( var m = 0, ml = this.geometry.morphTargets.length; m < ml; m ++ ) {\r\n\r\n\t\t\t\tthis.morphTargetInfluences.push( 0 );\r\n\t\t\t\tthis.morphTargetDictionary[ this.geometry.morphTargets[ m ].name ] = m;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tgetMorphTargetIndexByName: function ( name ) {\r\n\r\n\t\tif ( this.morphTargetDictionary[ name ] !== undefined ) {\r\n\r\n\t\t\treturn this.morphTargetDictionary[ name ];\r\n\r\n\t\t}\r\n\r\n\t\tconsole.warn( 'THREE.Mesh.getMorphTargetIndexByName: morph target ' + name + ' does not exist. Returning 0.' );\r\n\r\n\t\treturn 0;\r\n\r\n\t},\r\n\r\n\traycast: ( function () {\r\n\r\n\t\tvar inverseMatrix = new THREE.Matrix4();\r\n\t\tvar ray = new THREE.Ray();\r\n\t\tvar sphere = new THREE.Sphere();\r\n\r\n\t\tvar vA = new THREE.Vector3();\r\n\t\tvar vB = new THREE.Vector3();\r\n\t\tvar vC = new THREE.Vector3();\r\n\r\n\t\tvar tempA = new THREE.Vector3();\r\n\t\tvar tempB = new THREE.Vector3();\r\n\t\tvar tempC = new THREE.Vector3();\r\n\r\n\t\tvar uvA = new THREE.Vector2();\r\n\t\tvar uvB = new THREE.Vector2();\r\n\t\tvar uvC = new THREE.Vector2();\r\n\r\n\t\tvar barycoord = new THREE.Vector3();\r\n\r\n\t\tvar intersectionPoint = new THREE.Vector3();\r\n\t\tvar intersectionPointWorld = new THREE.Vector3();\r\n\r\n\t\tfunction uvIntersection( point, p1, p2, p3, uv1, uv2, uv3 ) {\r\n\r\n\t\t\tTHREE.Triangle.barycoordFromPoint( point, p1, p2, p3, barycoord );\r\n\r\n\t\t\tuv1.multiplyScalar( barycoord.x );\r\n\t\t\tuv2.multiplyScalar( barycoord.y );\r\n\t\t\tuv3.multiplyScalar( barycoord.z );\r\n\r\n\t\t\tuv1.add( uv2 ).add( uv3 );\r\n\r\n\t\t\treturn uv1.clone();\r\n\r\n\t\t}\r\n\r\n\t\tfunction checkIntersection( object, raycaster, ray, pA, pB, pC, point ) {\r\n\r\n\t\t\tvar intersect;\r\n\t\t\tvar material = object.material;\r\n\r\n\t\t\tif ( material.side === THREE.BackSide ) {\r\n\r\n\t\t\t\tintersect = ray.intersectTriangle( pC, pB, pA, true, point );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tintersect = ray.intersectTriangle( pA, pB, pC, material.side !== THREE.DoubleSide, point );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( intersect === null ) return null;\r\n\r\n\t\t\tintersectionPointWorld.copy( point );\r\n\t\t\tintersectionPointWorld.applyMatrix4( object.matrixWorld );\r\n\r\n\t\t\tvar distance = raycaster.ray.origin.distanceTo( intersectionPointWorld );\r\n\r\n\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) return null;\r\n\r\n\t\t\treturn {\r\n\t\t\t\tdistance: distance,\r\n\t\t\t\tpoint: intersectionPointWorld.clone(),\r\n\t\t\t\tobject: object\r\n\t\t\t};\r\n\r\n\t\t}\r\n\r\n\t\tfunction checkBufferGeometryIntersection( object, raycaster, ray, positions, uvs, a, b, c ) {\r\n\r\n\t\t\tvA.fromArray( positions, a * 3 );\r\n\t\t\tvB.fromArray( positions, b * 3 );\r\n\t\t\tvC.fromArray( positions, c * 3 );\r\n\r\n\t\t\tvar intersection = checkIntersection( object, raycaster, ray, vA, vB, vC, intersectionPoint );\r\n\r\n\t\t\tif ( intersection ) {\r\n\r\n\t\t\t\tif ( uvs ) {\r\n\r\n\t\t\t\t\tuvA.fromArray( uvs, a * 2 );\r\n\t\t\t\t\tuvB.fromArray( uvs, b * 2 );\r\n\t\t\t\t\tuvC.fromArray( uvs, c * 2 );\r\n\r\n\t\t\t\t\tintersection.uv = uvIntersection( intersectionPoint,  vA, vB, vC,  uvA, uvB, uvC );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tintersection.face = new THREE.Face3( a, b, c, THREE.Triangle.normal( vA, vB, vC ) );\r\n\t\t\t\tintersection.faceIndex = a;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn intersection;\r\n\r\n\t\t}\r\n\r\n\t\treturn function raycast( raycaster, intersects ) {\r\n\r\n\t\t\tvar geometry = this.geometry;\r\n\t\t\tvar material = this.material;\r\n\t\t\tvar matrixWorld = this.matrixWorld;\r\n\r\n\t\t\tif ( material === undefined ) return;\r\n\r\n\t\t\t// Checking boundingSphere distance to ray\r\n\r\n\t\t\tif ( geometry.boundingSphere === null ) geometry.computeBoundingSphere();\r\n\r\n\t\t\tsphere.copy( geometry.boundingSphere );\r\n\t\t\tsphere.applyMatrix4( matrixWorld );\r\n\r\n\t\t\tif ( raycaster.ray.intersectsSphere( sphere ) === false ) return;\r\n\r\n\t\t\t//\r\n\r\n\t\t\tinverseMatrix.getInverse( matrixWorld );\r\n\t\t\tray.copy( raycaster.ray ).applyMatrix4( inverseMatrix );\r\n\r\n\t\t\t// Check boundingBox before continuing\r\n\r\n\t\t\tif ( geometry.boundingBox !== null ) {\r\n\r\n\t\t\t\tif ( ray.intersectsBox( geometry.boundingBox ) === false ) return;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar uvs, intersection;\r\n\r\n\t\t\tif ( geometry instanceof THREE.BufferGeometry ) {\r\n\r\n\t\t\t\tvar a, b, c;\r\n\t\t\t\tvar index = geometry.index;\r\n\t\t\t\tvar attributes = geometry.attributes;\r\n\t\t\t\tvar positions = attributes.position.array;\r\n\r\n\t\t\t\tif ( attributes.uv !== undefined ) {\r\n\r\n\t\t\t\t\tuvs = attributes.uv.array;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( index !== null ) {\r\n\r\n\t\t\t\t\tvar indices = index.array;\r\n\r\n\t\t\t\t\tfor ( var i = 0, l = indices.length; i < l; i += 3 ) {\r\n\r\n\t\t\t\t\t\ta = indices[ i ];\r\n\t\t\t\t\t\tb = indices[ i + 1 ];\r\n\t\t\t\t\t\tc = indices[ i + 2 ];\r\n\r\n\t\t\t\t\t\tintersection = checkBufferGeometryIntersection( this, raycaster, ray, positions, uvs, a, b, c );\r\n\r\n\t\t\t\t\t\tif ( intersection ) {\r\n\r\n\t\t\t\t\t\t\tintersection.faceIndex = Math.floor( i / 3 ); // triangle number in indices buffer semantics\r\n\t\t\t\t\t\t\tintersects.push( intersection );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\r\n\t\t\t\t\tfor ( var i = 0, l = positions.length; i < l; i += 9 ) {\r\n\r\n\t\t\t\t\t\ta = i / 3;\r\n\t\t\t\t\t\tb = a + 1;\r\n\t\t\t\t\t\tc = a + 2;\r\n\r\n\t\t\t\t\t\tintersection = checkBufferGeometryIntersection( this, raycaster, ray, positions, uvs, a, b, c );\r\n\r\n\t\t\t\t\t\tif ( intersection ) {\r\n\r\n\t\t\t\t\t\t\tintersection.index = a; // triangle number in positions buffer semantics\r\n\t\t\t\t\t\t\tintersects.push( intersection );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( geometry instanceof THREE.Geometry ) {\r\n\r\n\t\t\t\tvar fvA, fvB, fvC;\r\n\t\t\t\tvar isFaceMaterial = material instanceof THREE.MultiMaterial;\r\n\t\t\t\tvar materials = isFaceMaterial === true ? material.materials : null;\r\n\r\n\t\t\t\tvar vertices = geometry.vertices;\r\n\t\t\t\tvar faces = geometry.faces;\r\n\t\t\t\tvar faceVertexUvs = geometry.faceVertexUvs[ 0 ];\r\n\t\t\t\tif ( faceVertexUvs.length > 0 ) uvs = faceVertexUvs;\r\n\r\n\t\t\t\tfor ( var f = 0, fl = faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\t\tvar face = faces[ f ];\r\n\t\t\t\t\tvar faceMaterial = isFaceMaterial === true ? materials[ face.materialIndex ] : material;\r\n\r\n\t\t\t\t\tif ( faceMaterial === undefined ) continue;\r\n\r\n\t\t\t\t\tfvA = vertices[ face.a ];\r\n\t\t\t\t\tfvB = vertices[ face.b ];\r\n\t\t\t\t\tfvC = vertices[ face.c ];\r\n\r\n\t\t\t\t\tif ( faceMaterial.morphTargets === true ) {\r\n\r\n\t\t\t\t\t\tvar morphTargets = geometry.morphTargets;\r\n\t\t\t\t\t\tvar morphInfluences = this.morphTargetInfluences;\r\n\r\n\t\t\t\t\t\tvA.set( 0, 0, 0 );\r\n\t\t\t\t\t\tvB.set( 0, 0, 0 );\r\n\t\t\t\t\t\tvC.set( 0, 0, 0 );\r\n\r\n\t\t\t\t\t\tfor ( var t = 0, tl = morphTargets.length; t < tl; t ++ ) {\r\n\r\n\t\t\t\t\t\t\tvar influence = morphInfluences[ t ];\r\n\r\n\t\t\t\t\t\t\tif ( influence === 0 ) continue;\r\n\r\n\t\t\t\t\t\t\tvar targets = morphTargets[ t ].vertices;\r\n\r\n\t\t\t\t\t\t\tvA.addScaledVector( tempA.subVectors( targets[ face.a ], fvA ), influence );\r\n\t\t\t\t\t\t\tvB.addScaledVector( tempB.subVectors( targets[ face.b ], fvB ), influence );\r\n\t\t\t\t\t\t\tvC.addScaledVector( tempC.subVectors( targets[ face.c ], fvC ), influence );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tvA.add( fvA );\r\n\t\t\t\t\t\tvB.add( fvB );\r\n\t\t\t\t\t\tvC.add( fvC );\r\n\r\n\t\t\t\t\t\tfvA = vA;\r\n\t\t\t\t\t\tfvB = vB;\r\n\t\t\t\t\t\tfvC = vC;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tintersection = checkIntersection( this, raycaster, ray, fvA, fvB, fvC, intersectionPoint );\r\n\r\n\t\t\t\t\tif ( intersection ) {\r\n\r\n\t\t\t\t\t\tif ( uvs ) {\r\n\r\n\t\t\t\t\t\t\tvar uvs_f = uvs[ f ];\r\n\t\t\t\t\t\t\tuvA.copy( uvs_f[ 0 ] );\r\n\t\t\t\t\t\t\tuvB.copy( uvs_f[ 1 ] );\r\n\t\t\t\t\t\t\tuvC.copy( uvs_f[ 2 ] );\r\n\r\n\t\t\t\t\t\t\tintersection.uv = uvIntersection( intersectionPoint, fvA, fvB, fvC, uvA, uvB, uvC );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tintersection.face = face;\r\n\t\t\t\t\t\tintersection.faceIndex = f;\r\n\t\t\t\t\t\tintersects.push( intersection );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t}() ),\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor( this.geometry, this.material ).copy( this );\r\n\r\n\t}\r\n\r\n} );\r\n\r\n// File:src/objects/Bone.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author ikerr / http://verold.com\r\n */\r\n\r\nTHREE.Bone = function ( skin ) {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.type = 'Bone';\r\n\r\n\tthis.skin = skin;\r\n\r\n};\r\n\r\nTHREE.Bone.prototype = Object.assign( Object.create( THREE.Object3D.prototype ), {\r\n\r\n\tconstructor: THREE.Bone,\r\n\r\n\tcopy: function ( source ) {\r\n\r\n\t\tTHREE.Object3D.prototype.copy.call( this, source );\r\n\r\n\t\tthis.skin = source.skin;\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n} );\r\n\r\n// File:src/objects/Skeleton.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author michael guerrero / http://realitymeltdown.com\r\n * @author ikerr / http://verold.com\r\n */\r\n\r\nTHREE.Skeleton = function ( bones, boneInverses, useVertexTexture ) {\r\n\r\n\tthis.useVertexTexture = useVertexTexture !== undefined ? useVertexTexture : true;\r\n\r\n\tthis.identityMatrix = new THREE.Matrix4();\r\n\r\n\t// copy the bone array\r\n\r\n\tbones = bones || [];\r\n\r\n\tthis.bones = bones.slice( 0 );\r\n\r\n\t// create a bone texture or an array of floats\r\n\r\n\tif ( this.useVertexTexture ) {\r\n\r\n\t\t// layout (1 matrix = 4 pixels)\r\n\t\t//      RGBA RGBA RGBA RGBA (=> column1, column2, column3, column4)\r\n\t\t//  with  8x8  pixel texture max   16 bones * 4 pixels =  (8 * 8)\r\n\t\t//       16x16 pixel texture max   64 bones * 4 pixels = (16 * 16)\r\n\t\t//       32x32 pixel texture max  256 bones * 4 pixels = (32 * 32)\r\n\t\t//       64x64 pixel texture max 1024 bones * 4 pixels = (64 * 64)\r\n\r\n\r\n\t\tvar size = Math.sqrt( this.bones.length * 4 ); // 4 pixels needed for 1 matrix\r\n\t\tsize = THREE.Math.nextPowerOfTwo( Math.ceil( size ) );\r\n\t\tsize = Math.max( size, 4 );\r\n\r\n\t\tthis.boneTextureWidth = size;\r\n\t\tthis.boneTextureHeight = size;\r\n\r\n\t\tthis.boneMatrices = new Float32Array( this.boneTextureWidth * this.boneTextureHeight * 4 ); // 4 floats per RGBA pixel\r\n\t\tthis.boneTexture = new THREE.DataTexture( this.boneMatrices, this.boneTextureWidth, this.boneTextureHeight, THREE.RGBAFormat, THREE.FloatType );\r\n\r\n\t} else {\r\n\r\n\t\tthis.boneMatrices = new Float32Array( 16 * this.bones.length );\r\n\r\n\t}\r\n\r\n\t// use the supplied bone inverses or calculate the inverses\r\n\r\n\tif ( boneInverses === undefined ) {\r\n\r\n\t\tthis.calculateInverses();\r\n\r\n\t} else {\r\n\r\n\t\tif ( this.bones.length === boneInverses.length ) {\r\n\r\n\t\t\tthis.boneInverses = boneInverses.slice( 0 );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tconsole.warn( 'THREE.Skeleton bonInverses is the wrong length.' );\r\n\r\n\t\t\tthis.boneInverses = [];\r\n\r\n\t\t\tfor ( var b = 0, bl = this.bones.length; b < bl; b ++ ) {\r\n\r\n\t\t\t\tthis.boneInverses.push( new THREE.Matrix4() );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\nObject.assign( THREE.Skeleton.prototype, {\r\n\r\n\tcalculateInverses: function () {\r\n\r\n\t\tthis.boneInverses = [];\r\n\r\n\t\tfor ( var b = 0, bl = this.bones.length; b < bl; b ++ ) {\r\n\r\n\t\t\tvar inverse = new THREE.Matrix4();\r\n\r\n\t\t\tif ( this.bones[ b ] ) {\r\n\r\n\t\t\t\tinverse.getInverse( this.bones[ b ].matrixWorld );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.boneInverses.push( inverse );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tpose: function () {\r\n\r\n\t\tvar bone;\r\n\r\n\t\t// recover the bind-time world matrices\r\n\r\n\t\tfor ( var b = 0, bl = this.bones.length; b < bl; b ++ ) {\r\n\r\n\t\t\tbone = this.bones[ b ];\r\n\r\n\t\t\tif ( bone ) {\r\n\r\n\t\t\t\tbone.matrixWorld.getInverse( this.boneInverses[ b ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// compute the local matrices, positions, rotations and scales\r\n\r\n\t\tfor ( var b = 0, bl = this.bones.length; b < bl; b ++ ) {\r\n\r\n\t\t\tbone = this.bones[ b ];\r\n\r\n\t\t\tif ( bone ) {\r\n\r\n\t\t\t\tif ( bone.parent ) {\r\n\r\n\t\t\t\t\tbone.matrix.getInverse( bone.parent.matrixWorld );\r\n\t\t\t\t\tbone.matrix.multiply( bone.matrixWorld );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tbone.matrix.copy( bone.matrixWorld );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tbone.matrix.decompose( bone.position, bone.quaternion, bone.scale );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tupdate: ( function () {\r\n\r\n\t\tvar offsetMatrix = new THREE.Matrix4();\r\n\r\n\t\treturn function update() {\r\n\r\n\t\t\t// flatten bone matrices to array\r\n\r\n\t\t\tfor ( var b = 0, bl = this.bones.length; b < bl; b ++ ) {\r\n\r\n\t\t\t\t// compute the offset between the current and the original transform\r\n\r\n\t\t\t\tvar matrix = this.bones[ b ] ? this.bones[ b ].matrixWorld : this.identityMatrix;\r\n\r\n\t\t\t\toffsetMatrix.multiplyMatrices( matrix, this.boneInverses[ b ] );\r\n\t\t\t\toffsetMatrix.toArray( this.boneMatrices, b * 16 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( this.useVertexTexture ) {\r\n\r\n\t\t\t\tthis.boneTexture.needsUpdate = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t} )(),\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new THREE.Skeleton( this.bones, this.boneInverses, this.useVertexTexture );\r\n\r\n\t}\r\n\r\n} );\r\n\r\n// File:src/objects/SkinnedMesh.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author ikerr / http://verold.com\r\n */\r\n\r\nTHREE.SkinnedMesh = function ( geometry, material, useVertexTexture ) {\r\n\r\n\tTHREE.Mesh.call( this, geometry, material );\r\n\r\n\tthis.type = 'SkinnedMesh';\r\n\r\n\tthis.bindMode = \"attached\";\r\n\tthis.bindMatrix = new THREE.Matrix4();\r\n\tthis.bindMatrixInverse = new THREE.Matrix4();\r\n\r\n\t// init bones\r\n\r\n\t// TODO: remove bone creation as there is no reason (other than\r\n\t// convenience) for THREE.SkinnedMesh to do this.\r\n\r\n\tvar bones = [];\r\n\r\n\tif ( this.geometry && this.geometry.bones !== undefined ) {\r\n\r\n\t\tvar bone, gbone;\r\n\r\n\t\tfor ( var b = 0, bl = this.geometry.bones.length; b < bl; ++ b ) {\r\n\r\n\t\t\tgbone = this.geometry.bones[ b ];\r\n\r\n\t\t\tbone = new THREE.Bone( this );\r\n\t\t\tbones.push( bone );\r\n\r\n\t\t\tbone.name = gbone.name;\r\n\t\t\tbone.position.fromArray( gbone.pos );\r\n\t\t\tbone.quaternion.fromArray( gbone.rotq );\r\n\t\t\tif ( gbone.scl !== undefined ) bone.scale.fromArray( gbone.scl );\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var b = 0, bl = this.geometry.bones.length; b < bl; ++ b ) {\r\n\r\n\t\t\tgbone = this.geometry.bones[ b ];\r\n\r\n\t\t\tif ( gbone.parent !== - 1 && gbone.parent !== null &&\r\n\t\t\t\t\tbones[ gbone.parent ] !== undefined ) {\r\n\r\n\t\t\t\tbones[ gbone.parent ].add( bones[ b ] );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis.add( bones[ b ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tthis.normalizeSkinWeights();\r\n\r\n\tthis.updateMatrixWorld( true );\r\n\tthis.bind( new THREE.Skeleton( bones, undefined, useVertexTexture ), this.matrixWorld );\r\n\r\n};\r\n\r\n\r\nTHREE.SkinnedMesh.prototype = Object.assign( Object.create( THREE.Mesh.prototype ), {\r\n\r\n\tconstructor: THREE.SkinnedMesh,\r\n\r\n\tbind: function( skeleton, bindMatrix ) {\r\n\r\n\t\tthis.skeleton = skeleton;\r\n\r\n\t\tif ( bindMatrix === undefined ) {\r\n\r\n\t\t\tthis.updateMatrixWorld( true );\r\n\r\n\t\t\tthis.skeleton.calculateInverses();\r\n\r\n\t\t\tbindMatrix = this.matrixWorld;\r\n\r\n\t\t}\r\n\r\n\t\tthis.bindMatrix.copy( bindMatrix );\r\n\t\tthis.bindMatrixInverse.getInverse( bindMatrix );\r\n\r\n\t},\r\n\r\n\tpose: function () {\r\n\r\n\t\tthis.skeleton.pose();\r\n\r\n\t},\r\n\r\n\tnormalizeSkinWeights: function () {\r\n\r\n\t\tif ( this.geometry instanceof THREE.Geometry ) {\r\n\r\n\t\t\tfor ( var i = 0; i < this.geometry.skinWeights.length; i ++ ) {\r\n\r\n\t\t\t\tvar sw = this.geometry.skinWeights[ i ];\r\n\r\n\t\t\t\tvar scale = 1.0 / sw.lengthManhattan();\r\n\r\n\t\t\t\tif ( scale !== Infinity ) {\r\n\r\n\t\t\t\t\tsw.multiplyScalar( scale );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tsw.set( 1, 0, 0, 0 ); // do something reasonable\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( this.geometry instanceof THREE.BufferGeometry ) {\r\n\r\n\t\t\tvar vec = new THREE.Vector4();\r\n\r\n\t\t\tvar skinWeight = this.geometry.attributes.skinWeight;\r\n\r\n\t\t\tfor ( var i = 0; i < skinWeight.count; i ++ ) {\r\n\r\n\t\t\t\tvec.x = skinWeight.getX( i );\r\n\t\t\t\tvec.y = skinWeight.getY( i );\r\n\t\t\t\tvec.z = skinWeight.getZ( i );\r\n\t\t\t\tvec.w = skinWeight.getW( i );\r\n\r\n\t\t\t\tvar scale = 1.0 / vec.lengthManhattan();\r\n\r\n\t\t\t\tif ( scale !== Infinity ) {\r\n\r\n\t\t\t\t\tvec.multiplyScalar( scale );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tvec.set( 1, 0, 0, 0 ); // do something reasonable\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tskinWeight.setXYZW( i, vec.x, vec.y, vec.z, vec.w );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tupdateMatrixWorld: function( force ) {\r\n\r\n\t\tTHREE.Mesh.prototype.updateMatrixWorld.call( this, true );\r\n\r\n\t\tif ( this.bindMode === \"attached\" ) {\r\n\r\n\t\t\tthis.bindMatrixInverse.getInverse( this.matrixWorld );\r\n\r\n\t\t} else if ( this.bindMode === \"detached\" ) {\r\n\r\n\t\t\tthis.bindMatrixInverse.getInverse( this.bindMatrix );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tconsole.warn( 'THREE.SkinnedMesh unrecognized bindMode: ' + this.bindMode );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tclone: function() {\r\n\r\n\t\treturn new this.constructor( this.geometry, this.material, this.useVertexTexture ).copy( this );\r\n\r\n\t}\r\n\r\n} );\r\n\r\n// File:src/objects/LOD.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.LOD = function () {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.type = 'LOD';\r\n\r\n\tObject.defineProperties( this, {\r\n\t\tlevels: {\r\n\t\t\tenumerable: true,\r\n\t\t\tvalue: []\r\n\t\t}\r\n\t} );\r\n\r\n};\r\n\r\n\r\nTHREE.LOD.prototype = Object.assign( Object.create( THREE.Object3D.prototype ), {\r\n\r\n\tconstructor: THREE.LOD,\r\n\r\n\tcopy: function ( source ) {\r\n\r\n\t\tTHREE.Object3D.prototype.copy.call( this, source, false );\r\n\r\n\t\tvar levels = source.levels;\r\n\r\n\t\tfor ( var i = 0, l = levels.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar level = levels[ i ];\r\n\r\n\t\t\tthis.addLevel( level.object.clone(), level.distance );\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\taddLevel: function ( object, distance ) {\r\n\r\n\t\tif ( distance === undefined ) distance = 0;\r\n\r\n\t\tdistance = Math.abs( distance );\r\n\r\n\t\tvar levels = this.levels;\r\n\r\n\t\tfor ( var l = 0; l < levels.length; l ++ ) {\r\n\r\n\t\t\tif ( distance < levels[ l ].distance ) {\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tlevels.splice( l, 0, { distance: distance, object: object } );\r\n\r\n\t\tthis.add( object );\r\n\r\n\t},\r\n\r\n\tgetObjectForDistance: function ( distance ) {\r\n\r\n\t\tvar levels = this.levels;\r\n\r\n\t\tfor ( var i = 1, l = levels.length; i < l; i ++ ) {\r\n\r\n\t\t\tif ( distance < levels[ i ].distance ) {\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn levels[ i - 1 ].object;\r\n\r\n\t},\r\n\r\n\traycast: ( function () {\r\n\r\n\t\tvar matrixPosition = new THREE.Vector3();\r\n\r\n\t\treturn function raycast( raycaster, intersects ) {\r\n\r\n\t\t\tmatrixPosition.setFromMatrixPosition( this.matrixWorld );\r\n\r\n\t\t\tvar distance = raycaster.ray.origin.distanceTo( matrixPosition );\r\n\r\n\t\t\tthis.getObjectForDistance( distance ).raycast( raycaster, intersects );\r\n\r\n\t\t};\r\n\r\n\t}() ),\r\n\r\n\tupdate: function () {\r\n\r\n\t\tvar v1 = new THREE.Vector3();\r\n\t\tvar v2 = new THREE.Vector3();\r\n\r\n\t\treturn function update( camera ) {\r\n\r\n\t\t\tvar levels = this.levels;\r\n\r\n\t\t\tif ( levels.length > 1 ) {\r\n\r\n\t\t\t\tv1.setFromMatrixPosition( camera.matrixWorld );\r\n\t\t\t\tv2.setFromMatrixPosition( this.matrixWorld );\r\n\r\n\t\t\t\tvar distance = v1.distanceTo( v2 );\r\n\r\n\t\t\t\tlevels[ 0 ].object.visible = true;\r\n\r\n\t\t\t\tfor ( var i = 1, l = levels.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\tif ( distance >= levels[ i ].distance ) {\r\n\r\n\t\t\t\t\t\tlevels[ i - 1 ].object.visible = false;\r\n\t\t\t\t\t\tlevels[ i ].object.visible = true;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor ( ; i < l; i ++ ) {\r\n\r\n\t\t\t\t\tlevels[ i ].object.visible = false;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\ttoJSON: function ( meta ) {\r\n\r\n\t\tvar data = THREE.Object3D.prototype.toJSON.call( this, meta );\r\n\r\n\t\tdata.object.levels = [];\r\n\r\n\t\tvar levels = this.levels;\r\n\r\n\t\tfor ( var i = 0, l = levels.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar level = levels[ i ];\r\n\r\n\t\t\tdata.object.levels.push( {\r\n\t\t\t\tobject: level.object.uuid,\r\n\t\t\t\tdistance: level.distance\r\n\t\t\t} );\r\n\r\n\t\t}\r\n\r\n\t\treturn data;\r\n\r\n\t}\r\n\r\n} );\r\n\r\n// File:src/objects/Sprite.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Sprite = function ( material ) {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.type = 'Sprite';\r\n\r\n\tthis.material = ( material !== undefined ) ? material : new THREE.SpriteMaterial();\r\n\r\n};\r\n\r\nTHREE.Sprite.prototype = Object.assign( Object.create( THREE.Object3D.prototype ), {\r\n\r\n\tconstructor: THREE.Sprite,\r\n\r\n\traycast: ( function () {\r\n\r\n\t\tvar matrixPosition = new THREE.Vector3();\r\n\r\n\t\treturn function raycast( raycaster, intersects ) {\r\n\r\n\t\t\tmatrixPosition.setFromMatrixPosition( this.matrixWorld );\r\n\r\n\t\t\tvar distanceSq = raycaster.ray.distanceSqToPoint( matrixPosition );\r\n\t\t\tvar guessSizeSq = this.scale.x * this.scale.y / 4;\r\n\r\n\t\t\tif ( distanceSq > guessSizeSq ) {\r\n\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tintersects.push( {\r\n\r\n\t\t\t\tdistance: Math.sqrt( distanceSq ),\r\n\t\t\t\tpoint: this.position,\r\n\t\t\t\tface: null,\r\n\t\t\t\tobject: this\r\n\r\n\t\t\t} );\r\n\r\n\t\t};\r\n\r\n\t}() ),\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor( this.material ).copy( this );\r\n\r\n\t}\r\n\r\n} );\r\n\r\n// File:src/objects/LensFlare.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.LensFlare = function ( texture, size, distance, blending, color ) {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.lensFlares = [];\r\n\r\n\tthis.positionScreen = new THREE.Vector3();\r\n\tthis.customUpdateCallback = undefined;\r\n\r\n\tif ( texture !== undefined ) {\r\n\r\n\t\tthis.add( texture, size, distance, blending, color );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.LensFlare.prototype = Object.assign( Object.create( THREE.Object3D.prototype ), {\r\n\r\n\tconstructor: THREE.LensFlare,\r\n\r\n\tcopy: function ( source ) {\r\n\r\n\t\tTHREE.Object3D.prototype.copy.call( this, source );\r\n\r\n\t\tthis.positionScreen.copy( source.positionScreen );\r\n\t\tthis.customUpdateCallback = source.customUpdateCallback;\r\n\r\n\t\tfor ( var i = 0, l = source.lensFlares.length; i < l; i ++ ) {\r\n\r\n\t\t\tthis.lensFlares.push( source.lensFlares[ i ] );\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tadd: function ( texture, size, distance, blending, color, opacity ) {\r\n\r\n\t\tif ( size === undefined ) size = - 1;\r\n\t\tif ( distance === undefined ) distance = 0;\r\n\t\tif ( opacity === undefined ) opacity = 1;\r\n\t\tif ( color === undefined ) color = new THREE.Color( 0xffffff );\r\n\t\tif ( blending === undefined ) blending = THREE.NormalBlending;\r\n\r\n\t\tdistance = Math.min( distance, Math.max( 0, distance ) );\r\n\r\n\t\tthis.lensFlares.push( {\r\n\t\t\ttexture: texture,\t// THREE.Texture\r\n\t\t\tsize: size, \t\t// size in pixels (-1 = use texture.width)\r\n\t\t\tdistance: distance, \t// distance (0-1) from light source (0=at light source)\r\n\t\t\tx: 0, y: 0, z: 0,\t// screen position (-1 => 1) z = 0 is in front z = 1 is back\r\n\t\t\tscale: 1, \t\t// scale\r\n\t\t\trotation: 0, \t\t// rotation\r\n\t\t\topacity: opacity,\t// opacity\r\n\t\t\tcolor: color,\t\t// color\r\n\t\t\tblending: blending\t// blending\r\n\t\t} );\r\n\r\n\t},\r\n\r\n\t/*\r\n\t * Update lens flares update positions on all flares based on the screen position\r\n\t * Set myLensFlare.customUpdateCallback to alter the flares in your project specific way.\r\n\t */\r\n\r\n\tupdateLensFlares: function () {\r\n\r\n\t\tvar f, fl = this.lensFlares.length;\r\n\t\tvar flare;\r\n\t\tvar vecX = - this.positionScreen.x * 2;\r\n\t\tvar vecY = - this.positionScreen.y * 2;\r\n\r\n\t\tfor ( f = 0; f < fl; f ++ ) {\r\n\r\n\t\t\tflare = this.lensFlares[ f ];\r\n\r\n\t\t\tflare.x = this.positionScreen.x + vecX * flare.distance;\r\n\t\t\tflare.y = this.positionScreen.y + vecY * flare.distance;\r\n\r\n\t\t\tflare.wantedRotation = flare.x * Math.PI * 0.25;\r\n\t\t\tflare.rotation += ( flare.wantedRotation - flare.rotation ) * 0.25;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n} );\r\n\r\n// File:src/scenes/Scene.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Scene = function () {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.type = 'Scene';\r\n\r\n\tthis.fog = null;\r\n\tthis.overrideMaterial = null;\r\n\r\n\tthis.autoUpdate = true; // checked by the renderer\r\n\r\n};\r\n\r\nTHREE.Scene.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.Scene.prototype.constructor = THREE.Scene;\r\n\r\nTHREE.Scene.prototype.copy = function ( source, recursive ) {\r\n\r\n\tTHREE.Object3D.prototype.copy.call( this, source, recursive );\r\n\r\n\tif ( source.fog !== null ) this.fog = source.fog.clone();\r\n\tif ( source.overrideMaterial !== null ) this.overrideMaterial = source.overrideMaterial.clone();\r\n\r\n\tthis.autoUpdate = source.autoUpdate;\r\n\tthis.matrixAutoUpdate = source.matrixAutoUpdate;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n// File:src/scenes/Fog.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.Fog = function ( color, near, far ) {\r\n\r\n\tthis.name = '';\r\n\r\n\tthis.color = new THREE.Color( color );\r\n\r\n\tthis.near = ( near !== undefined ) ? near : 1;\r\n\tthis.far = ( far !== undefined ) ? far : 1000;\r\n\r\n};\r\n\r\nTHREE.Fog.prototype.clone = function () {\r\n\r\n\treturn new THREE.Fog( this.color.getHex(), this.near, this.far );\r\n\r\n};\r\n\r\n// File:src/scenes/FogExp2.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.FogExp2 = function ( color, density ) {\r\n\r\n\tthis.name = '';\r\n\r\n\tthis.color = new THREE.Color( color );\r\n\tthis.density = ( density !== undefined ) ? density : 0.00025;\r\n\r\n};\r\n\r\nTHREE.FogExp2.prototype.clone = function () {\r\n\r\n\treturn new THREE.FogExp2( this.color.getHex(), this.density );\r\n\r\n};\r\n\r\n// File:src/renderers/shaders/ShaderChunk.js\r\n\r\nTHREE.ShaderChunk = {};\r\n\r\n// File:src/renderers/shaders/ShaderChunk/alphamap_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'alphamap_fragment' ] = \"#ifdef USE_ALPHAMAP\\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/alphamap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'alphamap_pars_fragment' ] = \"#ifdef USE_ALPHAMAP\\n\tuniform sampler2D alphaMap;\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/alphatest_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'alphatest_fragment' ] = \"#ifdef ALPHATEST\\n\tif ( diffuseColor.a < ALPHATEST ) discard;\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/aomap_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'aomap_fragment' ] = \"#ifdef USE_AOMAP\\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\\n\t#endif\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/aomap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'aomap_pars_fragment' ] = \"#ifdef USE_AOMAP\\n\tuniform sampler2D aoMap;\\n\tuniform float aoMapIntensity;\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/begin_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'begin_vertex' ] = \"\\nvec3 transformed = vec3( position );\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/beginnormal_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'beginnormal_vertex' ] = \"\\nvec3 objectNormal = vec3( normal );\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/bsdfs.glsl\r\n\r\nTHREE.ShaderChunk[ 'bsdfs' ] = \"bool testLightInRange( const in float lightDistance, const in float cutoffDistance ) {\\n\treturn any( bvec2( cutoffDistance == 0.0, lightDistance < cutoffDistance ) );\\n}\\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\\n\t\tif( decayExponent > 0.0 ) {\\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\\n\t\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\\n\t\t\tfloat maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\\n\t\t\treturn distanceFalloff * maxDistanceCutoffFactor;\\n#else\\n\t\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\\n#endif\\n\t\t}\\n\t\treturn 1.0;\\n}\\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\\n\treturn RECIPROCAL_PI * diffuseColor;\\n}\\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\\n}\\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\\n\tfloat a2 = pow2( alpha );\\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\\n\treturn 1.0 / ( gl * gv );\\n}\\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\\n\tfloat a2 = pow2( alpha );\\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\\n\treturn 0.5 / max( gv + gl, EPSILON );\\n}\\nfloat D_GGX( const in float alpha, const in float dotNH ) {\\n\tfloat a2 = pow2( alpha );\\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\\n}\\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\\n\tfloat alpha = pow2( roughness );\\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\\n\tvec3 F = F_Schlick( specularColor, dotLH );\\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\\n\tfloat D = D_GGX( alpha, dotNH );\\n\treturn F * ( G * D );\\n}\\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\\n\tvec4 r = roughness * c0 + c1;\\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\\n\treturn specularColor * AB.x + AB.y;\\n}\\nfloat G_BlinnPhong_Implicit( ) {\\n\treturn 0.25;\\n}\\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\\n}\\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\\n\tvec3 F = F_Schlick( specularColor, dotLH );\\n\tfloat G = G_BlinnPhong_Implicit( );\\n\tfloat D = D_BlinnPhong( shininess, dotNH );\\n\treturn F * ( G * D );\\n}\\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\\n}\\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/bumpmap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'bumpmap_pars_fragment' ] = \"#ifdef USE_BUMPMAP\\n\tuniform sampler2D bumpMap;\\n\tuniform float bumpScale;\\n\tvec2 dHdxy_fwd() {\\n\t\tvec2 dSTdx = dFdx( vUv );\\n\t\tvec2 dSTdy = dFdy( vUv );\\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\\n\t\treturn vec2( dBx, dBy );\\n\t}\\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\\n\t\tvec3 vSigmaX = dFdx( surf_pos );\\n\t\tvec3 vSigmaY = dFdy( surf_pos );\\n\t\tvec3 vN = surf_norm;\\n\t\tvec3 R1 = cross( vSigmaY, vN );\\n\t\tvec3 R2 = cross( vN, vSigmaX );\\n\t\tfloat fDet = dot( vSigmaX, R1 );\\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\\n\t}\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/clipping_planes_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'clipping_planes_fragment' ] = \"#if NUM_CLIPPING_PLANES > 0\\n\tfor ( int i = 0; i < NUM_CLIPPING_PLANES; ++ i ) {\\n\t\tvec4 plane = clippingPlanes[ i ];\\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\\n\t}\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/clipping_planes_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'clipping_planes_pars_fragment' ] = \"#if NUM_CLIPPING_PLANES > 0\\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG )\\n\t\tvarying vec3 vViewPosition;\\n\t#endif\\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/clipping_planes_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'clipping_planes_pars_vertex' ] = \"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\\n\tvarying vec3 vViewPosition;\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/clipping_planes_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'clipping_planes_vertex' ] = \"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\\n\tvViewPosition = - mvPosition.xyz;\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/color_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'color_fragment' ] = \"#ifdef USE_COLOR\\n\tdiffuseColor.rgb *= vColor;\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/color_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'color_pars_fragment' ] = \"#ifdef USE_COLOR\\n\tvarying vec3 vColor;\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/color_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'color_pars_vertex' ] = \"#ifdef USE_COLOR\\n\tvarying vec3 vColor;\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/color_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'color_vertex' ] = \"#ifdef USE_COLOR\\n\tvColor.xyz = color.xyz;\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/common.glsl\r\n\r\nTHREE.ShaderChunk[ 'common' ] = \"#define PI 3.14159265359\\n#define PI2 6.28318530718\\n#define RECIPROCAL_PI 0.31830988618\\n#define RECIPROCAL_PI2 0.15915494\\n#define LOG2 1.442695\\n#define EPSILON 1e-6\\n#define saturate(a) clamp( a, 0.0, 1.0 )\\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\\nfloat pow2( const in float x ) { return x*x; }\\nfloat pow3( const in float x ) { return x*x*x; }\\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\\nhighp float rand( const in vec2 uv ) {\\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\\n\treturn fract(sin(sn) * c);\\n}\\nstruct IncidentLight {\\n\tvec3 color;\\n\tvec3 direction;\\n\tbool visible;\\n};\\nstruct ReflectedLight {\\n\tvec3 directDiffuse;\\n\tvec3 directSpecular;\\n\tvec3 indirectDiffuse;\\n\tvec3 indirectSpecular;\\n};\\nstruct GeometricContext {\\n\tvec3 position;\\n\tvec3 normal;\\n\tvec3 viewDir;\\n};\\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\\n}\\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\\n}\\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\\n\treturn - distance * planeNormal + point;\\n}\\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\\n}\\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/cube_uv_reflection_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'cube_uv_reflection_fragment' ] = \"#ifdef ENVMAP_TYPE_CUBE_UV\\n#define cubeUV_textureSize (1024.0)\\nint getFaceFromDirection(vec3 direction) {\\n\tvec3 absDirection = abs(direction);\\n\tint face = -1;\\n\tif( absDirection.x > absDirection.z ) {\\n\t\tif(absDirection.x > absDirection.y )\\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\\n\t\telse\\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\\n\t}\\n\telse {\\n\t\tif(absDirection.z > absDirection.y )\\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\\n\t\telse\\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\\n\t}\\n\treturn face;\\n}\\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\\n\tfloat dxRoughness = dFdx(roughness);\\n\tfloat dyRoughness = dFdy(roughness);\\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\\n\tfloat mipLevel = 0.5 * log2(d);\\n\treturn vec2(floor(mipLevel), fract(mipLevel));\\n}\\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\\n\tbool bRes = mipLevel == 0.0;\\n\tscale =  bRes && (scale < a) ? a : scale;\\n\tvec3 r;\\n\tvec2 offset;\\n\tint face = getFaceFromDirection(direction);\\n\tfloat rcpPowScale = 1.0 / powScale;\\n\tif( face == 0) {\\n\t\tr = vec3(direction.x, -direction.z, direction.y);\\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  a : offset.y;\\n\t}\\n\telse if( face == 1) {\\n\t\tr = vec3(direction.y, direction.x, direction.z);\\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  a : offset.y;\\n\t}\\n\telse if( face == 2) {\\n\t\tr = vec3(direction.z, direction.x, direction.y);\\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  a : offset.y;\\n\t}\\n\telse if( face == 3) {\\n\t\tr = vec3(direction.x, direction.z, direction.y);\\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  0.0 : offset.y;\\n\t}\\n\telse if( face == 4) {\\n\t\tr = vec3(direction.y, direction.x, -direction.z);\\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  0.0 : offset.y;\\n\t}\\n\telse {\\n\t\tr = vec3(direction.z, -direction.x, direction.y);\\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  0.0 : offset.y;\\n\t}\\n\tr = normalize(r);\\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\\n\tvec2 base = offset + vec2( texelOffset );\\n\treturn base + s * ( scale - 2.0 * texelOffset );\\n}\\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\\nvec4 textureCubeUV(vec3 reflectedDirection, float roughness ) {\\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\\n\tfloat r1 = floor(roughnessVal);\\n\tfloat r2 = r1 + 1.0;\\n\tfloat t = fract(roughnessVal);\\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\\n\tfloat s = mipInfo.y;\\n\tfloat level0 = mipInfo.x;\\n\tfloat level1 = level0 + 1.0;\\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\\n\tvec4 result = mix(color10, color20, t);\\n\treturn vec4(result.rgb, 1.0);\\n}\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/defaultnormal_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'defaultnormal_vertex' ] = \"#ifdef FLIP_SIDED\\n\tobjectNormal = -objectNormal;\\n#endif\\nvec3 transformedNormal = normalMatrix * objectNormal;\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/displacementmap_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'displacementmap_vertex' ] = \"#ifdef USE_DISPLACEMENTMAP\\n\ttransformed += normal * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/displacementmap_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'displacementmap_pars_vertex' ] = \"#ifdef USE_DISPLACEMENTMAP\\n\tuniform sampler2D displacementMap;\\n\tuniform float displacementScale;\\n\tuniform float displacementBias;\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/emissivemap_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'emissivemap_fragment' ] = \"#ifdef USE_EMISSIVEMAP\\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/emissivemap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'emissivemap_pars_fragment' ] = \"#ifdef USE_EMISSIVEMAP\\n\tuniform sampler2D emissiveMap;\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/encodings_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'encodings_pars_fragment' ] = \"\\nvec4 LinearToLinear( in vec4 value ) {\\n  return value;\\n}\\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\\n  return vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\\n}\\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\\n  return vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\\n}\\nvec4 sRGBToLinear( in vec4 value ) {\\n  return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\\n}\\nvec4 LinearTosRGB( in vec4 value ) {\\n  return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\\n}\\nvec4 RGBEToLinear( in vec4 value ) {\\n  return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\\n}\\nvec4 LinearToRGBE( in vec4 value ) {\\n  float maxComponent = max( max( value.r, value.g ), value.b );\\n  float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\\n  return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\\n}\\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\\n  return vec4( value.xyz * value.w * maxRange, 1.0 );\\n}\\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\\n  float maxRGB = max( value.x, max( value.g, value.b ) );\\n  float M      = clamp( maxRGB / maxRange, 0.0, 1.0 );\\n  M            = ceil( M * 255.0 ) / 255.0;\\n  return vec4( value.rgb / ( M * maxRange ), M );\\n}\\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\\n    return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\\n}\\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\\n    float maxRGB = max( value.x, max( value.g, value.b ) );\\n    float D      = max( maxRange / maxRGB, 1.0 );\\n    D            = min( floor( D ) / 255.0, 1.0 );\\n    return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\\n}\\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\\nvec4 LinearToLogLuv( in vec4 value )  {\\n  vec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\\n  Xp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\\n  vec4 vResult;\\n  vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\\n  float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\\n  vResult.w = fract(Le);\\n  vResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\\n  return vResult;\\n}\\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\\nvec4 LogLuvToLinear( in vec4 value ) {\\n  float Le = value.z * 255.0 + value.w;\\n  vec3 Xp_Y_XYZp;\\n  Xp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\\n  Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\\n  Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\\n  vec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\\n  return vec4( max(vRGB, 0.0), 1.0 );\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/encodings_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'encodings_fragment' ] = \"  gl_FragColor = linearToOutputTexel( gl_FragColor );\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/envmap_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'envmap_fragment' ] = \"#ifdef USE_ENVMAP\\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\\n\t\t#ifdef ENVMAP_MODE_REFLECTION\\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\\n\t\t#else\\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\\n\t\t#endif\\n\t#else\\n\t\tvec3 reflectVec = vReflect;\\n\t#endif\\n\t#ifdef DOUBLE_SIDED\\n\t\tfloat flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\\n\t#else\\n\t\tfloat flipNormal = 1.0;\\n\t#endif\\n\t#ifdef ENVMAP_TYPE_CUBE\\n\t\tvec4 envColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\\n\t\tvec2 sampleUV;\\n\t\tsampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\\n\t\tsampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\\n\t#elif defined( ENVMAP_TYPE_SPHERE )\\n\t\tvec3 reflectView = flipNormal * normalize((viewMatrix * vec4( reflectVec, 0.0 )).xyz + vec3(0.0,0.0,1.0));\\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\\n\t#endif\\n\tenvColor = envMapTexelToLinear( envColor );\\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\\n\t#elif defined( ENVMAP_BLENDING_MIX )\\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\\n\t#elif defined( ENVMAP_BLENDING_ADD )\\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\\n\t#endif\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/envmap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'envmap_pars_fragment' ] = \"#if defined( USE_ENVMAP ) || defined( PHYSICAL )\\n\tuniform float reflectivity;\\n\tuniform float envMapIntenstiy;\\n#endif\\n#ifdef USE_ENVMAP\\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\\n\t\tvarying vec3 vWorldPosition;\\n\t#endif\\n\t#ifdef ENVMAP_TYPE_CUBE\\n\t\tuniform samplerCube envMap;\\n\t#else\\n\t\tuniform sampler2D envMap;\\n\t#endif\\n\tuniform float flipEnvMap;\\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\\n\t\tuniform float refractionRatio;\\n\t#else\\n\t\tvarying vec3 vReflect;\\n\t#endif\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/envmap_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'envmap_pars_vertex' ] = \"#ifdef USE_ENVMAP\\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\\n\t\tvarying vec3 vWorldPosition;\\n\t#else\\n\t\tvarying vec3 vReflect;\\n\t\tuniform float refractionRatio;\\n\t#endif\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/envmap_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'envmap_vertex' ] = \"#ifdef USE_ENVMAP\\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\\n\t\tvWorldPosition = worldPosition.xyz;\\n\t#else\\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\\n\t\t#ifdef ENVMAP_MODE_REFLECTION\\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\\n\t\t#else\\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\\n\t\t#endif\\n\t#endif\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/fog_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'fog_fragment' ] = \"#ifdef USE_FOG\\n\t#ifdef USE_LOGDEPTHBUF_EXT\\n\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\\n\t#else\\n\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\\n\t#endif\\n\t#ifdef FOG_EXP2\\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * depth * depth * LOG2 ) );\\n\t#else\\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, depth );\\n\t#endif\\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/fog_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'fog_pars_fragment' ] = \"#ifdef USE_FOG\\n\tuniform vec3 fogColor;\\n\t#ifdef FOG_EXP2\\n\t\tuniform float fogDensity;\\n\t#else\\n\t\tuniform float fogNear;\\n\t\tuniform float fogFar;\\n\t#endif\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lightmap_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'lightmap_fragment' ] = \"#ifdef USE_LIGHTMAP\\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lightmap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'lightmap_pars_fragment' ] = \"#ifdef USE_LIGHTMAP\\n\tuniform sampler2D lightMap;\\n\tuniform float lightMapIntensity;\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lights_lambert_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'lights_lambert_vertex' ] = \"vec3 diffuse = vec3( 1.0 );\\nGeometricContext geometry;\\ngeometry.position = mvPosition.xyz;\\ngeometry.normal = normalize( transformedNormal );\\ngeometry.viewDir = normalize( -mvPosition.xyz );\\nGeometricContext backGeometry;\\nbackGeometry.position = geometry.position;\\nbackGeometry.normal = -geometry.normal;\\nbackGeometry.viewDir = geometry.viewDir;\\nvLightFront = vec3( 0.0 );\\n#ifdef DOUBLE_SIDED\\n\tvLightBack = vec3( 0.0 );\\n#endif\\nIncidentLight directLight;\\nfloat dotNL;\\nvec3 directLightColor_Diffuse;\\n#if NUM_POINT_LIGHTS > 0\\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\\n\t\tdotNL = dot( geometry.normal, directLight.direction );\\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\\n\t\t#ifdef DOUBLE_SIDED\\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\\n\t\t#endif\\n\t}\\n#endif\\n#if NUM_SPOT_LIGHTS > 0\\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\\n\t\tdotNL = dot( geometry.normal, directLight.direction );\\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\\n\t\t#ifdef DOUBLE_SIDED\\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\\n\t\t#endif\\n\t}\\n#endif\\n#if NUM_DIR_LIGHTS > 0\\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\\n\t\tdotNL = dot( geometry.normal, directLight.direction );\\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\\n\t\t#ifdef DOUBLE_SIDED\\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\\n\t\t#endif\\n\t}\\n#endif\\n#if NUM_HEMI_LIGHTS > 0\\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\\n\t\t#ifdef DOUBLE_SIDED\\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\\n\t\t#endif\\n\t}\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lights_pars.glsl\r\n\r\nTHREE.ShaderChunk[ 'lights_pars' ] = \"uniform vec3 ambientLightColor;\\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\\n\tvec3 irradiance = ambientLightColor;\\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\\n\t\tirradiance *= PI;\\n\t#endif\\n\treturn irradiance;\\n}\\n#if NUM_DIR_LIGHTS > 0\\n\tstruct DirectionalLight {\\n\t\tvec3 direction;\\n\t\tvec3 color;\\n\t\tint shadow;\\n\t\tfloat shadowBias;\\n\t\tfloat shadowRadius;\\n\t\tvec2 shadowMapSize;\\n\t};\\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\\n\t\tdirectLight.color = directionalLight.color;\\n\t\tdirectLight.direction = directionalLight.direction;\\n\t\tdirectLight.visible = true;\\n\t}\\n#endif\\n#if NUM_POINT_LIGHTS > 0\\n\tstruct PointLight {\\n\t\tvec3 position;\\n\t\tvec3 color;\\n\t\tfloat distance;\\n\t\tfloat decay;\\n\t\tint shadow;\\n\t\tfloat shadowBias;\\n\t\tfloat shadowRadius;\\n\t\tvec2 shadowMapSize;\\n\t};\\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\\n\t\tvec3 lVector = pointLight.position - geometry.position;\\n\t\tdirectLight.direction = normalize( lVector );\\n\t\tfloat lightDistance = length( lVector );\\n\t\tif ( testLightInRange( lightDistance, pointLight.distance ) ) {\\n\t\t\tdirectLight.color = pointLight.color;\\n\t\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\\n\t\t\tdirectLight.visible = true;\\n\t\t} else {\\n\t\t\tdirectLight.color = vec3( 0.0 );\\n\t\t\tdirectLight.visible = false;\\n\t\t}\\n\t}\\n#endif\\n#if NUM_SPOT_LIGHTS > 0\\n\tstruct SpotLight {\\n\t\tvec3 position;\\n\t\tvec3 direction;\\n\t\tvec3 color;\\n\t\tfloat distance;\\n\t\tfloat decay;\\n\t\tfloat coneCos;\\n\t\tfloat penumbraCos;\\n\t\tint shadow;\\n\t\tfloat shadowBias;\\n\t\tfloat shadowRadius;\\n\t\tvec2 shadowMapSize;\\n\t};\\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\\n\t\tvec3 lVector = spotLight.position - geometry.position;\\n\t\tdirectLight.direction = normalize( lVector );\\n\t\tfloat lightDistance = length( lVector );\\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\\n\t\tif ( all( bvec2( angleCos > spotLight.coneCos, testLightInRange( lightDistance, spotLight.distance ) ) ) ) {\\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\\n\t\t\tdirectLight.color = spotLight.color;\\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\\n\t\t\tdirectLight.visible = true;\\n\t\t} else {\\n\t\t\tdirectLight.color = vec3( 0.0 );\\n\t\t\tdirectLight.visible = false;\\n\t\t}\\n\t}\\n#endif\\n#if NUM_HEMI_LIGHTS > 0\\n\tstruct HemisphereLight {\\n\t\tvec3 direction;\\n\t\tvec3 skyColor;\\n\t\tvec3 groundColor;\\n\t};\\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\\n\t\t\tirradiance *= PI;\\n\t\t#endif\\n\t\treturn irradiance;\\n\t}\\n#endif\\n#if defined( USE_ENVMAP ) && defined( PHYSICAL )\\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\\n\t\t#ifdef DOUBLE_SIDED\\n\t\t\tfloat flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\\n\t\t#else\\n\t\t\tfloat flipNormal = 1.0;\\n\t\t#endif\\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\\n\t\t#ifdef ENVMAP_TYPE_CUBE\\n\t\t\tvec3 queryVec = flipNormal * vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\\n\t\t\t#ifdef TEXTURE_LOD_EXT\\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\\n\t\t\t#else\\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\\n\t\t\t#endif\\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\\n\t\t\tvec3 queryVec = flipNormal * vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\\n\t\t\tvec4 envMapColor = textureCubeUV( queryVec, 1.0 );\\n\t\t#else\\n\t\t\tvec4 envMapColor = vec4( 0.0 );\\n\t\t#endif\\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\\n\t}\\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar - 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\\n\t}\\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\\n\t\t#ifdef ENVMAP_MODE_REFLECTION\\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\\n\t\t#else\\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\\n\t\t#endif\\n\t\t#ifdef DOUBLE_SIDED\\n\t\t\tfloat flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\\n\t\t#else\\n\t\t\tfloat flipNormal = 1.0;\\n\t\t#endif\\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\\n\t\t#ifdef ENVMAP_TYPE_CUBE\\n\t\t\tvec3 queryReflectVec = flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\\n\t\t\t#ifdef TEXTURE_LOD_EXT\\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\\n\t\t\t#else\\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\\n\t\t\t#endif\\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\\n\t\t\tvec3 queryReflectVec = flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\\n\t\t\tvec4 envMapColor = textureCubeUV(queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent));\\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\\n\t\t\tvec2 sampleUV;\\n\t\t\tsampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\\n\t\t\tsampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\\n\t\t\t#ifdef TEXTURE_LOD_EXT\\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\\n\t\t\t#else\\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\\n\t\t\t#endif\\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\\n\t\t\tvec3 reflectView = flipNormal * normalize((viewMatrix * vec4( reflectVec, 0.0 )).xyz + vec3(0.0,0.0,1.0));\\n\t\t\t#ifdef TEXTURE_LOD_EXT\\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\\n\t\t\t#else\\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\\n\t\t\t#endif\\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\\n\t\t#endif\\n\t\treturn envMapColor.rgb * envMapIntensity;\\n\t}\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lights_phong_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'lights_phong_fragment' ] = \"BlinnPhongMaterial material;\\nmaterial.diffuseColor = diffuseColor.rgb;\\nmaterial.specularColor = specular;\\nmaterial.specularShininess = shininess;\\nmaterial.specularStrength = specularStrength;\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lights_phong_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'lights_phong_pars_fragment' ] = \"varying vec3 vViewPosition;\\n#ifndef FLAT_SHADED\\n\tvarying vec3 vNormal;\\n#endif\\nstruct BlinnPhongMaterial {\\n\tvec3\tdiffuseColor;\\n\tvec3\tspecularColor;\\n\tfloat\tspecularShininess;\\n\tfloat\tspecularStrength;\\n};\\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\\n\tvec3 irradiance = dotNL * directLight.color;\\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\\n\t\tirradiance *= PI;\\n\t#endif\\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\\n}\\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\\n}\\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\\n#define Material_LightProbeLOD( material )\t(0)\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lights_physical_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'lights_physical_fragment' ] = \"PhysicalMaterial material;\\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\\n#ifdef STANDARD\\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\\n#else\\n\tmaterial.specularColor = mix( vec3( 0.16 * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lights_physical_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'lights_physical_pars_fragment' ] = \"struct PhysicalMaterial {\\n\tvec3\tdiffuseColor;\\n\tfloat\tspecularRoughness;\\n\tvec3\tspecularColor;\\n\t#ifndef STANDARD\\n\t#endif\\n};\\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\\n\tvec3 irradiance = dotNL * directLight.color;\\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\\n\t\tirradiance *= PI;\\n\t#endif\\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\\n}\\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\\n}\\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\\n\treflectedLight.indirectSpecular += radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\\n}\\n#define RE_Direct\t\t\t\tRE_Direct_Physical\\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/lights_template.glsl\r\n\r\nTHREE.ShaderChunk[ 'lights_template' ] = \"\\nGeometricContext geometry;\\ngeometry.position = - vViewPosition;\\ngeometry.normal = normal;\\ngeometry.viewDir = normalize( vViewPosition );\\nIncidentLight directLight;\\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\\n\tPointLight pointLight;\\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\\n\t\tpointLight = pointLights[ i ];\\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\\n\t\t#ifdef USE_SHADOWMAP\\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ] ) : 1.0;\\n\t\t#endif\\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\\n\t}\\n#endif\\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\\n\tSpotLight spotLight;\\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\\n\t\tspotLight = spotLights[ i ];\\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\\n\t\t#ifdef USE_SHADOWMAP\\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\\n\t\t#endif\\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\\n\t}\\n#endif\\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\\n\tDirectionalLight directionalLight;\\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\\n\t\tdirectionalLight = directionalLights[ i ];\\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\\n\t\t#ifdef USE_SHADOWMAP\\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\\n\t\t#endif\\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\\n\t}\\n#endif\\n#if defined( RE_IndirectDiffuse )\\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\\n\t#ifdef USE_LIGHTMAP\\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\\n\t\t\tlightMapIrradiance *= PI;\\n\t\t#endif\\n\t\tirradiance += lightMapIrradiance;\\n\t#endif\\n\t#if ( NUM_HEMI_LIGHTS > 0 )\\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\\n\t\t}\\n\t#endif\\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\\n\t \tirradiance += getLightProbeIndirectIrradiance( geometry, 8 );\\n\t#endif\\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\\n#endif\\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\\n\tvec3 radiance = getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), 8 );\\n\tRE_IndirectSpecular( radiance, geometry, material, reflectedLight );\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/logdepthbuf_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'logdepthbuf_fragment' ] = \"#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\\n\tgl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/logdepthbuf_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'logdepthbuf_pars_fragment' ] = \"#ifdef USE_LOGDEPTHBUF\\n\tuniform float logDepthBufFC;\\n\t#ifdef USE_LOGDEPTHBUF_EXT\\n\t\tvarying float vFragDepth;\\n\t#endif\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/logdepthbuf_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'logdepthbuf_pars_vertex' ] = \"#ifdef USE_LOGDEPTHBUF\\n\t#ifdef USE_LOGDEPTHBUF_EXT\\n\t\tvarying float vFragDepth;\\n\t#endif\\n\tuniform float logDepthBufFC;\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/logdepthbuf_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'logdepthbuf_vertex' ] = \"#ifdef USE_LOGDEPTHBUF\\n\tgl_Position.z = log2(max( EPSILON, gl_Position.w + 1.0 )) * logDepthBufFC;\\n\t#ifdef USE_LOGDEPTHBUF_EXT\\n\t\tvFragDepth = 1.0 + gl_Position.w;\\n\t#else\\n\t\tgl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\\n\t#endif\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/map_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'map_fragment' ] = \"#ifdef USE_MAP\\n\tvec4 texelColor = texture2D( map, vUv );\\n\ttexelColor = mapTexelToLinear( texelColor );\\n\tdiffuseColor *= texelColor;\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/map_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'map_pars_fragment' ] = \"#ifdef USE_MAP\\n\tuniform sampler2D map;\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/map_particle_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'map_particle_fragment' ] = \"#ifdef USE_MAP\\n\tvec4 mapTexel = texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) * offsetRepeat.zw + offsetRepeat.xy );\\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/map_particle_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'map_particle_pars_fragment' ] = \"#ifdef USE_MAP\\n\tuniform vec4 offsetRepeat;\\n\tuniform sampler2D map;\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/metalnessmap_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'metalnessmap_fragment' ] = \"float metalnessFactor = metalness;\\n#ifdef USE_METALNESSMAP\\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\\n\tmetalnessFactor *= texelMetalness.r;\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/metalnessmap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'metalnessmap_pars_fragment' ] = \"#ifdef USE_METALNESSMAP\\n\tuniform sampler2D metalnessMap;\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/morphnormal_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'morphnormal_vertex' ] = \"#ifdef USE_MORPHNORMALS\\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/morphtarget_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'morphtarget_pars_vertex' ] = \"#ifdef USE_MORPHTARGETS\\n\t#ifndef USE_MORPHNORMALS\\n\tuniform float morphTargetInfluences[ 8 ];\\n\t#else\\n\tuniform float morphTargetInfluences[ 4 ];\\n\t#endif\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/morphtarget_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'morphtarget_vertex' ] = \"#ifdef USE_MORPHTARGETS\\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\\n\t#ifndef USE_MORPHNORMALS\\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\\n\t#endif\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/normal_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'normal_fragment' ] = \"#ifdef FLAT_SHADED\\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\\n\tvec3 normal = normalize( cross( fdx, fdy ) );\\n#else\\n\tvec3 normal = normalize( vNormal );\\n\t#ifdef DOUBLE_SIDED\\n\t\tnormal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\\n\t#endif\\n#endif\\n#ifdef USE_NORMALMAP\\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\\n#elif defined( USE_BUMPMAP )\\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/normalmap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'normalmap_pars_fragment' ] = \"#ifdef USE_NORMALMAP\\n\tuniform sampler2D normalMap;\\n\tuniform vec2 normalScale;\\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\\n\t\tvec2 st0 = dFdx( vUv.st );\\n\t\tvec2 st1 = dFdy( vUv.st );\\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\\n\t\tvec3 N = normalize( surf_norm );\\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\\n\t\tmapN.xy = normalScale * mapN.xy;\\n\t\tmat3 tsn = mat3( S, T, N );\\n\t\treturn normalize( tsn * mapN );\\n\t}\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/packing.glsl\r\n\r\nTHREE.ShaderChunk[ 'packing' ] = \"vec3 packNormalToRGB( const in vec3 normal ) {\\n  return normalize( normal ) * 0.5 + 0.5;\\n}\\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\\n  return 1.0 - 2.0 * rgb.xyz;\\n}\\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\\nconst float ShiftRight8 = 1. / 256.;\\nvec4 packDepthToRGBA( const in float v ) {\\n\tvec4 r = vec4( fract( v * PackFactors ), v );\\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\\n}\\nfloat unpackRGBAToDepth( const in vec4 v ) {\\n\treturn dot( v, UnpackFactors );\\n}\\nfloat viewZToOrthoDepth( const in float viewZ, const in float near, const in float far ) {\\n  return ( viewZ + near ) / ( near - far );\\n}\\nfloat OrthoDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\\n  return linearClipZ * ( near - far ) - near;\\n}\\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\\n  return (( near + viewZ ) * far ) / (( far - near ) * viewZ );\\n}\\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\\n  return ( near * far ) / ( ( far - near ) * invClipZ - far );\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/premultiplied_alpha_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'premultiplied_alpha_fragment' ] = \"#ifdef PREMULTIPLIED_ALPHA\\n\tgl_FragColor.rgb *= gl_FragColor.a;\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/project_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'project_vertex' ] = \"#ifdef USE_SKINNING\\n\tvec4 mvPosition = modelViewMatrix * skinned;\\n#else\\n\tvec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\\n#endif\\ngl_Position = projectionMatrix * mvPosition;\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/roughnessmap_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'roughnessmap_fragment' ] = \"float roughnessFactor = roughness;\\n#ifdef USE_ROUGHNESSMAP\\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\\n\troughnessFactor *= texelRoughness.r;\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/roughnessmap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'roughnessmap_pars_fragment' ] = \"#ifdef USE_ROUGHNESSMAP\\n\tuniform sampler2D roughnessMap;\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/shadowmap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'shadowmap_pars_fragment' ] = \"#ifdef USE_SHADOWMAP\\n\t#if NUM_DIR_LIGHTS > 0\\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\\n\t#endif\\n\t#if NUM_SPOT_LIGHTS > 0\\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\\n\t#endif\\n\t#if NUM_POINT_LIGHTS > 0\\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\\n\t#endif\\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\\n\t}\\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\\n\t\tvec2 f = fract( uv * size + 0.5 );\\n\t\tfloat a = mix( lb, lt, f.y );\\n\t\tfloat b = mix( rb, rt, f.y );\\n\t\tfloat c = mix( a, b, f.x );\\n\t\treturn c;\\n\t}\\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\\n\t\tshadowCoord.xyz /= shadowCoord.w;\\n\t\tshadowCoord.z += shadowBias;\\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\\n\t\tbool inFrustum = all( inFrustumVec );\\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\\n\t\tbool frustumTest = all( frustumTestVec );\\n\t\tif ( frustumTest ) {\\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\\n\t\t\treturn (\\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\\n\t\t\t) * ( 1.0 / 9.0 );\\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\\n\t\t\treturn (\\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\\n\t\t\t) * ( 1.0 / 9.0 );\\n\t\t#else\\n\t\t\treturn texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\\n\t\t#endif\\n\t\t}\\n\t\treturn 1.0;\\n\t}\\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\\n\t\tvec3 absV = abs( v );\\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\\n\t\tabsV *= scaleToCube;\\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\\n\t\tvec2 planar = v.xy;\\n\t\tfloat almostATexel = 1.5 * texelSizeY;\\n\t\tfloat almostOne = 1.0 - almostATexel;\\n\t\tif ( absV.z >= almostOne ) {\\n\t\t\tif ( v.z > 0.0 )\\n\t\t\t\tplanar.x = 4.0 - v.x;\\n\t\t} else if ( absV.x >= almostOne ) {\\n\t\t\tfloat signX = sign( v.x );\\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\\n\t\t} else if ( absV.y >= almostOne ) {\\n\t\t\tfloat signY = sign( v.y );\\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\\n\t\t\tplanar.y = v.z * signY - 2.0;\\n\t\t}\\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\\n\t}\\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\\n\t\tvec3 lightToPosition = shadowCoord.xyz;\\n\t\tvec3 bd3D = normalize( lightToPosition );\\n\t\tfloat dp = ( length( lightToPosition ) - shadowBias ) / 1000.0;\\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\\n\t\t\treturn (\\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\\n\t\t\t) * ( 1.0 / 9.0 );\\n\t\t#else\\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\\n\t\t#endif\\n\t}\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/shadowmap_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'shadowmap_pars_vertex' ] = \"#ifdef USE_SHADOWMAP\\n\t#if NUM_DIR_LIGHTS > 0\\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\\n\t#endif\\n\t#if NUM_SPOT_LIGHTS > 0\\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\\n\t#endif\\n\t#if NUM_POINT_LIGHTS > 0\\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\\n\t#endif\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/shadowmap_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'shadowmap_vertex' ] = \"#ifdef USE_SHADOWMAP\\n\t#if NUM_DIR_LIGHTS > 0\\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\\n\t}\\n\t#endif\\n\t#if NUM_SPOT_LIGHTS > 0\\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\\n\t}\\n\t#endif\\n\t#if NUM_POINT_LIGHTS > 0\\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\\n\t}\\n\t#endif\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/shadowmask_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'shadowmask_pars_fragment' ] = \"float getShadowMask() {\\n\tfloat shadow = 1.0;\\n\t#ifdef USE_SHADOWMAP\\n\t#if NUM_DIR_LIGHTS > 0\\n\tDirectionalLight directionalLight;\\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\\n\t\tdirectionalLight = directionalLights[ i ];\\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\\n\t}\\n\t#endif\\n\t#if NUM_SPOT_LIGHTS > 0\\n\tSpotLight spotLight;\\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\\n\t\tspotLight = spotLights[ i ];\\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\\n\t}\\n\t#endif\\n\t#if NUM_POINT_LIGHTS > 0\\n\tPointLight pointLight;\\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\\n\t\tpointLight = pointLights[ i ];\\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ] ) : 1.0;\\n\t}\\n\t#endif\\n\t#endif\\n\treturn shadow;\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/skinbase_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'skinbase_vertex' ] = \"#ifdef USE_SKINNING\\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/skinning_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'skinning_pars_vertex' ] = \"#ifdef USE_SKINNING\\n\tuniform mat4 bindMatrix;\\n\tuniform mat4 bindMatrixInverse;\\n\t#ifdef BONE_TEXTURE\\n\t\tuniform sampler2D boneTexture;\\n\t\tuniform int boneTextureWidth;\\n\t\tuniform int boneTextureHeight;\\n\t\tmat4 getBoneMatrix( const in float i ) {\\n\t\t\tfloat j = i * 4.0;\\n\t\t\tfloat x = mod( j, float( boneTextureWidth ) );\\n\t\t\tfloat y = floor( j / float( boneTextureWidth ) );\\n\t\t\tfloat dx = 1.0 / float( boneTextureWidth );\\n\t\t\tfloat dy = 1.0 / float( boneTextureHeight );\\n\t\t\ty = dy * ( y + 0.5 );\\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\\n\t\t\treturn bone;\\n\t\t}\\n\t#else\\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\\n\t\tmat4 getBoneMatrix( const in float i ) {\\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\\n\t\t\treturn bone;\\n\t\t}\\n\t#endif\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/skinning_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'skinning_vertex' ] = \"#ifdef USE_SKINNING\\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\\n\tvec4 skinned = vec4( 0.0 );\\n\tskinned += boneMatX * skinVertex * skinWeight.x;\\n\tskinned += boneMatY * skinVertex * skinWeight.y;\\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\\n\tskinned += boneMatW * skinVertex * skinWeight.w;\\n\tskinned  = bindMatrixInverse * skinned;\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/skinnormal_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'skinnormal_vertex' ] = \"#ifdef USE_SKINNING\\n\tmat4 skinMatrix = mat4( 0.0 );\\n\tskinMatrix += skinWeight.x * boneMatX;\\n\tskinMatrix += skinWeight.y * boneMatY;\\n\tskinMatrix += skinWeight.z * boneMatZ;\\n\tskinMatrix += skinWeight.w * boneMatW;\\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/specularmap_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'specularmap_fragment' ] = \"float specularStrength;\\n#ifdef USE_SPECULARMAP\\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\\n\tspecularStrength = texelSpecular.r;\\n#else\\n\tspecularStrength = 1.0;\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/specularmap_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'specularmap_pars_fragment' ] = \"#ifdef USE_SPECULARMAP\\n\tuniform sampler2D specularMap;\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/tonemapping_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'tonemapping_fragment' ] = \"#if defined( TONE_MAPPING )\\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/tonemapping_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'tonemapping_pars_fragment' ] = \"#define saturate(a) clamp( a, 0.0, 1.0 )\\nuniform float toneMappingExposure;\\nuniform float toneMappingWhitePoint;\\nvec3 LinearToneMapping( vec3 color ) {\\n  return toneMappingExposure * color;\\n}\\nvec3 ReinhardToneMapping( vec3 color ) {\\n  color *= toneMappingExposure;\\n  return saturate( color / ( vec3( 1.0 ) + color ) );\\n}\\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\\nvec3 Uncharted2ToneMapping( vec3 color ) {\\n  color *= toneMappingExposure;\\n  return saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\\n}\\nvec3 OptimizedCineonToneMapping( vec3 color ) {\\n  color *= toneMappingExposure;\\n  color = max( vec3( 0.0 ), color - 0.004 );\\n  return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/uv2_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'uv2_pars_fragment' ] = \"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\\n\tvarying vec2 vUv2;\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/uv2_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'uv2_pars_vertex' ] = \"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\\n\tattribute vec2 uv2;\\n\tvarying vec2 vUv2;\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/uv2_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'uv2_vertex' ] = \"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\\n\tvUv2 = uv2;\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/uv_pars_fragment.glsl\r\n\r\nTHREE.ShaderChunk[ 'uv_pars_fragment' ] = \"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\\n\tvarying vec2 vUv;\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/uv_pars_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'uv_pars_vertex' ] = \"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\\n\tvarying vec2 vUv;\\n\tuniform vec4 offsetRepeat;\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/uv_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'uv_vertex' ] = \"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\\n\tvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\\n#endif\";\r\n\r\n// File:src/renderers/shaders/ShaderChunk/worldpos_vertex.glsl\r\n\r\nTHREE.ShaderChunk[ 'worldpos_vertex' ] = \"#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( PHYSICAL ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\\n\t#ifdef USE_SKINNING\\n\t\tvec4 worldPosition = modelMatrix * skinned;\\n\t#else\\n\t\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\\n\t#endif\\n#endif\\n\";\r\n\r\n// File:src/renderers/shaders/UniformsUtils.js\r\n\r\n/**\r\n * Uniform Utilities\r\n */\r\n\r\nTHREE.UniformsUtils = {\r\n\r\n\tmerge: function ( uniforms ) {\r\n\r\n\t\tvar merged = {};\r\n\r\n\t\tfor ( var u = 0; u < uniforms.length; u ++ ) {\r\n\r\n\t\t\tvar tmp = this.clone( uniforms[ u ] );\r\n\r\n\t\t\tfor ( var p in tmp ) {\r\n\r\n\t\t\t\tmerged[ p ] = tmp[ p ];\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn merged;\r\n\r\n\t},\r\n\r\n\tclone: function ( uniforms_src ) {\r\n\r\n\t\tvar uniforms_dst = {};\r\n\r\n\t\tfor ( var u in uniforms_src ) {\r\n\r\n\t\t\tuniforms_dst[ u ] = {};\r\n\r\n\t\t\tfor ( var p in uniforms_src[ u ] ) {\r\n\r\n\t\t\t\tvar parameter_src = uniforms_src[ u ][ p ];\r\n\r\n\t\t\t\tif ( parameter_src instanceof THREE.Color ||\r\n\t\t\t\t\t parameter_src instanceof THREE.Vector2 ||\r\n\t\t\t\t\t parameter_src instanceof THREE.Vector3 ||\r\n\t\t\t\t\t parameter_src instanceof THREE.Vector4 ||\r\n\t\t\t\t\t parameter_src instanceof THREE.Matrix3 ||\r\n\t\t\t\t\t parameter_src instanceof THREE.Matrix4 ||\r\n\t\t\t\t\t parameter_src instanceof THREE.Texture ) {\r\n\r\n\t\t\t\t\tuniforms_dst[ u ][ p ] = parameter_src.clone();\r\n\r\n\t\t\t\t} else if ( Array.isArray( parameter_src ) ) {\r\n\r\n\t\t\t\t\tuniforms_dst[ u ][ p ] = parameter_src.slice();\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tuniforms_dst[ u ][ p ] = parameter_src;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn uniforms_dst;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/renderers/shaders/UniformsLib.js\r\n\r\n/**\r\n * Uniforms library for shared webgl shaders\r\n */\r\n\r\nTHREE.UniformsLib = {\r\n\r\n\tcommon: {\r\n\r\n\t\t\"diffuse\": { type: \"c\", value: new THREE.Color( 0xeeeeee ) },\r\n\t\t\"opacity\": { type: \"1f\", value: 1.0 },\r\n\r\n\t\t\"map\": { type: \"t\", value: null },\r\n\t\t\"offsetRepeat\": { type: \"v4\", value: new THREE.Vector4( 0, 0, 1, 1 ) },\r\n\r\n\t\t\"specularMap\": { type: \"t\", value: null },\r\n\t\t\"alphaMap\": { type: \"t\", value: null },\r\n\r\n\t\t\"envMap\": { type: \"t\", value: null },\r\n\t\t\"flipEnvMap\": { type: \"1f\", value: - 1 },\r\n\t\t\"reflectivity\": { type: \"1f\", value: 1.0 },\r\n\t\t\"refractionRatio\": { type: \"1f\", value: 0.98 }\r\n\r\n\t},\r\n\r\n\taomap: {\r\n\r\n\t\t\"aoMap\": { type: \"t\", value: null },\r\n\t\t\"aoMapIntensity\": { type: \"1f\", value: 1 }\r\n\r\n\t},\r\n\r\n\tlightmap: {\r\n\r\n\t\t\"lightMap\": { type: \"t\", value: null },\r\n\t\t\"lightMapIntensity\": { type: \"1f\", value: 1 }\r\n\r\n\t},\r\n\r\n\temissivemap: {\r\n\r\n\t\t\"emissiveMap\": { type: \"t\", value: null }\r\n\r\n\t},\r\n\r\n\tbumpmap: {\r\n\r\n\t\t\"bumpMap\": { type: \"t\", value: null },\r\n\t\t\"bumpScale\": { type: \"1f\", value: 1 }\r\n\r\n\t},\r\n\r\n\tnormalmap: {\r\n\r\n\t\t\"normalMap\": { type: \"t\", value: null },\r\n\t\t\"normalScale\": { type: \"v2\", value: new THREE.Vector2( 1, 1 ) }\r\n\r\n\t},\r\n\r\n\tdisplacementmap: {\r\n\r\n\t\t\"displacementMap\": { type: \"t\", value: null },\r\n\t\t\"displacementScale\": { type: \"1f\", value: 1 },\r\n\t\t\"displacementBias\": { type: \"1f\", value: 0 }\r\n\r\n\t},\r\n\r\n\troughnessmap: {\r\n\r\n\t\t\"roughnessMap\": { type: \"t\", value: null }\r\n\r\n\t},\r\n\r\n\tmetalnessmap: {\r\n\r\n\t\t\"metalnessMap\": { type: \"t\", value: null }\r\n\r\n\t},\r\n\r\n\tfog: {\r\n\r\n\t\t\"fogDensity\": { type: \"1f\", value: 0.00025 },\r\n\t\t\"fogNear\": { type: \"1f\", value: 1 },\r\n\t\t\"fogFar\": { type: \"1f\", value: 2000 },\r\n\t\t\"fogColor\": { type: \"c\", value: new THREE.Color( 0xffffff ) }\r\n\r\n\t},\r\n\r\n\tlights: {\r\n\r\n\t\t\"ambientLightColor\": { type: \"3fv\", value: [] },\r\n\r\n\t\t\"directionalLights\": { type: \"sa\", value: [], properties: {\r\n\t\t\t\"direction\": { type: \"v3\" },\r\n\t\t\t\"color\": { type: \"c\" },\r\n\r\n\t\t\t\"shadow\": { type: \"1i\" },\r\n\t\t\t\"shadowBias\": { type: \"1f\" },\r\n\t\t\t\"shadowRadius\": { type: \"1f\" },\r\n\t\t\t\"shadowMapSize\": { type: \"v2\" }\r\n\t\t} },\r\n\r\n\t\t\"directionalShadowMap\": { type: \"tv\", value: [] },\r\n\t\t\"directionalShadowMatrix\": { type: \"m4v\", value: [] },\r\n\r\n\t\t\"spotLights\": { type: \"sa\", value: [], properties: {\r\n\t\t\t\"color\": { type: \"c\" },\r\n\t\t\t\"position\": { type: \"v3\" },\r\n\t\t\t\"direction\": { type: \"v3\" },\r\n\t\t\t\"distance\": { type: \"1f\" },\r\n\t\t\t\"coneCos\": { type: \"1f\" },\r\n\t\t\t\"penumbraCos\": { type: \"1f\" },\r\n\t\t\t\"decay\": { type: \"1f\" },\r\n\r\n\t\t\t\"shadow\": { type: \"1i\" },\r\n\t\t\t\"shadowBias\": { type: \"1f\" },\r\n\t\t\t\"shadowRadius\": { type: \"1f\" },\r\n\t\t\t\"shadowMapSize\": { type: \"v2\" }\r\n\t\t} },\r\n\r\n\t\t\"spotShadowMap\": { type: \"tv\", value: [] },\r\n\t\t\"spotShadowMatrix\": { type: \"m4v\", value: [] },\r\n\r\n\t\t\"pointLights\": { type: \"sa\", value: [], properties: {\r\n\t\t\t\"color\": { type: \"c\" },\r\n\t\t\t\"position\": { type: \"v3\" },\r\n\t\t\t\"decay\": { type: \"1f\" },\r\n\t\t\t\"distance\": { type: \"1f\" },\r\n\r\n\t\t\t\"shadow\": { type: \"1i\" },\r\n\t\t\t\"shadowBias\": { type: \"1f\" },\r\n\t\t\t\"shadowRadius\": { type: \"1f\" },\r\n\t\t\t\"shadowMapSize\": { type: \"v2\" }\r\n\t\t} },\r\n\r\n\t\t\"pointShadowMap\": { type: \"tv\", value: [] },\r\n\t\t\"pointShadowMatrix\": { type: \"m4v\", value: [] },\r\n\r\n\t\t\"hemisphereLights\": { type: \"sa\", value: [], properties: {\r\n\t\t\t\"direction\": { type: \"v3\" },\r\n\t\t\t\"skyColor\": { type: \"c\" },\r\n\t\t\t\"groundColor\": { type: \"c\" }\r\n\t\t} }\r\n\r\n\t},\r\n\r\n\tpoints: {\r\n\r\n\t\t\"diffuse\": { type: \"c\", value: new THREE.Color( 0xeeeeee ) },\r\n\t\t\"opacity\": { type: \"1f\", value: 1.0 },\r\n\t\t\"size\": { type: \"1f\", value: 1.0 },\r\n\t\t\"scale\": { type: \"1f\", value: 1.0 },\r\n\t\t\"map\": { type: \"t\", value: null },\r\n\t\t\"offsetRepeat\": { type: \"v4\", value: new THREE.Vector4( 0, 0, 1, 1 ) }\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/renderers/shaders/ShaderLib/cube_frag.glsl\r\n\r\nTHREE.ShaderChunk[ 'cube_frag' ] = \"uniform samplerCube tCube;\\nuniform float tFlip;\\nvarying vec3 vWorldPosition;\\n#include <common>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\t#include <clipping_planes_fragment>\\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\\n\t#include <logdepthbuf_fragment>\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderLib/cube_vert.glsl\r\n\r\nTHREE.ShaderChunk[ 'cube_vert' ] = \"varying vec3 vWorldPosition;\\n#include <common>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\tvWorldPosition = transformDirection( position, modelMatrix );\\n\t#include <begin_vertex>\\n\t#include <project_vertex>\\n\t#include <logdepthbuf_vertex>\\n\t#include <clipping_planes_vertex>\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderLib/depth_frag.glsl\r\n\r\nTHREE.ShaderChunk[ 'depth_frag' ] = \"#if DEPTH_PACKING == 3200\\n\tuniform float opacity;\\n#endif\\n#include <common>\\n#include <packing>\\n#include <uv_pars_fragment>\\n#include <map_pars_fragment>\\n#include <alphamap_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\t#include <clipping_planes_fragment>\\n\tvec4 diffuseColor = vec4( 1.0 );\\n\t#if DEPTH_PACKING == 3200\\n\t\tdiffuseColor.a = opacity;\\n\t#endif\\n\t#include <map_fragment>\\n\t#include <alphamap_fragment>\\n\t#include <alphatest_fragment>\\n\t#include <logdepthbuf_fragment>\\n\t#if DEPTH_PACKING == 3200\\n\t\tgl_FragColor = vec4( vec3( gl_FragCoord.z ), opacity );\\n\t#elif DEPTH_PACKING == 3201\\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\\n\t#endif\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderLib/depth_vert.glsl\r\n\r\nTHREE.ShaderChunk[ 'depth_vert' ] = \"#include <common>\\n#include <uv_pars_vertex>\\n#include <displacementmap_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\t#include <uv_vertex>\\n\t#include <skinbase_vertex>\\n\t#include <begin_vertex>\\n\t#include <displacementmap_vertex>\\n\t#include <morphtarget_vertex>\\n\t#include <skinning_vertex>\\n\t#include <project_vertex>\\n\t#include <logdepthbuf_vertex>\\n\t#include <clipping_planes_vertex>\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderLib/distanceRGBA_frag.glsl\r\n\r\nTHREE.ShaderChunk[ 'distanceRGBA_frag' ] = \"uniform vec3 lightPos;\\nvarying vec4 vWorldPosition;\\n#include <common>\\n#include <packing>\\n#include <clipping_planes_pars_fragment>\\nvoid main () {\\n\t#include <clipping_planes_fragment>\\n\tgl_FragColor = packDepthToRGBA( length( vWorldPosition.xyz - lightPos.xyz ) / 1000.0 );\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderLib/distanceRGBA_vert.glsl\r\n\r\nTHREE.ShaderChunk[ 'distanceRGBA_vert' ] = \"varying vec4 vWorldPosition;\\n#include <common>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\t#include <skinbase_vertex>\\n\t#include <begin_vertex>\\n\t#include <morphtarget_vertex>\\n\t#include <skinning_vertex>\\n\t#include <project_vertex>\\n\t#include <worldpos_vertex>\\n\t#include <clipping_planes_vertex>\\n\tvWorldPosition = worldPosition;\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderLib/equirect_frag.glsl\r\n\r\nTHREE.ShaderChunk[ 'equirect_frag' ] = \"uniform sampler2D tEquirect;\\nuniform float tFlip;\\nvarying vec3 vWorldPosition;\\n#include <common>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\t#include <clipping_planes_fragment>\\n\tvec3 direction = normalize( vWorldPosition );\\n\tvec2 sampleUV;\\n\tsampleUV.y = saturate( tFlip * direction.y * -0.5 + 0.5 );\\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\\n\t#include <logdepthbuf_fragment>\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderLib/equirect_vert.glsl\r\n\r\nTHREE.ShaderChunk[ 'equirect_vert' ] = \"varying vec3 vWorldPosition;\\n#include <common>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\tvWorldPosition = transformDirection( position, modelMatrix );\\n\t#include <begin_vertex>\\n\t#include <project_vertex>\\n\t#include <logdepthbuf_vertex>\\n\t#include <clipping_planes_vertex>\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderLib/linedashed_frag.glsl\r\n\r\nTHREE.ShaderChunk[ 'linedashed_frag' ] = \"uniform vec3 diffuse;\\nuniform float opacity;\\nuniform float dashSize;\\nuniform float totalSize;\\nvarying float vLineDistance;\\n#include <common>\\n#include <color_pars_fragment>\\n#include <fog_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\t#include <clipping_planes_fragment>\\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\\n\t\tdiscard;\\n\t}\\n\tvec3 outgoingLight = vec3( 0.0 );\\n\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\t#include <logdepthbuf_fragment>\\n\t#include <color_fragment>\\n\toutgoingLight = diffuseColor.rgb;\\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\\n\t#include <premultiplied_alpha_fragment>\\n\t#include <tonemapping_fragment>\\n\t#include <encodings_fragment>\\n\t#include <fog_fragment>\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderLib/linedashed_vert.glsl\r\n\r\nTHREE.ShaderChunk[ 'linedashed_vert' ] = \"uniform float scale;\\nattribute float lineDistance;\\nvarying float vLineDistance;\\n#include <common>\\n#include <color_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\t#include <color_vertex>\\n\tvLineDistance = scale * lineDistance;\\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\\n\tgl_Position = projectionMatrix * mvPosition;\\n\t#include <logdepthbuf_vertex>\\n\t#include <clipping_planes_vertex>\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderLib/meshbasic_frag.glsl\r\n\r\nTHREE.ShaderChunk[ 'meshbasic_frag' ] = \"uniform vec3 diffuse;\\nuniform float opacity;\\n#ifndef FLAT_SHADED\\n\tvarying vec3 vNormal;\\n#endif\\n#include <common>\\n#include <color_pars_fragment>\\n#include <uv_pars_fragment>\\n#include <uv2_pars_fragment>\\n#include <map_pars_fragment>\\n#include <alphamap_pars_fragment>\\n#include <aomap_pars_fragment>\\n#include <envmap_pars_fragment>\\n#include <fog_pars_fragment>\\n#include <specularmap_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\t#include <clipping_planes_fragment>\\n\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\t#include <logdepthbuf_fragment>\\n\t#include <map_fragment>\\n\t#include <color_fragment>\\n\t#include <alphamap_fragment>\\n\t#include <alphatest_fragment>\\n\t#include <specularmap_fragment>\\n\tReflectedLight reflectedLight;\\n\treflectedLight.directDiffuse = vec3( 0.0 );\\n\treflectedLight.directSpecular = vec3( 0.0 );\\n\treflectedLight.indirectDiffuse = diffuseColor.rgb;\\n\treflectedLight.indirectSpecular = vec3( 0.0 );\\n\t#include <aomap_fragment>\\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\\n\t#include <envmap_fragment>\\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\\n\t#include <premultiplied_alpha_fragment>\\n\t#include <tonemapping_fragment>\\n\t#include <encodings_fragment>\\n\t#include <fog_fragment>\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderLib/meshbasic_vert.glsl\r\n\r\nTHREE.ShaderChunk[ 'meshbasic_vert' ] = \"#include <common>\\n#include <uv_pars_vertex>\\n#include <uv2_pars_vertex>\\n#include <envmap_pars_vertex>\\n#include <color_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\t#include <uv_vertex>\\n\t#include <uv2_vertex>\\n\t#include <color_vertex>\\n\t#include <skinbase_vertex>\\n\t#ifdef USE_ENVMAP\\n\t#include <beginnormal_vertex>\\n\t#include <morphnormal_vertex>\\n\t#include <skinnormal_vertex>\\n\t#include <defaultnormal_vertex>\\n\t#endif\\n\t#include <begin_vertex>\\n\t#include <morphtarget_vertex>\\n\t#include <skinning_vertex>\\n\t#include <project_vertex>\\n\t#include <logdepthbuf_vertex>\\n\t#include <worldpos_vertex>\\n\t#include <clipping_planes_vertex>\\n\t#include <envmap_vertex>\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderLib/meshlambert_frag.glsl\r\n\r\nTHREE.ShaderChunk[ 'meshlambert_frag' ] = \"uniform vec3 diffuse;\\nuniform vec3 emissive;\\nuniform float opacity;\\nvarying vec3 vLightFront;\\n#ifdef DOUBLE_SIDED\\n\tvarying vec3 vLightBack;\\n#endif\\n#include <common>\\n#include <packing>\\n#include <color_pars_fragment>\\n#include <uv_pars_fragment>\\n#include <uv2_pars_fragment>\\n#include <map_pars_fragment>\\n#include <alphamap_pars_fragment>\\n#include <aomap_pars_fragment>\\n#include <lightmap_pars_fragment>\\n#include <emissivemap_pars_fragment>\\n#include <envmap_pars_fragment>\\n#include <bsdfs>\\n#include <lights_pars>\\n#include <fog_pars_fragment>\\n#include <shadowmap_pars_fragment>\\n#include <shadowmask_pars_fragment>\\n#include <specularmap_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\t#include <clipping_planes_fragment>\\n\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\\n\tvec3 totalEmissiveRadiance = emissive;\\n\t#include <logdepthbuf_fragment>\\n\t#include <map_fragment>\\n\t#include <color_fragment>\\n\t#include <alphamap_fragment>\\n\t#include <alphatest_fragment>\\n\t#include <specularmap_fragment>\\n\t#include <emissivemap_fragment>\\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\\n\t#include <lightmap_fragment>\\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\\n\t#ifdef DOUBLE_SIDED\\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\\n\t#else\\n\t\treflectedLight.directDiffuse = vLightFront;\\n\t#endif\\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\\n\t#include <aomap_fragment>\\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\\n\t#include <envmap_fragment>\\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\\n\t#include <premultiplied_alpha_fragment>\\n\t#include <tonemapping_fragment>\\n\t#include <encodings_fragment>\\n\t#include <fog_fragment>\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderLib/meshlambert_vert.glsl\r\n\r\nTHREE.ShaderChunk[ 'meshlambert_vert' ] = \"#define LAMBERT\\nvarying vec3 vLightFront;\\n#ifdef DOUBLE_SIDED\\n\tvarying vec3 vLightBack;\\n#endif\\n#include <common>\\n#include <uv_pars_vertex>\\n#include <uv2_pars_vertex>\\n#include <envmap_pars_vertex>\\n#include <bsdfs>\\n#include <lights_pars>\\n#include <color_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <shadowmap_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\t#include <uv_vertex>\\n\t#include <uv2_vertex>\\n\t#include <color_vertex>\\n\t#include <beginnormal_vertex>\\n\t#include <morphnormal_vertex>\\n\t#include <skinbase_vertex>\\n\t#include <skinnormal_vertex>\\n\t#include <defaultnormal_vertex>\\n\t#include <begin_vertex>\\n\t#include <morphtarget_vertex>\\n\t#include <skinning_vertex>\\n\t#include <project_vertex>\\n\t#include <logdepthbuf_vertex>\\n\t#include <clipping_planes_vertex>\\n\t#include <worldpos_vertex>\\n\t#include <envmap_vertex>\\n\t#include <lights_lambert_vertex>\\n\t#include <shadowmap_vertex>\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderLib/meshphong_frag.glsl\r\n\r\nTHREE.ShaderChunk[ 'meshphong_frag' ] = \"#define PHONG\\nuniform vec3 diffuse;\\nuniform vec3 emissive;\\nuniform vec3 specular;\\nuniform float shininess;\\nuniform float opacity;\\n#include <common>\\n#include <packing>\\n#include <color_pars_fragment>\\n#include <uv_pars_fragment>\\n#include <uv2_pars_fragment>\\n#include <map_pars_fragment>\\n#include <alphamap_pars_fragment>\\n#include <aomap_pars_fragment>\\n#include <lightmap_pars_fragment>\\n#include <emissivemap_pars_fragment>\\n#include <envmap_pars_fragment>\\n#include <fog_pars_fragment>\\n#include <bsdfs>\\n#include <lights_pars>\\n#include <lights_phong_pars_fragment>\\n#include <shadowmap_pars_fragment>\\n#include <bumpmap_pars_fragment>\\n#include <normalmap_pars_fragment>\\n#include <specularmap_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\t#include <clipping_planes_fragment>\\n\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\\n\tvec3 totalEmissiveRadiance = emissive;\\n\t#include <logdepthbuf_fragment>\\n\t#include <map_fragment>\\n\t#include <color_fragment>\\n\t#include <alphamap_fragment>\\n\t#include <alphatest_fragment>\\n\t#include <specularmap_fragment>\\n\t#include <normal_fragment>\\n\t#include <emissivemap_fragment>\\n\t#include <lights_phong_fragment>\\n\t#include <lights_template>\\n\t#include <aomap_fragment>\\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\\n\t#include <envmap_fragment>\\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\\n\t#include <premultiplied_alpha_fragment>\\n\t#include <tonemapping_fragment>\\n\t#include <encodings_fragment>\\n\t#include <fog_fragment>\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderLib/meshphong_vert.glsl\r\n\r\nTHREE.ShaderChunk[ 'meshphong_vert' ] = \"#define PHONG\\nvarying vec3 vViewPosition;\\n#ifndef FLAT_SHADED\\n\tvarying vec3 vNormal;\\n#endif\\n#include <common>\\n#include <uv_pars_vertex>\\n#include <uv2_pars_vertex>\\n#include <displacementmap_pars_vertex>\\n#include <envmap_pars_vertex>\\n#include <color_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <shadowmap_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\t#include <uv_vertex>\\n\t#include <uv2_vertex>\\n\t#include <color_vertex>\\n\t#include <beginnormal_vertex>\\n\t#include <morphnormal_vertex>\\n\t#include <skinbase_vertex>\\n\t#include <skinnormal_vertex>\\n\t#include <defaultnormal_vertex>\\n#ifndef FLAT_SHADED\\n\tvNormal = normalize( transformedNormal );\\n#endif\\n\t#include <begin_vertex>\\n\t#include <displacementmap_vertex>\\n\t#include <morphtarget_vertex>\\n\t#include <skinning_vertex>\\n\t#include <project_vertex>\\n\t#include <logdepthbuf_vertex>\\n\t#include <clipping_planes_vertex>\\n\tvViewPosition = - mvPosition.xyz;\\n\t#include <worldpos_vertex>\\n\t#include <envmap_vertex>\\n\t#include <shadowmap_vertex>\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderLib/meshphysical_frag.glsl\r\n\r\nTHREE.ShaderChunk[ 'meshphysical_frag' ] = \"#define PHYSICAL\\nuniform vec3 diffuse;\\nuniform vec3 emissive;\\nuniform float roughness;\\nuniform float metalness;\\nuniform float opacity;\\nuniform float envMapIntensity;\\nvarying vec3 vViewPosition;\\n#ifndef FLAT_SHADED\\n\tvarying vec3 vNormal;\\n#endif\\n#include <common>\\n#include <packing>\\n#include <color_pars_fragment>\\n#include <uv_pars_fragment>\\n#include <uv2_pars_fragment>\\n#include <map_pars_fragment>\\n#include <alphamap_pars_fragment>\\n#include <aomap_pars_fragment>\\n#include <lightmap_pars_fragment>\\n#include <emissivemap_pars_fragment>\\n#include <envmap_pars_fragment>\\n#include <fog_pars_fragment>\\n#include <bsdfs>\\n#include <cube_uv_reflection_fragment>\\n#include <lights_pars>\\n#include <lights_physical_pars_fragment>\\n#include <shadowmap_pars_fragment>\\n#include <bumpmap_pars_fragment>\\n#include <normalmap_pars_fragment>\\n#include <roughnessmap_pars_fragment>\\n#include <metalnessmap_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\t#include <clipping_planes_fragment>\\n\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\\n\tvec3 totalEmissiveRadiance = emissive;\\n\t#include <logdepthbuf_fragment>\\n\t#include <map_fragment>\\n\t#include <color_fragment>\\n\t#include <alphamap_fragment>\\n\t#include <alphatest_fragment>\\n\t#include <specularmap_fragment>\\n\t#include <roughnessmap_fragment>\\n\t#include <metalnessmap_fragment>\\n\t#include <normal_fragment>\\n\t#include <emissivemap_fragment>\\n\t#include <lights_physical_fragment>\\n\t#include <lights_template>\\n\t#include <aomap_fragment>\\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\\n\t#include <premultiplied_alpha_fragment>\\n\t#include <tonemapping_fragment>\\n\t#include <encodings_fragment>\\n\t#include <fog_fragment>\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderLib/meshphysical_vert.glsl\r\n\r\nTHREE.ShaderChunk[ 'meshphysical_vert' ] = \"#define PHYSICAL\\nvarying vec3 vViewPosition;\\n#ifndef FLAT_SHADED\\n\tvarying vec3 vNormal;\\n#endif\\n#include <common>\\n#include <uv_pars_vertex>\\n#include <uv2_pars_vertex>\\n#include <displacementmap_pars_vertex>\\n#include <color_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <shadowmap_pars_vertex>\\n#include <specularmap_pars_fragment>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\t#include <uv_vertex>\\n\t#include <uv2_vertex>\\n\t#include <color_vertex>\\n\t#include <beginnormal_vertex>\\n\t#include <morphnormal_vertex>\\n\t#include <skinbase_vertex>\\n\t#include <skinnormal_vertex>\\n\t#include <defaultnormal_vertex>\\n#ifndef FLAT_SHADED\\n\tvNormal = normalize( transformedNormal );\\n#endif\\n\t#include <begin_vertex>\\n\t#include <displacementmap_vertex>\\n\t#include <morphtarget_vertex>\\n\t#include <skinning_vertex>\\n\t#include <project_vertex>\\n\t#include <logdepthbuf_vertex>\\n\t#include <clipping_planes_vertex>\\n\tvViewPosition = - mvPosition.xyz;\\n\t#include <worldpos_vertex>\\n\t#include <shadowmap_vertex>\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderLib/normal_frag.glsl\r\n\r\nTHREE.ShaderChunk[ 'normal_frag' ] = \"uniform float opacity;\\nvarying vec3 vNormal;\\n#include <common>\\n#include <packing>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\t#include <clipping_planes_fragment>\\n\tgl_FragColor = vec4( packNormalToRGB( vNormal ), opacity );\\n\t#include <logdepthbuf_fragment>\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderLib/normal_vert.glsl\r\n\r\nTHREE.ShaderChunk[ 'normal_vert' ] = \"varying vec3 vNormal;\\n#include <common>\\n#include <morphtarget_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\tvNormal = normalize( normalMatrix * normal );\\n\t#include <begin_vertex>\\n\t#include <morphtarget_vertex>\\n\t#include <project_vertex>\\n\t#include <logdepthbuf_vertex>\\n\t#include <clipping_planes_vertex>\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderLib/points_frag.glsl\r\n\r\nTHREE.ShaderChunk[ 'points_frag' ] = \"uniform vec3 diffuse;\\nuniform float opacity;\\n#include <common>\\n#include <color_pars_fragment>\\n#include <map_particle_pars_fragment>\\n#include <fog_pars_fragment>\\n#include <shadowmap_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\t#include <clipping_planes_fragment>\\n\tvec3 outgoingLight = vec3( 0.0 );\\n\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\t#include <logdepthbuf_fragment>\\n\t#include <map_particle_fragment>\\n\t#include <color_fragment>\\n\t#include <alphatest_fragment>\\n\toutgoingLight = diffuseColor.rgb;\\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\\n\t#include <premultiplied_alpha_fragment>\\n\t#include <tonemapping_fragment>\\n\t#include <encodings_fragment>\\n\t#include <fog_fragment>\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderLib/points_vert.glsl\r\n\r\nTHREE.ShaderChunk[ 'points_vert' ] = \"uniform float size;\\nuniform float scale;\\n#include <common>\\n#include <color_pars_vertex>\\n#include <shadowmap_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\t#include <color_vertex>\\n\t#include <begin_vertex>\\n\t#include <project_vertex>\\n\t#ifdef USE_SIZEATTENUATION\\n\t\tgl_PointSize = size * ( scale / - mvPosition.z );\\n\t#else\\n\t\tgl_PointSize = size;\\n\t#endif\\n\t#include <logdepthbuf_vertex>\\n\t#include <clipping_planes_vertex>\\n\t#include <worldpos_vertex>\\n\t#include <shadowmap_vertex>\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderLib/shadow_frag.glsl\r\n\r\nTHREE.ShaderChunk[ 'shadow_frag' ] = \"uniform float opacity;\\n#include <common>\\n#include <packing>\\n#include <bsdfs>\\n#include <lights_pars>\\n#include <shadowmap_pars_fragment>\\n#include <shadowmask_pars_fragment>\\nvoid main() {\\n\tgl_FragColor = vec4( 0.0, 0.0, 0.0, opacity * ( 1.0  - getShadowMask() ) );\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderLib/shadow_vert.glsl\r\n\r\nTHREE.ShaderChunk[ 'shadow_vert' ] = \"#include <shadowmap_pars_vertex>\\nvoid main() {\\n\t#include <begin_vertex>\\n\t#include <project_vertex>\\n\t#include <worldpos_vertex>\\n\t#include <shadowmap_vertex>\\n}\\n\";\r\n\r\n// File:src/renderers/shaders/ShaderLib.js\r\n\r\n/**\r\n * Webgl Shader Library for three.js\r\n *\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author mikael emtinger / http://gomo.se/\r\n */\r\n\r\n\r\nTHREE.ShaderLib = {\r\n\r\n\t'basic': {\r\n\r\n\t\tuniforms: THREE.UniformsUtils.merge( [\r\n\r\n\t\t\tTHREE.UniformsLib[ 'common' ],\r\n\t\t\tTHREE.UniformsLib[ 'aomap' ],\r\n\t\t\tTHREE.UniformsLib[ 'fog' ]\r\n\r\n\t\t] ),\r\n\r\n\t\tvertexShader: THREE.ShaderChunk[ 'meshbasic_vert' ],\r\n\t\tfragmentShader: THREE.ShaderChunk[ 'meshbasic_frag' ]\r\n\r\n\t},\r\n\r\n\t'lambert': {\r\n\r\n\t\tuniforms: THREE.UniformsUtils.merge( [\r\n\r\n\t\t\tTHREE.UniformsLib[ 'common' ],\r\n\t\t\tTHREE.UniformsLib[ 'aomap' ],\r\n\t\t\tTHREE.UniformsLib[ 'lightmap' ],\r\n\t\t\tTHREE.UniformsLib[ 'emissivemap' ],\r\n\t\t\tTHREE.UniformsLib[ 'fog' ],\r\n\t\t\tTHREE.UniformsLib[ 'lights' ],\r\n\r\n\t\t\t{\r\n\t\t\t\t\"emissive\" : { type: \"c\", value: new THREE.Color( 0x000000 ) }\r\n\t\t\t}\r\n\r\n\t\t] ),\r\n\r\n\t\tvertexShader: THREE.ShaderChunk[ 'meshlambert_vert' ],\r\n\t\tfragmentShader: THREE.ShaderChunk[ 'meshlambert_frag' ]\r\n\r\n\t},\r\n\r\n\t'phong': {\r\n\r\n\t\tuniforms: THREE.UniformsUtils.merge( [\r\n\r\n\t\t\tTHREE.UniformsLib[ 'common' ],\r\n\t\t\tTHREE.UniformsLib[ 'aomap' ],\r\n\t\t\tTHREE.UniformsLib[ 'lightmap' ],\r\n\t\t\tTHREE.UniformsLib[ 'emissivemap' ],\r\n\t\t\tTHREE.UniformsLib[ 'bumpmap' ],\r\n\t\t\tTHREE.UniformsLib[ 'normalmap' ],\r\n\t\t\tTHREE.UniformsLib[ 'displacementmap' ],\r\n\t\t\tTHREE.UniformsLib[ 'fog' ],\r\n\t\t\tTHREE.UniformsLib[ 'lights' ],\r\n\r\n\t\t\t{\r\n\t\t\t\t\"emissive\" : { type: \"c\", value: new THREE.Color( 0x000000 ) },\r\n\t\t\t\t\"specular\" : { type: \"c\", value: new THREE.Color( 0x111111 ) },\r\n\t\t\t\t\"shininess\": { type: \"1f\", value: 30 }\r\n\t\t\t}\r\n\r\n\t\t] ),\r\n\r\n\t\tvertexShader: THREE.ShaderChunk[ 'meshphong_vert' ],\r\n\t\tfragmentShader: THREE.ShaderChunk[ 'meshphong_frag' ]\r\n\r\n\t},\r\n\r\n\t'standard': {\r\n\r\n\t\tuniforms: THREE.UniformsUtils.merge( [\r\n\r\n\t\t\tTHREE.UniformsLib[ 'common' ],\r\n\t\t\tTHREE.UniformsLib[ 'aomap' ],\r\n\t\t\tTHREE.UniformsLib[ 'lightmap' ],\r\n\t\t\tTHREE.UniformsLib[ 'emissivemap' ],\r\n\t\t\tTHREE.UniformsLib[ 'bumpmap' ],\r\n\t\t\tTHREE.UniformsLib[ 'normalmap' ],\r\n\t\t\tTHREE.UniformsLib[ 'displacementmap' ],\r\n\t\t\tTHREE.UniformsLib[ 'roughnessmap' ],\r\n\t\t\tTHREE.UniformsLib[ 'metalnessmap' ],\r\n\t\t\tTHREE.UniformsLib[ 'fog' ],\r\n\t\t\tTHREE.UniformsLib[ 'lights' ],\r\n\r\n\t\t\t{\r\n\t\t\t\t\"emissive\" : { type: \"c\", value: new THREE.Color( 0x000000 ) },\r\n\t\t\t\t\"roughness\": { type: \"1f\", value: 0.5 },\r\n\t\t\t\t\"metalness\": { type: \"1f\", value: 0 },\r\n\t\t\t\t\"envMapIntensity\" : { type: \"1f\", value: 1 } // temporary\r\n\t\t\t}\r\n\r\n\t\t] ),\r\n\r\n\t\tvertexShader: THREE.ShaderChunk[ 'meshphysical_vert' ],\r\n\t\tfragmentShader: THREE.ShaderChunk[ 'meshphysical_frag' ]\r\n\r\n\t},\r\n\r\n\t'points': {\r\n\r\n\t\tuniforms: THREE.UniformsUtils.merge( [\r\n\r\n\t\t\tTHREE.UniformsLib[ 'points' ],\r\n\t\t\tTHREE.UniformsLib[ 'fog' ]\r\n\r\n\t\t] ),\r\n\r\n\t\tvertexShader: THREE.ShaderChunk[ 'points_vert' ],\r\n\t\tfragmentShader: THREE.ShaderChunk[ 'points_frag' ]\r\n\r\n\t},\r\n\r\n\t'dashed': {\r\n\r\n\t\tuniforms: THREE.UniformsUtils.merge( [\r\n\r\n\t\t\tTHREE.UniformsLib[ 'common' ],\r\n\t\t\tTHREE.UniformsLib[ 'fog' ],\r\n\r\n\t\t\t{\r\n\t\t\t\t\"scale\"    : { type: \"1f\", value: 1 },\r\n\t\t\t\t\"dashSize\" : { type: \"1f\", value: 1 },\r\n\t\t\t\t\"totalSize\": { type: \"1f\", value: 2 }\r\n\t\t\t}\r\n\r\n\t\t] ),\r\n\r\n\t\tvertexShader: THREE.ShaderChunk[ 'linedashed_vert' ],\r\n\t\tfragmentShader: THREE.ShaderChunk[ 'linedashed_frag' ]\r\n\r\n\t},\r\n\r\n\t'depth': {\r\n\r\n\t\tuniforms: THREE.UniformsUtils.merge( [\r\n\r\n\t\t\tTHREE.UniformsLib[ 'common' ],\r\n\t\t\tTHREE.UniformsLib[ 'displacementmap' ]\r\n\r\n\t\t] ),\r\n\r\n\t\tvertexShader: THREE.ShaderChunk[ 'depth_vert' ],\r\n\t\tfragmentShader: THREE.ShaderChunk[ 'depth_frag' ]\r\n\r\n\t},\r\n\r\n\t'normal': {\r\n\r\n\t\tuniforms: {\r\n\r\n\t\t\t\"opacity\" : { type: \"1f\", value: 1.0 }\r\n\r\n\t\t},\r\n\r\n\t\tvertexShader: THREE.ShaderChunk[ 'normal_vert' ],\r\n\t\tfragmentShader: THREE.ShaderChunk[ 'normal_frag' ]\r\n\r\n\t},\r\n\r\n\t/* -------------------------------------------------------------------------\r\n\t//\tCube map shader\r\n\t ------------------------------------------------------------------------- */\r\n\r\n\t'cube': {\r\n\r\n\t\tuniforms: {\r\n\t\t\t\"tCube\": { type: \"t\", value: null },\r\n\t\t\t\"tFlip\": { type: \"1f\", value: - 1 }\r\n\t\t},\r\n\r\n\t\tvertexShader: THREE.ShaderChunk[ 'cube_vert' ],\r\n\t\tfragmentShader: THREE.ShaderChunk[ 'cube_frag' ]\r\n\r\n\t},\r\n\r\n\t/* -------------------------------------------------------------------------\r\n\t//\tCube map shader\r\n\t ------------------------------------------------------------------------- */\r\n\r\n\t'equirect': {\r\n\r\n\t\tuniforms: {\r\n\t\t\t\"tEquirect\": { type: \"t\", value: null },\r\n\t\t\t\"tFlip\": { type: \"1f\", value: - 1 }\r\n\t\t},\r\n\r\n\t\tvertexShader: THREE.ShaderChunk[ 'equirect_vert' ],\r\n\t\tfragmentShader: THREE.ShaderChunk[ 'equirect_frag' ]\r\n\r\n\t},\r\n\r\n\t'distanceRGBA': {\r\n\r\n\t\tuniforms: {\r\n\r\n\t\t\t\"lightPos\": { type: \"v3\", value: new THREE.Vector3() }\r\n\r\n\t\t},\r\n\r\n\t\tvertexShader: THREE.ShaderChunk[ 'distanceRGBA_vert' ],\r\n\t\tfragmentShader: THREE.ShaderChunk[ 'distanceRGBA_frag' ]\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.ShaderLib[ 'physical' ] = {\r\n\r\n\tuniforms: THREE.UniformsUtils.merge( [\r\n\r\n\t\tTHREE.ShaderLib[ 'standard' ].uniforms,\r\n\r\n\t\t{\r\n\t\t\t// future\r\n\t\t}\r\n\r\n\t] ),\r\n\r\n\tvertexShader: THREE.ShaderChunk[ 'meshphysical_vert' ],\r\n\tfragmentShader: THREE.ShaderChunk[ 'meshphysical_frag' ]\r\n\r\n};\r\n\r\n\r\n// File:src/renderers/WebGLRenderer.js\r\n\r\n/**\r\n * @author supereggbert / http://www.paulbrunt.co.uk/\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author szimek / https://github.com/szimek/\r\n * @author tschw\r\n */\r\n\r\nTHREE.WebGLRenderer = function ( parameters ) {\r\n\r\n\tconsole.log( 'THREE.WebGLRenderer', THREE.REVISION );\r\n\r\n\tparameters = parameters || {};\r\n\r\n\tvar _canvas = parameters.canvas !== undefined ? parameters.canvas : document.createElement( 'canvas' ),\r\n\t_context = parameters.context !== undefined ? parameters.context : null,\r\n\r\n\t_alpha = parameters.alpha !== undefined ? parameters.alpha : false,\r\n\t_depth = parameters.depth !== undefined ? parameters.depth : true,\r\n\t_stencil = parameters.stencil !== undefined ? parameters.stencil : true,\r\n\t_antialias = parameters.antialias !== undefined ? parameters.antialias : false,\r\n\t_premultipliedAlpha = parameters.premultipliedAlpha !== undefined ? parameters.premultipliedAlpha : true,\r\n\t_preserveDrawingBuffer = parameters.preserveDrawingBuffer !== undefined ? parameters.preserveDrawingBuffer : false;\r\n\r\n\tvar lights = [];\r\n\r\n\tvar opaqueObjects = [];\r\n\tvar opaqueObjectsLastIndex = - 1;\r\n\tvar transparentObjects = [];\r\n\tvar transparentObjectsLastIndex = - 1;\r\n\r\n\tvar morphInfluences = new Float32Array( 8 );\r\n\r\n\tvar sprites = [];\r\n\tvar lensFlares = [];\r\n\r\n\t// public properties\r\n\r\n\tthis.domElement = _canvas;\r\n\tthis.context = null;\r\n\r\n\t// clearing\r\n\r\n\tthis.autoClear = true;\r\n\tthis.autoClearColor = true;\r\n\tthis.autoClearDepth = true;\r\n\tthis.autoClearStencil = true;\r\n\r\n\t// scene graph\r\n\r\n\tthis.sortObjects = true;\r\n\r\n\t// user-defined clipping\r\n\r\n\tthis.clippingPlanes = [];\r\n\tthis.localClippingEnabled = false;\r\n\r\n\t// physically based shading\r\n\r\n\tthis.gammaFactor = 2.0;\t// for backwards compatibility\r\n\tthis.gammaInput = false;\r\n\tthis.gammaOutput = false;\r\n\r\n\t// physical lights\r\n\r\n\tthis.physicallyCorrectLights = false;\r\n\r\n\t// tone mapping\r\n\r\n\tthis.toneMapping = THREE.LinearToneMapping;\r\n\tthis.toneMappingExposure = 1.0;\r\n\tthis.toneMappingWhitePoint = 1.0;\r\n\r\n\t// morphs\r\n\r\n\tthis.maxMorphTargets = 8;\r\n\tthis.maxMorphNormals = 4;\r\n\r\n\t// flags\r\n\r\n\tthis.autoScaleCubemaps = true;\r\n\r\n\t// internal properties\r\n\r\n\tvar _this = this,\r\n\r\n\t// internal state cache\r\n\r\n\t_currentProgram = null,\r\n\t_currentRenderTarget = null,\r\n\t_currentFramebuffer = null,\r\n\t_currentMaterialId = - 1,\r\n\t_currentGeometryProgram = '',\r\n\t_currentCamera = null,\r\n\r\n\t_currentScissor = new THREE.Vector4(),\r\n\t_currentScissorTest = null,\r\n\r\n\t_currentViewport = new THREE.Vector4(),\r\n\r\n\t//\r\n\r\n\t_usedTextureUnits = 0,\r\n\r\n\t//\r\n\r\n\t_clearColor = new THREE.Color( 0x000000 ),\r\n\t_clearAlpha = 0,\r\n\r\n\t_width = _canvas.width,\r\n\t_height = _canvas.height,\r\n\r\n\t_pixelRatio = 1,\r\n\r\n\t_scissor = new THREE.Vector4( 0, 0, _width, _height ),\r\n\t_scissorTest = false,\r\n\r\n\t_viewport = new THREE.Vector4( 0, 0, _width, _height ),\r\n\r\n\t// frustum\r\n\r\n\t_frustum = new THREE.Frustum(),\r\n\r\n\t// clipping\r\n\r\n\t_clipping = new THREE.WebGLClipping(),\r\n\t_clippingEnabled = false,\r\n\t_localClippingEnabled = false,\r\n\r\n\t_sphere = new THREE.Sphere(),\r\n\r\n\t// camera matrices cache\r\n\r\n\t_projScreenMatrix = new THREE.Matrix4(),\r\n\r\n\t_vector3 = new THREE.Vector3(),\r\n\r\n\t// light arrays cache\r\n\r\n\t_lights = {\r\n\r\n\t\thash: '',\r\n\r\n\t\tambient: [ 0, 0, 0 ],\r\n\t\tdirectional: [],\r\n\t\tdirectionalShadowMap: [],\r\n\t\tdirectionalShadowMatrix: [],\r\n\t\tspot: [],\r\n\t\tspotShadowMap: [],\r\n\t\tspotShadowMatrix: [],\r\n\t\tpoint: [],\r\n\t\tpointShadowMap: [],\r\n\t\tpointShadowMatrix: [],\r\n\t\themi: [],\r\n\r\n\t\tshadows: []\r\n\r\n\t},\r\n\r\n\t// info\r\n\r\n\t_infoMemory = {\r\n\r\n\t\tgeometries: 0,\r\n\t\ttextures: 0\r\n\r\n\t},\r\n\r\n\t_infoRender = {\r\n\r\n\t\tcalls: 0,\r\n\t\tvertices: 0,\r\n\t\tfaces: 0,\r\n\t\tpoints: 0\r\n\r\n\t};\r\n\r\n\tthis.info = {\r\n\r\n\t\trender: _infoRender,\r\n\t\tmemory: _infoMemory,\r\n\t\tprograms: null\r\n\r\n\t};\r\n\r\n\r\n\t// initialize\r\n\r\n\tvar _gl;\r\n\r\n\ttry {\r\n\r\n\t\tvar attributes = {\r\n\t\t\talpha: _alpha,\r\n\t\t\tdepth: _depth,\r\n\t\t\tstencil: _stencil,\r\n\t\t\tantialias: _antialias,\r\n\t\t\tpremultipliedAlpha: _premultipliedAlpha,\r\n\t\t\tpreserveDrawingBuffer: _preserveDrawingBuffer\r\n\t\t};\r\n\r\n\t\t_gl = _context || _canvas.getContext( 'webgl', attributes ) || _canvas.getContext( 'experimental-webgl', attributes );\r\n\r\n\t\tif ( _gl === null ) {\r\n\r\n\t\t\tif ( _canvas.getContext( 'webgl' ) !== null ) {\r\n\r\n\t\t\t\tthrow 'Error creating WebGL context with your selected attributes.';\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthrow 'Error creating WebGL context.';\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// Some experimental-webgl implementations do not have getShaderPrecisionFormat\r\n\r\n\t\tif ( _gl.getShaderPrecisionFormat === undefined ) {\r\n\r\n\t\t\t_gl.getShaderPrecisionFormat = function () {\r\n\r\n\t\t\t\treturn { 'rangeMin': 1, 'rangeMax': 1, 'precision': 1 };\r\n\r\n\t\t\t};\r\n\r\n\t\t}\r\n\r\n\t\t_canvas.addEventListener( 'webglcontextlost', onContextLost, false );\r\n\r\n\t} catch ( error ) {\r\n\r\n\t\tconsole.error( 'THREE.WebGLRenderer: ' + error );\r\n\r\n\t}\r\n\r\n\tvar _isWebGL2 = (typeof WebGL2RenderingContext !== 'undefined' && _gl instanceof WebGL2RenderingContext);\r\n\tvar extensions = new THREE.WebGLExtensions( _gl );\r\n\r\n\textensions.get( 'WEBGL_depth_texture' );\r\n\textensions.get( 'OES_texture_float' );\r\n\textensions.get( 'OES_texture_float_linear' );\r\n\textensions.get( 'OES_texture_half_float' );\r\n\textensions.get( 'OES_texture_half_float_linear' );\r\n\textensions.get( 'OES_standard_derivatives' );\r\n\textensions.get( 'ANGLE_instanced_arrays' );\r\n\r\n\tif ( extensions.get( 'OES_element_index_uint' ) ) {\r\n\r\n\t\tTHREE.BufferGeometry.MaxIndex = 4294967296;\r\n\r\n\t}\r\n\r\n\tvar capabilities = new THREE.WebGLCapabilities( _gl, extensions, parameters );\r\n\r\n\tvar state = new THREE.WebGLState( _gl, extensions, paramThreeToGL );\r\n\tvar properties = new THREE.WebGLProperties();\r\n\tvar objects = new THREE.WebGLObjects( _gl, properties, this.info );\r\n\tvar programCache = new THREE.WebGLPrograms( this, capabilities );\r\n\tvar lightCache = new THREE.WebGLLights();\r\n\r\n\tthis.info.programs = programCache.programs;\r\n\r\n\tvar bufferRenderer = new THREE.WebGLBufferRenderer( _gl, extensions, _infoRender );\r\n\tvar indexedBufferRenderer = new THREE.WebGLIndexedBufferRenderer( _gl, extensions, _infoRender );\r\n\r\n\t//\r\n\r\n\tfunction getTargetPixelRatio() {\r\n\r\n\t\treturn _currentRenderTarget === null ? _pixelRatio : 1;\r\n\r\n\t}\r\n\r\n\tfunction glClearColor( r, g, b, a ) {\r\n\r\n\t\tif ( _premultipliedAlpha === true ) {\r\n\r\n\t\t\tr *= a; g *= a; b *= a;\r\n\r\n\t\t}\r\n\r\n\t\tstate.clearColor( r, g, b, a );\r\n\r\n\t}\r\n\r\n\tfunction setDefaultGLState() {\r\n\r\n\t\tstate.init();\r\n\r\n\t\tstate.scissor( _currentScissor.copy( _scissor ).multiplyScalar( _pixelRatio ) );\r\n\t\tstate.viewport( _currentViewport.copy( _viewport ).multiplyScalar( _pixelRatio ) );\r\n\r\n\t\tglClearColor( _clearColor.r, _clearColor.g, _clearColor.b, _clearAlpha );\r\n\r\n\t}\r\n\r\n\tfunction resetGLState() {\r\n\r\n\t\t_currentProgram = null;\r\n\t\t_currentCamera = null;\r\n\r\n\t\t_currentGeometryProgram = '';\r\n\t\t_currentMaterialId = - 1;\r\n\r\n\t\tstate.reset();\r\n\r\n\t}\r\n\r\n\tsetDefaultGLState();\r\n\r\n\tthis.context = _gl;\r\n\tthis.capabilities = capabilities;\r\n\tthis.extensions = extensions;\r\n\tthis.properties = properties;\r\n\tthis.state = state;\r\n\r\n\t// shadow map\r\n\r\n\tvar shadowMap = new THREE.WebGLShadowMap( this, _lights, objects );\r\n\r\n\tthis.shadowMap = shadowMap;\r\n\r\n\r\n\t// Plugins\r\n\r\n\tvar spritePlugin = new THREE.SpritePlugin( this, sprites );\r\n\tvar lensFlarePlugin = new THREE.LensFlarePlugin( this, lensFlares );\r\n\r\n\t// API\r\n\r\n\tthis.getContext = function () {\r\n\r\n\t\treturn _gl;\r\n\r\n\t};\r\n\r\n\tthis.getContextAttributes = function () {\r\n\r\n\t\treturn _gl.getContextAttributes();\r\n\r\n\t};\r\n\r\n\tthis.forceContextLoss = function () {\r\n\r\n\t\textensions.get( 'WEBGL_lose_context' ).loseContext();\r\n\r\n\t};\r\n\r\n\tthis.getMaxAnisotropy = ( function () {\r\n\r\n\t\tvar value;\r\n\r\n\t\treturn function getMaxAnisotropy() {\r\n\r\n\t\t\tif ( value !== undefined ) return value;\r\n\r\n\t\t\tvar extension = extensions.get( 'EXT_texture_filter_anisotropic' );\r\n\r\n\t\t\tif ( extension !== null ) {\r\n\r\n\t\t\t\tvalue = _gl.getParameter( extension.MAX_TEXTURE_MAX_ANISOTROPY_EXT );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tvalue = 0;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn value;\r\n\r\n\t\t};\r\n\r\n\t} )();\r\n\r\n\tthis.getPrecision = function () {\r\n\r\n\t\treturn capabilities.precision;\r\n\r\n\t};\r\n\r\n\tthis.getPixelRatio = function () {\r\n\r\n\t\treturn _pixelRatio;\r\n\r\n\t};\r\n\r\n\tthis.setPixelRatio = function ( value ) {\r\n\r\n\t\tif ( value === undefined ) return;\r\n\r\n\t\t_pixelRatio = value;\r\n\r\n\t\tthis.setSize( _viewport.z, _viewport.w, false );\r\n\r\n\t};\r\n\r\n\tthis.getSize = function () {\r\n\r\n\t\treturn {\r\n\t\t\twidth: _width,\r\n\t\t\theight: _height\r\n\t\t};\r\n\r\n\t};\r\n\r\n\tthis.setSize = function ( width, height, updateStyle ) {\r\n\r\n\t\t_width = width;\r\n\t\t_height = height;\r\n\r\n\t\t_canvas.width = width * _pixelRatio;\r\n\t\t_canvas.height = height * _pixelRatio;\r\n\r\n\t\tif ( updateStyle !== false ) {\r\n\r\n\t\t\t_canvas.style.width = width + 'px';\r\n\t\t\t_canvas.style.height = height + 'px';\r\n\r\n\t\t}\r\n\r\n\t\tthis.setViewport( 0, 0, width, height );\r\n\r\n\t};\r\n\r\n\tthis.setViewport = function ( x, y, width, height ) {\r\n\r\n\t\tstate.viewport( _viewport.set( x, y, width, height ) );\r\n\r\n\t};\r\n\r\n\tthis.setScissor = function ( x, y, width, height ) {\r\n\r\n\t\tstate.scissor( _scissor.set( x, y, width, height ) );\r\n\r\n\t};\r\n\r\n\tthis.setScissorTest = function ( boolean ) {\r\n\r\n\t\tstate.setScissorTest( _scissorTest = boolean );\r\n\r\n\t};\r\n\r\n\t// Clearing\r\n\r\n\tthis.getClearColor = function () {\r\n\r\n\t\treturn _clearColor;\r\n\r\n\t};\r\n\r\n\tthis.setClearColor = function ( color, alpha ) {\r\n\r\n\t\t_clearColor.set( color );\r\n\r\n\t\t_clearAlpha = alpha !== undefined ? alpha : 1;\r\n\r\n\t\tglClearColor( _clearColor.r, _clearColor.g, _clearColor.b, _clearAlpha );\r\n\r\n\t};\r\n\r\n\tthis.getClearAlpha = function () {\r\n\r\n\t\treturn _clearAlpha;\r\n\r\n\t};\r\n\r\n\tthis.setClearAlpha = function ( alpha ) {\r\n\r\n\t\t_clearAlpha = alpha;\r\n\r\n\t\tglClearColor( _clearColor.r, _clearColor.g, _clearColor.b, _clearAlpha );\r\n\r\n\t};\r\n\r\n\tthis.clear = function ( color, depth, stencil ) {\r\n\r\n\t\tvar bits = 0;\r\n\r\n\t\tif ( color === undefined || color ) bits |= _gl.COLOR_BUFFER_BIT;\r\n\t\tif ( depth === undefined || depth ) bits |= _gl.DEPTH_BUFFER_BIT;\r\n\t\tif ( stencil === undefined || stencil ) bits |= _gl.STENCIL_BUFFER_BIT;\r\n\r\n\t\t_gl.clear( bits );\r\n\r\n\t};\r\n\r\n\tthis.clearColor = function () {\r\n\r\n\t\tthis.clear( true, false, false );\r\n\r\n\t};\r\n\r\n\tthis.clearDepth = function () {\r\n\r\n\t\tthis.clear( false, true, false );\r\n\r\n\t};\r\n\r\n\tthis.clearStencil = function () {\r\n\r\n\t\tthis.clear( false, false, true );\r\n\r\n\t};\r\n\r\n\tthis.clearTarget = function ( renderTarget, color, depth, stencil ) {\r\n\r\n\t\tthis.setRenderTarget( renderTarget );\r\n\t\tthis.clear( color, depth, stencil );\r\n\r\n\t};\r\n\r\n\t// Reset\r\n\r\n\tthis.resetGLState = resetGLState;\r\n\r\n\tthis.dispose = function() {\r\n\r\n\t\t_canvas.removeEventListener( 'webglcontextlost', onContextLost, false );\r\n\r\n\t};\r\n\r\n\t// Events\r\n\r\n\tfunction onContextLost( event ) {\r\n\r\n\t\tevent.preventDefault();\r\n\r\n\t\tresetGLState();\r\n\t\tsetDefaultGLState();\r\n\r\n\t\tproperties.clear();\r\n\r\n\t}\r\n\r\n\tfunction onTextureDispose( event ) {\r\n\r\n\t\tvar texture = event.target;\r\n\r\n\t\ttexture.removeEventListener( 'dispose', onTextureDispose );\r\n\r\n\t\tdeallocateTexture( texture );\r\n\r\n\t\t_infoMemory.textures --;\r\n\r\n\r\n\t}\r\n\r\n\tfunction onRenderTargetDispose( event ) {\r\n\r\n\t\tvar renderTarget = event.target;\r\n\r\n\t\trenderTarget.removeEventListener( 'dispose', onRenderTargetDispose );\r\n\r\n\t\tdeallocateRenderTarget( renderTarget );\r\n\r\n\t\t_infoMemory.textures --;\r\n\r\n\t}\r\n\r\n\tfunction onMaterialDispose( event ) {\r\n\r\n\t\tvar material = event.target;\r\n\r\n\t\tmaterial.removeEventListener( 'dispose', onMaterialDispose );\r\n\r\n\t\tdeallocateMaterial( material );\r\n\r\n\t}\r\n\r\n\t// Buffer deallocation\r\n\r\n\tfunction deallocateTexture( texture ) {\r\n\r\n\t\tvar textureProperties = properties.get( texture );\r\n\r\n\t\tif ( texture.image && textureProperties.__image__webglTextureCube ) {\r\n\r\n\t\t\t// cube texture\r\n\r\n\t\t\t_gl.deleteTexture( textureProperties.__image__webglTextureCube );\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// 2D texture\r\n\r\n\t\t\tif ( textureProperties.__webglInit === undefined ) return;\r\n\r\n\t\t\t_gl.deleteTexture( textureProperties.__webglTexture );\r\n\r\n\t\t}\r\n\r\n\t\t// remove all webgl properties\r\n\t\tproperties.delete( texture );\r\n\r\n\t}\r\n\r\n\tfunction deallocateRenderTarget( renderTarget ) {\r\n\r\n\t\tvar renderTargetProperties = properties.get( renderTarget );\r\n\t\tvar textureProperties = properties.get( renderTarget.texture );\r\n\r\n\t\tif ( ! renderTarget ) return;\r\n\r\n\t\tif ( textureProperties.__webglTexture !== undefined ) {\r\n\r\n\t\t\t_gl.deleteTexture( textureProperties.__webglTexture );\r\n\r\n\t\t}\r\n\r\n\t\tif ( renderTarget.depthTexture ) {\r\n\r\n\t\t\trenderTarget.depthTexture.dispose();\r\n\r\n\t\t}\r\n\r\n\t\tif ( renderTarget instanceof THREE.WebGLRenderTargetCube ) {\r\n\r\n\t\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\r\n\t\t\t\t_gl.deleteFramebuffer( renderTargetProperties.__webglFramebuffer[ i ] );\r\n\t\t\t\tif ( renderTargetProperties.__webglDepthbuffer ) _gl.deleteRenderbuffer( renderTargetProperties.__webglDepthbuffer[ i ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\t_gl.deleteFramebuffer( renderTargetProperties.__webglFramebuffer );\r\n\t\t\tif ( renderTargetProperties.__webglDepthbuffer ) _gl.deleteRenderbuffer( renderTargetProperties.__webglDepthbuffer );\r\n\r\n\t\t}\r\n\r\n\t\tproperties.delete( renderTarget.texture );\r\n\t\tproperties.delete( renderTarget );\r\n\r\n\t}\r\n\r\n\tfunction deallocateMaterial( material ) {\r\n\r\n\t\treleaseMaterialProgramReference( material );\r\n\r\n\t\tproperties.delete( material );\r\n\r\n\t}\r\n\r\n\r\n\tfunction releaseMaterialProgramReference( material ) {\r\n\r\n\t\tvar programInfo = properties.get( material ).program;\r\n\r\n\t\tmaterial.program = undefined;\r\n\r\n\t\tif ( programInfo !== undefined ) {\r\n\r\n\t\t\tprogramCache.releaseProgram( programInfo );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// Buffer rendering\r\n\r\n\tthis.renderBufferImmediate = function ( object, program, material ) {\r\n\r\n\t\tstate.initAttributes();\r\n\r\n\t\tvar buffers = properties.get( object );\r\n\r\n\t\tif ( object.hasPositions && ! buffers.position ) buffers.position = _gl.createBuffer();\r\n\t\tif ( object.hasNormals && ! buffers.normal ) buffers.normal = _gl.createBuffer();\r\n\t\tif ( object.hasUvs && ! buffers.uv ) buffers.uv = _gl.createBuffer();\r\n\t\tif ( object.hasColors && ! buffers.color ) buffers.color = _gl.createBuffer();\r\n\r\n\t\tvar attributes = program.getAttributes();\r\n\r\n\t\tif ( object.hasPositions ) {\r\n\r\n\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, buffers.position );\r\n\t\t\t_gl.bufferData( _gl.ARRAY_BUFFER, object.positionArray, _gl.DYNAMIC_DRAW );\r\n\r\n\t\t\tstate.enableAttribute( attributes.position );\r\n\t\t\t_gl.vertexAttribPointer( attributes.position, 3, _gl.FLOAT, false, 0, 0 );\r\n\r\n\t\t}\r\n\r\n\t\tif ( object.hasNormals ) {\r\n\r\n\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, buffers.normal );\r\n\r\n\t\t\tif ( material.type !== 'MeshPhongMaterial' && material.type !== 'MeshStandardMaterial' && material.type !== 'MeshPhysicalMaterial' && material.shading === THREE.FlatShading ) {\r\n\r\n\t\t\t\tfor ( var i = 0, l = object.count * 3; i < l; i += 9 ) {\r\n\r\n\t\t\t\t\tvar array = object.normalArray;\r\n\r\n\t\t\t\t\tvar nx = ( array[ i + 0 ] + array[ i + 3 ] + array[ i + 6 ] ) / 3;\r\n\t\t\t\t\tvar ny = ( array[ i + 1 ] + array[ i + 4 ] + array[ i + 7 ] ) / 3;\r\n\t\t\t\t\tvar nz = ( array[ i + 2 ] + array[ i + 5 ] + array[ i + 8 ] ) / 3;\r\n\r\n\t\t\t\t\tarray[ i + 0 ] = nx;\r\n\t\t\t\t\tarray[ i + 1 ] = ny;\r\n\t\t\t\t\tarray[ i + 2 ] = nz;\r\n\r\n\t\t\t\t\tarray[ i + 3 ] = nx;\r\n\t\t\t\t\tarray[ i + 4 ] = ny;\r\n\t\t\t\t\tarray[ i + 5 ] = nz;\r\n\r\n\t\t\t\t\tarray[ i + 6 ] = nx;\r\n\t\t\t\t\tarray[ i + 7 ] = ny;\r\n\t\t\t\t\tarray[ i + 8 ] = nz;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t_gl.bufferData( _gl.ARRAY_BUFFER, object.normalArray, _gl.DYNAMIC_DRAW );\r\n\r\n\t\t\tstate.enableAttribute( attributes.normal );\r\n\r\n\t\t\t_gl.vertexAttribPointer( attributes.normal, 3, _gl.FLOAT, false, 0, 0 );\r\n\r\n\t\t}\r\n\r\n\t\tif ( object.hasUvs && material.map ) {\r\n\r\n\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, buffers.uv );\r\n\t\t\t_gl.bufferData( _gl.ARRAY_BUFFER, object.uvArray, _gl.DYNAMIC_DRAW );\r\n\r\n\t\t\tstate.enableAttribute( attributes.uv );\r\n\r\n\t\t\t_gl.vertexAttribPointer( attributes.uv, 2, _gl.FLOAT, false, 0, 0 );\r\n\r\n\t\t}\r\n\r\n\t\tif ( object.hasColors && material.vertexColors !== THREE.NoColors ) {\r\n\r\n\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, buffers.color );\r\n\t\t\t_gl.bufferData( _gl.ARRAY_BUFFER, object.colorArray, _gl.DYNAMIC_DRAW );\r\n\r\n\t\t\tstate.enableAttribute( attributes.color );\r\n\r\n\t\t\t_gl.vertexAttribPointer( attributes.color, 3, _gl.FLOAT, false, 0, 0 );\r\n\r\n\t\t}\r\n\r\n\t\tstate.disableUnusedAttributes();\r\n\r\n\t\t_gl.drawArrays( _gl.TRIANGLES, 0, object.count );\r\n\r\n\t\tobject.count = 0;\r\n\r\n\t};\r\n\r\n\tthis.renderBufferDirect = function ( camera, fog, geometry, material, object, group ) {\r\n\r\n\t\tsetMaterial( material );\r\n\r\n\t\tvar program = setProgram( camera, fog, material, object );\r\n\r\n\t\tvar updateBuffers = false;\r\n\t\tvar geometryProgram = geometry.id + '_' + program.id + '_' + material.wireframe;\r\n\r\n\t\tif ( geometryProgram !== _currentGeometryProgram ) {\r\n\r\n\t\t\t_currentGeometryProgram = geometryProgram;\r\n\t\t\tupdateBuffers = true;\r\n\r\n\t\t}\r\n\r\n\t\t// morph targets\r\n\r\n\t\tvar morphTargetInfluences = object.morphTargetInfluences;\r\n\r\n\t\tif ( morphTargetInfluences !== undefined ) {\r\n\r\n\t\t\tvar activeInfluences = [];\r\n\r\n\t\t\tfor ( var i = 0, l = morphTargetInfluences.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar influence = morphTargetInfluences[ i ];\r\n\t\t\t\tactiveInfluences.push( [ influence, i ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tactiveInfluences.sort( absNumericalSort );\r\n\r\n\t\t\tif ( activeInfluences.length > 8 ) {\r\n\r\n\t\t\t\tactiveInfluences.length = 8;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar morphAttributes = geometry.morphAttributes;\r\n\r\n\t\t\tfor ( var i = 0, l = activeInfluences.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar influence = activeInfluences[ i ];\r\n\t\t\t\tmorphInfluences[ i ] = influence[ 0 ];\r\n\r\n\t\t\t\tif ( influence[ 0 ] !== 0 ) {\r\n\r\n\t\t\t\t\tvar index = influence[ 1 ];\r\n\r\n\t\t\t\t\tif ( material.morphTargets === true && morphAttributes.position ) geometry.addAttribute( 'morphTarget' + i, morphAttributes.position[ index ] );\r\n\t\t\t\t\tif ( material.morphNormals === true && morphAttributes.normal ) geometry.addAttribute( 'morphNormal' + i, morphAttributes.normal[ index ] );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tif ( material.morphTargets === true ) geometry.removeAttribute( 'morphTarget' + i );\r\n\t\t\t\t\tif ( material.morphNormals === true ) geometry.removeAttribute( 'morphNormal' + i );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tprogram.getUniforms().setValue(\r\n\t\t\t\t\t_gl, 'morphTargetInfluences', morphInfluences );\r\n\r\n\t\t\tupdateBuffers = true;\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tvar index = geometry.index;\r\n\t\tvar position = geometry.attributes.position;\r\n\r\n\t\tif ( material.wireframe === true ) {\r\n\r\n\t\t\tindex = objects.getWireframeAttribute( geometry );\r\n\r\n\t\t}\r\n\r\n\t\tvar renderer;\r\n\r\n\t\tif ( index !== null ) {\r\n\r\n\t\t\trenderer = indexedBufferRenderer;\r\n\t\t\trenderer.setIndex( index );\r\n\r\n\t\t} else {\r\n\r\n\t\t\trenderer = bufferRenderer;\r\n\r\n\t\t}\r\n\r\n\t\tif ( updateBuffers ) {\r\n\r\n\t\t\tsetupVertexAttributes( material, program, geometry );\r\n\r\n\t\t\tif ( index !== null ) {\r\n\r\n\t\t\t\t_gl.bindBuffer( _gl.ELEMENT_ARRAY_BUFFER, objects.getAttributeBuffer( index ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tvar dataStart = 0;\r\n\t\tvar dataCount = Infinity;\r\n\r\n\t\tif ( index !== null ) {\r\n\r\n\t\t\tdataCount = index.count;\r\n\r\n\t\t} else if ( position !== undefined ) {\r\n\r\n\t\t\tdataCount = position.count;\r\n\r\n\t\t}\r\n\r\n\t\tvar rangeStart = geometry.drawRange.start;\r\n\t\tvar rangeCount = geometry.drawRange.count;\r\n\r\n\t\tvar groupStart = group !== null ? group.start : 0;\r\n\t\tvar groupCount = group !== null ? group.count : Infinity;\r\n\r\n\t\tvar drawStart = Math.max( dataStart, rangeStart, groupStart );\r\n\t\tvar drawEnd = Math.min( dataStart + dataCount, rangeStart + rangeCount, groupStart + groupCount ) - 1;\r\n\r\n\t\tvar drawCount = Math.max( 0, drawEnd - drawStart + 1 );\r\n\r\n\t\t//\r\n\r\n\t\tif ( object instanceof THREE.Mesh ) {\r\n\r\n\t\t\tif ( material.wireframe === true ) {\r\n\r\n\t\t\t\tstate.setLineWidth( material.wireframeLinewidth * getTargetPixelRatio() );\r\n\t\t\t\trenderer.setMode( _gl.LINES );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tswitch ( object.drawMode ) {\r\n\r\n\t\t\t\t\tcase THREE.TrianglesDrawMode:\r\n\t\t\t\t\t\trenderer.setMode( _gl.TRIANGLES );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase THREE.TriangleStripDrawMode:\r\n\t\t\t\t\t\trenderer.setMode( _gl.TRIANGLE_STRIP );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase THREE.TriangleFanDrawMode:\r\n\t\t\t\t\t\trenderer.setMode( _gl.TRIANGLE_FAN );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\r\n\t\t} else if ( object instanceof THREE.Line ) {\r\n\r\n\t\t\tvar lineWidth = material.linewidth;\r\n\r\n\t\t\tif ( lineWidth === undefined ) lineWidth = 1; // Not using Line*Material\r\n\r\n\t\t\tstate.setLineWidth( lineWidth * getTargetPixelRatio() );\r\n\r\n\t\t\tif ( object instanceof THREE.LineSegments ) {\r\n\r\n\t\t\t\trenderer.setMode( _gl.LINES );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\trenderer.setMode( _gl.LINE_STRIP );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( object instanceof THREE.Points ) {\r\n\r\n\t\t\trenderer.setMode( _gl.POINTS );\r\n\r\n\t\t}\r\n\r\n\t\tif ( geometry instanceof THREE.InstancedBufferGeometry ) {\r\n\r\n\t\t\tif ( geometry.maxInstancedCount > 0 ) {\r\n\r\n\t\t\t\trenderer.renderInstances( geometry, drawStart, drawCount );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\trenderer.render( drawStart, drawCount );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tfunction setupVertexAttributes( material, program, geometry, startIndex ) {\r\n\r\n\t\tvar extension;\r\n\r\n\t\tif ( geometry instanceof THREE.InstancedBufferGeometry ) {\r\n\r\n\t\t\textension = extensions.get( 'ANGLE_instanced_arrays' );\r\n\r\n\t\t\tif ( extension === null ) {\r\n\r\n\t\t\t\tconsole.error( 'THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.' );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( startIndex === undefined ) startIndex = 0;\r\n\r\n\t\tstate.initAttributes();\r\n\r\n\t\tvar geometryAttributes = geometry.attributes;\r\n\r\n\t\tvar programAttributes = program.getAttributes();\r\n\r\n\t\tvar materialDefaultAttributeValues = material.defaultAttributeValues;\r\n\r\n\t\tfor ( var name in programAttributes ) {\r\n\r\n\t\t\tvar programAttribute = programAttributes[ name ];\r\n\r\n\t\t\tif ( programAttribute >= 0 ) {\r\n\r\n\t\t\t\tvar geometryAttribute = geometryAttributes[ name ];\r\n\r\n\t\t\t\tif ( geometryAttribute !== undefined ) {\r\n\r\n\t\t\t\t\tvar type = _gl.FLOAT;\r\n\t\t\t\t\tvar array = geometryAttribute.array;\r\n\t\t\t\t\tvar normalized = geometryAttribute.normalized;\r\n\r\n\t\t\t\t\tif ( array instanceof Float32Array ) {\r\n\r\n\t\t\t\t\t\ttype = _gl.FLOAT;\r\n\r\n\t\t\t\t\t} else if ( array instanceof Float64Array ) {\r\n\r\n\t\t\t\t\t\tconsole.warn(\"Unsupported data buffer format: Float64Array\");\r\n\r\n\t\t\t\t\t} else if ( array instanceof Uint16Array ) {\r\n\r\n\t\t\t\t\t\ttype = _gl.UNSIGNED_SHORT;\r\n\r\n\t\t\t\t\t} else if ( array instanceof Int16Array ) {\r\n\r\n\t\t\t\t\t\ttype = _gl.SHORT;\r\n\r\n\t\t\t\t\t} else if ( array instanceof Uint32Array ) {\r\n\r\n\t\t\t\t\t\ttype = _gl.UNSIGNED_INT;\r\n\r\n\t\t\t\t\t} else if ( array instanceof Int32Array ) {\r\n\r\n\t\t\t\t\t\ttype = _gl.INT;\r\n\r\n\t\t\t\t\t} else if ( array instanceof Int8Array ) {\r\n\r\n\t\t\t\t\t\ttype = _gl.BYTE;\r\n\r\n\t\t\t\t\t} else if ( array instanceof Uint8Array ) {\r\n\r\n\t\t\t\t\t\ttype = _gl.UNSIGNED_BYTE;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar size = geometryAttribute.itemSize;\r\n\t\t\t\t\tvar buffer = objects.getAttributeBuffer( geometryAttribute );\r\n\r\n\t\t\t\t\tif ( geometryAttribute instanceof THREE.InterleavedBufferAttribute ) {\r\n\r\n\t\t\t\t\t\tvar data = geometryAttribute.data;\r\n\t\t\t\t\t\tvar stride = data.stride;\r\n\t\t\t\t\t\tvar offset = geometryAttribute.offset;\r\n\r\n\t\t\t\t\t\tif ( data instanceof THREE.InstancedInterleavedBuffer ) {\r\n\r\n\t\t\t\t\t\t\tstate.enableAttributeAndDivisor( programAttribute, data.meshPerAttribute, extension );\r\n\r\n\t\t\t\t\t\t\tif ( geometry.maxInstancedCount === undefined ) {\r\n\r\n\t\t\t\t\t\t\t\tgeometry.maxInstancedCount = data.meshPerAttribute * data.count;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tstate.enableAttribute( programAttribute );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, buffer );\r\n\t\t\t\t\t\t_gl.vertexAttribPointer( programAttribute, size, type, normalized, stride * data.array.BYTES_PER_ELEMENT, ( startIndex * stride + offset ) * data.array.BYTES_PER_ELEMENT );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tif ( geometryAttribute instanceof THREE.InstancedBufferAttribute ) {\r\n\r\n\t\t\t\t\t\t\tstate.enableAttributeAndDivisor( programAttribute, geometryAttribute.meshPerAttribute, extension );\r\n\r\n\t\t\t\t\t\t\tif ( geometry.maxInstancedCount === undefined ) {\r\n\r\n\t\t\t\t\t\t\t\tgeometry.maxInstancedCount = geometryAttribute.meshPerAttribute * geometryAttribute.count;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tstate.enableAttribute( programAttribute );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, buffer );\r\n\t\t\t\t\t\t_gl.vertexAttribPointer( programAttribute, size, type, normalized, 0, startIndex * size * geometryAttribute.array.BYTES_PER_ELEMENT );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else if ( materialDefaultAttributeValues !== undefined ) {\r\n\r\n\t\t\t\t\tvar value = materialDefaultAttributeValues[ name ];\r\n\r\n\t\t\t\t\tif ( value !== undefined ) {\r\n\r\n\t\t\t\t\t\tswitch ( value.length ) {\r\n\r\n\t\t\t\t\t\t\tcase 2:\r\n\t\t\t\t\t\t\t\t_gl.vertexAttrib2fv( programAttribute, value );\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\tcase 3:\r\n\t\t\t\t\t\t\t\t_gl.vertexAttrib3fv( programAttribute, value );\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\tcase 4:\r\n\t\t\t\t\t\t\t\t_gl.vertexAttrib4fv( programAttribute, value );\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\t\t_gl.vertexAttrib1fv( programAttribute, value );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tstate.disableUnusedAttributes();\r\n\r\n\t}\r\n\r\n\t// Sorting\r\n\r\n\tfunction absNumericalSort( a, b ) {\r\n\r\n\t\treturn Math.abs( b[ 0 ] ) - Math.abs( a[ 0 ] );\r\n\r\n\t}\r\n\r\n\tfunction painterSortStable ( a, b ) {\r\n\r\n\t\tif ( a.object.renderOrder !== b.object.renderOrder ) {\r\n\r\n\t\t\treturn a.object.renderOrder - b.object.renderOrder;\r\n\r\n\t\t} else if ( a.material.id !== b.material.id ) {\r\n\r\n\t\t\treturn a.material.id - b.material.id;\r\n\r\n\t\t} else if ( a.z !== b.z ) {\r\n\r\n\t\t\treturn a.z - b.z;\r\n\r\n\t\t} else {\r\n\r\n\t\t\treturn a.id - b.id;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction reversePainterSortStable ( a, b ) {\r\n\r\n\t\tif ( a.object.renderOrder !== b.object.renderOrder ) {\r\n\r\n\t\t\treturn a.object.renderOrder - b.object.renderOrder;\r\n\r\n\t\t} if ( a.z !== b.z ) {\r\n\r\n\t\t\treturn b.z - a.z;\r\n\r\n\t\t} else {\r\n\r\n\t\t\treturn a.id - b.id;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// Rendering\r\n\r\n\tthis.render = function ( scene, camera, renderTarget, forceClear ) {\r\n\r\n\t\tif ( camera instanceof THREE.Camera === false ) {\r\n\r\n\t\t\tconsole.error( 'THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.' );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tvar fog = scene.fog;\r\n\r\n\t\t// reset caching for this frame\r\n\r\n\t\t_currentGeometryProgram = '';\r\n\t\t_currentMaterialId = - 1;\r\n\t\t_currentCamera = null;\r\n\r\n\t\t// update scene graph\r\n\r\n\t\tif ( scene.autoUpdate === true ) scene.updateMatrixWorld();\r\n\r\n\t\t// update camera matrices and frustum\r\n\r\n\t\tif ( camera.parent === null ) camera.updateMatrixWorld();\r\n\r\n\t\tcamera.matrixWorldInverse.getInverse( camera.matrixWorld );\r\n\r\n\t\t_projScreenMatrix.multiplyMatrices( camera.projectionMatrix, camera.matrixWorldInverse );\r\n\t\t_frustum.setFromMatrix( _projScreenMatrix );\r\n\r\n\t\tlights.length = 0;\r\n\r\n\t\topaqueObjectsLastIndex = - 1;\r\n\t\ttransparentObjectsLastIndex = - 1;\r\n\r\n\t\tsprites.length = 0;\r\n\t\tlensFlares.length = 0;\r\n\r\n\t\t_localClippingEnabled = this.localClippingEnabled;\r\n\t\t_clippingEnabled = _clipping.init(\r\n\t\t\t\tthis.clippingPlanes, _localClippingEnabled, camera );\r\n\r\n\t\tprojectObject( scene, camera );\r\n\r\n\r\n\t\topaqueObjects.length = opaqueObjectsLastIndex + 1;\r\n\t\ttransparentObjects.length = transparentObjectsLastIndex + 1;\r\n\r\n\t\tif ( _this.sortObjects === true ) {\r\n\r\n\t\t\topaqueObjects.sort( painterSortStable );\r\n\t\t\ttransparentObjects.sort( reversePainterSortStable );\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tif ( _clippingEnabled ) _clipping.beginShadows();\r\n\r\n\t\tsetupShadows( lights );\r\n\r\n\t\tshadowMap.render( scene, camera );\r\n\r\n\t\tsetupLights( lights, camera );\r\n\r\n\t\tif ( _clippingEnabled ) _clipping.endShadows();\r\n\r\n\t\t//\r\n\r\n\t\t_infoRender.calls = 0;\r\n\t\t_infoRender.vertices = 0;\r\n\t\t_infoRender.faces = 0;\r\n\t\t_infoRender.points = 0;\r\n\r\n\t\tif ( renderTarget === undefined ) {\r\n\r\n\t\t\trenderTarget = null;\r\n\r\n\t\t}\r\n\r\n\t\tthis.setRenderTarget( renderTarget );\r\n\r\n\t\tif ( this.autoClear || forceClear ) {\r\n\r\n\t\t\tthis.clear( this.autoClearColor, this.autoClearDepth, this.autoClearStencil );\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tif ( scene.overrideMaterial ) {\r\n\r\n\t\t\tvar overrideMaterial = scene.overrideMaterial;\r\n\r\n\t\t\trenderObjects( opaqueObjects, camera, fog, overrideMaterial );\r\n\t\t\trenderObjects( transparentObjects, camera, fog, overrideMaterial );\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// opaque pass (front-to-back order)\r\n\r\n\t\t\tstate.setBlending( THREE.NoBlending );\r\n\t\t\trenderObjects( opaqueObjects, camera, fog );\r\n\r\n\t\t\t// transparent pass (back-to-front order)\r\n\r\n\t\t\trenderObjects( transparentObjects, camera, fog );\r\n\r\n\t\t}\r\n\r\n\t\t// custom render plugins (post pass)\r\n\r\n\t\tspritePlugin.render( scene, camera );\r\n\t\tlensFlarePlugin.render( scene, camera, _currentViewport );\r\n\r\n\t\t// Generate mipmap if we're using any kind of mipmap filtering\r\n\r\n\t\tif ( renderTarget ) {\r\n\r\n\t\t\tvar texture = renderTarget.texture;\r\n\r\n\t\t\tif ( texture.generateMipmaps && isPowerOfTwo( renderTarget ) &&\r\n\t\t\t\t\ttexture.minFilter !== THREE.NearestFilter &&\r\n\t\t\t\t\ttexture.minFilter !== THREE.LinearFilter ) {\r\n\r\n\t\t\t\tupdateRenderTargetMipmap( renderTarget );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// Ensure depth buffer writing is enabled so it can be cleared on next render\r\n\r\n\t\tstate.setDepthTest( true );\r\n\t\tstate.setDepthWrite( true );\r\n\t\tstate.setColorWrite( true );\r\n\r\n\t\t// _gl.finish();\r\n\r\n\t};\r\n\r\n\tfunction pushRenderItem( object, geometry, material, z, group ) {\r\n\r\n\t\tvar array, index;\r\n\r\n\t\t// allocate the next position in the appropriate array\r\n\r\n\t\tif ( material.transparent ) {\r\n\r\n\t\t\tarray = transparentObjects;\r\n\t\t\tindex = ++ transparentObjectsLastIndex;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tarray = opaqueObjects;\r\n\t\t\tindex = ++ opaqueObjectsLastIndex;\r\n\r\n\t\t}\r\n\r\n\t\t// recycle existing render item or grow the array\r\n\r\n\t\tvar renderItem = array[ index ];\r\n\r\n\t\tif ( renderItem !== undefined ) {\r\n\r\n\t\t\trenderItem.id = object.id;\r\n\t\t\trenderItem.object = object;\r\n\t\t\trenderItem.geometry = geometry;\r\n\t\t\trenderItem.material = material;\r\n\t\t\trenderItem.z = _vector3.z;\r\n\t\t\trenderItem.group = group;\r\n\r\n\t\t} else {\r\n\r\n\t\t\trenderItem = {\r\n\t\t\t\tid: object.id,\r\n\t\t\t\tobject: object,\r\n\t\t\t\tgeometry: geometry,\r\n\t\t\t\tmaterial: material,\r\n\t\t\t\tz: _vector3.z,\r\n\t\t\t\tgroup: group\r\n\t\t\t};\r\n\r\n\t\t\t// assert( index === array.length );\r\n\t\t\tarray.push( renderItem );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// TODO Duplicated code (Frustum)\r\n\r\n\tfunction isObjectViewable( object ) {\r\n\r\n\t\tvar geometry = object.geometry;\r\n\r\n\t\tif ( geometry.boundingSphere === null )\r\n\t\t\tgeometry.computeBoundingSphere();\r\n\r\n\t\t_sphere.copy( geometry.boundingSphere ).\r\n\t\t\tapplyMatrix4( object.matrixWorld );\r\n\r\n\t\treturn isSphereViewable( _sphere );\r\n\r\n\t}\r\n\r\n\tfunction isSpriteViewable( sprite ) {\r\n\r\n\t\t_sphere.center.set( 0, 0, 0 );\r\n\t\t_sphere.radius = 0.7071067811865476;\r\n\t\t_sphere.applyMatrix4( sprite.matrixWorld );\r\n\r\n\t\treturn isSphereViewable( _sphere );\r\n\r\n\t}\r\n\r\n\tfunction isSphereViewable( sphere ) {\r\n\r\n\t\tif ( ! _frustum.intersectsSphere( sphere ) ) return false;\r\n\r\n\t\tvar numPlanes = _clipping.numPlanes;\r\n\r\n\t\tif ( numPlanes === 0 ) return true;\r\n\r\n\t\tvar planes = _this.clippingPlanes,\r\n\r\n\t\t\tcenter = sphere.center,\r\n\t\t\tnegRad = - sphere.radius,\r\n\t\t\ti = 0;\r\n\r\n\t\tdo {\r\n\r\n\t\t\t// out when deeper than radius in the negative halfspace\r\n\t\t\tif ( planes[ i ].distanceToPoint( center ) < negRad ) return false;\r\n\r\n\t\t} while ( ++ i !== numPlanes );\r\n\r\n\t\treturn true;\r\n\r\n\t}\r\n\r\n\tfunction projectObject( object, camera ) {\r\n\r\n\t\tif ( object.visible === false ) return;\r\n\r\n\t\tif ( object.layers.test( camera.layers ) ) {\r\n\r\n\t\t\tif ( object instanceof THREE.Light ) {\r\n\r\n\t\t\t\tlights.push( object );\r\n\r\n\t\t\t} else if ( object instanceof THREE.Sprite ) {\r\n\r\n\t\t\t\tif ( object.frustumCulled === false || isSpriteViewable( object ) === true ) {\r\n\r\n\t\t\t\t\tsprites.push( object );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( object instanceof THREE.LensFlare ) {\r\n\r\n\t\t\t\tlensFlares.push( object );\r\n\r\n\t\t\t} else if ( object instanceof THREE.ImmediateRenderObject ) {\r\n\r\n\t\t\t\tif ( _this.sortObjects === true ) {\r\n\r\n\t\t\t\t\t_vector3.setFromMatrixPosition( object.matrixWorld );\r\n\t\t\t\t\t_vector3.applyProjection( _projScreenMatrix );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tpushRenderItem( object, null, object.material, _vector3.z, null );\r\n\r\n\t\t\t} else if ( object instanceof THREE.Mesh || object instanceof THREE.Line || object instanceof THREE.Points ) {\r\n\r\n\t\t\t\tif ( object instanceof THREE.SkinnedMesh ) {\r\n\r\n\t\t\t\t\tobject.skeleton.update();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( object.frustumCulled === false || isObjectViewable( object ) === true ) {\r\n\r\n\t\t\t\t\tvar material = object.material;\r\n\r\n\t\t\t\t\tif ( material.visible === true ) {\r\n\r\n\t\t\t\t\t\tif ( _this.sortObjects === true ) {\r\n\r\n\t\t\t\t\t\t\t_vector3.setFromMatrixPosition( object.matrixWorld );\r\n\t\t\t\t\t\t\t_vector3.applyProjection( _projScreenMatrix );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tvar geometry = objects.update( object );\r\n\r\n\t\t\t\t\t\tif ( material instanceof THREE.MultiMaterial ) {\r\n\r\n\t\t\t\t\t\t\tvar groups = geometry.groups;\r\n\t\t\t\t\t\t\tvar materials = material.materials;\r\n\r\n\t\t\t\t\t\t\tfor ( var i = 0, l = groups.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\t\t\t\tvar group = groups[ i ];\r\n\t\t\t\t\t\t\t\tvar groupMaterial = materials[ group.materialIndex ];\r\n\r\n\t\t\t\t\t\t\t\tif ( groupMaterial.visible === true ) {\r\n\r\n\t\t\t\t\t\t\t\t\tpushRenderItem( object, geometry, groupMaterial, _vector3.z, group );\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tpushRenderItem( object, geometry, material, _vector3.z, null );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar children = object.children;\r\n\r\n\t\tfor ( var i = 0, l = children.length; i < l; i ++ ) {\r\n\r\n\t\t\tprojectObject( children[ i ], camera );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction renderObjects( renderList, camera, fog, overrideMaterial ) {\r\n\r\n\t\tfor ( var i = 0, l = renderList.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar renderItem = renderList[ i ];\r\n\r\n\t\t\tvar object = renderItem.object;\r\n\t\t\tvar geometry = renderItem.geometry;\r\n\t\t\tvar material = overrideMaterial === undefined ? renderItem.material : overrideMaterial;\r\n\t\t\tvar group = renderItem.group;\r\n\r\n\t\t\tobject.modelViewMatrix.multiplyMatrices( camera.matrixWorldInverse, object.matrixWorld );\r\n\t\t\tobject.normalMatrix.getNormalMatrix( object.modelViewMatrix );\r\n\r\n\t\t\tif ( object instanceof THREE.ImmediateRenderObject ) {\r\n\r\n\t\t\t\tsetMaterial( material );\r\n\r\n\t\t\t\tvar program = setProgram( camera, fog, material, object );\r\n\r\n\t\t\t\t_currentGeometryProgram = '';\r\n\r\n\t\t\t\tobject.render( function ( object ) {\r\n\r\n\t\t\t\t\t_this.renderBufferImmediate( object, program, material );\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t_this.renderBufferDirect( camera, fog, geometry, material, object, group );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction initMaterial( material, fog, object ) {\r\n\r\n\t\tvar materialProperties = properties.get( material );\r\n\r\n\t\tvar parameters = programCache.getParameters(\r\n\t\t\t\tmaterial, _lights, fog, _clipping.numPlanes, object );\r\n\r\n\t\tvar code = programCache.getProgramCode( material, parameters );\r\n\r\n\t\tvar program = materialProperties.program;\r\n\t\tvar programChange = true;\r\n\r\n\t\tif ( program === undefined ) {\r\n\r\n\t\t\t// new material\r\n\t\t\tmaterial.addEventListener( 'dispose', onMaterialDispose );\r\n\r\n\t\t} else if ( program.code !== code ) {\r\n\r\n\t\t\t// changed glsl or parameters\r\n\t\t\treleaseMaterialProgramReference( material );\r\n\r\n\t\t} else if ( parameters.shaderID !== undefined ) {\r\n\r\n\t\t\t// same glsl and uniform list\r\n\t\t\treturn;\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// only rebuild uniform list\r\n\t\t\tprogramChange = false;\r\n\r\n\t\t}\r\n\r\n\t\tif ( programChange ) {\r\n\r\n\t\t\tif ( parameters.shaderID ) {\r\n\r\n\t\t\t\tvar shader = THREE.ShaderLib[ parameters.shaderID ];\r\n\r\n\t\t\t\tmaterialProperties.__webglShader = {\r\n\t\t\t\t\tname: material.type,\r\n\t\t\t\t\tuniforms: THREE.UniformsUtils.clone( shader.uniforms ),\r\n\t\t\t\t\tvertexShader: shader.vertexShader,\r\n\t\t\t\t\tfragmentShader: shader.fragmentShader\r\n\t\t\t\t};\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tmaterialProperties.__webglShader = {\r\n\t\t\t\t\tname: material.type,\r\n\t\t\t\t\tuniforms: material.uniforms,\r\n\t\t\t\t\tvertexShader: material.vertexShader,\r\n\t\t\t\t\tfragmentShader: material.fragmentShader\r\n\t\t\t\t};\r\n\r\n\t\t\t}\r\n\r\n\t\t\tmaterial.__webglShader = materialProperties.__webglShader;\r\n\r\n\t\t\tprogram = programCache.acquireProgram( material, parameters, code );\r\n\r\n\t\t\tmaterialProperties.program = program;\r\n\t\t\tmaterial.program = program;\r\n\r\n\t\t}\r\n\r\n\t\tvar attributes = program.getAttributes();\r\n\r\n\t\tif ( material.morphTargets ) {\r\n\r\n\t\t\tmaterial.numSupportedMorphTargets = 0;\r\n\r\n\t\t\tfor ( var i = 0; i < _this.maxMorphTargets; i ++ ) {\r\n\r\n\t\t\t\tif ( attributes[ 'morphTarget' + i ] >= 0 ) {\r\n\r\n\t\t\t\t\tmaterial.numSupportedMorphTargets ++;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( material.morphNormals ) {\r\n\r\n\t\t\tmaterial.numSupportedMorphNormals = 0;\r\n\r\n\t\t\tfor ( var i = 0; i < _this.maxMorphNormals; i ++ ) {\r\n\r\n\t\t\t\tif ( attributes[ 'morphNormal' + i ] >= 0 ) {\r\n\r\n\t\t\t\t\tmaterial.numSupportedMorphNormals ++;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar uniforms = materialProperties.__webglShader.uniforms;\r\n\r\n\t\tif ( ! ( material instanceof THREE.ShaderMaterial ) &&\r\n\t\t\t\t! ( material instanceof THREE.RawShaderMaterial ) ||\r\n\t\t\t\tmaterial.clipping === true ) {\r\n\r\n\t\t\tmaterialProperties.numClippingPlanes = _clipping.numPlanes;\r\n\t\t\tuniforms.clippingPlanes = _clipping.uniform;\r\n\r\n\t\t}\r\n\r\n\t\tif ( material.lights ) {\r\n\r\n\t\t\t// store the light setup it was created for\r\n\r\n\t\t\tmaterialProperties.lightsHash = _lights.hash;\r\n\r\n\t\t\t// wire up the material to this renderer's lighting state\r\n\r\n\t\t\tuniforms.ambientLightColor.value = _lights.ambient;\r\n\t\t\tuniforms.directionalLights.value = _lights.directional;\r\n\t\t\tuniforms.spotLights.value = _lights.spot;\r\n\t\t\tuniforms.pointLights.value = _lights.point;\r\n\t\t\tuniforms.hemisphereLights.value = _lights.hemi;\r\n\r\n\t\t\tuniforms.directionalShadowMap.value = _lights.directionalShadowMap;\r\n\t\t\tuniforms.directionalShadowMatrix.value = _lights.directionalShadowMatrix;\r\n\t\t\tuniforms.spotShadowMap.value = _lights.spotShadowMap;\r\n\t\t\tuniforms.spotShadowMatrix.value = _lights.spotShadowMatrix;\r\n\t\t\tuniforms.pointShadowMap.value = _lights.pointShadowMap;\r\n\t\t\tuniforms.pointShadowMatrix.value = _lights.pointShadowMatrix;\r\n\r\n\t\t}\r\n\r\n\t\tvar progUniforms = materialProperties.program.getUniforms(),\r\n\t\t\tuniformsList =\r\n\t\t\t\t\tTHREE.WebGLUniforms.seqWithValue( progUniforms.seq, uniforms );\r\n\r\n\t\tmaterialProperties.uniformsList = uniformsList;\r\n\t\tmaterialProperties.dynamicUniforms =\r\n\t\t\t\tTHREE.WebGLUniforms.splitDynamic( uniformsList, uniforms );\r\n\r\n\t}\r\n\r\n\tfunction setMaterial( material ) {\r\n\r\n\t\tif ( material.side !== THREE.DoubleSide )\r\n\t\t\tstate.enable( _gl.CULL_FACE );\r\n\t\telse\r\n\t\t\tstate.disable( _gl.CULL_FACE );\r\n\r\n\t\tstate.setFlipSided( material.side === THREE.BackSide );\r\n\r\n\t\tif ( material.transparent === true ) {\r\n\r\n\t\t\tstate.setBlending( material.blending, material.blendEquation, material.blendSrc, material.blendDst, material.blendEquationAlpha, material.blendSrcAlpha, material.blendDstAlpha, material.premultipliedAlpha );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tstate.setBlending( THREE.NoBlending );\r\n\r\n\t\t}\r\n\r\n\t\tstate.setDepthFunc( material.depthFunc );\r\n\t\tstate.setDepthTest( material.depthTest );\r\n\t\tstate.setDepthWrite( material.depthWrite );\r\n\t\tstate.setColorWrite( material.colorWrite );\r\n\t\tstate.setPolygonOffset( material.polygonOffset, material.polygonOffsetFactor, material.polygonOffsetUnits );\r\n\r\n\t}\r\n\r\n\tfunction setProgram( camera, fog, material, object ) {\r\n\r\n\t\t_usedTextureUnits = 0;\r\n\r\n\t\tvar materialProperties = properties.get( material );\r\n\r\n\t\tif ( _clippingEnabled ) {\r\n\r\n\t\t\tif ( _localClippingEnabled || camera !== _currentCamera ) {\r\n\r\n\t\t\t\tvar useCache =\r\n\t\t\t\t\t\tcamera === _currentCamera &&\r\n\t\t\t\t\t\tmaterial.id === _currentMaterialId;\r\n\r\n\t\t\t\t// we might want to call this function with some ClippingGroup\r\n\t\t\t\t// object instead of the material, once it becomes feasible\r\n\t\t\t\t// (#8465, #8379)\r\n\t\t\t\t_clipping.setState(\r\n\t\t\t\t\t\tmaterial.clippingPlanes, material.clipShadows,\r\n\t\t\t\t\t\tcamera, materialProperties, useCache );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( materialProperties.numClippingPlanes !== undefined &&\r\n\t\t\t\tmaterialProperties.numClippingPlanes !== _clipping.numPlanes ) {\r\n\r\n\t\t\t\tmaterial.needsUpdate = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( materialProperties.program === undefined ) {\r\n\r\n\t\t\tmaterial.needsUpdate = true;\r\n\r\n\t\t}\r\n\r\n\t\tif ( materialProperties.lightsHash !== undefined &&\r\n\t\t\tmaterialProperties.lightsHash !== _lights.hash ) {\r\n\r\n\t\t\tmaterial.needsUpdate = true;\r\n\r\n\t\t}\r\n\r\n\t\tif ( material.needsUpdate ) {\r\n\r\n\t\t\tinitMaterial( material, fog, object );\r\n\t\t\tmaterial.needsUpdate = false;\r\n\r\n\t\t}\r\n\r\n\t\tvar refreshProgram = false;\r\n\t\tvar refreshMaterial = false;\r\n\t\tvar refreshLights = false;\r\n\r\n\t\tvar program = materialProperties.program,\r\n\t\t\tp_uniforms = program.getUniforms(),\r\n\t\t\tm_uniforms = materialProperties.__webglShader.uniforms;\r\n\r\n\t\tif ( program.id !== _currentProgram ) {\r\n\r\n\t\t\t_gl.useProgram( program.program );\r\n\t\t\t_currentProgram = program.id;\r\n\r\n\t\t\trefreshProgram = true;\r\n\t\t\trefreshMaterial = true;\r\n\t\t\trefreshLights = true;\r\n\r\n\t\t}\r\n\r\n\t\tif ( material.id !== _currentMaterialId ) {\r\n\r\n\t\t\t_currentMaterialId = material.id;\r\n\r\n\t\t\trefreshMaterial = true;\r\n\r\n\t\t}\r\n\r\n\t\tif ( refreshProgram || camera !== _currentCamera ) {\r\n\r\n\t\t\tp_uniforms.set( _gl, camera, 'projectionMatrix' );\r\n\r\n\t\t\tif ( capabilities.logarithmicDepthBuffer ) {\r\n\r\n\t\t\t\tp_uniforms.setValue( _gl, 'logDepthBufFC',\r\n\t\t\t\t\t\t2.0 / ( Math.log( camera.far + 1.0 ) / Math.LN2 ) );\r\n\r\n\t\t\t}\r\n\r\n\r\n\t\t\tif ( camera !== _currentCamera ) {\r\n\r\n\t\t\t\t_currentCamera = camera;\r\n\r\n\t\t\t\t// lighting uniforms depend on the camera so enforce an update\r\n\t\t\t\t// now, in case this material supports lights - or later, when\r\n\t\t\t\t// the next material that does gets activated:\r\n\r\n\t\t\t\trefreshMaterial = true;\t\t// set to true on material change\r\n\t\t\t\trefreshLights = true;\t\t// remains set until update done\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// load material specific uniforms\r\n\t\t\t// (shader material also gets them for the sake of genericity)\r\n\r\n\t\t\tif ( material instanceof THREE.ShaderMaterial ||\r\n\t\t\t\t material instanceof THREE.MeshPhongMaterial ||\r\n\t\t\t\t material instanceof THREE.MeshStandardMaterial ||\r\n\t\t\t\t material.envMap ) {\r\n\r\n\t\t\t\tvar uCamPos = p_uniforms.map.cameraPosition;\r\n\r\n\t\t\t\tif ( uCamPos !== undefined ) {\r\n\r\n\t\t\t\t\tuCamPos.setValue( _gl,\r\n\t\t\t\t\t\t\t_vector3.setFromMatrixPosition( camera.matrixWorld ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material instanceof THREE.MeshPhongMaterial ||\r\n\t\t\t\t material instanceof THREE.MeshLambertMaterial ||\r\n\t\t\t\t material instanceof THREE.MeshBasicMaterial ||\r\n\t\t\t\t material instanceof THREE.MeshStandardMaterial ||\r\n\t\t\t\t material instanceof THREE.ShaderMaterial ||\r\n\t\t\t\t material.skinning ) {\r\n\r\n\t\t\t\tp_uniforms.setValue( _gl, 'viewMatrix', camera.matrixWorldInverse );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tp_uniforms.set( _gl, _this, 'toneMappingExposure' );\r\n\t\t\tp_uniforms.set( _gl, _this, 'toneMappingWhitePoint' );\r\n\r\n\t\t}\r\n\r\n\t\t// skinning uniforms must be set even if material didn't change\r\n\t\t// auto-setting of texture unit for bone texture must go before other textures\r\n\t\t// not sure why, but otherwise weird things happen\r\n\r\n\t\tif ( material.skinning ) {\r\n\r\n\t\t\tp_uniforms.setOptional( _gl, object, 'bindMatrix' );\r\n\t\t\tp_uniforms.setOptional( _gl, object, 'bindMatrixInverse' );\r\n\r\n\t\t\tvar skeleton = object.skeleton;\r\n\r\n\t\t\tif ( skeleton ) {\r\n\r\n\t\t\t\tif ( capabilities.floatVertexTextures && skeleton.useVertexTexture ) {\r\n\r\n\t\t\t\t\tp_uniforms.set( _gl, skeleton, 'boneTexture' );\r\n\t\t\t\t\tp_uniforms.set( _gl, skeleton, 'boneTextureWidth' );\r\n\t\t\t\t\tp_uniforms.set( _gl, skeleton, 'boneTextureHeight' );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tp_uniforms.setOptional( _gl, skeleton, 'boneMatrices' );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( refreshMaterial ) {\r\n\r\n\t\t\tif ( material.lights ) {\r\n\r\n\t\t\t\t// the current material requires lighting info\r\n\r\n\t\t\t\t// note: all lighting uniforms are always set correctly\r\n\t\t\t\t// they simply reference the renderer's state for their\r\n\t\t\t\t// values\r\n\t\t\t\t//\r\n\t\t\t\t// use the current material's .needsUpdate flags to set\r\n\t\t\t\t// the GL state when required\r\n\r\n\t\t\t\tmarkUniformsLightsNeedsUpdate( m_uniforms, refreshLights );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// refresh uniforms common to several materials\r\n\r\n\t\t\tif ( fog && material.fog ) {\r\n\r\n\t\t\t\trefreshUniformsFog( m_uniforms, fog );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material instanceof THREE.MeshBasicMaterial ||\r\n\t\t\t\t material instanceof THREE.MeshLambertMaterial ||\r\n\t\t\t\t material instanceof THREE.MeshPhongMaterial ||\r\n\t\t\t\t material instanceof THREE.MeshStandardMaterial ||\r\n\t\t\t\t material instanceof THREE.MeshDepthMaterial ) {\r\n\r\n\t\t\t\trefreshUniformsCommon( m_uniforms, material );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// refresh single material specific uniforms\r\n\r\n\t\t\tif ( material instanceof THREE.LineBasicMaterial ) {\r\n\r\n\t\t\t\trefreshUniformsLine( m_uniforms, material );\r\n\r\n\t\t\t} else if ( material instanceof THREE.LineDashedMaterial ) {\r\n\r\n\t\t\t\trefreshUniformsLine( m_uniforms, material );\r\n\t\t\t\trefreshUniformsDash( m_uniforms, material );\r\n\r\n\t\t\t} else if ( material instanceof THREE.PointsMaterial ) {\r\n\r\n\t\t\t\trefreshUniformsPoints( m_uniforms, material );\r\n\r\n\t\t\t} else if ( material instanceof THREE.MeshLambertMaterial ) {\r\n\r\n\t\t\t\trefreshUniformsLambert( m_uniforms, material );\r\n\r\n\t\t\t} else if ( material instanceof THREE.MeshPhongMaterial ) {\r\n\r\n\t\t\t\trefreshUniformsPhong( m_uniforms, material );\r\n\r\n\t\t\t} else if ( material instanceof THREE.MeshPhysicalMaterial ) {\r\n\r\n\t\t\t\trefreshUniformsPhysical( m_uniforms, material );\r\n\r\n\t\t\t} else if ( material instanceof THREE.MeshStandardMaterial ) {\r\n\r\n\t\t\t\trefreshUniformsStandard( m_uniforms, material );\r\n\r\n\t\t\t} else if ( material instanceof THREE.MeshDepthMaterial ) {\r\n\r\n\t\t\t\tif ( material.displacementMap ) {\r\n\r\n\t\t\t\t\tm_uniforms.displacementMap.value = material.displacementMap;\r\n\t\t\t\t\tm_uniforms.displacementScale.value = material.displacementScale;\r\n\t\t\t\t\tm_uniforms.displacementBias.value = material.displacementBias;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( material instanceof THREE.MeshNormalMaterial ) {\r\n\r\n\t\t\t\tm_uniforms.opacity.value = material.opacity;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tTHREE.WebGLUniforms.upload(\r\n\t\t\t\t\t_gl, materialProperties.uniformsList, m_uniforms, _this );\r\n\r\n\t\t}\r\n\r\n\r\n\t\t// common matrices\r\n\r\n\t\tp_uniforms.set( _gl, object, 'modelViewMatrix' );\r\n\t\tp_uniforms.set( _gl, object, 'normalMatrix' );\r\n\t\tp_uniforms.setValue( _gl, 'modelMatrix', object.matrixWorld );\r\n\r\n\r\n\t\t// dynamic uniforms\r\n\r\n\t\tvar dynUniforms = materialProperties.dynamicUniforms;\r\n\r\n\t\tif ( dynUniforms !== null ) {\r\n\r\n\t\t\tTHREE.WebGLUniforms.evalDynamic(\r\n\t\t\t\t\tdynUniforms, m_uniforms, object, camera );\r\n\r\n\t\t\tTHREE.WebGLUniforms.upload( _gl, dynUniforms, m_uniforms, _this );\r\n\r\n\t\t}\r\n\r\n\t\treturn program;\r\n\r\n\t}\r\n\r\n\t// Uniforms (refresh uniforms objects)\r\n\r\n\tfunction refreshUniformsCommon ( uniforms, material ) {\r\n\r\n\t\tuniforms.opacity.value = material.opacity;\r\n\r\n\t\tuniforms.diffuse.value = material.color;\r\n\r\n\t\tif ( material.emissive ) {\r\n\r\n\t\t\tuniforms.emissive.value.copy( material.emissive ).multiplyScalar( material.emissiveIntensity );\r\n\r\n\t\t}\r\n\r\n\t\tuniforms.map.value = material.map;\r\n\t\tuniforms.specularMap.value = material.specularMap;\r\n\t\tuniforms.alphaMap.value = material.alphaMap;\r\n\r\n\t\tif ( material.aoMap ) {\r\n\r\n\t\t\tuniforms.aoMap.value = material.aoMap;\r\n\t\t\tuniforms.aoMapIntensity.value = material.aoMapIntensity;\r\n\r\n\t\t}\r\n\r\n\t\t// uv repeat and offset setting priorities\r\n\t\t// 1. color map\r\n\t\t// 2. specular map\r\n\t\t// 3. normal map\r\n\t\t// 4. bump map\r\n\t\t// 5. alpha map\r\n\t\t// 6. emissive map\r\n\r\n\t\tvar uvScaleMap;\r\n\r\n\t\tif ( material.map ) {\r\n\r\n\t\t\tuvScaleMap = material.map;\r\n\r\n\t\t} else if ( material.specularMap ) {\r\n\r\n\t\t\tuvScaleMap = material.specularMap;\r\n\r\n\t\t} else if ( material.displacementMap ) {\r\n\r\n\t\t\tuvScaleMap = material.displacementMap;\r\n\r\n\t\t} else if ( material.normalMap ) {\r\n\r\n\t\t\tuvScaleMap = material.normalMap;\r\n\r\n\t\t} else if ( material.bumpMap ) {\r\n\r\n\t\t\tuvScaleMap = material.bumpMap;\r\n\r\n\t\t} else if ( material.roughnessMap ) {\r\n\r\n\t\t\tuvScaleMap = material.roughnessMap;\r\n\r\n\t\t} else if ( material.metalnessMap ) {\r\n\r\n\t\t\tuvScaleMap = material.metalnessMap;\r\n\r\n\t\t} else if ( material.alphaMap ) {\r\n\r\n\t\t\tuvScaleMap = material.alphaMap;\r\n\r\n\t\t} else if ( material.emissiveMap ) {\r\n\r\n\t\t\tuvScaleMap = material.emissiveMap;\r\n\r\n\t\t}\r\n\r\n\t\tif ( uvScaleMap !== undefined ) {\r\n\r\n\t\t\t// backwards compatibility\r\n\t\t\tif ( uvScaleMap instanceof THREE.WebGLRenderTarget ) {\r\n\r\n\t\t\t\tuvScaleMap = uvScaleMap.texture;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar offset = uvScaleMap.offset;\r\n\t\t\tvar repeat = uvScaleMap.repeat;\r\n\r\n\t\t\tuniforms.offsetRepeat.value.set( offset.x, offset.y, repeat.x, repeat.y );\r\n\r\n\t\t}\r\n\r\n\t\tuniforms.envMap.value = material.envMap;\r\n\r\n\t\t// don't flip CubeTexture envMaps, flip everything else:\r\n\t\t//  WebGLRenderTargetCube will be flipped for backwards compatibility\r\n\t\t//  WebGLRenderTargetCube.texture will be flipped because it's a Texture and NOT a CubeTexture\r\n\t\t// this check must be handled differently, or removed entirely, if WebGLRenderTargetCube uses a CubeTexture in the future\r\n\t\tuniforms.flipEnvMap.value = ( ! ( material.envMap instanceof THREE.CubeTexture ) ) ? 1 : - 1;\r\n\r\n\t\tuniforms.reflectivity.value = material.reflectivity;\r\n\t\tuniforms.refractionRatio.value = material.refractionRatio;\r\n\r\n\t}\r\n\r\n\tfunction refreshUniformsLine ( uniforms, material ) {\r\n\r\n\t\tuniforms.diffuse.value = material.color;\r\n\t\tuniforms.opacity.value = material.opacity;\r\n\r\n\t}\r\n\r\n\tfunction refreshUniformsDash ( uniforms, material ) {\r\n\r\n\t\tuniforms.dashSize.value = material.dashSize;\r\n\t\tuniforms.totalSize.value = material.dashSize + material.gapSize;\r\n\t\tuniforms.scale.value = material.scale;\r\n\r\n\t}\r\n\r\n\tfunction refreshUniformsPoints ( uniforms, material ) {\r\n\r\n\t\tuniforms.diffuse.value = material.color;\r\n\t\tuniforms.opacity.value = material.opacity;\r\n\t\tuniforms.size.value = material.size * _pixelRatio;\r\n\t\tuniforms.scale.value = _canvas.clientHeight * 0.5;\r\n\r\n\t\tuniforms.map.value = material.map;\r\n\r\n\t\tif ( material.map !== null ) {\r\n\r\n\t\t\tvar offset = material.map.offset;\r\n\t\t\tvar repeat = material.map.repeat;\r\n\r\n\t\t\tuniforms.offsetRepeat.value.set( offset.x, offset.y, repeat.x, repeat.y );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction refreshUniformsFog ( uniforms, fog ) {\r\n\r\n\t\tuniforms.fogColor.value = fog.color;\r\n\r\n\t\tif ( fog instanceof THREE.Fog ) {\r\n\r\n\t\t\tuniforms.fogNear.value = fog.near;\r\n\t\t\tuniforms.fogFar.value = fog.far;\r\n\r\n\t\t} else if ( fog instanceof THREE.FogExp2 ) {\r\n\r\n\t\t\tuniforms.fogDensity.value = fog.density;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction refreshUniformsLambert ( uniforms, material ) {\r\n\r\n\t\tif ( material.lightMap ) {\r\n\r\n\t\t\tuniforms.lightMap.value = material.lightMap;\r\n\t\t\tuniforms.lightMapIntensity.value = material.lightMapIntensity;\r\n\r\n\t\t}\r\n\r\n\t\tif ( material.emissiveMap ) {\r\n\r\n\t\t\tuniforms.emissiveMap.value = material.emissiveMap;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction refreshUniformsPhong ( uniforms, material ) {\r\n\r\n\t\tuniforms.specular.value = material.specular;\r\n\t\tuniforms.shininess.value = Math.max( material.shininess, 1e-4 ); // to prevent pow( 0.0, 0.0 )\r\n\r\n\t\tif ( material.lightMap ) {\r\n\r\n\t\t\tuniforms.lightMap.value = material.lightMap;\r\n\t\t\tuniforms.lightMapIntensity.value = material.lightMapIntensity;\r\n\r\n\t\t}\r\n\r\n\t\tif ( material.emissiveMap ) {\r\n\r\n\t\t\tuniforms.emissiveMap.value = material.emissiveMap;\r\n\r\n\t\t}\r\n\r\n\t\tif ( material.bumpMap ) {\r\n\r\n\t\t\tuniforms.bumpMap.value = material.bumpMap;\r\n\t\t\tuniforms.bumpScale.value = material.bumpScale;\r\n\r\n\t\t}\r\n\r\n\t\tif ( material.normalMap ) {\r\n\r\n\t\t\tuniforms.normalMap.value = material.normalMap;\r\n\t\t\tuniforms.normalScale.value.copy( material.normalScale );\r\n\r\n\t\t}\r\n\r\n\t\tif ( material.displacementMap ) {\r\n\r\n\t\t\tuniforms.displacementMap.value = material.displacementMap;\r\n\t\t\tuniforms.displacementScale.value = material.displacementScale;\r\n\t\t\tuniforms.displacementBias.value = material.displacementBias;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction refreshUniformsStandard ( uniforms, material ) {\r\n\r\n\t\tuniforms.roughness.value = material.roughness;\r\n\t\tuniforms.metalness.value = material.metalness;\r\n\r\n\t\tif ( material.roughnessMap ) {\r\n\r\n\t\t\tuniforms.roughnessMap.value = material.roughnessMap;\r\n\r\n\t\t}\r\n\r\n\t\tif ( material.metalnessMap ) {\r\n\r\n\t\t\tuniforms.metalnessMap.value = material.metalnessMap;\r\n\r\n\t\t}\r\n\r\n\t\tif ( material.lightMap ) {\r\n\r\n\t\t\tuniforms.lightMap.value = material.lightMap;\r\n\t\t\tuniforms.lightMapIntensity.value = material.lightMapIntensity;\r\n\r\n\t\t}\r\n\r\n\t\tif ( material.emissiveMap ) {\r\n\r\n\t\t\tuniforms.emissiveMap.value = material.emissiveMap;\r\n\r\n\t\t}\r\n\r\n\t\tif ( material.bumpMap ) {\r\n\r\n\t\t\tuniforms.bumpMap.value = material.bumpMap;\r\n\t\t\tuniforms.bumpScale.value = material.bumpScale;\r\n\r\n\t\t}\r\n\r\n\t\tif ( material.normalMap ) {\r\n\r\n\t\t\tuniforms.normalMap.value = material.normalMap;\r\n\t\t\tuniforms.normalScale.value.copy( material.normalScale );\r\n\r\n\t\t}\r\n\r\n\t\tif ( material.displacementMap ) {\r\n\r\n\t\t\tuniforms.displacementMap.value = material.displacementMap;\r\n\t\t\tuniforms.displacementScale.value = material.displacementScale;\r\n\t\t\tuniforms.displacementBias.value = material.displacementBias;\r\n\r\n\t\t}\r\n\r\n\t\tif ( material.envMap ) {\r\n\r\n\t\t\t//uniforms.envMap.value = material.envMap; // part of uniforms common\r\n\t\t\tuniforms.envMapIntensity.value = material.envMapIntensity;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction refreshUniformsPhysical ( uniforms, material ) {\r\n\r\n\t\trefreshUniformsStandard( uniforms, material );\r\n\r\n\t}\r\n\r\n\t// If uniforms are marked as clean, they don't need to be loaded to the GPU.\r\n\r\n\tfunction markUniformsLightsNeedsUpdate ( uniforms, value ) {\r\n\r\n\t\tuniforms.ambientLightColor.needsUpdate = value;\r\n\r\n\t\tuniforms.directionalLights.needsUpdate = value;\r\n\t\tuniforms.pointLights.needsUpdate = value;\r\n\t\tuniforms.spotLights.needsUpdate = value;\r\n\t\tuniforms.hemisphereLights.needsUpdate = value;\r\n\r\n\t}\r\n\r\n\t// Lighting\r\n\r\n\tfunction setupShadows ( lights ) {\r\n\r\n\t\tvar lightShadowsLength = 0;\r\n\r\n\t\tfor ( var i = 0, l = lights.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar light = lights[ i ];\r\n\r\n\t\t\tif ( light.castShadow ) {\r\n\r\n\t\t\t\t_lights.shadows[ lightShadowsLength ++ ] = light;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t_lights.shadows.length = lightShadowsLength;\r\n\r\n\t}\r\n\r\n\tfunction setupLights ( lights, camera ) {\r\n\r\n\t\tvar l, ll, light,\r\n\t\tr = 0, g = 0, b = 0,\r\n\t\tcolor,\r\n\t\tintensity,\r\n\t\tdistance,\r\n\t\tshadowMap,\r\n\r\n\t\tviewMatrix = camera.matrixWorldInverse,\r\n\r\n\t\tdirectionalLength = 0,\r\n\t\tpointLength = 0,\r\n\t\tspotLength = 0,\r\n\t\themiLength = 0;\r\n\r\n\t\tfor ( l = 0, ll = lights.length; l < ll; l ++ ) {\r\n\r\n\t\t\tlight = lights[ l ];\r\n\r\n\t\t\tcolor = light.color;\r\n\t\t\tintensity = light.intensity;\r\n\t\t\tdistance = light.distance;\r\n\r\n\t\t\tshadowMap = ( light.shadow && light.shadow.map ) ? light.shadow.map.texture : null;\r\n\r\n\t\t\tif ( light instanceof THREE.AmbientLight ) {\r\n\r\n\t\t\t\tr += color.r * intensity;\r\n\t\t\t\tg += color.g * intensity;\r\n\t\t\t\tb += color.b * intensity;\r\n\r\n\t\t\t} else if ( light instanceof THREE.DirectionalLight ) {\r\n\r\n\t\t\t\tvar uniforms = lightCache.get( light );\r\n\r\n\t\t\t\tuniforms.color.copy( light.color ).multiplyScalar( light.intensity );\r\n\t\t\t\tuniforms.direction.setFromMatrixPosition( light.matrixWorld );\r\n\t\t\t\t_vector3.setFromMatrixPosition( light.target.matrixWorld );\r\n\t\t\t\tuniforms.direction.sub( _vector3 );\r\n\t\t\t\tuniforms.direction.transformDirection( viewMatrix );\r\n\r\n\t\t\t\tuniforms.shadow = light.castShadow;\r\n\r\n\t\t\t\tif ( light.castShadow ) {\r\n\r\n\t\t\t\t\tuniforms.shadowBias = light.shadow.bias;\r\n\t\t\t\t\tuniforms.shadowRadius = light.shadow.radius;\r\n\t\t\t\t\tuniforms.shadowMapSize = light.shadow.mapSize;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t_lights.directionalShadowMap[ directionalLength ] = shadowMap;\r\n\t\t\t\t_lights.directionalShadowMatrix[ directionalLength ] = light.shadow.matrix;\r\n\t\t\t\t_lights.directional[ directionalLength ++ ] = uniforms;\r\n\r\n\t\t\t} else if ( light instanceof THREE.SpotLight ) {\r\n\r\n\t\t\t\tvar uniforms = lightCache.get( light );\r\n\r\n\t\t\t\tuniforms.position.setFromMatrixPosition( light.matrixWorld );\r\n\t\t\t\tuniforms.position.applyMatrix4( viewMatrix );\r\n\r\n\t\t\t\tuniforms.color.copy( color ).multiplyScalar( intensity );\r\n\t\t\t\tuniforms.distance = distance;\r\n\r\n\t\t\t\tuniforms.direction.setFromMatrixPosition( light.matrixWorld );\r\n\t\t\t\t_vector3.setFromMatrixPosition( light.target.matrixWorld );\r\n\t\t\t\tuniforms.direction.sub( _vector3 );\r\n\t\t\t\tuniforms.direction.transformDirection( viewMatrix );\r\n\r\n\t\t\t\tuniforms.coneCos = Math.cos( light.angle );\r\n\t\t\t\tuniforms.penumbraCos = Math.cos( light.angle * ( 1 - light.penumbra ) );\r\n\t\t\t\tuniforms.decay = ( light.distance === 0 ) ? 0.0 : light.decay;\r\n\r\n\t\t\t\tuniforms.shadow = light.castShadow;\r\n\r\n\t\t\t\tif ( light.castShadow ) {\r\n\r\n\t\t\t\t\tuniforms.shadowBias = light.shadow.bias;\r\n\t\t\t\t\tuniforms.shadowRadius = light.shadow.radius;\r\n\t\t\t\t\tuniforms.shadowMapSize = light.shadow.mapSize;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t_lights.spotShadowMap[ spotLength ] = shadowMap;\r\n\t\t\t\t_lights.spotShadowMatrix[ spotLength ] = light.shadow.matrix;\r\n\t\t\t\t_lights.spot[ spotLength ++ ] = uniforms;\r\n\r\n\t\t\t} else if ( light instanceof THREE.PointLight ) {\r\n\r\n\t\t\t\tvar uniforms = lightCache.get( light );\r\n\r\n\t\t\t\tuniforms.position.setFromMatrixPosition( light.matrixWorld );\r\n\t\t\t\tuniforms.position.applyMatrix4( viewMatrix );\r\n\r\n\t\t\t\tuniforms.color.copy( light.color ).multiplyScalar( light.intensity );\r\n\t\t\t\tuniforms.distance = light.distance;\r\n\t\t\t\tuniforms.decay = ( light.distance === 0 ) ? 0.0 : light.decay;\r\n\r\n\t\t\t\tuniforms.shadow = light.castShadow;\r\n\r\n\t\t\t\tif ( light.castShadow ) {\r\n\r\n\t\t\t\t\tuniforms.shadowBias = light.shadow.bias;\r\n\t\t\t\t\tuniforms.shadowRadius = light.shadow.radius;\r\n\t\t\t\t\tuniforms.shadowMapSize = light.shadow.mapSize;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t_lights.pointShadowMap[ pointLength ] = shadowMap;\r\n\r\n\t\t\t\tif ( _lights.pointShadowMatrix[ pointLength ] === undefined ) {\r\n\r\n\t\t\t\t\t_lights.pointShadowMatrix[ pointLength ] = new THREE.Matrix4();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// for point lights we set the shadow matrix to be a translation-only matrix\r\n\t\t\t\t// equal to inverse of the light's position\r\n\t\t\t\t_vector3.setFromMatrixPosition( light.matrixWorld ).negate();\r\n\t\t\t\t_lights.pointShadowMatrix[ pointLength ].identity().setPosition( _vector3 );\r\n\r\n\t\t\t\t_lights.point[ pointLength ++ ] = uniforms;\r\n\r\n\t\t\t} else if ( light instanceof THREE.HemisphereLight ) {\r\n\r\n\t\t\t\tvar uniforms = lightCache.get( light );\r\n\r\n\t\t\t\tuniforms.direction.setFromMatrixPosition( light.matrixWorld );\r\n\t\t\t\tuniforms.direction.transformDirection( viewMatrix );\r\n\t\t\t\tuniforms.direction.normalize();\r\n\r\n\t\t\t\tuniforms.skyColor.copy( light.color ).multiplyScalar( intensity );\r\n\t\t\t\tuniforms.groundColor.copy( light.groundColor ).multiplyScalar( intensity );\r\n\r\n\t\t\t\t_lights.hemi[ hemiLength ++ ] = uniforms;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t_lights.ambient[ 0 ] = r;\r\n\t\t_lights.ambient[ 1 ] = g;\r\n\t\t_lights.ambient[ 2 ] = b;\r\n\r\n\t\t_lights.directional.length = directionalLength;\r\n\t\t_lights.spot.length = spotLength;\r\n\t\t_lights.point.length = pointLength;\r\n\t\t_lights.hemi.length = hemiLength;\r\n\r\n\t\t_lights.hash = directionalLength + ',' + pointLength + ',' + spotLength + ',' + hemiLength + ',' + _lights.shadows.length;\r\n\r\n\t}\r\n\r\n\t// GL state setting\r\n\r\n\tthis.setFaceCulling = function ( cullFace, frontFaceDirection ) {\r\n\r\n\t\tstate.setCullFace( cullFace );\r\n\t\tstate.setFlipSided( frontFaceDirection === THREE.FrontFaceDirectionCW );\r\n\r\n\t};\r\n\r\n\t// Textures\r\n\r\n\tfunction allocTextureUnit() {\r\n\r\n\t\tvar textureUnit = _usedTextureUnits;\r\n\r\n\t\tif ( textureUnit >= capabilities.maxTextures ) {\r\n\r\n\t\t\tconsole.warn( 'WebGLRenderer: trying to use ' + textureUnit + ' texture units while this GPU supports only ' + capabilities.maxTextures );\r\n\r\n\t\t}\r\n\r\n\t\t_usedTextureUnits += 1;\r\n\r\n\t\treturn textureUnit;\r\n\r\n\t}\r\n\r\n\tfunction setTextureParameters ( textureType, texture, isPowerOfTwoImage ) {\r\n\r\n\t\tvar extension;\r\n\r\n\t\tif ( isPowerOfTwoImage ) {\r\n\r\n\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_WRAP_S, paramThreeToGL( texture.wrapS ) );\r\n\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_WRAP_T, paramThreeToGL( texture.wrapT ) );\r\n\r\n\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_MAG_FILTER, paramThreeToGL( texture.magFilter ) );\r\n\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_MIN_FILTER, paramThreeToGL( texture.minFilter ) );\r\n\r\n\t\t} else {\r\n\r\n\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_WRAP_S, _gl.CLAMP_TO_EDGE );\r\n\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_WRAP_T, _gl.CLAMP_TO_EDGE );\r\n\r\n\t\t\tif ( texture.wrapS !== THREE.ClampToEdgeWrapping || texture.wrapT !== THREE.ClampToEdgeWrapping ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.', texture );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_MAG_FILTER, filterFallback( texture.magFilter ) );\r\n\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_MIN_FILTER, filterFallback( texture.minFilter ) );\r\n\r\n\t\t\tif ( texture.minFilter !== THREE.NearestFilter && texture.minFilter !== THREE.LinearFilter ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.', texture );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\textension = extensions.get( 'EXT_texture_filter_anisotropic' );\r\n\r\n\t\tif ( extension ) {\r\n\r\n\t\t\tif ( texture.type === THREE.FloatType && extensions.get( 'OES_texture_float_linear' ) === null ) return;\r\n\t\t\tif ( texture.type === THREE.HalfFloatType && extensions.get( 'OES_texture_half_float_linear' ) === null ) return;\r\n\r\n\t\t\tif ( texture.anisotropy > 1 || properties.get( texture ).__currentAnisotropy ) {\r\n\r\n\t\t\t\t_gl.texParameterf( textureType, extension.TEXTURE_MAX_ANISOTROPY_EXT, Math.min( texture.anisotropy, _this.getMaxAnisotropy() ) );\r\n\t\t\t\tproperties.get( texture ).__currentAnisotropy = texture.anisotropy;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction uploadTexture( textureProperties, texture, slot ) {\r\n\r\n\t\tif ( textureProperties.__webglInit === undefined ) {\r\n\r\n\t\t\ttextureProperties.__webglInit = true;\r\n\r\n\t\t\ttexture.addEventListener( 'dispose', onTextureDispose );\r\n\r\n\t\t\ttextureProperties.__webglTexture = _gl.createTexture();\r\n\r\n\t\t\t_infoMemory.textures ++;\r\n\r\n\t\t}\r\n\r\n\t\tstate.activeTexture( _gl.TEXTURE0 + slot );\r\n\t\tstate.bindTexture( _gl.TEXTURE_2D, textureProperties.__webglTexture );\r\n\r\n\t\t_gl.pixelStorei( _gl.UNPACK_FLIP_Y_WEBGL, texture.flipY );\r\n\t\t_gl.pixelStorei( _gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, texture.premultiplyAlpha );\r\n\t\t_gl.pixelStorei( _gl.UNPACK_ALIGNMENT, texture.unpackAlignment );\r\n\r\n\t\tvar image = clampToMaxSize( texture.image, capabilities.maxTextureSize );\r\n\r\n\t\tif ( textureNeedsPowerOfTwo( texture ) && isPowerOfTwo( image ) === false ) {\r\n\r\n\t\t\timage = makePowerOfTwo( image );\r\n\r\n\t\t}\r\n\r\n\t\tvar isPowerOfTwoImage = isPowerOfTwo( image ),\r\n\t\tglFormat = paramThreeToGL( texture.format ),\r\n\t\tglType = paramThreeToGL( texture.type );\r\n\r\n\t\tsetTextureParameters( _gl.TEXTURE_2D, texture, isPowerOfTwoImage );\r\n\r\n\t\tvar mipmap, mipmaps = texture.mipmaps;\r\n\r\n\t\tif ( texture instanceof THREE.DepthTexture ) {\r\n\r\n\t\t\t// populate depth texture with dummy data\r\n\r\n\t\t\tvar internalFormat = _gl.DEPTH_COMPONENT;\r\n\r\n\t\t\tif ( texture.type === THREE.FloatType ) {\r\n\r\n\t\t\t\tif ( !_isWebGL2 ) throw new Error('Float Depth Texture only supported in WebGL2.0');\r\n\t\t\t\tinternalFormat = _gl.DEPTH_COMPONENT32F;\r\n\r\n\t\t\t} else if ( _isWebGL2 ) {\r\n\r\n\t\t\t\t// WebGL 2.0 requires signed internalformat for glTexImage2D\r\n\t\t\t\tinternalFormat = _gl.DEPTH_COMPONENT16;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tstate.texImage2D( _gl.TEXTURE_2D, 0, internalFormat, image.width, image.height, 0, glFormat, glType, null );\r\n\r\n\t\t} else if ( texture instanceof THREE.DataTexture ) {\r\n\r\n\t\t\t// use manually created mipmaps if available\r\n\t\t\t// if there are no manual mipmaps\r\n\t\t\t// set 0 level mipmap and then use GL to generate other mipmap levels\r\n\r\n\t\t\tif ( mipmaps.length > 0 && isPowerOfTwoImage ) {\r\n\r\n\t\t\t\tfor ( var i = 0, il = mipmaps.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\tmipmap = mipmaps[ i ];\r\n\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_2D, i, glFormat, mipmap.width, mipmap.height, 0, glFormat, glType, mipmap.data );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttexture.generateMipmaps = false;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tstate.texImage2D( _gl.TEXTURE_2D, 0, glFormat, image.width, image.height, 0, glFormat, glType, image.data );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( texture instanceof THREE.CompressedTexture ) {\r\n\r\n\t\t\tfor ( var i = 0, il = mipmaps.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tmipmap = mipmaps[ i ];\r\n\r\n\t\t\t\tif ( texture.format !== THREE.RGBAFormat && texture.format !== THREE.RGBFormat ) {\r\n\r\n\t\t\t\t\tif ( state.getCompressedTextureFormats().indexOf( glFormat ) > - 1 ) {\r\n\r\n\t\t\t\t\t\tstate.compressedTexImage2D( _gl.TEXTURE_2D, i, glFormat, mipmap.width, mipmap.height, 0, mipmap.data );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tconsole.warn( \"THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()\" );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_2D, i, glFormat, mipmap.width, mipmap.height, 0, glFormat, glType, mipmap.data );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// regular Texture (image, video, canvas)\r\n\r\n\t\t\t// use manually created mipmaps if available\r\n\t\t\t// if there are no manual mipmaps\r\n\t\t\t// set 0 level mipmap and then use GL to generate other mipmap levels\r\n\r\n\t\t\tif ( mipmaps.length > 0 && isPowerOfTwoImage ) {\r\n\r\n\t\t\t\tfor ( var i = 0, il = mipmaps.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\tmipmap = mipmaps[ i ];\r\n\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_2D, i, glFormat, glFormat, glType, mipmap );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttexture.generateMipmaps = false;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tstate.texImage2D( _gl.TEXTURE_2D, 0, glFormat, glFormat, glType, image );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( texture.generateMipmaps && isPowerOfTwoImage ) _gl.generateMipmap( _gl.TEXTURE_2D );\r\n\r\n\t\ttextureProperties.__version = texture.version;\r\n\r\n\t\tif ( texture.onUpdate ) texture.onUpdate( texture );\r\n\r\n\t}\r\n\r\n\tfunction setTexture2D( texture, slot ) {\r\n\r\n\t\tvar textureProperties = properties.get( texture );\r\n\r\n\t\tif ( texture.version > 0 && textureProperties.__version !== texture.version ) {\r\n\r\n\t\t\tvar image = texture.image;\r\n\r\n\t\t\tif ( image === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Texture marked for update but image is undefined', texture );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( image.complete === false ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Texture marked for update but image is incomplete', texture );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tuploadTexture( textureProperties, texture, slot );\r\n\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tstate.activeTexture( _gl.TEXTURE0 + slot );\r\n\t\tstate.bindTexture( _gl.TEXTURE_2D, textureProperties.__webglTexture );\r\n\r\n\t}\r\n\r\n\tfunction clampToMaxSize ( image, maxSize ) {\r\n\r\n\t\tif ( image.width > maxSize || image.height > maxSize ) {\r\n\r\n\t\t\t// Warning: Scaling through the canvas will only work with images that use\r\n\t\t\t// premultiplied alpha.\r\n\r\n\t\t\tvar scale = maxSize / Math.max( image.width, image.height );\r\n\r\n\t\t\tvar canvas = document.createElement( 'canvas' );\r\n\t\t\tcanvas.width = Math.floor( image.width * scale );\r\n\t\t\tcanvas.height = Math.floor( image.height * scale );\r\n\r\n\t\t\tvar context = canvas.getContext( '2d' );\r\n\t\t\tcontext.drawImage( image, 0, 0, image.width, image.height, 0, 0, canvas.width, canvas.height );\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: image is too big (' + image.width + 'x' + image.height + '). Resized to ' + canvas.width + 'x' + canvas.height, image );\r\n\r\n\t\t\treturn canvas;\r\n\r\n\t\t}\r\n\r\n\t\treturn image;\r\n\r\n\t}\r\n\r\n\tfunction isPowerOfTwo( image ) {\r\n\r\n\t\treturn THREE.Math.isPowerOfTwo( image.width ) && THREE.Math.isPowerOfTwo( image.height );\r\n\r\n\t}\r\n\r\n\tfunction textureNeedsPowerOfTwo( texture ) {\r\n\r\n\t\tif ( texture.wrapS !== THREE.ClampToEdgeWrapping || texture.wrapT !== THREE.ClampToEdgeWrapping ) return true;\r\n\t\tif ( texture.minFilter !== THREE.NearestFilter && texture.minFilter !== THREE.LinearFilter ) return true;\r\n\r\n\t\treturn false;\r\n\r\n\t}\r\n\r\n\tfunction makePowerOfTwo( image ) {\r\n\r\n\t\tif ( image instanceof HTMLImageElement || image instanceof HTMLCanvasElement ) {\r\n\r\n\t\t\tvar canvas = document.createElement( 'canvas' );\r\n\t\t\tcanvas.width = THREE.Math.nearestPowerOfTwo( image.width );\r\n\t\t\tcanvas.height = THREE.Math.nearestPowerOfTwo( image.height );\r\n\r\n\t\t\tvar context = canvas.getContext( '2d' );\r\n\t\t\tcontext.drawImage( image, 0, 0, canvas.width, canvas.height );\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: image is not power of two (' + image.width + 'x' + image.height + '). Resized to ' + canvas.width + 'x' + canvas.height, image );\r\n\r\n\t\t\treturn canvas;\r\n\r\n\t\t}\r\n\r\n\t\treturn image;\r\n\r\n\t}\r\n\r\n\tfunction setTextureCube ( texture, slot ) {\r\n\r\n\t\tvar textureProperties = properties.get( texture );\r\n\r\n\t\tif ( texture.image.length === 6 ) {\r\n\r\n\t\t\tif ( texture.version > 0 && textureProperties.__version !== texture.version ) {\r\n\r\n\t\t\t\tif ( ! textureProperties.__image__webglTextureCube ) {\r\n\r\n\t\t\t\t\ttexture.addEventListener( 'dispose', onTextureDispose );\r\n\r\n\t\t\t\t\ttextureProperties.__image__webglTextureCube = _gl.createTexture();\r\n\r\n\t\t\t\t\t_infoMemory.textures ++;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tstate.activeTexture( _gl.TEXTURE0 + slot );\r\n\t\t\t\tstate.bindTexture( _gl.TEXTURE_CUBE_MAP, textureProperties.__image__webglTextureCube );\r\n\r\n\t\t\t\t_gl.pixelStorei( _gl.UNPACK_FLIP_Y_WEBGL, texture.flipY );\r\n\r\n\t\t\t\tvar isCompressed = texture instanceof THREE.CompressedTexture;\r\n\t\t\t\tvar isDataTexture = texture.image[ 0 ] instanceof THREE.DataTexture;\r\n\r\n\t\t\t\tvar cubeImage = [];\r\n\r\n\t\t\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\r\n\t\t\t\t\tif ( _this.autoScaleCubemaps && ! isCompressed && ! isDataTexture ) {\r\n\r\n\t\t\t\t\t\tcubeImage[ i ] = clampToMaxSize( texture.image[ i ], capabilities.maxCubemapSize );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tcubeImage[ i ] = isDataTexture ? texture.image[ i ].image : texture.image[ i ];\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar image = cubeImage[ 0 ],\r\n\t\t\t\tisPowerOfTwoImage = isPowerOfTwo( image ),\r\n\t\t\t\tglFormat = paramThreeToGL( texture.format ),\r\n\t\t\t\tglType = paramThreeToGL( texture.type );\r\n\r\n\t\t\t\tsetTextureParameters( _gl.TEXTURE_CUBE_MAP, texture, isPowerOfTwoImage );\r\n\r\n\t\t\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\r\n\t\t\t\t\tif ( ! isCompressed ) {\r\n\r\n\t\t\t\t\t\tif ( isDataTexture ) {\r\n\r\n\t\t\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, 0, glFormat, cubeImage[ i ].width, cubeImage[ i ].height, 0, glFormat, glType, cubeImage[ i ].data );\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, 0, glFormat, glFormat, glType, cubeImage[ i ] );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tvar mipmap, mipmaps = cubeImage[ i ].mipmaps;\r\n\r\n\t\t\t\t\t\tfor ( var j = 0, jl = mipmaps.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\t\t\t\tmipmap = mipmaps[ j ];\r\n\r\n\t\t\t\t\t\t\tif ( texture.format !== THREE.RGBAFormat && texture.format !== THREE.RGBFormat ) {\r\n\r\n\t\t\t\t\t\t\t\tif ( state.getCompressedTextureFormats().indexOf( glFormat ) > - 1 ) {\r\n\r\n\t\t\t\t\t\t\t\t\tstate.compressedTexImage2D( _gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, j, glFormat, mipmap.width, mipmap.height, 0, mipmap.data );\r\n\r\n\t\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\t\tconsole.warn( \"THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()\" );\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, j, glFormat, mipmap.width, mipmap.height, 0, glFormat, glType, mipmap.data );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( texture.generateMipmaps && isPowerOfTwoImage ) {\r\n\r\n\t\t\t\t\t_gl.generateMipmap( _gl.TEXTURE_CUBE_MAP );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttextureProperties.__version = texture.version;\r\n\r\n\t\t\t\tif ( texture.onUpdate ) texture.onUpdate( texture );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tstate.activeTexture( _gl.TEXTURE0 + slot );\r\n\t\t\t\tstate.bindTexture( _gl.TEXTURE_CUBE_MAP, textureProperties.__image__webglTextureCube );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction setTextureCubeDynamic ( texture, slot ) {\r\n\r\n\t\tstate.activeTexture( _gl.TEXTURE0 + slot );\r\n\t\tstate.bindTexture( _gl.TEXTURE_CUBE_MAP, properties.get( texture ).__webglTexture );\r\n\r\n\t}\r\n\r\n\tthis.allocTextureUnit = allocTextureUnit;\r\n\r\n\t//this.setTexture2D = setTexture2D;\r\n\tthis.setTexture2D = ( function() {\r\n\r\n\t\tvar warned = false;\r\n\r\n\t\t// backwards compatibility: peel texture.texture\r\n\t\treturn function( texture, slot ) {\r\n\r\n\t\t\tif ( texture instanceof THREE.WebGLRenderTarget ) {\r\n\r\n\t\t\t\tif ( ! warned ) {\r\n\r\n\t\t\t\t\tconsole.warn( \"THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead.\" );\r\n\t\t\t\t\twarned = true;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttexture = texture.texture;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tsetTexture2D( texture, slot );\r\n\r\n\t\t};\r\n\r\n\t}() );\r\n\r\n\tthis.setTexture = ( function() {\r\n\r\n\t\tvar warned = false;\r\n\r\n\t\treturn function( texture, slot ) {\r\n\r\n\t\t\tif ( ! warned ) {\r\n\r\n\t\t\t\tconsole.warn( \"THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead.\" );\r\n\t\t\t\twarned = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t_this.setTexture2D( texture, slot );\r\n\r\n\t\t};\r\n\r\n\t}() );\r\n\r\n\tthis.setTextureCube = ( function() {\r\n\r\n\t\tvar warned = false;\r\n\r\n\t\treturn function( texture, slot ) {\r\n\r\n\t\t\t// backwards compatibility: peel texture.texture\r\n\t\t\tif ( texture instanceof THREE.WebGLRenderTargetCube ) {\r\n\r\n\t\t\t\tif ( ! warned ) {\r\n\r\n\t\t\t\t\tconsole.warn( \"THREE.WebGLRenderer.setTextureCube: don't use cube render targets as textures. Use their .texture property instead.\" );\r\n\t\t\t\t\twarned = true;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttexture = texture.texture;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// currently relying on the fact that WebGLRenderTargetCube.texture is a Texture and NOT a CubeTexture\r\n\t\t\t// TODO: unify these code paths\r\n\t\t\tif ( texture instanceof THREE.CubeTexture ||\r\n\t\t\t\t ( Array.isArray( texture.image ) && texture.image.length === 6 ) ) {\r\n\r\n\t\t\t\t// CompressedTexture can have Array in image :/\r\n\r\n\t\t\t\t// this function alone should take care of cube textures\r\n\t\t\t\tsetTextureCube( texture, slot );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// assumed: texture property of THREE.WebGLRenderTargetCube\r\n\r\n\t\t\t\tsetTextureCubeDynamic( texture, slot );\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t}() );\r\n\r\n\t// Render targets\r\n\r\n\t// Setup storage for target texture and bind it to correct framebuffer\r\n\tfunction setupFrameBufferTexture ( framebuffer, renderTarget, attachment, textureTarget ) {\r\n\r\n\t\tvar glFormat = paramThreeToGL( renderTarget.texture.format );\r\n\t\tvar glType = paramThreeToGL( renderTarget.texture.type );\r\n\t\tstate.texImage2D( textureTarget, 0, glFormat, renderTarget.width, renderTarget.height, 0, glFormat, glType, null );\r\n\t\t_gl.bindFramebuffer( _gl.FRAMEBUFFER, framebuffer );\r\n\t\t_gl.framebufferTexture2D( _gl.FRAMEBUFFER, attachment, textureTarget, properties.get( renderTarget.texture ).__webglTexture, 0 );\r\n\t\t_gl.bindFramebuffer( _gl.FRAMEBUFFER, null );\r\n\r\n\t}\r\n\r\n\t// Setup storage for internal depth/stencil buffers and bind to correct framebuffer\r\n\tfunction setupRenderBufferStorage ( renderbuffer, renderTarget ) {\r\n\r\n\t\t_gl.bindRenderbuffer( _gl.RENDERBUFFER, renderbuffer );\r\n\r\n\t\tif ( renderTarget.depthBuffer && ! renderTarget.stencilBuffer ) {\r\n\r\n\t\t\t_gl.renderbufferStorage( _gl.RENDERBUFFER, _gl.DEPTH_COMPONENT16, renderTarget.width, renderTarget.height );\r\n\t\t\t_gl.framebufferRenderbuffer( _gl.FRAMEBUFFER, _gl.DEPTH_ATTACHMENT, _gl.RENDERBUFFER, renderbuffer );\r\n\r\n\t\t} else if ( renderTarget.depthBuffer && renderTarget.stencilBuffer ) {\r\n\r\n\t\t\t_gl.renderbufferStorage( _gl.RENDERBUFFER, _gl.DEPTH_STENCIL, renderTarget.width, renderTarget.height );\r\n\t\t\t_gl.framebufferRenderbuffer( _gl.FRAMEBUFFER, _gl.DEPTH_STENCIL_ATTACHMENT, _gl.RENDERBUFFER, renderbuffer );\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// FIXME: We don't support !depth !stencil\r\n\t\t\t_gl.renderbufferStorage( _gl.RENDERBUFFER, _gl.RGBA4, renderTarget.width, renderTarget.height );\r\n\r\n\t\t}\r\n\r\n\t\t_gl.bindRenderbuffer( _gl.RENDERBUFFER, null );\r\n\r\n\t}\r\n\r\n\t// Setup resources for a Depth Texture for a FBO (needs an extension)\r\n\tfunction setupDepthTexture ( framebuffer, renderTarget ) {\r\n\r\n\t\tvar isCube = ( renderTarget instanceof THREE.WebGLRenderTargetCube );\r\n\t\tif ( isCube ) throw new Error('Depth Texture with cube render targets is not supported!');\r\n\r\n\t\t_gl.bindFramebuffer( _gl.FRAMEBUFFER, framebuffer );\r\n\r\n\t\tif ( !( renderTarget.depthTexture instanceof THREE.DepthTexture ) ) {\r\n\r\n\t\t\tthrow new Error('renderTarget.depthTexture must be an instance of THREE.DepthTexture');\r\n\r\n\t\t}\r\n\r\n\t\t// upload an empty depth texture with framebuffer size\r\n\t\tif ( !properties.get( renderTarget.depthTexture ).__webglTexture ||\r\n\t\t\t\trenderTarget.depthTexture.image.width !== renderTarget.width ||\r\n\t\t\t\trenderTarget.depthTexture.image.height !== renderTarget.height ) {\r\n\t\t\trenderTarget.depthTexture.image.width = renderTarget.width;\r\n\t\t\trenderTarget.depthTexture.image.height = renderTarget.height;\r\n\t\t\trenderTarget.depthTexture.needsUpdate = true;\r\n\t\t}\r\n\r\n\t\t_this.setTexture2D( renderTarget.depthTexture, 0 );\r\n\r\n\t\tvar webglDepthTexture = properties.get( renderTarget.depthTexture ).__webglTexture;\r\n\t\t_gl.framebufferTexture2D( _gl.FRAMEBUFFER, _gl.DEPTH_ATTACHMENT, _gl.TEXTURE_2D, webglDepthTexture, 0 );\r\n\r\n\t}\r\n\r\n\t// Setup GL resources for a non-texture depth buffer\r\n\tfunction setupDepthRenderbuffer( renderTarget ) {\r\n\r\n\t\tvar renderTargetProperties = properties.get( renderTarget );\r\n\r\n\t\tvar isCube = ( renderTarget instanceof THREE.WebGLRenderTargetCube );\r\n\r\n\t\tif ( renderTarget.depthTexture ) {\r\n\r\n\t\t\tif ( isCube ) throw new Error('target.depthTexture not supported in Cube render targets');\r\n\r\n\t\t\tsetupDepthTexture( renderTargetProperties.__webglFramebuffer, renderTarget );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tif ( isCube ) {\r\n\r\n\t\t\t\trenderTargetProperties.__webglDepthbuffer = [];\r\n\r\n\t\t\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\r\n\t\t\t\t\t_gl.bindFramebuffer( _gl.FRAMEBUFFER, renderTargetProperties.__webglFramebuffer[ i ] );\r\n\t\t\t\t\trenderTargetProperties.__webglDepthbuffer[ i ] = _gl.createRenderbuffer();\r\n\t\t\t\t\tsetupRenderBufferStorage( renderTargetProperties.__webglDepthbuffer[ i ], renderTarget );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t_gl.bindFramebuffer( _gl.FRAMEBUFFER, renderTargetProperties.__webglFramebuffer );\r\n\t\t\t\trenderTargetProperties.__webglDepthbuffer = _gl.createRenderbuffer();\r\n\t\t\t\tsetupRenderBufferStorage( renderTargetProperties.__webglDepthbuffer, renderTarget );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t_gl.bindFramebuffer( _gl.FRAMEBUFFER, null );\r\n\r\n\t}\r\n\r\n\t// Set up GL resources for the render target\r\n\tfunction setupRenderTarget( renderTarget ) {\r\n\r\n\t\tvar renderTargetProperties = properties.get( renderTarget );\r\n\t\tvar textureProperties = properties.get( renderTarget.texture );\r\n\r\n\t\trenderTarget.addEventListener( 'dispose', onRenderTargetDispose );\r\n\r\n\t\ttextureProperties.__webglTexture = _gl.createTexture();\r\n\r\n\t\t_infoMemory.textures ++;\r\n\r\n\t\tvar isCube = ( renderTarget instanceof THREE.WebGLRenderTargetCube );\r\n\t\tvar isTargetPowerOfTwo = THREE.Math.isPowerOfTwo( renderTarget.width ) && THREE.Math.isPowerOfTwo( renderTarget.height );\r\n\r\n\t\t// Setup framebuffer\r\n\r\n\t\tif ( isCube ) {\r\n\r\n\t\t\trenderTargetProperties.__webglFramebuffer = [];\r\n\r\n\t\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\r\n\t\t\t\trenderTargetProperties.__webglFramebuffer[ i ] = _gl.createFramebuffer();\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\trenderTargetProperties.__webglFramebuffer = _gl.createFramebuffer();\r\n\r\n\t\t}\r\n\r\n\t\t// Setup color buffer\r\n\r\n\t\tif ( isCube ) {\r\n\r\n\t\t\tstate.bindTexture( _gl.TEXTURE_CUBE_MAP, textureProperties.__webglTexture );\r\n\t\t\tsetTextureParameters( _gl.TEXTURE_CUBE_MAP, renderTarget.texture, isTargetPowerOfTwo );\r\n\r\n\t\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\r\n\t\t\t\tsetupFrameBufferTexture( renderTargetProperties.__webglFramebuffer[ i ], renderTarget, _gl.COLOR_ATTACHMENT0, _gl.TEXTURE_CUBE_MAP_POSITIVE_X + i );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( renderTarget.texture.generateMipmaps && isTargetPowerOfTwo ) _gl.generateMipmap( _gl.TEXTURE_CUBE_MAP );\r\n\t\t\tstate.bindTexture( _gl.TEXTURE_CUBE_MAP, null );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tstate.bindTexture( _gl.TEXTURE_2D, textureProperties.__webglTexture );\r\n\t\t\tsetTextureParameters( _gl.TEXTURE_2D, renderTarget.texture, isTargetPowerOfTwo );\r\n\t\t\tsetupFrameBufferTexture( renderTargetProperties.__webglFramebuffer, renderTarget, _gl.COLOR_ATTACHMENT0, _gl.TEXTURE_2D );\r\n\r\n\t\t\tif ( renderTarget.texture.generateMipmaps && isTargetPowerOfTwo ) _gl.generateMipmap( _gl.TEXTURE_2D );\r\n\t\t\tstate.bindTexture( _gl.TEXTURE_2D, null );\r\n\r\n\t\t}\r\n\r\n\t\t// Setup depth and stencil buffers\r\n\r\n\t\tif ( renderTarget.depthBuffer ) {\r\n\r\n\t\t\tsetupDepthRenderbuffer( renderTarget );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tthis.getCurrentRenderTarget = function() {\r\n\r\n\t\treturn _currentRenderTarget;\r\n\r\n\t};\r\n\r\n\tthis.setRenderTarget = function ( renderTarget ) {\r\n\r\n\t\t_currentRenderTarget = renderTarget;\r\n\r\n\t\tif ( renderTarget && properties.get( renderTarget ).__webglFramebuffer === undefined ) {\r\n\r\n\t\t\tsetupRenderTarget( renderTarget );\r\n\r\n\t\t}\r\n\r\n\t\tvar isCube = ( renderTarget instanceof THREE.WebGLRenderTargetCube );\r\n\t\tvar framebuffer;\r\n\r\n\t\tif ( renderTarget ) {\r\n\r\n\t\t\tvar renderTargetProperties = properties.get( renderTarget );\r\n\r\n\t\t\tif ( isCube ) {\r\n\r\n\t\t\t\tframebuffer = renderTargetProperties.__webglFramebuffer[ renderTarget.activeCubeFace ];\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tframebuffer = renderTargetProperties.__webglFramebuffer;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t_currentScissor.copy( renderTarget.scissor );\r\n\t\t\t_currentScissorTest = renderTarget.scissorTest;\r\n\r\n\t\t\t_currentViewport.copy( renderTarget.viewport );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tframebuffer = null;\r\n\r\n\t\t\t_currentScissor.copy( _scissor ).multiplyScalar( _pixelRatio );\r\n\t\t\t_currentScissorTest = _scissorTest;\r\n\r\n\t\t\t_currentViewport.copy( _viewport ).multiplyScalar( _pixelRatio );\r\n\r\n\t\t}\r\n\r\n\t\tif ( _currentFramebuffer !== framebuffer ) {\r\n\r\n\t\t\t_gl.bindFramebuffer( _gl.FRAMEBUFFER, framebuffer );\r\n\t\t\t_currentFramebuffer = framebuffer;\r\n\r\n\t\t}\r\n\r\n\t\tstate.scissor( _currentScissor );\r\n\t\tstate.setScissorTest( _currentScissorTest );\r\n\r\n\t\tstate.viewport( _currentViewport );\r\n\r\n\t\tif ( isCube ) {\r\n\r\n\t\t\tvar textureProperties = properties.get( renderTarget.texture );\r\n\t\t\t_gl.framebufferTexture2D( _gl.FRAMEBUFFER, _gl.COLOR_ATTACHMENT0, _gl.TEXTURE_CUBE_MAP_POSITIVE_X + renderTarget.activeCubeFace, textureProperties.__webglTexture, renderTarget.activeMipMapLevel );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.readRenderTargetPixels = function ( renderTarget, x, y, width, height, buffer ) {\r\n\r\n\t\tif ( renderTarget instanceof THREE.WebGLRenderTarget === false ) {\r\n\r\n\t\t\tconsole.error( 'THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.' );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tvar framebuffer = properties.get( renderTarget ).__webglFramebuffer;\r\n\r\n\t\tif ( framebuffer ) {\r\n\r\n\t\t\tvar restore = false;\r\n\r\n\t\t\tif ( framebuffer !== _currentFramebuffer ) {\r\n\r\n\t\t\t\t_gl.bindFramebuffer( _gl.FRAMEBUFFER, framebuffer );\r\n\r\n\t\t\t\trestore = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\ttry {\r\n\r\n\t\t\t\tvar texture = renderTarget.texture;\r\n\r\n\t\t\t\tif ( texture.format !== THREE.RGBAFormat && paramThreeToGL( texture.format ) !== _gl.getParameter( _gl.IMPLEMENTATION_COLOR_READ_FORMAT ) ) {\r\n\r\n\t\t\t\t\tconsole.error( 'THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.' );\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( texture.type !== THREE.UnsignedByteType &&\r\n\t\t\t\t     paramThreeToGL( texture.type ) !== _gl.getParameter( _gl.IMPLEMENTATION_COLOR_READ_TYPE ) &&\r\n\t\t\t\t     ! ( texture.type === THREE.FloatType && extensions.get( 'WEBGL_color_buffer_float' ) ) &&\r\n\t\t\t\t     ! ( texture.type === THREE.HalfFloatType && extensions.get( 'EXT_color_buffer_half_float' ) ) ) {\r\n\r\n\t\t\t\t\tconsole.error( 'THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.' );\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( _gl.checkFramebufferStatus( _gl.FRAMEBUFFER ) === _gl.FRAMEBUFFER_COMPLETE ) {\r\n\r\n\t\t\t\t\t// the following if statement ensures valid read requests (no out-of-bounds pixels, see #8604)\r\n\r\n\t\t\t\t\tif ( ( x >= 0 && x <= ( renderTarget.width - width ) ) && ( y >= 0 && y <= ( renderTarget.height - height ) ) ) {\r\n\r\n\t\t\t\t\t\t_gl.readPixels( x, y, width, height, paramThreeToGL( texture.format ), paramThreeToGL( texture.type ), buffer );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tconsole.error( 'THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.' );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} finally {\r\n\r\n\t\t\t\tif ( restore ) {\r\n\r\n\t\t\t\t\t_gl.bindFramebuffer( _gl.FRAMEBUFFER, _currentFramebuffer );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tfunction updateRenderTargetMipmap( renderTarget ) {\r\n\r\n\t\tvar target = renderTarget instanceof THREE.WebGLRenderTargetCube ? _gl.TEXTURE_CUBE_MAP : _gl.TEXTURE_2D;\r\n\t\tvar texture = properties.get( renderTarget.texture ).__webglTexture;\r\n\r\n\t\tstate.bindTexture( target, texture );\r\n\t\t_gl.generateMipmap( target );\r\n\t\tstate.bindTexture( target, null );\r\n\r\n\t}\r\n\r\n\t// Fallback filters for non-power-of-2 textures\r\n\r\n\tfunction filterFallback ( f ) {\r\n\r\n\t\tif ( f === THREE.NearestFilter || f === THREE.NearestMipMapNearestFilter || f === THREE.NearestMipMapLinearFilter ) {\r\n\r\n\t\t\treturn _gl.NEAREST;\r\n\r\n\t\t}\r\n\r\n\t\treturn _gl.LINEAR;\r\n\r\n\t}\r\n\r\n\t// Map three.js constants to WebGL constants\r\n\r\n\tfunction paramThreeToGL ( p ) {\r\n\r\n\t\tvar extension;\r\n\r\n\t\tif ( p === THREE.RepeatWrapping ) return _gl.REPEAT;\r\n\t\tif ( p === THREE.ClampToEdgeWrapping ) return _gl.CLAMP_TO_EDGE;\r\n\t\tif ( p === THREE.MirroredRepeatWrapping ) return _gl.MIRRORED_REPEAT;\r\n\r\n\t\tif ( p === THREE.NearestFilter ) return _gl.NEAREST;\r\n\t\tif ( p === THREE.NearestMipMapNearestFilter ) return _gl.NEAREST_MIPMAP_NEAREST;\r\n\t\tif ( p === THREE.NearestMipMapLinearFilter ) return _gl.NEAREST_MIPMAP_LINEAR;\r\n\r\n\t\tif ( p === THREE.LinearFilter ) return _gl.LINEAR;\r\n\t\tif ( p === THREE.LinearMipMapNearestFilter ) return _gl.LINEAR_MIPMAP_NEAREST;\r\n\t\tif ( p === THREE.LinearMipMapLinearFilter ) return _gl.LINEAR_MIPMAP_LINEAR;\r\n\r\n\t\tif ( p === THREE.UnsignedByteType ) return _gl.UNSIGNED_BYTE;\r\n\t\tif ( p === THREE.UnsignedShort4444Type ) return _gl.UNSIGNED_SHORT_4_4_4_4;\r\n\t\tif ( p === THREE.UnsignedShort5551Type ) return _gl.UNSIGNED_SHORT_5_5_5_1;\r\n\t\tif ( p === THREE.UnsignedShort565Type ) return _gl.UNSIGNED_SHORT_5_6_5;\r\n\r\n\t\tif ( p === THREE.ByteType ) return _gl.BYTE;\r\n\t\tif ( p === THREE.ShortType ) return _gl.SHORT;\r\n\t\tif ( p === THREE.UnsignedShortType ) return _gl.UNSIGNED_SHORT;\r\n\t\tif ( p === THREE.IntType ) return _gl.INT;\r\n\t\tif ( p === THREE.UnsignedIntType ) return _gl.UNSIGNED_INT;\r\n\t\tif ( p === THREE.FloatType ) return _gl.FLOAT;\r\n\r\n\t\textension = extensions.get( 'OES_texture_half_float' );\r\n\r\n\t\tif ( extension !== null ) {\r\n\r\n\t\t\tif ( p === THREE.HalfFloatType ) return extension.HALF_FLOAT_OES;\r\n\r\n\t\t}\r\n\r\n\t\tif ( p === THREE.AlphaFormat ) return _gl.ALPHA;\r\n\t\tif ( p === THREE.RGBFormat ) return _gl.RGB;\r\n\t\tif ( p === THREE.RGBAFormat ) return _gl.RGBA;\r\n\t\tif ( p === THREE.LuminanceFormat ) return _gl.LUMINANCE;\r\n\t\tif ( p === THREE.LuminanceAlphaFormat ) return _gl.LUMINANCE_ALPHA;\r\n\t\tif ( p === THREE.DepthFormat ) return _gl.DEPTH_COMPONENT;\r\n\r\n\t\tif ( p === THREE.AddEquation ) return _gl.FUNC_ADD;\r\n\t\tif ( p === THREE.SubtractEquation ) return _gl.FUNC_SUBTRACT;\r\n\t\tif ( p === THREE.ReverseSubtractEquation ) return _gl.FUNC_REVERSE_SUBTRACT;\r\n\r\n\t\tif ( p === THREE.ZeroFactor ) return _gl.ZERO;\r\n\t\tif ( p === THREE.OneFactor ) return _gl.ONE;\r\n\t\tif ( p === THREE.SrcColorFactor ) return _gl.SRC_COLOR;\r\n\t\tif ( p === THREE.OneMinusSrcColorFactor ) return _gl.ONE_MINUS_SRC_COLOR;\r\n\t\tif ( p === THREE.SrcAlphaFactor ) return _gl.SRC_ALPHA;\r\n\t\tif ( p === THREE.OneMinusSrcAlphaFactor ) return _gl.ONE_MINUS_SRC_ALPHA;\r\n\t\tif ( p === THREE.DstAlphaFactor ) return _gl.DST_ALPHA;\r\n\t\tif ( p === THREE.OneMinusDstAlphaFactor ) return _gl.ONE_MINUS_DST_ALPHA;\r\n\r\n\t\tif ( p === THREE.DstColorFactor ) return _gl.DST_COLOR;\r\n\t\tif ( p === THREE.OneMinusDstColorFactor ) return _gl.ONE_MINUS_DST_COLOR;\r\n\t\tif ( p === THREE.SrcAlphaSaturateFactor ) return _gl.SRC_ALPHA_SATURATE;\r\n\r\n\t\textension = extensions.get( 'WEBGL_compressed_texture_s3tc' );\r\n\r\n\t\tif ( extension !== null ) {\r\n\r\n\t\t\tif ( p === THREE.RGB_S3TC_DXT1_Format ) return extension.COMPRESSED_RGB_S3TC_DXT1_EXT;\r\n\t\t\tif ( p === THREE.RGBA_S3TC_DXT1_Format ) return extension.COMPRESSED_RGBA_S3TC_DXT1_EXT;\r\n\t\t\tif ( p === THREE.RGBA_S3TC_DXT3_Format ) return extension.COMPRESSED_RGBA_S3TC_DXT3_EXT;\r\n\t\t\tif ( p === THREE.RGBA_S3TC_DXT5_Format ) return extension.COMPRESSED_RGBA_S3TC_DXT5_EXT;\r\n\r\n\t\t}\r\n\r\n\t\textension = extensions.get( 'WEBGL_compressed_texture_pvrtc' );\r\n\r\n\t\tif ( extension !== null ) {\r\n\r\n\t\t\tif ( p === THREE.RGB_PVRTC_4BPPV1_Format ) return extension.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;\r\n\t\t\tif ( p === THREE.RGB_PVRTC_2BPPV1_Format ) return extension.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;\r\n\t\t\tif ( p === THREE.RGBA_PVRTC_4BPPV1_Format ) return extension.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;\r\n\t\t\tif ( p === THREE.RGBA_PVRTC_2BPPV1_Format ) return extension.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG;\r\n\r\n\t\t}\r\n\r\n\t\textension = extensions.get( 'WEBGL_compressed_texture_etc1' );\r\n\r\n\t\tif ( extension !== null ) {\r\n\r\n\t\t\tif ( p === THREE.RGB_ETC1_Format ) return extension.COMPRESSED_RGB_ETC1_WEBGL;\r\n\r\n\t\t}\r\n\r\n\t\textension = extensions.get( 'EXT_blend_minmax' );\r\n\r\n\t\tif ( extension !== null ) {\r\n\r\n\t\t\tif ( p === THREE.MinEquation ) return extension.MIN_EXT;\r\n\t\t\tif ( p === THREE.MaxEquation ) return extension.MAX_EXT;\r\n\r\n\t\t}\r\n\r\n\t\treturn 0;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/renderers/WebGLRenderTarget.js\r\n\r\n/**\r\n * @author szimek / https://github.com/szimek/\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author Marius Kintel / https://github.com/kintel\r\n */\r\n\r\n/*\r\n In options, we can specify:\r\n * Texture parameters for an auto-generated target texture\r\n * depthBuffer/stencilBuffer: Booleans to indicate if we should generate these buffers\r\n*/\r\nTHREE.WebGLRenderTarget = function ( width, height, options ) {\r\n\r\n\tthis.uuid = THREE.Math.generateUUID();\r\n\r\n\tthis.width = width;\r\n\tthis.height = height;\r\n\r\n\tthis.scissor = new THREE.Vector4( 0, 0, width, height );\r\n\tthis.scissorTest = false;\r\n\r\n\tthis.viewport = new THREE.Vector4( 0, 0, width, height );\r\n\r\n\toptions = options || {};\r\n\r\n\tif ( options.minFilter === undefined ) options.minFilter = THREE.LinearFilter;\r\n\r\n\tthis.texture = new THREE.Texture( undefined, undefined, options.wrapS, options.wrapT, options.magFilter, options.minFilter, options.format, options.type, options.anisotropy, options.encoding );\r\n\r\n\tthis.depthBuffer = options.depthBuffer !== undefined ? options.depthBuffer : true;\r\n\tthis.stencilBuffer = options.stencilBuffer !== undefined ? options.stencilBuffer : true;\r\n\tthis.depthTexture = null;\r\n\r\n};\r\n\r\nObject.assign( THREE.WebGLRenderTarget.prototype, THREE.EventDispatcher.prototype, {\r\n\r\n\tsetSize: function ( width, height ) {\r\n\r\n\t\tif ( this.width !== width || this.height !== height ) {\r\n\r\n\t\t\tthis.width = width;\r\n\t\t\tthis.height = height;\r\n\r\n\t\t\tthis.dispose();\r\n\r\n\t\t}\r\n\r\n\t\tthis.viewport.set( 0, 0, width, height );\r\n\t\tthis.scissor.set( 0, 0, width, height );\r\n\r\n\t},\r\n\r\n\tclone: function () {\r\n\r\n\t\treturn new this.constructor().copy( this );\r\n\r\n\t},\r\n\r\n\tcopy: function ( source ) {\r\n\r\n\t\tthis.width = source.width;\r\n\t\tthis.height = source.height;\r\n\r\n\t\tthis.viewport.copy( source.viewport );\r\n\r\n\t\tthis.texture = source.texture.clone();\r\n\r\n\t\tthis.depthBuffer = source.depthBuffer;\r\n\t\tthis.stencilBuffer = source.stencilBuffer;\r\n\t\tthis.depthTexture = source.depthTexture;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tdispose: function () {\r\n\r\n\t\tthis.dispatchEvent( { type: 'dispose' } );\r\n\r\n\t}\r\n\r\n} );\r\n\r\n// File:src/renderers/WebGLRenderTargetCube.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com\r\n */\r\n\r\nTHREE.WebGLRenderTargetCube = function ( width, height, options ) {\r\n\r\n\tTHREE.WebGLRenderTarget.call( this, width, height, options );\r\n\r\n\tthis.activeCubeFace = 0; // PX 0, NX 1, PY 2, NY 3, PZ 4, NZ 5\r\n\tthis.activeMipMapLevel = 0;\r\n\r\n};\r\n\r\nTHREE.WebGLRenderTargetCube.prototype = Object.create( THREE.WebGLRenderTarget.prototype );\r\nTHREE.WebGLRenderTargetCube.prototype.constructor = THREE.WebGLRenderTargetCube;\r\n\r\n// File:src/renderers/webgl/WebGLBufferRenderer.js\r\n\r\n/**\r\n* @author mrdoob / http://mrdoob.com/\r\n*/\r\n\r\nTHREE.WebGLBufferRenderer = function ( _gl, extensions, _infoRender ) {\r\n\r\n\tvar mode;\r\n\r\n\tfunction setMode( value ) {\r\n\r\n\t\tmode = value;\r\n\r\n\t}\r\n\r\n\tfunction render( start, count ) {\r\n\r\n\t\t_gl.drawArrays( mode, start, count );\r\n\r\n\t\t_infoRender.calls ++;\r\n\t\t_infoRender.vertices += count;\r\n\t\tif ( mode === _gl.TRIANGLES ) _infoRender.faces += count / 3;\r\n\r\n\t}\r\n\r\n\tfunction renderInstances( geometry ) {\r\n\r\n\t\tvar extension = extensions.get( 'ANGLE_instanced_arrays' );\r\n\r\n\t\tif ( extension === null ) {\r\n\r\n\t\t\tconsole.error( 'THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.' );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tvar position = geometry.attributes.position;\r\n\r\n\t\tvar count = 0;\r\n\r\n\t\tif ( position instanceof THREE.InterleavedBufferAttribute ) {\r\n\r\n\t\t\tcount = position.data.count;\r\n\r\n\t\t\textension.drawArraysInstancedANGLE( mode, 0, count, geometry.maxInstancedCount );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tcount = position.count;\r\n\r\n\t\t\textension.drawArraysInstancedANGLE( mode, 0, count, geometry.maxInstancedCount );\r\n\r\n\t\t}\r\n\r\n\t\t_infoRender.calls ++;\r\n\t\t_infoRender.vertices += count * geometry.maxInstancedCount;\r\n\t\tif ( mode === _gl.TRIANGLES ) _infoRender.faces += geometry.maxInstancedCount * count / 3;\r\n\r\n\t}\r\n\r\n\tthis.setMode = setMode;\r\n\tthis.render = render;\r\n\tthis.renderInstances = renderInstances;\r\n\r\n};\r\n\r\n// File:src/renderers/webgl/WebGLClipping.js\r\n\r\nTHREE.WebGLClipping = function() {\r\n\r\n\tvar scope = this,\r\n\r\n\t\tglobalState = null,\r\n\t\tnumGlobalPlanes = 0,\r\n\t\tlocalClippingEnabled = false,\r\n\t\trenderingShadows = false,\r\n\r\n\t\tplane = new THREE.Plane(),\r\n\t\tviewNormalMatrix = new THREE.Matrix3(),\r\n\r\n\t\tuniform = { value: null, needsUpdate: false };\r\n\r\n\tthis.uniform = uniform;\r\n\tthis.numPlanes = 0;\r\n\r\n\tthis.init = function( planes, enableLocalClipping, camera ) {\r\n\r\n\t\tvar enabled =\r\n\t\t\tplanes.length !== 0 ||\r\n\t\t\tenableLocalClipping ||\r\n\t\t\t// enable state of previous frame - the clipping code has to\r\n\t\t\t// run another frame in order to reset the state:\r\n\t\t\tnumGlobalPlanes !== 0 ||\r\n\t\t\tlocalClippingEnabled;\r\n\r\n\t\tlocalClippingEnabled = enableLocalClipping;\r\n\r\n\t\tglobalState = projectPlanes( planes, camera, 0 );\r\n\t\tnumGlobalPlanes = planes.length;\r\n\r\n\t\treturn enabled;\r\n\r\n\t};\r\n\r\n\tthis.beginShadows = function() {\r\n\r\n\t\trenderingShadows = true;\r\n\t\tprojectPlanes( null );\r\n\r\n\t};\r\n\r\n\tthis.endShadows = function() {\r\n\r\n\t\trenderingShadows = false;\r\n\t\tresetGlobalState();\r\n\r\n\t};\r\n\r\n\tthis.setState = function( planes, clipShadows, camera, cache, fromCache ) {\r\n\r\n\t\tif ( ! localClippingEnabled ||\r\n\t\t\t\tplanes === null || planes.length === 0 ||\r\n\t\t\t\trenderingShadows && ! clipShadows ) {\r\n\t\t\t// there's no local clipping\r\n\r\n\t\t\tif ( renderingShadows ) {\r\n\t\t\t\t// there's no global clipping\r\n\r\n\t\t\t\tprojectPlanes( null );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tresetGlobalState();\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tvar nGlobal = renderingShadows ? 0 : numGlobalPlanes,\r\n\t\t\t\tlGlobal = nGlobal * 4,\r\n\r\n\t\t\t\tdstArray = cache.clippingState || null;\r\n\r\n\t\t\tuniform.value = dstArray; // ensure unique state\r\n\r\n\t\t\tdstArray = projectPlanes( planes, camera, lGlobal, fromCache );\r\n\r\n\t\t\tfor ( var i = 0; i !== lGlobal; ++ i ) {\r\n\r\n\t\t\t\tdstArray[ i ] = globalState[ i ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tcache.clippingState = dstArray;\r\n\t\t\tthis.numPlanes += nGlobal;\r\n\r\n\t\t}\r\n\r\n\r\n\t};\r\n\r\n\tfunction resetGlobalState() {\r\n\r\n\t\tif ( uniform.value !== globalState ) {\r\n\r\n\t\t\tuniform.value = globalState;\r\n\t\t\tuniform.needsUpdate = numGlobalPlanes > 0;\r\n\r\n\t\t}\r\n\r\n\t\tscope.numPlanes = numGlobalPlanes;\r\n\r\n\t}\r\n\r\n\tfunction projectPlanes( planes, camera, dstOffset, skipTransform ) {\r\n\r\n\t\tvar nPlanes = planes !== null ? planes.length : 0,\r\n\t\t\tdstArray = null;\r\n\r\n\t\tif ( nPlanes !== 0 ) {\r\n\r\n\t\t\tdstArray = uniform.value;\r\n\r\n\t\t\tif ( skipTransform !== true || dstArray === null ) {\r\n\r\n\t\t\t\tvar flatSize = dstOffset + nPlanes * 4,\r\n\t\t\t\t\tviewMatrix = camera.matrixWorldInverse;\r\n\r\n\t\t\t\tviewNormalMatrix.getNormalMatrix( viewMatrix );\r\n\r\n\t\t\t\tif ( dstArray === null || dstArray.length < flatSize ) {\r\n\r\n\t\t\t\t\tdstArray = new Float32Array( flatSize );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor ( var i = 0, i4 = dstOffset;\r\n\t\t\t\t\t\t\t\t\ti !== nPlanes; ++ i, i4 += 4 ) {\r\n\r\n\t\t\t\t\tplane.copy( planes[ i ] ).\r\n\t\t\t\t\t\t\tapplyMatrix4( viewMatrix, viewNormalMatrix );\r\n\r\n\t\t\t\t\tplane.normal.toArray( dstArray, i4 );\r\n\t\t\t\t\tdstArray[ i4 + 3 ] = plane.constant;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tuniform.value = dstArray;\r\n\t\t\tuniform.needsUpdate = true;\r\n\r\n\t\t}\r\n\r\n\t\tscope.numPlanes = nPlanes;\r\n\t\treturn dstArray;\r\n\r\n\t}\r\n\r\n};\r\n\r\n\r\n// File:src/renderers/webgl/WebGLIndexedBufferRenderer.js\r\n\r\n/**\r\n* @author mrdoob / http://mrdoob.com/\r\n*/\r\n\r\nTHREE.WebGLIndexedBufferRenderer = function ( _gl, extensions, _infoRender ) {\r\n\r\n\tvar mode;\r\n\r\n\tfunction setMode( value ) {\r\n\r\n\t\tmode = value;\r\n\r\n\t}\r\n\r\n\tvar type, size;\r\n\r\n\tfunction setIndex( index ) {\r\n\r\n\t\tif ( index.array instanceof Uint32Array && extensions.get( 'OES_element_index_uint' ) ) {\r\n\r\n\t\t\ttype = _gl.UNSIGNED_INT;\r\n\t\t\tsize = 4;\r\n\r\n\t\t} else {\r\n\r\n\t\t\ttype = _gl.UNSIGNED_SHORT;\r\n\t\t\tsize = 2;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction render( start, count ) {\r\n\r\n\t\t_gl.drawElements( mode, count, type, start * size );\r\n\r\n\t\t_infoRender.calls ++;\r\n\t\t_infoRender.vertices += count;\r\n\t\tif ( mode === _gl.TRIANGLES ) _infoRender.faces += count / 3;\r\n\r\n\t}\r\n\r\n\tfunction renderInstances( geometry, start, count ) {\r\n\r\n\t\tvar extension = extensions.get( 'ANGLE_instanced_arrays' );\r\n\r\n\t\tif ( extension === null ) {\r\n\r\n\t\t\tconsole.error( 'THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.' );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\textension.drawElementsInstancedANGLE( mode, count, type, start * size, geometry.maxInstancedCount );\r\n\r\n\t\t_infoRender.calls ++;\r\n\t\t_infoRender.vertices += count * geometry.maxInstancedCount;\r\n\t\tif ( mode === _gl.TRIANGLES ) _infoRender.faces += geometry.maxInstancedCount * count / 3;\r\n\t}\r\n\r\n\tthis.setMode = setMode;\r\n\tthis.setIndex = setIndex;\r\n\tthis.render = render;\r\n\tthis.renderInstances = renderInstances;\r\n\r\n};\r\n\r\n// File:src/renderers/webgl/WebGLExtensions.js\r\n\r\n/**\r\n* @author mrdoob / http://mrdoob.com/\r\n*/\r\n\r\nTHREE.WebGLExtensions = function ( gl ) {\r\n\r\n\tvar extensions = {};\r\n\r\n\tthis.get = function ( name ) {\r\n\r\n\t\tif ( extensions[ name ] !== undefined ) {\r\n\r\n\t\t\treturn extensions[ name ];\r\n\r\n\t\t}\r\n\r\n\t\tvar extension;\r\n\r\n\t\tswitch ( name ) {\r\n\r\n\t\t\tcase 'WEBGL_depth_texture':\r\n\t\t\t\textension = gl.getExtension( 'WEBGL_depth_texture' ) || gl.getExtension( 'MOZ_WEBGL_depth_texture' ) || gl.getExtension( 'WEBKIT_WEBGL_depth_texture' );\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 'EXT_texture_filter_anisotropic':\r\n\t\t\t\textension = gl.getExtension( 'EXT_texture_filter_anisotropic' ) || gl.getExtension( 'MOZ_EXT_texture_filter_anisotropic' ) || gl.getExtension( 'WEBKIT_EXT_texture_filter_anisotropic' );\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 'WEBGL_compressed_texture_s3tc':\r\n\t\t\t\textension = gl.getExtension( 'WEBGL_compressed_texture_s3tc' ) || gl.getExtension( 'MOZ_WEBGL_compressed_texture_s3tc' ) || gl.getExtension( 'WEBKIT_WEBGL_compressed_texture_s3tc' );\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 'WEBGL_compressed_texture_pvrtc':\r\n\t\t\t\textension = gl.getExtension( 'WEBGL_compressed_texture_pvrtc' ) || gl.getExtension( 'WEBKIT_WEBGL_compressed_texture_pvrtc' );\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 'WEBGL_compressed_texture_etc1':\r\n\t\t\t\textension = gl.getExtension( 'WEBGL_compressed_texture_etc1' );\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tdefault:\r\n\t\t\t\textension = gl.getExtension( name );\r\n\r\n\t\t}\r\n\r\n\t\tif ( extension === null ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: ' + name + ' extension not supported.' );\r\n\r\n\t\t}\r\n\r\n\t\textensions[ name ] = extension;\r\n\r\n\t\treturn extension;\r\n\r\n\t};\r\n\r\n};\r\n\r\n// File:src/renderers/webgl/WebGLCapabilities.js\r\n\r\nTHREE.WebGLCapabilities = function ( gl, extensions, parameters ) {\r\n\r\n\tfunction getMaxPrecision( precision ) {\r\n\r\n\t\tif ( precision === 'highp' ) {\r\n\r\n\t\t\tif ( gl.getShaderPrecisionFormat( gl.VERTEX_SHADER, gl.HIGH_FLOAT ).precision > 0 &&\r\n\t\t\t     gl.getShaderPrecisionFormat( gl.FRAGMENT_SHADER, gl.HIGH_FLOAT ).precision > 0 ) {\r\n\r\n\t\t\t\treturn 'highp';\r\n\r\n\t\t\t}\r\n\r\n\t\t\tprecision = 'mediump';\r\n\r\n\t\t}\r\n\r\n\t\tif ( precision === 'mediump' ) {\r\n\r\n\t\t\tif ( gl.getShaderPrecisionFormat( gl.VERTEX_SHADER, gl.MEDIUM_FLOAT ).precision > 0 &&\r\n\t\t\t     gl.getShaderPrecisionFormat( gl.FRAGMENT_SHADER, gl.MEDIUM_FLOAT ).precision > 0 ) {\r\n\r\n\t\t\t\treturn 'mediump';\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn 'lowp';\r\n\r\n\t}\r\n\r\n\tthis.getMaxPrecision = getMaxPrecision;\r\n\r\n\tthis.precision = parameters.precision !== undefined ? parameters.precision : 'highp';\r\n\tthis.logarithmicDepthBuffer = parameters.logarithmicDepthBuffer !== undefined ? parameters.logarithmicDepthBuffer : false;\r\n\r\n\tthis.maxTextures = gl.getParameter( gl.MAX_TEXTURE_IMAGE_UNITS );\r\n\tthis.maxVertexTextures = gl.getParameter( gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS );\r\n\tthis.maxTextureSize = gl.getParameter( gl.MAX_TEXTURE_SIZE );\r\n\tthis.maxCubemapSize = gl.getParameter( gl.MAX_CUBE_MAP_TEXTURE_SIZE );\r\n\r\n\tthis.maxAttributes = gl.getParameter( gl.MAX_VERTEX_ATTRIBS );\r\n\tthis.maxVertexUniforms = gl.getParameter( gl.MAX_VERTEX_UNIFORM_VECTORS );\r\n\tthis.maxVaryings = gl.getParameter( gl.MAX_VARYING_VECTORS );\r\n\tthis.maxFragmentUniforms = gl.getParameter( gl.MAX_FRAGMENT_UNIFORM_VECTORS );\r\n\r\n\tthis.vertexTextures = this.maxVertexTextures > 0;\r\n\tthis.floatFragmentTextures = !! extensions.get( 'OES_texture_float' );\r\n\tthis.floatVertexTextures = this.vertexTextures && this.floatFragmentTextures;\r\n\r\n\tvar _maxPrecision = getMaxPrecision( this.precision );\r\n\r\n\tif ( _maxPrecision !== this.precision ) {\r\n\r\n\t\tconsole.warn( 'THREE.WebGLRenderer:', this.precision, 'not supported, using', _maxPrecision, 'instead.' );\r\n\t\tthis.precision = _maxPrecision;\r\n\r\n\t}\r\n\r\n\tif ( this.logarithmicDepthBuffer ) {\r\n\r\n\t\tthis.logarithmicDepthBuffer = !! extensions.get( 'EXT_frag_depth' );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/renderers/webgl/WebGLGeometries.js\r\n\r\n/**\r\n* @author mrdoob / http://mrdoob.com/\r\n*/\r\n\r\nTHREE.WebGLGeometries = function ( gl, properties, info ) {\r\n\r\n\tvar geometries = {};\r\n\r\n\tfunction get( object ) {\r\n\r\n\t\tvar geometry = object.geometry;\r\n\r\n\t\tif ( geometries[ geometry.id ] !== undefined ) {\r\n\r\n\t\t\treturn geometries[ geometry.id ];\r\n\r\n\t\t}\r\n\r\n\t\tgeometry.addEventListener( 'dispose', onGeometryDispose );\r\n\r\n\t\tvar buffergeometry;\r\n\r\n\t\tif ( geometry instanceof THREE.BufferGeometry ) {\r\n\r\n\t\t\tbuffergeometry = geometry;\r\n\r\n\t\t} else if ( geometry instanceof THREE.Geometry ) {\r\n\r\n\t\t\tif ( geometry._bufferGeometry === undefined ) {\r\n\r\n\t\t\t\tgeometry._bufferGeometry = new THREE.BufferGeometry().setFromObject( object );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tbuffergeometry = geometry._bufferGeometry;\r\n\r\n\t\t}\r\n\r\n\t\tgeometries[ geometry.id ] = buffergeometry;\r\n\r\n\t\tinfo.memory.geometries ++;\r\n\r\n\t\treturn buffergeometry;\r\n\r\n\t}\r\n\r\n\tfunction onGeometryDispose( event ) {\r\n\r\n\t\tvar geometry = event.target;\r\n\t\tvar buffergeometry = geometries[ geometry.id ];\r\n\r\n\t\tif ( buffergeometry.index !== null ) {\r\n\r\n\t\t\tdeleteAttribute( buffergeometry.index );\r\n\r\n\t\t}\r\n\r\n\t\tdeleteAttributes( buffergeometry.attributes );\r\n\r\n\t\tgeometry.removeEventListener( 'dispose', onGeometryDispose );\r\n\r\n\t\tdelete geometries[ geometry.id ];\r\n\r\n\t\t// TODO\r\n\r\n\t\tvar property = properties.get( geometry );\r\n\r\n\t\tif ( property.wireframe ) {\r\n\r\n\t\t\tdeleteAttribute( property.wireframe );\r\n\r\n\t\t}\r\n\r\n\t\tproperties.delete( geometry );\r\n\r\n\t\tvar bufferproperty = properties.get( buffergeometry );\r\n\r\n\t\tif ( bufferproperty.wireframe ) {\r\n\r\n\t\t\tdeleteAttribute( bufferproperty.wireframe );\r\n\r\n\t\t}\r\n\r\n\t\tproperties.delete( buffergeometry );\r\n\r\n\t\t//\r\n\r\n\t\tinfo.memory.geometries --;\r\n\r\n\t}\r\n\r\n\tfunction getAttributeBuffer( attribute ) {\r\n\r\n\t\tif ( attribute instanceof THREE.InterleavedBufferAttribute ) {\r\n\r\n\t\t\treturn properties.get( attribute.data ).__webglBuffer;\r\n\r\n\t\t}\r\n\r\n\t\treturn properties.get( attribute ).__webglBuffer;\r\n\r\n\t}\r\n\r\n\tfunction deleteAttribute( attribute ) {\r\n\r\n\t\tvar buffer = getAttributeBuffer( attribute );\r\n\r\n\t\tif ( buffer !== undefined ) {\r\n\r\n\t\t\tgl.deleteBuffer( buffer );\r\n\t\t\tremoveAttributeBuffer( attribute );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction deleteAttributes( attributes ) {\r\n\r\n\t\tfor ( var name in attributes ) {\r\n\r\n\t\t\tdeleteAttribute( attributes[ name ] );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction removeAttributeBuffer( attribute ) {\r\n\r\n\t\tif ( attribute instanceof THREE.InterleavedBufferAttribute ) {\r\n\r\n\t\t\tproperties.delete( attribute.data );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tproperties.delete( attribute );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tthis.get = get;\r\n\r\n};\r\n\r\n// File:src/renderers/webgl/WebGLLights.js\r\n\r\n/**\r\n* @author mrdoob / http://mrdoob.com/\r\n*/\r\n\r\nTHREE.WebGLLights = function () {\r\n\r\n\tvar lights = {};\r\n\r\n\tthis.get = function ( light ) {\r\n\r\n\t\tif ( lights[ light.id ] !== undefined ) {\r\n\r\n\t\t\treturn lights[ light.id ];\r\n\r\n\t\t}\r\n\r\n\t\tvar uniforms;\r\n\r\n\t\tswitch ( light.type ) {\r\n\r\n\t\t\tcase 'DirectionalLight':\r\n\t\t\t\tuniforms = {\r\n\t\t\t\t\tdirection: new THREE.Vector3(),\r\n\t\t\t\t\tcolor: new THREE.Color(),\r\n\r\n\t\t\t\t\tshadow: false,\r\n\t\t\t\t\tshadowBias: 0,\r\n\t\t\t\t\tshadowRadius: 1,\r\n\t\t\t\t\tshadowMapSize: new THREE.Vector2()\r\n\t\t\t\t};\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 'SpotLight':\r\n\t\t\t\tuniforms = {\r\n\t\t\t\t\tposition: new THREE.Vector3(),\r\n\t\t\t\t\tdirection: new THREE.Vector3(),\r\n\t\t\t\t\tcolor: new THREE.Color(),\r\n\t\t\t\t\tdistance: 0,\r\n\t\t\t\t\tconeCos: 0,\r\n\t\t\t\t\tpenumbraCos: 0,\r\n\t\t\t\t\tdecay: 0,\r\n\r\n\t\t\t\t\tshadow: false,\r\n\t\t\t\t\tshadowBias: 0,\r\n\t\t\t\t\tshadowRadius: 1,\r\n\t\t\t\t\tshadowMapSize: new THREE.Vector2()\r\n\t\t\t\t};\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 'PointLight':\r\n\t\t\t\tuniforms = {\r\n\t\t\t\t\tposition: new THREE.Vector3(),\r\n\t\t\t\t\tcolor: new THREE.Color(),\r\n\t\t\t\t\tdistance: 0,\r\n\t\t\t\t\tdecay: 0,\r\n\r\n\t\t\t\t\tshadow: false,\r\n\t\t\t\t\tshadowBias: 0,\r\n\t\t\t\t\tshadowRadius: 1,\r\n\t\t\t\t\tshadowMapSize: new THREE.Vector2()\r\n\t\t\t\t};\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 'HemisphereLight':\r\n\t\t\t\tuniforms = {\r\n\t\t\t\t\tdirection: new THREE.Vector3(),\r\n\t\t\t\t\tskyColor: new THREE.Color(),\r\n\t\t\t\t\tgroundColor: new THREE.Color()\r\n\t\t\t\t};\r\n\t\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t\tlights[ light.id ] = uniforms;\r\n\r\n\t\treturn uniforms;\r\n\r\n\t};\r\n\r\n};\r\n\r\n// File:src/renderers/webgl/WebGLObjects.js\r\n\r\n/**\r\n* @author mrdoob / http://mrdoob.com/\r\n*/\r\n\r\nTHREE.WebGLObjects = function ( gl, properties, info ) {\r\n\r\n\tvar geometries = new THREE.WebGLGeometries( gl, properties, info );\r\n\r\n\t//\r\n\r\n\tfunction update( object ) {\r\n\r\n\t\t// TODO: Avoid updating twice (when using shadowMap). Maybe add frame counter.\r\n\r\n\t\tvar geometry = geometries.get( object );\r\n\r\n\t\tif ( object.geometry instanceof THREE.Geometry ) {\r\n\r\n\t\t\tgeometry.updateFromObject( object );\r\n\r\n\t\t}\r\n\r\n\t\tvar index = geometry.index;\r\n\t\tvar attributes = geometry.attributes;\r\n\r\n\t\tif ( index !== null ) {\r\n\r\n\t\t\tupdateAttribute( index, gl.ELEMENT_ARRAY_BUFFER );\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var name in attributes ) {\r\n\r\n\t\t\tupdateAttribute( attributes[ name ], gl.ARRAY_BUFFER );\r\n\r\n\t\t}\r\n\r\n\t\t// morph targets\r\n\r\n\t\tvar morphAttributes = geometry.morphAttributes;\r\n\r\n\t\tfor ( var name in morphAttributes ) {\r\n\r\n\t\t\tvar array = morphAttributes[ name ];\r\n\r\n\t\t\tfor ( var i = 0, l = array.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tupdateAttribute( array[ i ], gl.ARRAY_BUFFER );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn geometry;\r\n\r\n\t}\r\n\r\n\tfunction updateAttribute( attribute, bufferType ) {\r\n\r\n\t\tvar data = ( attribute instanceof THREE.InterleavedBufferAttribute ) ? attribute.data : attribute;\r\n\r\n\t\tvar attributeProperties = properties.get( data );\r\n\r\n\t\tif ( attributeProperties.__webglBuffer === undefined ) {\r\n\r\n\t\t\tcreateBuffer( attributeProperties, data, bufferType );\r\n\r\n\t\t} else if ( attributeProperties.version !== data.version ) {\r\n\r\n\t\t\tupdateBuffer( attributeProperties, data, bufferType );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction createBuffer( attributeProperties, data, bufferType ) {\r\n\r\n\t\tattributeProperties.__webglBuffer = gl.createBuffer();\r\n\t\tgl.bindBuffer( bufferType, attributeProperties.__webglBuffer );\r\n\r\n\t\tvar usage = data.dynamic ? gl.DYNAMIC_DRAW : gl.STATIC_DRAW;\r\n\r\n\t\tgl.bufferData( bufferType, data.array, usage );\r\n\r\n\t\tattributeProperties.version = data.version;\r\n\r\n\t}\r\n\r\n\tfunction updateBuffer( attributeProperties, data, bufferType ) {\r\n\r\n\t\tgl.bindBuffer( bufferType, attributeProperties.__webglBuffer );\r\n\r\n\t\tif ( data.dynamic === false || data.updateRange.count === - 1 ) {\r\n\r\n\t\t\t// Not using update ranges\r\n\r\n\t\t\tgl.bufferSubData( bufferType, 0, data.array );\r\n\r\n\t\t} else if ( data.updateRange.count === 0 ) {\r\n\r\n\t\t\tconsole.error( 'THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually.' );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tgl.bufferSubData( bufferType, data.updateRange.offset * data.array.BYTES_PER_ELEMENT,\r\n\t\t\t\t\t\t\t  data.array.subarray( data.updateRange.offset, data.updateRange.offset + data.updateRange.count ) );\r\n\r\n\t\t\tdata.updateRange.count = 0; // reset range\r\n\r\n\t\t}\r\n\r\n\t\tattributeProperties.version = data.version;\r\n\r\n\t}\r\n\r\n\tfunction getAttributeBuffer( attribute ) {\r\n\r\n\t\tif ( attribute instanceof THREE.InterleavedBufferAttribute ) {\r\n\r\n\t\t\treturn properties.get( attribute.data ).__webglBuffer;\r\n\r\n\t\t}\r\n\r\n\t\treturn properties.get( attribute ).__webglBuffer;\r\n\r\n\t}\r\n\r\n\tfunction getWireframeAttribute( geometry ) {\r\n\r\n\t\tvar property = properties.get( geometry );\r\n\r\n\t\tif ( property.wireframe !== undefined ) {\r\n\r\n\t\t\treturn property.wireframe;\r\n\r\n\t\t}\r\n\r\n\t\tvar indices = [];\r\n\r\n\t\tvar index = geometry.index;\r\n\t\tvar attributes = geometry.attributes;\r\n\t\tvar position = attributes.position;\r\n\r\n\t\t// console.time( 'wireframe' );\r\n\r\n\t\tif ( index !== null ) {\r\n\r\n\t\t\tvar edges = {};\r\n\t\t\tvar array = index.array;\r\n\r\n\t\t\tfor ( var i = 0, l = array.length; i < l; i += 3 ) {\r\n\r\n\t\t\t\tvar a = array[ i + 0 ];\r\n\t\t\t\tvar b = array[ i + 1 ];\r\n\t\t\t\tvar c = array[ i + 2 ];\r\n\r\n\t\t\t\tif ( checkEdge( edges, a, b ) ) indices.push( a, b );\r\n\t\t\t\tif ( checkEdge( edges, b, c ) ) indices.push( b, c );\r\n\t\t\t\tif ( checkEdge( edges, c, a ) ) indices.push( c, a );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tvar array = attributes.position.array;\r\n\r\n\t\t\tfor ( var i = 0, l = ( array.length / 3 ) - 1; i < l; i += 3 ) {\r\n\r\n\t\t\t\tvar a = i + 0;\r\n\t\t\t\tvar b = i + 1;\r\n\t\t\t\tvar c = i + 2;\r\n\r\n\t\t\t\tindices.push( a, b, b, c, c, a );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// console.timeEnd( 'wireframe' );\r\n\r\n\t\tvar TypeArray = position.count > 65535 ? Uint32Array : Uint16Array;\r\n\t\tvar attribute = new THREE.BufferAttribute( new TypeArray( indices ), 1 );\r\n\r\n\t\tupdateAttribute( attribute, gl.ELEMENT_ARRAY_BUFFER );\r\n\r\n\t\tproperty.wireframe = attribute;\r\n\r\n\t\treturn attribute;\r\n\r\n\t}\r\n\r\n\tfunction checkEdge( edges, a, b ) {\r\n\r\n\t\tif ( a > b ) {\r\n\r\n\t\t\tvar tmp = a;\r\n\t\t\ta = b;\r\n\t\t\tb = tmp;\r\n\r\n\t\t}\r\n\r\n\t\tvar list = edges[ a ];\r\n\r\n\t\tif ( list === undefined ) {\r\n\r\n\t\t\tedges[ a ] = [ b ];\r\n\t\t\treturn true;\r\n\r\n\t\t} else if ( list.indexOf( b ) === -1 ) {\r\n\r\n\t\t\tlist.push( b );\r\n\t\t\treturn true;\r\n\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\r\n\t}\r\n\r\n\tthis.getAttributeBuffer = getAttributeBuffer;\r\n\tthis.getWireframeAttribute = getWireframeAttribute;\r\n\r\n\tthis.update = update;\r\n\r\n};\r\n\r\n// File:src/renderers/webgl/WebGLProgram.js\r\n\r\nTHREE.WebGLProgram = ( function () {\r\n\r\n\tvar programIdCount = 0;\r\n\r\n\tfunction getEncodingComponents( encoding ) {\r\n\r\n\t\tswitch ( encoding ) {\r\n\r\n\t\t\tcase THREE.LinearEncoding:\r\n\t\t\t\treturn [ 'Linear','( value )' ];\r\n\t\t\tcase THREE.sRGBEncoding:\r\n\t\t\t\treturn [ 'sRGB','( value )' ];\r\n\t\t\tcase THREE.RGBEEncoding:\r\n\t\t\t\treturn [ 'RGBE','( value )' ];\r\n\t\t\tcase THREE.RGBM7Encoding:\r\n\t\t\t\treturn [ 'RGBM','( value, 7.0 )' ];\r\n\t\t\tcase THREE.RGBM16Encoding:\r\n\t\t\t\treturn [ 'RGBM','( value, 16.0 )' ];\r\n\t\t\tcase THREE.RGBDEncoding:\r\n\t\t\t\treturn [ 'RGBD','( value, 256.0 )' ];\r\n\t\t\tcase THREE.GammaEncoding:\r\n\t\t\t\treturn [ 'Gamma','( value, float( GAMMA_FACTOR ) )' ];\r\n\t\t\tdefault:\r\n\t\t\t\tthrow new Error( 'unsupported encoding: ' + encoding );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction getTexelDecodingFunction( functionName, encoding ) {\r\n\r\n\t\tvar components = getEncodingComponents( encoding );\r\n\t\treturn \"vec4 \" + functionName + \"( vec4 value ) { return \" + components[ 0 ] + \"ToLinear\" + components[ 1 ] + \"; }\";\r\n\r\n\t}\r\n\r\n\tfunction getTexelEncodingFunction( functionName, encoding ) {\r\n\r\n\t\tvar components = getEncodingComponents( encoding );\r\n\t\treturn \"vec4 \" + functionName + \"( vec4 value ) { return LinearTo\" + components[ 0 ] + components[ 1 ] + \"; }\";\r\n\r\n\t}\r\n\r\n\tfunction getToneMappingFunction( functionName, toneMapping ) {\r\n\r\n\t\tvar toneMappingName;\r\n\r\n\t\tswitch ( toneMapping ) {\r\n\r\n\t\t\tcase THREE.LinearToneMapping:\r\n\t\t\t\ttoneMappingName = \"Linear\";\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase THREE.ReinhardToneMapping:\r\n\t\t\t\ttoneMappingName = \"Reinhard\";\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase THREE.Uncharted2ToneMapping:\r\n\t\t\t\ttoneMappingName = \"Uncharted2\";\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase THREE.CineonToneMapping:\r\n\t\t\t\ttoneMappingName = \"OptimizedCineon\";\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tdefault:\r\n\t\t\t\tthrow new Error( 'unsupported toneMapping: ' + toneMapping );\r\n\r\n\t\t}\r\n\r\n\t\treturn \"vec3 \" + functionName + \"( vec3 color ) { return \" + toneMappingName + \"ToneMapping( color ); }\";\r\n\r\n\t}\r\n\r\n\tfunction generateExtensions( extensions, parameters, rendererExtensions ) {\r\n\r\n\t\textensions = extensions || {};\r\n\r\n\t\tvar chunks = [\r\n\t\t\t( extensions.derivatives || parameters.envMapCubeUV || parameters.bumpMap || parameters.normalMap || parameters.flatShading ) ? '#extension GL_OES_standard_derivatives : enable' : '',\r\n\t\t\t( extensions.fragDepth || parameters.logarithmicDepthBuffer ) && rendererExtensions.get( 'EXT_frag_depth' ) ? '#extension GL_EXT_frag_depth : enable' : '',\r\n\t\t\t( extensions.drawBuffers ) && rendererExtensions.get( 'WEBGL_draw_buffers' ) ? '#extension GL_EXT_draw_buffers : require' : '',\r\n\t\t\t( extensions.shaderTextureLOD || parameters.envMap ) && rendererExtensions.get( 'EXT_shader_texture_lod' ) ? '#extension GL_EXT_shader_texture_lod : enable' : '',\r\n\t\t];\r\n\r\n\t\treturn chunks.filter( filterEmptyLine ).join( '\\n' );\r\n\r\n\t}\r\n\r\n\tfunction generateDefines( defines ) {\r\n\r\n\t\tvar chunks = [];\r\n\r\n\t\tfor ( var name in defines ) {\r\n\r\n\t\t\tvar value = defines[ name ];\r\n\r\n\t\t\tif ( value === false ) continue;\r\n\r\n\t\t\tchunks.push( '#define ' + name + ' ' + value );\r\n\r\n\t\t}\r\n\r\n\t\treturn chunks.join( '\\n' );\r\n\r\n\t}\r\n\r\n\tfunction fetchAttributeLocations( gl, program, identifiers ) {\r\n\r\n\t\tvar attributes = {};\r\n\r\n\t\tvar n = gl.getProgramParameter( program, gl.ACTIVE_ATTRIBUTES );\r\n\r\n\t\tfor ( var i = 0; i < n; i ++ ) {\r\n\r\n\t\t\tvar info = gl.getActiveAttrib( program, i );\r\n\t\t\tvar name = info.name;\r\n\r\n\t\t\t// console.log(\"THREE.WebGLProgram: ACTIVE VERTEX ATTRIBUTE:\", name, i );\r\n\r\n\t\t\tattributes[ name ] = gl.getAttribLocation( program, name );\r\n\r\n\t\t}\r\n\r\n\t\treturn attributes;\r\n\r\n\t}\r\n\r\n\tfunction filterEmptyLine( string ) {\r\n\r\n\t\treturn string !== '';\r\n\r\n\t}\r\n\r\n\tfunction replaceLightNums( string, parameters ) {\r\n\r\n\t\treturn string\r\n\t\t\t.replace( /NUM_DIR_LIGHTS/g, parameters.numDirLights )\r\n\t\t\t.replace( /NUM_SPOT_LIGHTS/g, parameters.numSpotLights )\r\n\t\t\t.replace( /NUM_POINT_LIGHTS/g, parameters.numPointLights )\r\n\t\t\t.replace( /NUM_HEMI_LIGHTS/g, parameters.numHemiLights );\r\n\r\n\t}\r\n\r\n\tfunction parseIncludes( string ) {\r\n\r\n\t\tvar pattern = /#include +<([\\w\\d.]+)>/g;\r\n\r\n\t\tfunction replace( match, include ) {\r\n\r\n\t\t\tvar replace = THREE.ShaderChunk[ include ];\r\n\r\n\t\t\tif ( replace === undefined ) {\r\n\r\n\t\t\t\tthrow new Error( 'Can not resolve #include <' + include + '>' );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn parseIncludes( replace );\r\n\r\n\t\t}\r\n\r\n\t\treturn string.replace( pattern, replace );\r\n\r\n\t}\r\n\r\n\tfunction unrollLoops( string ) {\r\n\r\n\t\tvar pattern = /for \\( int i \\= (\\d+)\\; i < (\\d+)\\; i \\+\\+ \\) \\{([\\s\\S]+?)(?=\\})\\}/g;\r\n\r\n\t\tfunction replace( match, start, end, snippet ) {\r\n\r\n\t\t\tvar unroll = '';\r\n\r\n\t\t\tfor ( var i = parseInt( start ); i < parseInt( end ); i ++ ) {\r\n\r\n\t\t\t\tunroll += snippet.replace( /\\[ i \\]/g, '[ ' + i + ' ]' );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn unroll;\r\n\r\n\t\t}\r\n\r\n\t\treturn string.replace( pattern, replace );\r\n\r\n\t}\r\n\r\n\treturn function WebGLProgram( renderer, code, material, parameters ) {\r\n\r\n\t\tvar gl = renderer.context;\r\n\r\n\t\tvar extensions = material.extensions;\r\n\t\tvar defines = material.defines;\r\n\r\n\t\tvar vertexShader = material.__webglShader.vertexShader;\r\n\t\tvar fragmentShader = material.__webglShader.fragmentShader;\r\n\r\n\t\tvar shadowMapTypeDefine = 'SHADOWMAP_TYPE_BASIC';\r\n\r\n\t\tif ( parameters.shadowMapType === THREE.PCFShadowMap ) {\r\n\r\n\t\t\tshadowMapTypeDefine = 'SHADOWMAP_TYPE_PCF';\r\n\r\n\t\t} else if ( parameters.shadowMapType === THREE.PCFSoftShadowMap ) {\r\n\r\n\t\t\tshadowMapTypeDefine = 'SHADOWMAP_TYPE_PCF_SOFT';\r\n\r\n\t\t}\r\n\r\n\t\tvar envMapTypeDefine = 'ENVMAP_TYPE_CUBE';\r\n\t\tvar envMapModeDefine = 'ENVMAP_MODE_REFLECTION';\r\n\t\tvar envMapBlendingDefine = 'ENVMAP_BLENDING_MULTIPLY';\r\n\r\n\t\tif ( parameters.envMap ) {\r\n\r\n\t\t\tswitch ( material.envMap.mapping ) {\r\n\r\n\t\t\t\tcase THREE.CubeReflectionMapping:\r\n\t\t\t\tcase THREE.CubeRefractionMapping:\r\n\t\t\t\t\tenvMapTypeDefine = 'ENVMAP_TYPE_CUBE';\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase THREE.CubeUVReflectionMapping:\r\n\t\t\t\tcase THREE.CubeUVRefractionMapping:\r\n\t\t\t\t\tenvMapTypeDefine = 'ENVMAP_TYPE_CUBE_UV';\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase THREE.EquirectangularReflectionMapping:\r\n\t\t\t\tcase THREE.EquirectangularRefractionMapping:\r\n\t\t\t\t\tenvMapTypeDefine = 'ENVMAP_TYPE_EQUIREC';\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase THREE.SphericalReflectionMapping:\r\n\t\t\t\t\tenvMapTypeDefine = 'ENVMAP_TYPE_SPHERE';\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tswitch ( material.envMap.mapping ) {\r\n\r\n\t\t\t\tcase THREE.CubeRefractionMapping:\r\n\t\t\t\tcase THREE.EquirectangularRefractionMapping:\r\n\t\t\t\t\tenvMapModeDefine = 'ENVMAP_MODE_REFRACTION';\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tswitch ( material.combine ) {\r\n\r\n\t\t\t\tcase THREE.MultiplyOperation:\r\n\t\t\t\t\tenvMapBlendingDefine = 'ENVMAP_BLENDING_MULTIPLY';\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase THREE.MixOperation:\r\n\t\t\t\t\tenvMapBlendingDefine = 'ENVMAP_BLENDING_MIX';\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase THREE.AddOperation:\r\n\t\t\t\t\tenvMapBlendingDefine = 'ENVMAP_BLENDING_ADD';\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar gammaFactorDefine = ( renderer.gammaFactor > 0 ) ? renderer.gammaFactor : 1.0;\r\n\r\n\t\t// console.log( 'building new program ' );\r\n\r\n\t\t//\r\n\r\n\t\tvar customExtensions = generateExtensions( extensions, parameters, renderer.extensions );\r\n\r\n\t\tvar customDefines = generateDefines( defines );\r\n\r\n\t\t//\r\n\r\n\t\tvar program = gl.createProgram();\r\n\r\n\t\tvar prefixVertex, prefixFragment;\r\n\r\n\t\tif ( material instanceof THREE.RawShaderMaterial ) {\r\n\r\n\t\t\tprefixVertex = '';\r\n\t\t\tprefixFragment = '';\r\n\r\n\t\t} else {\r\n\r\n\t\t\tprefixVertex = [\r\n\r\n\t\t\t\t'precision ' + parameters.precision + ' float;',\r\n\t\t\t\t'precision ' + parameters.precision + ' int;',\r\n\r\n\t\t\t\t'#define SHADER_NAME ' + material.__webglShader.name,\r\n\r\n\t\t\t\tcustomDefines,\r\n\r\n\t\t\t\tparameters.supportsVertexTextures ? '#define VERTEX_TEXTURES' : '',\r\n\r\n\t\t\t\t'#define GAMMA_FACTOR ' + gammaFactorDefine,\r\n\r\n\t\t\t\t'#define MAX_BONES ' + parameters.maxBones,\r\n\r\n\t\t\t\tparameters.map ? '#define USE_MAP' : '',\r\n\t\t\t\tparameters.envMap ? '#define USE_ENVMAP' : '',\r\n\t\t\t\tparameters.envMap ? '#define ' + envMapModeDefine : '',\r\n\t\t\t\tparameters.lightMap ? '#define USE_LIGHTMAP' : '',\r\n\t\t\t\tparameters.aoMap ? '#define USE_AOMAP' : '',\r\n\t\t\t\tparameters.emissiveMap ? '#define USE_EMISSIVEMAP' : '',\r\n\t\t\t\tparameters.bumpMap ? '#define USE_BUMPMAP' : '',\r\n\t\t\t\tparameters.normalMap ? '#define USE_NORMALMAP' : '',\r\n\t\t\t\tparameters.displacementMap && parameters.supportsVertexTextures ? '#define USE_DISPLACEMENTMAP' : '',\r\n\t\t\t\tparameters.specularMap ? '#define USE_SPECULARMAP' : '',\r\n\t\t\t\tparameters.roughnessMap ? '#define USE_ROUGHNESSMAP' : '',\r\n\t\t\t\tparameters.metalnessMap ? '#define USE_METALNESSMAP' : '',\r\n\t\t\t\tparameters.alphaMap ? '#define USE_ALPHAMAP' : '',\r\n\t\t\t\tparameters.vertexColors ? '#define USE_COLOR' : '',\r\n\r\n\t\t\t\tparameters.flatShading ? '#define FLAT_SHADED' : '',\r\n\r\n\t\t\t\tparameters.skinning ? '#define USE_SKINNING' : '',\r\n\t\t\t\tparameters.useVertexTexture ? '#define BONE_TEXTURE' : '',\r\n\r\n\t\t\t\tparameters.morphTargets ? '#define USE_MORPHTARGETS' : '',\r\n\t\t\t\tparameters.morphNormals && parameters.flatShading === false ? '#define USE_MORPHNORMALS' : '',\r\n\t\t\t\tparameters.doubleSided ? '#define DOUBLE_SIDED' : '',\r\n\t\t\t\tparameters.flipSided ? '#define FLIP_SIDED' : '',\r\n\r\n\t\t\t\t'#define NUM_CLIPPING_PLANES ' + parameters.numClippingPlanes,\r\n\r\n\t\t\t\tparameters.shadowMapEnabled ? '#define USE_SHADOWMAP' : '',\r\n\t\t\t\tparameters.shadowMapEnabled ? '#define ' + shadowMapTypeDefine : '',\r\n\r\n\t\t\t\tparameters.sizeAttenuation ? '#define USE_SIZEATTENUATION' : '',\r\n\r\n\t\t\t\tparameters.logarithmicDepthBuffer ? '#define USE_LOGDEPTHBUF' : '',\r\n\t\t\t\tparameters.logarithmicDepthBuffer && renderer.extensions.get( 'EXT_frag_depth' ) ? '#define USE_LOGDEPTHBUF_EXT' : '',\r\n\r\n\t\t\t\t'uniform mat4 modelMatrix;',\r\n\t\t\t\t'uniform mat4 modelViewMatrix;',\r\n\t\t\t\t'uniform mat4 projectionMatrix;',\r\n\t\t\t\t'uniform mat4 viewMatrix;',\r\n\t\t\t\t'uniform mat3 normalMatrix;',\r\n\t\t\t\t'uniform vec3 cameraPosition;',\r\n\r\n\t\t\t\t'attribute vec3 position;',\r\n\t\t\t\t'attribute vec3 normal;',\r\n\t\t\t\t'attribute vec2 uv;',\r\n\r\n\t\t\t\t'#ifdef USE_COLOR',\r\n\r\n\t\t\t\t'\tattribute vec3 color;',\r\n\r\n\t\t\t\t'#endif',\r\n\r\n\t\t\t\t'#ifdef USE_MORPHTARGETS',\r\n\r\n\t\t\t\t'\tattribute vec3 morphTarget0;',\r\n\t\t\t\t'\tattribute vec3 morphTarget1;',\r\n\t\t\t\t'\tattribute vec3 morphTarget2;',\r\n\t\t\t\t'\tattribute vec3 morphTarget3;',\r\n\r\n\t\t\t\t'\t#ifdef USE_MORPHNORMALS',\r\n\r\n\t\t\t\t'\t\tattribute vec3 morphNormal0;',\r\n\t\t\t\t'\t\tattribute vec3 morphNormal1;',\r\n\t\t\t\t'\t\tattribute vec3 morphNormal2;',\r\n\t\t\t\t'\t\tattribute vec3 morphNormal3;',\r\n\r\n\t\t\t\t'\t#else',\r\n\r\n\t\t\t\t'\t\tattribute vec3 morphTarget4;',\r\n\t\t\t\t'\t\tattribute vec3 morphTarget5;',\r\n\t\t\t\t'\t\tattribute vec3 morphTarget6;',\r\n\t\t\t\t'\t\tattribute vec3 morphTarget7;',\r\n\r\n\t\t\t\t'\t#endif',\r\n\r\n\t\t\t\t'#endif',\r\n\r\n\t\t\t\t'#ifdef USE_SKINNING',\r\n\r\n\t\t\t\t'\tattribute vec4 skinIndex;',\r\n\t\t\t\t'\tattribute vec4 skinWeight;',\r\n\r\n\t\t\t\t'#endif',\r\n\r\n\t\t\t\t'\\n'\r\n\r\n\t\t\t].filter( filterEmptyLine ).join( '\\n' );\r\n\r\n\t\t\tprefixFragment = [\r\n\r\n\t\t\t\tcustomExtensions,\r\n\r\n\t\t\t\t'precision ' + parameters.precision + ' float;',\r\n\t\t\t\t'precision ' + parameters.precision + ' int;',\r\n\r\n\t\t\t\t'#define SHADER_NAME ' + material.__webglShader.name,\r\n\r\n\t\t\t\tcustomDefines,\r\n\r\n\t\t\t\tparameters.alphaTest ? '#define ALPHATEST ' + parameters.alphaTest : '',\r\n\r\n\t\t\t\t'#define GAMMA_FACTOR ' + gammaFactorDefine,\r\n\r\n\t\t\t\t( parameters.useFog && parameters.fog ) ? '#define USE_FOG' : '',\r\n\t\t\t\t( parameters.useFog && parameters.fogExp ) ? '#define FOG_EXP2' : '',\r\n\r\n\t\t\t\tparameters.map ? '#define USE_MAP' : '',\r\n\t\t\t\tparameters.envMap ? '#define USE_ENVMAP' : '',\r\n\t\t\t\tparameters.envMap ? '#define ' + envMapTypeDefine : '',\r\n\t\t\t\tparameters.envMap ? '#define ' + envMapModeDefine : '',\r\n\t\t\t\tparameters.envMap ? '#define ' + envMapBlendingDefine : '',\r\n\t\t\t\tparameters.lightMap ? '#define USE_LIGHTMAP' : '',\r\n\t\t\t\tparameters.aoMap ? '#define USE_AOMAP' : '',\r\n\t\t\t\tparameters.emissiveMap ? '#define USE_EMISSIVEMAP' : '',\r\n\t\t\t\tparameters.bumpMap ? '#define USE_BUMPMAP' : '',\r\n\t\t\t\tparameters.normalMap ? '#define USE_NORMALMAP' : '',\r\n\t\t\t\tparameters.specularMap ? '#define USE_SPECULARMAP' : '',\r\n\t\t\t\tparameters.roughnessMap ? '#define USE_ROUGHNESSMAP' : '',\r\n\t\t\t\tparameters.metalnessMap ? '#define USE_METALNESSMAP' : '',\r\n\t\t\t\tparameters.alphaMap ? '#define USE_ALPHAMAP' : '',\r\n\t\t\t\tparameters.vertexColors ? '#define USE_COLOR' : '',\r\n\r\n\t\t\t\tparameters.flatShading ? '#define FLAT_SHADED' : '',\r\n\r\n\t\t\t\tparameters.doubleSided ? '#define DOUBLE_SIDED' : '',\r\n\t\t\t\tparameters.flipSided ? '#define FLIP_SIDED' : '',\r\n\r\n\t\t\t\t'#define NUM_CLIPPING_PLANES ' + parameters.numClippingPlanes,\r\n\r\n\t\t\t\tparameters.shadowMapEnabled ? '#define USE_SHADOWMAP' : '',\r\n\t\t\t\tparameters.shadowMapEnabled ? '#define ' + shadowMapTypeDefine : '',\r\n\r\n\t\t\t\tparameters.premultipliedAlpha ? \"#define PREMULTIPLIED_ALPHA\" : '',\r\n\r\n\t\t\t\tparameters.physicallyCorrectLights ? \"#define PHYSICALLY_CORRECT_LIGHTS\" : '',\r\n\r\n\t\t\t\tparameters.logarithmicDepthBuffer ? '#define USE_LOGDEPTHBUF' : '',\r\n\t\t\t\tparameters.logarithmicDepthBuffer && renderer.extensions.get( 'EXT_frag_depth' ) ? '#define USE_LOGDEPTHBUF_EXT' : '',\r\n\r\n\t\t\t\tparameters.envMap && renderer.extensions.get( 'EXT_shader_texture_lod' ) ? '#define TEXTURE_LOD_EXT' : '',\r\n\r\n\t\t\t\t'uniform mat4 viewMatrix;',\r\n\t\t\t\t'uniform vec3 cameraPosition;',\r\n\r\n\t\t\t\t( parameters.toneMapping !== THREE.NoToneMapping ) ? \"#define TONE_MAPPING\" : '',\r\n\t\t\t\t( parameters.toneMapping !== THREE.NoToneMapping ) ? THREE.ShaderChunk[ 'tonemapping_pars_fragment' ] : '',  // this code is required here because it is used by the toneMapping() function defined below\r\n\t\t\t\t( parameters.toneMapping !== THREE.NoToneMapping ) ? getToneMappingFunction( \"toneMapping\", parameters.toneMapping ) : '',\r\n\r\n\t\t\t\t( parameters.outputEncoding || parameters.mapEncoding || parameters.envMapEncoding || parameters.emissiveMapEncoding ) ? THREE.ShaderChunk[ 'encodings_pars_fragment' ] : '', // this code is required here because it is used by the various encoding/decoding function defined below\r\n\t\t\t\tparameters.mapEncoding ? getTexelDecodingFunction( 'mapTexelToLinear', parameters.mapEncoding ) : '',\r\n\t\t\t\tparameters.envMapEncoding ? getTexelDecodingFunction( 'envMapTexelToLinear', parameters.envMapEncoding ) : '',\r\n\t\t\t\tparameters.emissiveMapEncoding ? getTexelDecodingFunction( 'emissiveMapTexelToLinear', parameters.emissiveMapEncoding ) : '',\r\n\t\t\t\tparameters.outputEncoding ? getTexelEncodingFunction( \"linearToOutputTexel\", parameters.outputEncoding ) : '',\r\n\r\n\t\t\t\tparameters.depthPacking ? \"#define DEPTH_PACKING \" + material.depthPacking : '',\r\n\r\n\t\t\t\t'\\n'\r\n\r\n\t\t\t].filter( filterEmptyLine ).join( '\\n' );\r\n\r\n\t\t}\r\n\r\n\t\tvertexShader = parseIncludes( vertexShader, parameters );\r\n\t\tvertexShader = replaceLightNums( vertexShader, parameters );\r\n\r\n\t\tfragmentShader = parseIncludes( fragmentShader, parameters );\r\n\t\tfragmentShader = replaceLightNums( fragmentShader, parameters );\r\n\r\n\t\tif ( material instanceof THREE.ShaderMaterial === false ) {\r\n\r\n\t\t\tvertexShader = unrollLoops( vertexShader );\r\n\t\t\tfragmentShader = unrollLoops( fragmentShader );\r\n\r\n\t\t}\r\n\r\n\t\tvar vertexGlsl = prefixVertex + vertexShader;\r\n\t\tvar fragmentGlsl = prefixFragment + fragmentShader;\r\n\r\n\t\t// console.log( '*VERTEX*', vertexGlsl );\r\n\t\t// console.log( '*FRAGMENT*', fragmentGlsl );\r\n\r\n\t\tvar glVertexShader = THREE.WebGLShader( gl, gl.VERTEX_SHADER, vertexGlsl );\r\n\t\tvar glFragmentShader = THREE.WebGLShader( gl, gl.FRAGMENT_SHADER, fragmentGlsl );\r\n\r\n\t\tgl.attachShader( program, glVertexShader );\r\n\t\tgl.attachShader( program, glFragmentShader );\r\n\r\n\t\t// Force a particular attribute to index 0.\r\n\r\n\t\tif ( material.index0AttributeName !== undefined ) {\r\n\r\n\t\t\tgl.bindAttribLocation( program, 0, material.index0AttributeName );\r\n\r\n\t\t} else if ( parameters.morphTargets === true ) {\r\n\r\n\t\t\t// programs with morphTargets displace position out of attribute 0\r\n\t\t\tgl.bindAttribLocation( program, 0, 'position' );\r\n\r\n\t\t}\r\n\r\n\t\tgl.linkProgram( program );\r\n\r\n\t\tvar programLog = gl.getProgramInfoLog( program );\r\n\t\tvar vertexLog = gl.getShaderInfoLog( glVertexShader );\r\n\t\tvar fragmentLog = gl.getShaderInfoLog( glFragmentShader );\r\n\r\n\t\tvar runnable = true;\r\n\t\tvar haveDiagnostics = true;\r\n\r\n\t\t// console.log( '**VERTEX**', gl.getExtension( 'WEBGL_debug_shaders' ).getTranslatedShaderSource( glVertexShader ) );\r\n\t\t// console.log( '**FRAGMENT**', gl.getExtension( 'WEBGL_debug_shaders' ).getTranslatedShaderSource( glFragmentShader ) );\r\n\r\n\t\tif ( gl.getProgramParameter( program, gl.LINK_STATUS ) === false ) {\r\n\r\n\t\t\trunnable = false;\r\n\r\n\t\t\tconsole.error( 'THREE.WebGLProgram: shader error: ', gl.getError(), 'gl.VALIDATE_STATUS', gl.getProgramParameter( program, gl.VALIDATE_STATUS ), 'gl.getProgramInfoLog', programLog, vertexLog, fragmentLog );\r\n\r\n\t\t} else if ( programLog !== '' ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLProgram: gl.getProgramInfoLog()', programLog );\r\n\r\n\t\t} else if ( vertexLog === '' || fragmentLog === '' ) {\r\n\r\n\t\t\thaveDiagnostics = false;\r\n\r\n\t\t}\r\n\r\n\t\tif ( haveDiagnostics ) {\r\n\r\n\t\t\tthis.diagnostics = {\r\n\r\n\t\t\t\trunnable: runnable,\r\n\t\t\t\tmaterial: material,\r\n\r\n\t\t\t\tprogramLog: programLog,\r\n\r\n\t\t\t\tvertexShader: {\r\n\r\n\t\t\t\t\tlog: vertexLog,\r\n\t\t\t\t\tprefix: prefixVertex\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\tfragmentShader: {\r\n\r\n\t\t\t\t\tlog: fragmentLog,\r\n\t\t\t\t\tprefix: prefixFragment\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t};\r\n\r\n\t\t}\r\n\r\n\t\t// clean up\r\n\r\n\t\tgl.deleteShader( glVertexShader );\r\n\t\tgl.deleteShader( glFragmentShader );\r\n\r\n\t\t// set up caching for uniform locations\r\n\r\n\t\tvar cachedUniforms;\r\n\r\n\t\tthis.getUniforms = function() {\r\n\r\n\t\t\tif ( cachedUniforms === undefined ) {\r\n\r\n\t\t\t\tcachedUniforms =\r\n\t\t\t\t\t\tnew THREE.WebGLUniforms( gl, program, renderer );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn cachedUniforms;\r\n\r\n\t\t};\r\n\r\n\t\t// set up caching for attribute locations\r\n\r\n\t\tvar cachedAttributes;\r\n\r\n\t\tthis.getAttributes = function() {\r\n\r\n\t\t\tif ( cachedAttributes === undefined ) {\r\n\r\n\t\t\t\tcachedAttributes = fetchAttributeLocations( gl, program );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn cachedAttributes;\r\n\r\n\t\t};\r\n\r\n\t\t// free resource\r\n\r\n\t\tthis.destroy = function() {\r\n\r\n\t\t\tgl.deleteProgram( program );\r\n\t\t\tthis.program = undefined;\r\n\r\n\t\t};\r\n\r\n\t\t// DEPRECATED\r\n\r\n\t\tObject.defineProperties( this, {\r\n\r\n\t\t\tuniforms: {\r\n\t\t\t\tget: function() {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.WebGLProgram: .uniforms is now .getUniforms().' );\r\n\t\t\t\t\treturn this.getUniforms();\r\n\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tattributes: {\r\n\t\t\t\tget: function() {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.WebGLProgram: .attributes is now .getAttributes().' );\r\n\t\t\t\t\treturn this.getAttributes();\r\n\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t} );\r\n\r\n\r\n\t\t//\r\n\r\n\t\tthis.id = programIdCount ++;\r\n\t\tthis.code = code;\r\n\t\tthis.usedTimes = 1;\r\n\t\tthis.program = program;\r\n\t\tthis.vertexShader = glVertexShader;\r\n\t\tthis.fragmentShader = glFragmentShader;\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n} )();\r\n\r\n// File:src/renderers/webgl/WebGLPrograms.js\r\n\r\nTHREE.WebGLPrograms = function ( renderer, capabilities ) {\r\n\r\n\tvar programs = [];\r\n\r\n\tvar shaderIDs = {\r\n\t\tMeshDepthMaterial: 'depth',\r\n\t\tMeshNormalMaterial: 'normal',\r\n\t\tMeshBasicMaterial: 'basic',\r\n\t\tMeshLambertMaterial: 'lambert',\r\n\t\tMeshPhongMaterial: 'phong',\r\n\t\tMeshStandardMaterial: 'physical',\r\n\t\tMeshPhysicalMaterial: 'physical',\r\n\t\tLineBasicMaterial: 'basic',\r\n\t\tLineDashedMaterial: 'dashed',\r\n\t\tPointsMaterial: 'points'\r\n\t};\r\n\r\n\tvar parameterNames = [\r\n\t\t\"precision\", \"supportsVertexTextures\", \"map\", \"mapEncoding\", \"envMap\", \"envMapMode\", \"envMapEncoding\",\r\n\t\t\"lightMap\", \"aoMap\", \"emissiveMap\", \"emissiveMapEncoding\", \"bumpMap\", \"normalMap\", \"displacementMap\", \"specularMap\",\r\n\t\t\"roughnessMap\", \"metalnessMap\",\r\n\t\t\"alphaMap\", \"combine\", \"vertexColors\", \"fog\", \"useFog\", \"fogExp\",\r\n\t\t\"flatShading\", \"sizeAttenuation\", \"logarithmicDepthBuffer\", \"skinning\",\r\n\t\t\"maxBones\", \"useVertexTexture\", \"morphTargets\", \"morphNormals\",\r\n\t\t\"maxMorphTargets\", \"maxMorphNormals\", \"premultipliedAlpha\",\r\n\t\t\"numDirLights\", \"numPointLights\", \"numSpotLights\", \"numHemiLights\",\r\n\t\t\"shadowMapEnabled\", \"shadowMapType\", \"toneMapping\", 'physicallyCorrectLights',\r\n\t\t\"alphaTest\", \"doubleSided\", \"flipSided\", \"numClippingPlanes\", \"depthPacking\"\r\n\t];\r\n\r\n\r\n\tfunction allocateBones ( object ) {\r\n\r\n\t\tif ( capabilities.floatVertexTextures && object && object.skeleton && object.skeleton.useVertexTexture ) {\r\n\r\n\t\t\treturn 1024;\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// default for when object is not specified\r\n\t\t\t// ( for example when prebuilding shader to be used with multiple objects )\r\n\t\t\t//\r\n\t\t\t//  - leave some extra space for other uniforms\r\n\t\t\t//  - limit here is ANGLE's 254 max uniform vectors\r\n\t\t\t//    (up to 54 should be safe)\r\n\r\n\t\t\tvar nVertexUniforms = capabilities.maxVertexUniforms;\r\n\t\t\tvar nVertexMatrices = Math.floor( ( nVertexUniforms - 20 ) / 4 );\r\n\r\n\t\t\tvar maxBones = nVertexMatrices;\r\n\r\n\t\t\tif ( object !== undefined && object instanceof THREE.SkinnedMesh ) {\r\n\r\n\t\t\t\tmaxBones = Math.min( object.skeleton.bones.length, maxBones );\r\n\r\n\t\t\t\tif ( maxBones < object.skeleton.bones.length ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'WebGLRenderer: too many bones - ' + object.skeleton.bones.length + ', this GPU supports just ' + maxBones + ' (try OpenGL instead of ANGLE)' );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn maxBones;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction getTextureEncodingFromMap( map, gammaOverrideLinear ) {\r\n\r\n\t\tvar encoding;\r\n\r\n\t\tif ( ! map ) {\r\n\r\n\t\t\tencoding = THREE.LinearEncoding;\r\n\r\n\t\t} else if ( map instanceof THREE.Texture ) {\r\n\r\n\t\t\tencoding = map.encoding;\r\n\r\n\t\t} else if ( map instanceof THREE.WebGLRenderTarget ) {\r\n\r\n\t\t\tconsole.warn( \"THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead.\" );\r\n\t\t\tencoding = map.texture.encoding;\r\n\r\n\t\t}\r\n\r\n\t\t// add backwards compatibility for WebGLRenderer.gammaInput/gammaOutput parameter, should probably be removed at some point.\r\n\t\tif ( encoding === THREE.LinearEncoding && gammaOverrideLinear ) {\r\n\r\n\t\t\tencoding = THREE.GammaEncoding;\r\n\r\n\t\t}\r\n\r\n\t\treturn encoding;\r\n\r\n\t}\r\n\r\n\tthis.getParameters = function ( material, lights, fog, nClipPlanes, object ) {\r\n\r\n\t\tvar shaderID = shaderIDs[ material.type ];\r\n\r\n\t\t// heuristics to create shader parameters according to lights in the scene\r\n\t\t// (not to blow over maxLights budget)\r\n\r\n\t\tvar maxBones = allocateBones( object );\r\n\t\tvar precision = renderer.getPrecision();\r\n\r\n\t\tif ( material.precision !== null ) {\r\n\r\n\t\t\tprecision = capabilities.getMaxPrecision( material.precision );\r\n\r\n\t\t\tif ( precision !== material.precision ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLProgram.getParameters:', material.precision, 'not supported, using', precision, 'instead.' );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar currentRenderTarget = renderer.getCurrentRenderTarget();\r\n\r\n\t\tvar parameters = {\r\n\r\n\t\t\tshaderID: shaderID,\r\n\r\n\t\t\tprecision: precision,\r\n\t\t\tsupportsVertexTextures: capabilities.vertexTextures,\r\n\t\t\toutputEncoding: getTextureEncodingFromMap( ( ! currentRenderTarget ) ? null : currentRenderTarget.texture, renderer.gammaOutput ),\r\n\t\t\tmap: !! material.map,\r\n\t\t\tmapEncoding: getTextureEncodingFromMap( material.map, renderer.gammaInput ),\r\n\t\t\tenvMap: !! material.envMap,\r\n\t\t\tenvMapMode: material.envMap && material.envMap.mapping,\r\n\t\t\tenvMapEncoding: getTextureEncodingFromMap( material.envMap, renderer.gammaInput ),\r\n\t\t\tenvMapCubeUV: ( !! material.envMap ) && ( ( material.envMap.mapping === THREE.CubeUVReflectionMapping ) || ( material.envMap.mapping === THREE.CubeUVRefractionMapping ) ),\r\n\t\t\tlightMap: !! material.lightMap,\r\n\t\t\taoMap: !! material.aoMap,\r\n\t\t\temissiveMap: !! material.emissiveMap,\r\n\t\t\temissiveMapEncoding: getTextureEncodingFromMap( material.emissiveMap, renderer.gammaInput ),\r\n\t\t\tbumpMap: !! material.bumpMap,\r\n\t\t\tnormalMap: !! material.normalMap,\r\n\t\t\tdisplacementMap: !! material.displacementMap,\r\n\t\t\troughnessMap: !! material.roughnessMap,\r\n\t\t\tmetalnessMap: !! material.metalnessMap,\r\n\t\t\tspecularMap: !! material.specularMap,\r\n\t\t\talphaMap: !! material.alphaMap,\r\n\r\n\t\t\tcombine: material.combine,\r\n\r\n\t\t\tvertexColors: material.vertexColors,\r\n\r\n\t\t\tfog: fog,\r\n\t\t\tuseFog: material.fog,\r\n\t\t\tfogExp: fog instanceof THREE.FogExp2,\r\n\r\n\t\t\tflatShading: material.shading === THREE.FlatShading,\r\n\r\n\t\t\tsizeAttenuation: material.sizeAttenuation,\r\n\t\t\tlogarithmicDepthBuffer: capabilities.logarithmicDepthBuffer,\r\n\r\n\t\t\tskinning: material.skinning,\r\n\t\t\tmaxBones: maxBones,\r\n\t\t\tuseVertexTexture: capabilities.floatVertexTextures && object && object.skeleton && object.skeleton.useVertexTexture,\r\n\r\n\t\t\tmorphTargets: material.morphTargets,\r\n\t\t\tmorphNormals: material.morphNormals,\r\n\t\t\tmaxMorphTargets: renderer.maxMorphTargets,\r\n\t\t\tmaxMorphNormals: renderer.maxMorphNormals,\r\n\r\n\t\t\tnumDirLights: lights.directional.length,\r\n\t\t\tnumPointLights: lights.point.length,\r\n\t\t\tnumSpotLights: lights.spot.length,\r\n\t\t\tnumHemiLights: lights.hemi.length,\r\n\r\n\t\t\tnumClippingPlanes: nClipPlanes,\r\n\r\n\t\t\tshadowMapEnabled: renderer.shadowMap.enabled && object.receiveShadow && lights.shadows.length > 0,\r\n\t\t\tshadowMapType: renderer.shadowMap.type,\r\n\r\n\t\t\ttoneMapping: renderer.toneMapping,\r\n\t\t\tphysicallyCorrectLights: renderer.physicallyCorrectLights,\r\n\r\n\t\t\tpremultipliedAlpha: material.premultipliedAlpha,\r\n\r\n\t\t\talphaTest: material.alphaTest,\r\n\t\t\tdoubleSided: material.side === THREE.DoubleSide,\r\n\t\t\tflipSided: material.side === THREE.BackSide,\r\n\r\n\t\t\tdepthPacking: ( material.depthPacking !== undefined ) ? material.depthPacking : false\r\n\r\n\t\t};\r\n\r\n\t\treturn parameters;\r\n\r\n\t};\r\n\r\n\tthis.getProgramCode = function ( material, parameters ) {\r\n\r\n\t\tvar array = [];\r\n\r\n\t\tif ( parameters.shaderID ) {\r\n\r\n\t\t\tarray.push( parameters.shaderID );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tarray.push( material.fragmentShader );\r\n\t\t\tarray.push( material.vertexShader );\r\n\r\n\t\t}\r\n\r\n\t\tif ( material.defines !== undefined ) {\r\n\r\n\t\t\tfor ( var name in material.defines ) {\r\n\r\n\t\t\t\tarray.push( name );\r\n\t\t\t\tarray.push( material.defines[ name ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var i = 0; i < parameterNames.length; i ++ ) {\r\n\r\n\t\t\tarray.push( parameters[ parameterNames[ i ] ] );\r\n\r\n\t\t}\r\n\r\n\t\treturn array.join();\r\n\r\n\t};\r\n\r\n\tthis.acquireProgram = function ( material, parameters, code ) {\r\n\r\n\t\tvar program;\r\n\r\n\t\t// Check if code has been already compiled\r\n\t\tfor ( var p = 0, pl = programs.length; p < pl; p ++ ) {\r\n\r\n\t\t\tvar programInfo = programs[ p ];\r\n\r\n\t\t\tif ( programInfo.code === code ) {\r\n\r\n\t\t\t\tprogram = programInfo;\r\n\t\t\t\t++ program.usedTimes;\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( program === undefined ) {\r\n\r\n\t\t\tprogram = new THREE.WebGLProgram( renderer, code, material, parameters );\r\n\t\t\tprograms.push( program );\r\n\r\n\t\t}\r\n\r\n\t\treturn program;\r\n\r\n\t};\r\n\r\n\tthis.releaseProgram = function( program ) {\r\n\r\n\t\tif ( -- program.usedTimes === 0 ) {\r\n\r\n\t\t\t// Remove from unordered set\r\n\t\t\tvar i = programs.indexOf( program );\r\n\t\t\tprograms[ i ] = programs[ programs.length - 1 ];\r\n\t\t\tprograms.pop();\r\n\r\n\t\t\t// Free WebGL resources\r\n\t\t\tprogram.destroy();\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\t// Exposed for resource monitoring & error feedback via renderer.info:\r\n\tthis.programs = programs;\r\n\r\n};\r\n\r\n// File:src/renderers/webgl/WebGLProperties.js\r\n\r\n/**\r\n* @author fordacious / fordacious.github.io\r\n*/\r\n\r\nTHREE.WebGLProperties = function () {\r\n\r\n\tvar properties = {};\r\n\r\n\tthis.get = function ( object ) {\r\n\r\n\t\tvar uuid = object.uuid;\r\n\t\tvar map = properties[ uuid ];\r\n\r\n\t\tif ( map === undefined ) {\r\n\r\n\t\t\tmap = {};\r\n\t\t\tproperties[ uuid ] = map;\r\n\r\n\t\t}\r\n\r\n\t\treturn map;\r\n\r\n\t};\r\n\r\n\tthis.delete = function ( object ) {\r\n\r\n\t\tdelete properties[ object.uuid ];\r\n\r\n\t};\r\n\r\n\tthis.clear = function () {\r\n\r\n\t\tproperties = {};\r\n\r\n\t};\r\n\r\n};\r\n\r\n// File:src/renderers/webgl/WebGLShader.js\r\n\r\nTHREE.WebGLShader = ( function () {\r\n\r\n\tfunction addLineNumbers( string ) {\r\n\r\n\t\tvar lines = string.split( '\\n' );\r\n\r\n\t\tfor ( var i = 0; i < lines.length; i ++ ) {\r\n\r\n\t\t\tlines[ i ] = ( i + 1 ) + ': ' + lines[ i ];\r\n\r\n\t\t}\r\n\r\n\t\treturn lines.join( '\\n' );\r\n\r\n\t}\r\n\r\n\treturn function WebGLShader( gl, type, string ) {\r\n\r\n\t\tvar shader = gl.createShader( type );\r\n\r\n\t\tgl.shaderSource( shader, string );\r\n\t\tgl.compileShader( shader );\r\n\r\n\t\tif ( gl.getShaderParameter( shader, gl.COMPILE_STATUS ) === false ) {\r\n\r\n\t\t\tconsole.error( 'THREE.WebGLShader: Shader couldn\\'t compile.' );\r\n\r\n\t\t}\r\n\r\n\t\tif ( gl.getShaderInfoLog( shader ) !== '' ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLShader: gl.getShaderInfoLog()', type === gl.VERTEX_SHADER ? 'vertex' : 'fragment', gl.getShaderInfoLog( shader ), addLineNumbers( string ) );\r\n\r\n\t\t}\r\n\r\n\t\t// --enable-privileged-webgl-extension\r\n\t\t// console.log( type, gl.getExtension( 'WEBGL_debug_shaders' ).getTranslatedShaderSource( shader ) );\r\n\r\n\t\treturn shader;\r\n\r\n\t};\r\n\r\n} )();\r\n\r\n// File:src/renderers/webgl/WebGLShadowMap.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.WebGLShadowMap = function ( _renderer, _lights, _objects ) {\r\n\r\n\tvar _gl = _renderer.context,\r\n\t_state = _renderer.state,\r\n\t_frustum = new THREE.Frustum(),\r\n\t_projScreenMatrix = new THREE.Matrix4(),\r\n\r\n\t_lightShadows = _lights.shadows,\r\n\r\n\t_shadowMapSize = new THREE.Vector2(),\r\n\r\n\t_lookTarget = new THREE.Vector3(),\r\n\t_lightPositionWorld = new THREE.Vector3(),\r\n\r\n\t_renderList = [],\r\n\r\n\t_MorphingFlag = 1,\r\n\t_SkinningFlag = 2,\r\n\r\n\t_NumberOfMaterialVariants = ( _MorphingFlag | _SkinningFlag ) + 1,\r\n\r\n\t_depthMaterials = new Array( _NumberOfMaterialVariants ),\r\n\t_distanceMaterials = new Array( _NumberOfMaterialVariants ),\r\n\r\n\t_materialCache = {};\r\n\r\n\tvar cubeDirections = [\r\n\t\tnew THREE.Vector3( 1, 0, 0 ), new THREE.Vector3( - 1, 0, 0 ), new THREE.Vector3( 0, 0, 1 ),\r\n\t\tnew THREE.Vector3( 0, 0, - 1 ), new THREE.Vector3( 0, 1, 0 ), new THREE.Vector3( 0, - 1, 0 )\r\n\t];\r\n\r\n\tvar cubeUps = [\r\n\t\tnew THREE.Vector3( 0, 1, 0 ), new THREE.Vector3( 0, 1, 0 ), new THREE.Vector3( 0, 1, 0 ),\r\n\t\tnew THREE.Vector3( 0, 1, 0 ), new THREE.Vector3( 0, 0, 1 ),\tnew THREE.Vector3( 0, 0, - 1 )\r\n\t];\r\n\r\n\tvar cube2DViewPorts = [\r\n\t\tnew THREE.Vector4(), new THREE.Vector4(), new THREE.Vector4(),\r\n\t\tnew THREE.Vector4(), new THREE.Vector4(), new THREE.Vector4()\r\n\t];\r\n\r\n\t// init\r\n\r\n\tvar depthMaterialTemplate = new THREE.MeshDepthMaterial();\r\n\tdepthMaterialTemplate.depthPacking = THREE.RGBADepthPacking;\r\n\tdepthMaterialTemplate.clipping = true;\r\n\r\n\tvar distanceShader = THREE.ShaderLib[ \"distanceRGBA\" ];\r\n\tvar distanceUniforms = THREE.UniformsUtils.clone( distanceShader.uniforms );\r\n\r\n\tfor ( var i = 0; i !== _NumberOfMaterialVariants; ++ i ) {\r\n\r\n\t\tvar useMorphing = ( i & _MorphingFlag ) !== 0;\r\n\t\tvar useSkinning = ( i & _SkinningFlag ) !== 0;\r\n\r\n\t\tvar depthMaterial = depthMaterialTemplate.clone();\r\n\t\tdepthMaterial.morphTargets = useMorphing;\r\n\t\tdepthMaterial.skinning = useSkinning;\r\n\r\n\t\t_depthMaterials[ i ] = depthMaterial;\r\n\r\n\t\tvar distanceMaterial = new THREE.ShaderMaterial( {\r\n\t\t\tdefines: {\r\n\t\t\t\t'USE_SHADOWMAP': ''\r\n\t\t\t},\r\n\t\t\tuniforms: distanceUniforms,\r\n\t\t\tvertexShader: distanceShader.vertexShader,\r\n\t\t\tfragmentShader: distanceShader.fragmentShader,\r\n\t\t\tmorphTargets: useMorphing,\r\n\t\t\tskinning: useSkinning,\r\n\t\t\tclipping: true\r\n\t\t} );\r\n\r\n\t\t_distanceMaterials[ i ] = distanceMaterial;\r\n\r\n\t}\r\n\r\n\t//\r\n\r\n\tvar scope = this;\r\n\r\n\tthis.enabled = false;\r\n\r\n\tthis.autoUpdate = true;\r\n\tthis.needsUpdate = false;\r\n\r\n\tthis.type = THREE.PCFShadowMap;\r\n\r\n\tthis.renderReverseSided = true;\r\n\tthis.renderSingleSided = true;\r\n\r\n\tthis.render = function ( scene, camera ) {\r\n\r\n\t\tif ( scope.enabled === false ) return;\r\n\t\tif ( scope.autoUpdate === false && scope.needsUpdate === false ) return;\r\n\r\n\t\tif ( _lightShadows.length === 0 ) return;\r\n\r\n\t\t// Set GL state for depth map.\r\n\t\t_state.clearColor( 1, 1, 1, 1 );\r\n\t\t_state.disable( _gl.BLEND );\r\n\t\t_state.setDepthTest( true );\r\n\t\t_state.setScissorTest( false );\r\n\r\n\t\t// render depth map\r\n\r\n\t\tvar faceCount, isPointLight;\r\n\r\n\t\tfor ( var i = 0, il = _lightShadows.length; i < il; i ++ ) {\r\n\r\n\t\t\tvar light = _lightShadows[ i ];\r\n\t\t\tvar shadow = light.shadow;\r\n\r\n\t\t\tif ( shadow === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLShadowMap:', light, 'has no shadow.' );\r\n\t\t\t\tcontinue;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar shadowCamera = shadow.camera;\r\n\r\n\t\t\t_shadowMapSize.copy( shadow.mapSize );\r\n\r\n\t\t\tif ( light instanceof THREE.PointLight ) {\r\n\r\n\t\t\t\tfaceCount = 6;\r\n\t\t\t\tisPointLight = true;\r\n\r\n\t\t\t\tvar vpWidth = _shadowMapSize.x;\r\n\t\t\t\tvar vpHeight = _shadowMapSize.y;\r\n\r\n\t\t\t\t// These viewports map a cube-map onto a 2D texture with the\r\n\t\t\t\t// following orientation:\r\n\t\t\t\t//\r\n\t\t\t\t//  xzXZ\r\n\t\t\t\t//   y Y\r\n\t\t\t\t//\r\n\t\t\t\t// X - Positive x direction\r\n\t\t\t\t// x - Negative x direction\r\n\t\t\t\t// Y - Positive y direction\r\n\t\t\t\t// y - Negative y direction\r\n\t\t\t\t// Z - Positive z direction\r\n\t\t\t\t// z - Negative z direction\r\n\r\n\t\t\t\t// positive X\r\n\t\t\t\tcube2DViewPorts[ 0 ].set( vpWidth * 2, vpHeight, vpWidth, vpHeight );\r\n\t\t\t\t// negative X\r\n\t\t\t\tcube2DViewPorts[ 1 ].set( 0, vpHeight, vpWidth, vpHeight );\r\n\t\t\t\t// positive Z\r\n\t\t\t\tcube2DViewPorts[ 2 ].set( vpWidth * 3, vpHeight, vpWidth, vpHeight );\r\n\t\t\t\t// negative Z\r\n\t\t\t\tcube2DViewPorts[ 3 ].set( vpWidth, vpHeight, vpWidth, vpHeight );\r\n\t\t\t\t// positive Y\r\n\t\t\t\tcube2DViewPorts[ 4 ].set( vpWidth * 3, 0, vpWidth, vpHeight );\r\n\t\t\t\t// negative Y\r\n\t\t\t\tcube2DViewPorts[ 5 ].set( vpWidth, 0, vpWidth, vpHeight );\r\n\r\n\t\t\t\t_shadowMapSize.x *= 4.0;\r\n\t\t\t\t_shadowMapSize.y *= 2.0;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tfaceCount = 1;\r\n\t\t\t\tisPointLight = false;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( shadow.map === null ) {\r\n\r\n\t\t\t\tvar pars = { minFilter: THREE.NearestFilter, magFilter: THREE.NearestFilter, format: THREE.RGBAFormat };\r\n\r\n\t\t\t\tshadow.map = new THREE.WebGLRenderTarget( _shadowMapSize.x, _shadowMapSize.y, pars );\r\n\r\n\t\t\t\tshadowCamera.updateProjectionMatrix();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( shadow instanceof THREE.SpotLightShadow ) {\r\n\r\n\t\t\t\tshadow.update( light );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar shadowMap = shadow.map;\r\n\t\t\tvar shadowMatrix = shadow.matrix;\r\n\r\n\t\t\t_lightPositionWorld.setFromMatrixPosition( light.matrixWorld );\r\n\t\t\tshadowCamera.position.copy( _lightPositionWorld );\r\n\r\n\t\t\t_renderer.setRenderTarget( shadowMap );\r\n\t\t\t_renderer.clear();\r\n\r\n\t\t\t// render shadow map for each cube face (if omni-directional) or\r\n\t\t\t// run a single pass if not\r\n\r\n\t\t\tfor ( var face = 0; face < faceCount; face ++ ) {\r\n\r\n\t\t\t\tif ( isPointLight ) {\r\n\r\n\t\t\t\t\t_lookTarget.copy( shadowCamera.position );\r\n\t\t\t\t\t_lookTarget.add( cubeDirections[ face ] );\r\n\t\t\t\t\tshadowCamera.up.copy( cubeUps[ face ] );\r\n\t\t\t\t\tshadowCamera.lookAt( _lookTarget );\r\n\r\n\t\t\t\t\tvar vpDimensions = cube2DViewPorts[ face ];\r\n\t\t\t\t\t_state.viewport( vpDimensions );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t_lookTarget.setFromMatrixPosition( light.target.matrixWorld );\r\n\t\t\t\t\tshadowCamera.lookAt( _lookTarget );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tshadowCamera.updateMatrixWorld();\r\n\t\t\t\tshadowCamera.matrixWorldInverse.getInverse( shadowCamera.matrixWorld );\r\n\r\n\t\t\t\t// compute shadow matrix\r\n\r\n\t\t\t\tshadowMatrix.set(\r\n\t\t\t\t\t0.5, 0.0, 0.0, 0.5,\r\n\t\t\t\t\t0.0, 0.5, 0.0, 0.5,\r\n\t\t\t\t\t0.0, 0.0, 0.5, 0.5,\r\n\t\t\t\t\t0.0, 0.0, 0.0, 1.0\r\n\t\t\t\t);\r\n\r\n\t\t\t\tshadowMatrix.multiply( shadowCamera.projectionMatrix );\r\n\t\t\t\tshadowMatrix.multiply( shadowCamera.matrixWorldInverse );\r\n\r\n\t\t\t\t// update camera matrices and frustum\r\n\r\n\t\t\t\t_projScreenMatrix.multiplyMatrices( shadowCamera.projectionMatrix, shadowCamera.matrixWorldInverse );\r\n\t\t\t\t_frustum.setFromMatrix( _projScreenMatrix );\r\n\r\n\t\t\t\t// set object matrices & frustum culling\r\n\r\n\t\t\t\t_renderList.length = 0;\r\n\r\n\t\t\t\tprojectObject( scene, camera, shadowCamera );\r\n\r\n\t\t\t\t// render shadow map\r\n\t\t\t\t// render regular objects\r\n\r\n\t\t\t\tfor ( var j = 0, jl = _renderList.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\t\tvar object = _renderList[ j ];\r\n\t\t\t\t\tvar geometry = _objects.update( object );\r\n\t\t\t\t\tvar material = object.material;\r\n\r\n\t\t\t\t\tif ( material instanceof THREE.MultiMaterial ) {\r\n\r\n\t\t\t\t\t\tvar groups = geometry.groups;\r\n\t\t\t\t\t\tvar materials = material.materials;\r\n\r\n\t\t\t\t\t\tfor ( var k = 0, kl = groups.length; k < kl; k ++ ) {\r\n\r\n\t\t\t\t\t\t\tvar group = groups[ k ];\r\n\t\t\t\t\t\t\tvar groupMaterial = materials[ group.materialIndex ];\r\n\r\n\t\t\t\t\t\t\tif ( groupMaterial.visible === true ) {\r\n\r\n\t\t\t\t\t\t\t\tvar depthMaterial = getDepthMaterial( object, groupMaterial, isPointLight, _lightPositionWorld );\r\n\t\t\t\t\t\t\t\t_renderer.renderBufferDirect( shadowCamera, null, geometry, depthMaterial, object, group );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tvar depthMaterial = getDepthMaterial( object, material, isPointLight, _lightPositionWorld );\r\n\t\t\t\t\t\t_renderer.renderBufferDirect( shadowCamera, null, geometry, depthMaterial, object, null );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// Restore GL state.\r\n\t\tvar clearColor = _renderer.getClearColor(),\r\n\t\tclearAlpha = _renderer.getClearAlpha();\r\n\t\t_renderer.setClearColor( clearColor, clearAlpha );\r\n\r\n\t\tscope.needsUpdate = false;\r\n\r\n\t};\r\n\r\n\tfunction getDepthMaterial( object, material, isPointLight, lightPositionWorld ) {\r\n\r\n\t\tvar geometry = object.geometry;\r\n\r\n\t\tvar result = null;\r\n\r\n\t\tvar materialVariants = _depthMaterials;\r\n\t\tvar customMaterial = object.customDepthMaterial;\r\n\r\n\t\tif ( isPointLight ) {\r\n\r\n\t\t\tmaterialVariants = _distanceMaterials;\r\n\t\t\tcustomMaterial = object.customDistanceMaterial;\r\n\r\n\t\t}\r\n\r\n\t\tif ( ! customMaterial ) {\r\n\r\n\t\t\tvar useMorphing = geometry.morphTargets !== undefined &&\r\n\t\t\t\t\tgeometry.morphTargets.length > 0 && material.morphTargets;\r\n\r\n\t\t\tvar useSkinning = object instanceof THREE.SkinnedMesh && material.skinning;\r\n\r\n\t\t\tvar variantIndex = 0;\r\n\r\n\t\t\tif ( useMorphing ) variantIndex |= _MorphingFlag;\r\n\t\t\tif ( useSkinning ) variantIndex |= _SkinningFlag;\r\n\r\n\t\t\tresult = materialVariants[ variantIndex ];\r\n\r\n\t\t} else {\r\n\r\n\t\t\tresult = customMaterial;\r\n\r\n\t\t}\r\n\r\n\t\tif ( _renderer.localClippingEnabled &&\r\n\t\t\t material.clipShadows === true &&\r\n\t\t\t\tmaterial.clippingPlanes.length !== 0 ) {\r\n\r\n\t\t\t// in this case we need a unique material instance reflecting the\r\n\t\t\t// appropriate state\r\n\r\n\t\t\tvar keyA = result.uuid, keyB = material.uuid;\r\n\r\n\t\t\tvar materialsForVariant = _materialCache[ keyA ];\r\n\r\n\t\t\tif ( materialsForVariant === undefined ) {\r\n\r\n\t\t\t\tmaterialsForVariant = {};\r\n\t\t\t\t_materialCache[ keyA ] = materialsForVariant;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar cachedMaterial = materialsForVariant[ keyB ];\r\n\r\n\t\t\tif ( cachedMaterial === undefined ) {\r\n\r\n\t\t\t\tcachedMaterial = result.clone();\r\n\t\t\t\tmaterialsForVariant[ keyB ] = cachedMaterial;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tresult = cachedMaterial;\r\n\r\n\t\t}\r\n\r\n\t\tresult.visible = material.visible;\r\n\t\tresult.wireframe = material.wireframe;\r\n\r\n\t\tvar side = material.side;\r\n\r\n\t\tif ( scope.renderSingleSided && side == THREE.DoubleSide ) {\r\n\r\n\t\t\tside = THREE.FrontSide;\r\n\r\n\t\t}\r\n\r\n\t\tif ( scope.renderReverseSided ) {\r\n\r\n\t\t\tif ( side === THREE.FrontSide ) side = THREE.BackSide;\r\n\t\t\telse if ( side === THREE.BackSide ) side = THREE.FrontSide;\r\n\r\n\t\t}\r\n\r\n\t\tresult.side = side;\r\n\r\n\t\tresult.clipShadows = material.clipShadows;\r\n\t\tresult.clippingPlanes = material.clippingPlanes;\r\n\r\n\t\tresult.wireframeLinewidth = material.wireframeLinewidth;\r\n\t\tresult.linewidth = material.linewidth;\r\n\r\n\t\tif ( isPointLight && result.uniforms.lightPos !== undefined ) {\r\n\r\n\t\t\tresult.uniforms.lightPos.value.copy( lightPositionWorld );\r\n\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\r\n\t}\r\n\r\n\tfunction projectObject( object, camera, shadowCamera ) {\r\n\r\n\t\tif ( object.visible === false ) return;\r\n\r\n\t\tif ( object.layers.test( camera.layers ) && ( object instanceof THREE.Mesh || object instanceof THREE.Line || object instanceof THREE.Points ) ) {\r\n\r\n\t\t\tif ( object.castShadow && ( object.frustumCulled === false || _frustum.intersectsObject( object ) === true ) ) {\r\n\r\n\t\t\t\tvar material = object.material;\r\n\r\n\t\t\t\tif ( material.visible === true ) {\r\n\r\n\t\t\t\t\tobject.modelViewMatrix.multiplyMatrices( shadowCamera.matrixWorldInverse, object.matrixWorld );\r\n\t\t\t\t\t_renderList.push( object );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar children = object.children;\r\n\r\n\t\tfor ( var i = 0, l = children.length; i < l; i ++ ) {\r\n\r\n\t\t\tprojectObject( children[ i ], camera, shadowCamera );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/renderers/webgl/WebGLState.js\r\n\r\n/**\r\n* @author mrdoob / http://mrdoob.com/\r\n*/\r\n\r\nTHREE.WebGLState = function ( gl, extensions, paramThreeToGL ) {\r\n\r\n\tvar _this = this;\r\n\r\n\tthis.buffers = {\r\n\t\tcolor: new THREE.WebGLColorBuffer( gl, this ),\r\n\t\tdepth: new THREE.WebGLDepthBuffer( gl, this ),\r\n\t\tstencil: new THREE.WebGLStencilBuffer( gl, this )\r\n\t};\r\n\r\n\tvar maxVertexAttributes = gl.getParameter( gl.MAX_VERTEX_ATTRIBS );\r\n\tvar newAttributes = new Uint8Array( maxVertexAttributes );\r\n\tvar enabledAttributes = new Uint8Array( maxVertexAttributes );\r\n\tvar attributeDivisors = new Uint8Array( maxVertexAttributes );\r\n\r\n\tvar capabilities = {};\r\n\r\n\tvar compressedTextureFormats = null;\r\n\r\n\tvar currentBlending = null;\r\n\tvar currentBlendEquation = null;\r\n\tvar currentBlendSrc = null;\r\n\tvar currentBlendDst = null;\r\n\tvar currentBlendEquationAlpha = null;\r\n\tvar currentBlendSrcAlpha = null;\r\n\tvar currentBlendDstAlpha = null;\r\n\tvar currentPremultipledAlpha = false;\r\n\r\n\tvar currentFlipSided = null;\r\n\tvar currentCullFace = null;\r\n\r\n\tvar currentLineWidth = null;\r\n\r\n\tvar currentPolygonOffsetFactor = null;\r\n\tvar currentPolygonOffsetUnits = null;\r\n\r\n\tvar currentScissorTest = null;\r\n\r\n\tvar maxTextures = gl.getParameter( gl.MAX_TEXTURE_IMAGE_UNITS );\r\n\r\n\tvar currentTextureSlot = null;\r\n\tvar currentBoundTextures = {};\r\n\r\n\tvar currentScissor = new THREE.Vector4();\r\n\tvar currentViewport = new THREE.Vector4();\r\n\r\n\tfunction createTexture( type, target, count ) {\r\n\r\n\t\tvar data = new Uint8Array( 3 );\r\n\t\tvar texture = gl.createTexture();\r\n\r\n\t\tgl.bindTexture( type, texture );\r\n\t\tgl.texParameteri( type, gl.TEXTURE_MIN_FILTER, gl.NEAREST );\r\n\t\tgl.texParameteri( type, gl.TEXTURE_MAG_FILTER, gl.NEAREST );\r\n\r\n\t\tfor ( var i = 0; i < count; i ++ ) {\r\n\r\n\t\t\tgl.texImage2D( target + i, 0, gl.RGB, 1, 1, 0, gl.RGB, gl.UNSIGNED_BYTE, data );\r\n\r\n\t\t}\r\n\r\n\t\treturn texture;\r\n\r\n\t}\r\n\r\n\tvar emptyTextures = {};\r\n\temptyTextures[ gl.TEXTURE_2D ] = createTexture( gl.TEXTURE_2D, gl.TEXTURE_2D, 1 );\r\n\temptyTextures[ gl.TEXTURE_CUBE_MAP ] = createTexture( gl.TEXTURE_CUBE_MAP, gl.TEXTURE_CUBE_MAP_POSITIVE_X, 6 );\r\n\r\n\t//\r\n\r\n\tthis.init = function () {\r\n\r\n\t\tthis.clearColor( 0, 0, 0, 1 );\r\n\t\tthis.clearDepth( 1 );\r\n\t\tthis.clearStencil( 0 );\r\n\r\n\t\tthis.enable( gl.DEPTH_TEST );\r\n\t\tthis.setDepthFunc( THREE.LessEqualDepth );\r\n\r\n\t\tthis.setFlipSided( false );\r\n\t\tthis.setCullFace( THREE.CullFaceBack );\r\n\t\tthis.enable( gl.CULL_FACE );\r\n\r\n\t\tthis.enable( gl.BLEND );\r\n\t\tthis.setBlending( THREE.NormalBlending );\r\n\r\n\t};\r\n\r\n\tthis.initAttributes = function () {\r\n\r\n\t\tfor ( var i = 0, l = newAttributes.length; i < l; i ++ ) {\r\n\r\n\t\t\tnewAttributes[ i ] = 0;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.enableAttribute = function ( attribute ) {\r\n\r\n\t\tnewAttributes[ attribute ] = 1;\r\n\r\n\t\tif ( enabledAttributes[ attribute ] === 0 ) {\r\n\r\n\t\t\tgl.enableVertexAttribArray( attribute );\r\n\t\t\tenabledAttributes[ attribute ] = 1;\r\n\r\n\t\t}\r\n\r\n\t\tif ( attributeDivisors[ attribute ] !== 0 ) {\r\n\r\n\t\t\tvar extension = extensions.get( 'ANGLE_instanced_arrays' );\r\n\r\n\t\t\textension.vertexAttribDivisorANGLE( attribute, 0 );\r\n\t\t\tattributeDivisors[ attribute ] = 0;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.enableAttributeAndDivisor = function ( attribute, meshPerAttribute, extension ) {\r\n\r\n\t\tnewAttributes[ attribute ] = 1;\r\n\r\n\t\tif ( enabledAttributes[ attribute ] === 0 ) {\r\n\r\n\t\t\tgl.enableVertexAttribArray( attribute );\r\n\t\t\tenabledAttributes[ attribute ] = 1;\r\n\r\n\t\t}\r\n\r\n\t\tif ( attributeDivisors[ attribute ] !== meshPerAttribute ) {\r\n\r\n\t\t\textension.vertexAttribDivisorANGLE( attribute, meshPerAttribute );\r\n\t\t\tattributeDivisors[ attribute ] = meshPerAttribute;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.disableUnusedAttributes = function () {\r\n\r\n\t\tfor ( var i = 0, l = enabledAttributes.length; i !== l; ++ i ) {\r\n\r\n\t\t\tif ( enabledAttributes[ i ] !== newAttributes[ i ] ) {\r\n\r\n\t\t\t\tgl.disableVertexAttribArray( i );\r\n\t\t\t\tenabledAttributes[ i ] = 0;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.enable = function ( id ) {\r\n\r\n\t\tif ( capabilities[ id ] !== true ) {\r\n\r\n\t\t\tgl.enable( id );\r\n\t\t\tcapabilities[ id ] = true;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.disable = function ( id ) {\r\n\r\n\t\tif ( capabilities[ id ] !== false ) {\r\n\r\n\t\t\tgl.disable( id );\r\n\t\t\tcapabilities[ id ] = false;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.getCompressedTextureFormats = function () {\r\n\r\n\t\tif ( compressedTextureFormats === null ) {\r\n\r\n\t\t\tcompressedTextureFormats = [];\r\n\r\n\t\t\tif ( extensions.get( 'WEBGL_compressed_texture_pvrtc' ) ||\r\n\t\t\t     extensions.get( 'WEBGL_compressed_texture_s3tc' ) ||\r\n\t\t\t     extensions.get( 'WEBGL_compressed_texture_etc1' ) ) {\r\n\r\n\t\t\t\tvar formats = gl.getParameter( gl.COMPRESSED_TEXTURE_FORMATS );\r\n\r\n\t\t\t\tfor ( var i = 0; i < formats.length; i ++ ) {\r\n\r\n\t\t\t\t\tcompressedTextureFormats.push( formats[ i ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn compressedTextureFormats;\r\n\r\n\t};\r\n\r\n\tthis.setBlending = function ( blending, blendEquation, blendSrc, blendDst, blendEquationAlpha, blendSrcAlpha, blendDstAlpha, premultipliedAlpha ) {\r\n\r\n\t\tif ( blending !== THREE.NoBlending ) {\r\n\r\n\t\t\tthis.enable( gl.BLEND );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.disable( gl.BLEND );\r\n\t\t\tcurrentBlending = blending; // no blending, that is\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tif ( blending !== currentBlending || premultipliedAlpha !== currentPremultipledAlpha ) {\r\n\r\n\t\t\tif ( blending === THREE.AdditiveBlending ) {\r\n\r\n\t\t\t\tif ( premultipliedAlpha ) {\r\n\r\n\t\t\t\t\tgl.blendEquationSeparate( gl.FUNC_ADD, gl.FUNC_ADD );\r\n\t\t\t\t\tgl.blendFuncSeparate( gl.ONE, gl.ONE, gl.ONE, gl.ONE );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tgl.blendEquation( gl.FUNC_ADD );\r\n\t\t\t\t\tgl.blendFunc( gl.SRC_ALPHA, gl.ONE );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( blending === THREE.SubtractiveBlending ) {\r\n\r\n\t\t\t\tif ( premultipliedAlpha ) {\r\n\r\n\t\t\t\t\tgl.blendEquationSeparate( gl.FUNC_ADD, gl.FUNC_ADD );\r\n\t\t\t\t\tgl.blendFuncSeparate( gl.ZERO, gl.ZERO, gl.ONE_MINUS_SRC_COLOR, gl.ONE_MINUS_SRC_ALPHA );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tgl.blendEquation( gl.FUNC_ADD );\r\n\t\t\t\t\tgl.blendFunc( gl.ZERO, gl.ONE_MINUS_SRC_COLOR );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( blending === THREE.MultiplyBlending ) {\r\n\r\n\t\t\t\tif ( premultipliedAlpha ) {\r\n\r\n\t\t\t\t\tgl.blendEquationSeparate( gl.FUNC_ADD, gl.FUNC_ADD );\r\n\t\t\t\t\tgl.blendFuncSeparate( gl.ZERO, gl.SRC_COLOR, gl.ZERO, gl.SRC_ALPHA );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tgl.blendEquation( gl.FUNC_ADD );\r\n\t\t\t\t\tgl.blendFunc( gl.ZERO, gl.SRC_COLOR );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tif ( premultipliedAlpha ) {\r\n\r\n\t\t\t\t\tgl.blendEquationSeparate( gl.FUNC_ADD, gl.FUNC_ADD );\r\n\t\t\t\t\tgl.blendFuncSeparate( gl.ONE, gl.ONE_MINUS_SRC_ALPHA, gl.ONE, gl.ONE_MINUS_SRC_ALPHA );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tgl.blendEquationSeparate( gl.FUNC_ADD, gl.FUNC_ADD );\r\n\t\t\t\t\tgl.blendFuncSeparate( gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA, gl.ONE, gl.ONE_MINUS_SRC_ALPHA );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tcurrentBlending = blending;\r\n\t\t\tcurrentPremultipledAlpha = premultipliedAlpha;\r\n\r\n\t\t}\r\n\r\n\t\tif ( blending === THREE.CustomBlending ) {\r\n\r\n\t\t\tblendEquationAlpha = blendEquationAlpha || blendEquation;\r\n\t\t\tblendSrcAlpha = blendSrcAlpha || blendSrc;\r\n\t\t\tblendDstAlpha = blendDstAlpha || blendDst;\r\n\r\n\t\t\tif ( blendEquation !== currentBlendEquation || blendEquationAlpha !== currentBlendEquationAlpha ) {\r\n\r\n\t\t\t\tgl.blendEquationSeparate( paramThreeToGL( blendEquation ), paramThreeToGL( blendEquationAlpha ) );\r\n\r\n\t\t\t\tcurrentBlendEquation = blendEquation;\r\n\t\t\t\tcurrentBlendEquationAlpha = blendEquationAlpha;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( blendSrc !== currentBlendSrc || blendDst !== currentBlendDst || blendSrcAlpha !== currentBlendSrcAlpha || blendDstAlpha !== currentBlendDstAlpha ) {\r\n\r\n\t\t\t\tgl.blendFuncSeparate( paramThreeToGL( blendSrc ), paramThreeToGL( blendDst ), paramThreeToGL( blendSrcAlpha ), paramThreeToGL( blendDstAlpha ) );\r\n\r\n\t\t\t\tcurrentBlendSrc = blendSrc;\r\n\t\t\t\tcurrentBlendDst = blendDst;\r\n\t\t\t\tcurrentBlendSrcAlpha = blendSrcAlpha;\r\n\t\t\t\tcurrentBlendDstAlpha = blendDstAlpha;\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tcurrentBlendEquation = null;\r\n\t\t\tcurrentBlendSrc = null;\r\n\t\t\tcurrentBlendDst = null;\r\n\t\t\tcurrentBlendEquationAlpha = null;\r\n\t\t\tcurrentBlendSrcAlpha = null;\r\n\t\t\tcurrentBlendDstAlpha = null;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\t// TODO Deprecate\r\n\r\n\tthis.setColorWrite = function ( colorWrite ) {\r\n\r\n\t\tthis.buffers.color.setMask( colorWrite );\r\n\r\n\t};\r\n\r\n\tthis.setDepthTest = function ( depthTest ) {\r\n\r\n\t\tthis.buffers.depth.setTest( depthTest );\r\n\r\n\t};\r\n\r\n\tthis.setDepthWrite = function ( depthWrite ) {\r\n\r\n\t\tthis.buffers.depth.setMask( depthWrite );\r\n\r\n\t};\r\n\r\n\tthis.setDepthFunc = function ( depthFunc ) {\r\n\r\n\t\tthis.buffers.depth.setFunc( depthFunc );\r\n\r\n\t};\r\n\r\n\tthis.setStencilTest = function ( stencilTest ) {\r\n\r\n\t\tthis.buffers.stencil.setTest( stencilTest );\r\n\r\n\t};\r\n\r\n\tthis.setStencilWrite = function ( stencilWrite ) {\r\n\r\n\t\tthis.buffers.stencil.setMask( stencilWrite );\r\n\r\n\t};\r\n\r\n\tthis.setStencilFunc = function ( stencilFunc, stencilRef, stencilMask ) {\r\n\r\n\t\tthis.buffers.stencil.setFunc( stencilFunc, stencilRef, stencilMask );\r\n\r\n\t};\r\n\r\n\tthis.setStencilOp = function ( stencilFail, stencilZFail, stencilZPass ) {\r\n\r\n\t\tthis.buffers.stencil.setOp( stencilFail, stencilZFail, stencilZPass );\r\n\r\n\t};\r\n\r\n\t//\r\n\r\n\tthis.setFlipSided = function ( flipSided ) {\r\n\r\n\t\tif ( currentFlipSided !== flipSided ) {\r\n\r\n\t\t\tif ( flipSided ) {\r\n\r\n\t\t\t\tgl.frontFace( gl.CW );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tgl.frontFace( gl.CCW );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tcurrentFlipSided = flipSided;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.setCullFace = function ( cullFace ) {\r\n\r\n\t\tif ( cullFace !== THREE.CullFaceNone ) {\r\n\r\n\t\t\tthis.enable( gl.CULL_FACE );\r\n\r\n\t\t\tif ( cullFace !== currentCullFace ) {\r\n\r\n\t\t\t\tif ( cullFace === THREE.CullFaceBack ) {\r\n\r\n\t\t\t\t\tgl.cullFace( gl.BACK );\r\n\r\n\t\t\t\t} else if ( cullFace === THREE.CullFaceFront ) {\r\n\r\n\t\t\t\t\tgl.cullFace( gl.FRONT );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tgl.cullFace( gl.FRONT_AND_BACK );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.disable( gl.CULL_FACE );\r\n\r\n\t\t}\r\n\r\n\t\tcurrentCullFace = cullFace;\r\n\r\n\t};\r\n\r\n\tthis.setLineWidth = function ( width ) {\r\n\r\n\t\tif ( width !== currentLineWidth ) {\r\n\r\n\t\t\tgl.lineWidth( width );\r\n\r\n\t\t\tcurrentLineWidth = width;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.setPolygonOffset = function ( polygonOffset, factor, units ) {\r\n\r\n\t\tif ( polygonOffset ) {\r\n\r\n\t\t\tthis.enable( gl.POLYGON_OFFSET_FILL );\r\n\r\n\t\t\tif ( currentPolygonOffsetFactor !== factor || currentPolygonOffsetUnits !== units ) {\r\n\r\n\t\t\t\tgl.polygonOffset( factor, units );\r\n\r\n\t\t\t\tcurrentPolygonOffsetFactor = factor;\r\n\t\t\t\tcurrentPolygonOffsetUnits = units;\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.disable( gl.POLYGON_OFFSET_FILL );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.getScissorTest = function () {\r\n\r\n\t\treturn currentScissorTest;\r\n\r\n\t};\r\n\r\n\tthis.setScissorTest = function ( scissorTest ) {\r\n\r\n\t\tcurrentScissorTest = scissorTest;\r\n\r\n\t\tif ( scissorTest ) {\r\n\r\n\t\t\tthis.enable( gl.SCISSOR_TEST );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.disable( gl.SCISSOR_TEST );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\t// texture\r\n\r\n\tthis.activeTexture = function ( webglSlot ) {\r\n\r\n\t\tif ( webglSlot === undefined ) webglSlot = gl.TEXTURE0 + maxTextures - 1;\r\n\r\n\t\tif ( currentTextureSlot !== webglSlot ) {\r\n\r\n\t\t\tgl.activeTexture( webglSlot );\r\n\t\t\tcurrentTextureSlot = webglSlot;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.bindTexture = function ( webglType, webglTexture ) {\r\n\r\n\t\tif ( currentTextureSlot === null ) {\r\n\r\n\t\t\t_this.activeTexture();\r\n\r\n\t\t}\r\n\r\n\t\tvar boundTexture = currentBoundTextures[ currentTextureSlot ];\r\n\r\n\t\tif ( boundTexture === undefined ) {\r\n\r\n\t\t\tboundTexture = { type: undefined, texture: undefined };\r\n\t\t\tcurrentBoundTextures[ currentTextureSlot ] = boundTexture;\r\n\r\n\t\t}\r\n\r\n\t\tif ( boundTexture.type !== webglType || boundTexture.texture !== webglTexture ) {\r\n\r\n\t\t\tgl.bindTexture( webglType, webglTexture || emptyTextures[ webglType ] );\r\n\r\n\t\t\tboundTexture.type = webglType;\r\n\t\t\tboundTexture.texture = webglTexture;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.compressedTexImage2D = function () {\r\n\r\n\t\ttry {\r\n\r\n\t\t\tgl.compressedTexImage2D.apply( gl, arguments );\r\n\r\n\t\t} catch ( error ) {\r\n\r\n\t\t\tconsole.error( error );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.texImage2D = function () {\r\n\r\n\t\ttry {\r\n\r\n\t\t\tgl.texImage2D.apply( gl, arguments );\r\n\r\n\t\t} catch ( error ) {\r\n\r\n\t\t\tconsole.error( error );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\t// TODO Deprecate\r\n\r\n\tthis.clearColor = function ( r, g, b, a ) {\r\n\r\n\t\tthis.buffers.color.setClear( r, g, b, a );\r\n\r\n\t};\r\n\r\n\tthis.clearDepth = function ( depth ) {\r\n\r\n\t\tthis.buffers.depth.setClear( depth );\r\n\r\n\t};\r\n\r\n\tthis.clearStencil = function ( stencil ) {\r\n\r\n\t\tthis.buffers.stencil.setClear( stencil );\r\n\r\n\t};\r\n\r\n\t//\r\n\r\n\tthis.scissor = function ( scissor ) {\r\n\r\n\t\tif ( currentScissor.equals( scissor ) === false ) {\r\n\r\n\t\t\tgl.scissor( scissor.x, scissor.y, scissor.z, scissor.w );\r\n\t\t\tcurrentScissor.copy( scissor );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.viewport = function ( viewport ) {\r\n\r\n\t\tif ( currentViewport.equals( viewport ) === false ) {\r\n\r\n\t\t\tgl.viewport( viewport.x, viewport.y, viewport.z, viewport.w );\r\n\t\t\tcurrentViewport.copy( viewport );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\t//\r\n\r\n\tthis.reset = function () {\r\n\r\n\t\tfor ( var i = 0; i < enabledAttributes.length; i ++ ) {\r\n\r\n\t\t\tif ( enabledAttributes[ i ] === 1 ) {\r\n\r\n\t\t\t\tgl.disableVertexAttribArray( i );\r\n\t\t\t\tenabledAttributes[ i ] = 0;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tcapabilities = {};\r\n\r\n\t\tcompressedTextureFormats = null;\r\n\r\n\t\tcurrentTextureSlot = null;\r\n\t\tcurrentBoundTextures = {};\r\n\r\n\t\tcurrentBlending = null;\r\n\r\n\t\tcurrentFlipSided = null;\r\n\t\tcurrentCullFace = null;\r\n\r\n\t\tthis.buffers.color.reset();\r\n\t\tthis.buffers.depth.reset();\r\n\t\tthis.buffers.stencil.reset();\r\n\r\n\t};\r\n\r\n};\r\n\r\nTHREE.WebGLColorBuffer = function ( gl, state ) {\r\n\r\n\tvar locked = false;\r\n\r\n\tvar color = new THREE.Vector4();\r\n\tvar currentColorMask = null;\r\n\tvar currentColorClear = new THREE.Vector4();\r\n\r\n\tthis.setMask = function ( colorMask ) {\r\n\r\n\t\tif ( currentColorMask !== colorMask && ! locked ) {\r\n\r\n\t\t\tgl.colorMask( colorMask, colorMask, colorMask, colorMask );\r\n\t\t\tcurrentColorMask = colorMask;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.setLocked = function ( lock ) {\r\n\r\n\t\tlocked = lock;\r\n\r\n\t};\r\n\r\n\tthis.setClear = function ( r, g, b, a ) {\r\n\r\n\t\tcolor.set( r, g, b, a );\r\n\r\n\t\tif ( currentColorClear.equals( color ) === false ) {\r\n\r\n\t\t\tgl.clearColor( r, g, b, a );\r\n\t\t\tcurrentColorClear.copy( color );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.reset = function () {\r\n\r\n\t\tlocked = false;\r\n\r\n\t\tcurrentColorMask = null;\r\n\t\tcurrentColorClear = new THREE.Vector4();\r\n\r\n\t};\r\n\r\n};\r\n\r\nTHREE.WebGLDepthBuffer = function( gl, state ) {\r\n\r\n\tvar locked = false;\r\n\r\n\tvar currentDepthMask = null;\r\n\tvar currentDepthFunc = null;\r\n\tvar currentDepthClear = null;\r\n\r\n\tthis.setTest = function ( depthTest ) {\r\n\r\n\t\tif ( depthTest ) {\r\n\r\n\t\t\tstate.enable( gl.DEPTH_TEST );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tstate.disable( gl.DEPTH_TEST );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.setMask = function( depthMask ){\r\n\r\n\t\tif ( currentDepthMask !== depthMask && ! locked ) {\r\n\r\n\t\t\tgl.depthMask( depthMask );\r\n\t\t\tcurrentDepthMask = depthMask;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.setFunc = function ( depthFunc ) {\r\n\r\n\t\tif ( currentDepthFunc !== depthFunc ) {\r\n\r\n\t\t\tif ( depthFunc ) {\r\n\r\n\t\t\t\tswitch ( depthFunc ) {\r\n\r\n\t\t\t\t\tcase THREE.NeverDepth:\r\n\r\n\t\t\t\t\t\tgl.depthFunc( gl.NEVER );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase THREE.AlwaysDepth:\r\n\r\n\t\t\t\t\t\tgl.depthFunc( gl.ALWAYS );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase THREE.LessDepth:\r\n\r\n\t\t\t\t\t\tgl.depthFunc( gl.LESS );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase THREE.LessEqualDepth:\r\n\r\n\t\t\t\t\t\tgl.depthFunc( gl.LEQUAL );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase THREE.EqualDepth:\r\n\r\n\t\t\t\t\t\tgl.depthFunc( gl.EQUAL );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase THREE.GreaterEqualDepth:\r\n\r\n\t\t\t\t\t\tgl.depthFunc( gl.GEQUAL );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase THREE.GreaterDepth:\r\n\r\n\t\t\t\t\t\tgl.depthFunc( gl.GREATER );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase THREE.NotEqualDepth:\r\n\r\n\t\t\t\t\t\tgl.depthFunc( gl.NOTEQUAL );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tdefault:\r\n\r\n\t\t\t\t\t\tgl.depthFunc( gl.LEQUAL );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tgl.depthFunc( gl.LEQUAL );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tcurrentDepthFunc = depthFunc;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.setLocked = function ( lock ) {\r\n\r\n\t\tlocked = lock;\r\n\r\n\t};\r\n\r\n\tthis.setClear = function ( depth ) {\r\n\r\n\t\tif ( currentDepthClear !== depth ) {\r\n\r\n\t\t\tgl.clearDepth( depth );\r\n\t\t\tcurrentDepthClear = depth;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.reset = function () {\r\n\r\n\t\tlocked = false;\r\n\r\n\t\tcurrentDepthMask = null;\r\n\t\tcurrentDepthFunc = null;\r\n\t\tcurrentDepthClear = null;\r\n\r\n\t};\r\n\r\n};\r\n\r\nTHREE.WebGLStencilBuffer = function ( gl, state ) {\r\n\r\n\tvar locked = false;\r\n\r\n\tvar currentStencilMask = null;\r\n\tvar currentStencilFunc = null;\r\n\tvar currentStencilRef = null;\r\n\tvar currentStencilFuncMask = null;\r\n\tvar currentStencilFail  = null;\r\n\tvar currentStencilZFail = null;\r\n\tvar currentStencilZPass = null;\r\n\tvar currentStencilClear = null;\r\n\r\n\tthis.setTest = function ( stencilTest ) {\r\n\r\n\t\tif ( stencilTest ) {\r\n\r\n\t\t\tstate.enable( gl.STENCIL_TEST );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tstate.disable( gl.STENCIL_TEST );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.setMask = function ( stencilMask ) {\r\n\r\n\t\tif ( currentStencilMask !== stencilMask && ! locked ) {\r\n\r\n\t\t\tgl.stencilMask( stencilMask );\r\n\t\t\tcurrentStencilMask = stencilMask;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.setFunc = function ( stencilFunc, stencilRef, stencilMask ) {\r\n\r\n\t\tif ( currentStencilFunc !== stencilFunc ||\r\n\t\t     currentStencilRef \t!== stencilRef \t||\r\n\t\t     currentStencilFuncMask !== stencilMask ) {\r\n\r\n\t\t\tgl.stencilFunc( stencilFunc,  stencilRef, stencilMask );\r\n\r\n\t\t\tcurrentStencilFunc = stencilFunc;\r\n\t\t\tcurrentStencilRef  = stencilRef;\r\n\t\t\tcurrentStencilFuncMask = stencilMask;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.setOp\t = function ( stencilFail, stencilZFail, stencilZPass ) {\r\n\r\n\t\tif ( currentStencilFail\t !== stencilFail \t||\r\n\t\t     currentStencilZFail !== stencilZFail ||\r\n\t\t     currentStencilZPass !== stencilZPass ) {\r\n\r\n\t\t\tgl.stencilOp( stencilFail,  stencilZFail, stencilZPass );\r\n\r\n\t\t\tcurrentStencilFail  = stencilFail;\r\n\t\t\tcurrentStencilZFail = stencilZFail;\r\n\t\t\tcurrentStencilZPass = stencilZPass;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.setLocked = function ( lock ) {\r\n\r\n\t\tlocked = lock;\r\n\r\n\t};\r\n\r\n\tthis.setClear = function ( stencil ) {\r\n\r\n\t\tif ( currentStencilClear !== stencil ) {\r\n\r\n\t\t\tgl.clearStencil( stencil );\r\n\t\t\tcurrentStencilClear = stencil;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.reset = function () {\r\n\r\n\t\tlocked = false;\r\n\r\n\t\tcurrentStencilMask = null;\r\n\t\tcurrentStencilFunc = null;\r\n\t\tcurrentStencilRef = null;\r\n\t\tcurrentStencilFuncMask = null;\r\n\t\tcurrentStencilFail = null;\r\n\t\tcurrentStencilZFail = null;\r\n\t\tcurrentStencilZPass = null;\r\n\t\tcurrentStencilClear = null;\r\n\r\n\t};\r\n\r\n};\r\n\r\n// File:src/renderers/webgl/WebGLUniforms.js\r\n\r\n/**\r\n *\r\n * Uniforms of a program.\r\n * Those form a tree structure with a special top-level container for the root,\r\n * which you get by calling 'new WebGLUniforms( gl, program, renderer )'.\r\n *\r\n *\r\n * Properties of inner nodes including the top-level container:\r\n *\r\n * .seq - array of nested uniforms\r\n * .map - nested uniforms by name\r\n *\r\n *\r\n * Methods of all nodes except the top-level container:\r\n *\r\n * .setValue( gl, value, [renderer] )\r\n *\r\n * \t\tuploads a uniform value(s)\r\n *  \tthe 'renderer' parameter is needed for sampler uniforms\r\n *\r\n *\r\n * Static methods of the top-level container (renderer factorizations):\r\n *\r\n * .upload( gl, seq, values, renderer )\r\n *\r\n * \t\tsets uniforms in 'seq' to 'values[id].value'\r\n *\r\n * .seqWithValue( seq, values ) : filteredSeq\r\n *\r\n * \t\tfilters 'seq' entries with corresponding entry in values\r\n *\r\n * .splitDynamic( seq, values ) : filteredSeq\r\n *\r\n * \t\tfilters 'seq' entries with dynamic entry and removes them from 'seq'\r\n *\r\n *\r\n * Methods of the top-level container (renderer factorizations):\r\n *\r\n * .setValue( gl, name, value )\r\n *\r\n * \t\tsets uniform with  name 'name' to 'value'\r\n *\r\n * .set( gl, obj, prop )\r\n *\r\n * \t\tsets uniform from object and property with same name than uniform\r\n *\r\n * .setOptional( gl, obj, prop )\r\n *\r\n * \t\tlike .set for an optional property of the object\r\n *\r\n *\r\n * @author tschw\r\n *\r\n */\r\n\r\nTHREE.WebGLUniforms = ( function() { // scope\r\n\r\n\t// --- Base for inner nodes (including the root) ---\r\n\r\n\tvar UniformContainer = function() {\r\n\r\n\t\t\tthis.seq = [];\r\n\t\t\tthis.map = {};\r\n\r\n\t\t},\r\n\r\n\t// --- Utilities ---\r\n\r\n\t// Array Caches (provide typed arrays for temporary by size)\r\n\r\n\t\tarrayCacheF32 = [],\r\n\t\tarrayCacheI32 = [],\r\n\r\n\t\tuncacheTemporaryArrays = function() {\r\n\r\n\t\t\tarrayCacheF32.length = 0;\r\n\t\t\tarrayCacheI32.length = 0;\r\n\r\n\t\t},\r\n\r\n\t// Flattening for arrays of vectors and matrices\r\n\r\n\t\tflatten = function( array, nBlocks, blockSize ) {\r\n\r\n\t\t\tvar firstElem = array[ 0 ];\r\n\r\n\t\t\tif ( firstElem <= 0 || firstElem > 0 ) return array;\r\n\t\t\t// unoptimized: ! isNaN( firstElem )\r\n\t\t\t// see http://jacksondunstan.com/articles/983\r\n\r\n\t\t\tvar n = nBlocks * blockSize,\r\n\t\t\t\tr = arrayCacheF32[ n ];\r\n\r\n\t\t\tif ( r === undefined ) {\r\n\r\n\t\t\t\tr = new Float32Array( n );\r\n\t\t\t\tarrayCacheF32[ n ] = r;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( nBlocks !== 0 ) {\r\n\r\n\t\t\t\tfirstElem.toArray( r, 0 );\r\n\r\n\t\t\t\tfor ( var i = 1, offset = 0; i !== nBlocks; ++ i ) {\r\n\r\n\t\t\t\t\toffset += blockSize;\r\n\t\t\t\t\tarray[ i ].toArray( r, offset );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn r;\r\n\r\n\t\t},\r\n\r\n\t// Texture unit allocation\r\n\r\n\t\tallocTexUnits = function( renderer, n ) {\r\n\r\n\t\t\tvar r = arrayCacheI32[ n ];\r\n\r\n\t\t\tif ( r === undefined ) {\r\n\r\n\t\t\t\tr = new Int32Array( n );\r\n\t\t\t\tarrayCacheI32[ n ] = r;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var i = 0; i !== n; ++ i )\r\n\t\t\t\tr[ i ] = renderer.allocTextureUnit();\r\n\r\n\t\t\treturn r;\r\n\r\n\t\t},\r\n\r\n\t// --- Setters ---\r\n\r\n\t// Note: Defining these methods externally, because they come in a bunch\r\n\t// and this way their names minify.\r\n\r\n\t\t// Single scalar\r\n\r\n\t\tsetValue1f = function( gl, v ) { gl.uniform1f( this.addr, v ); },\r\n\t\tsetValue1i = function( gl, v ) { gl.uniform1i( this.addr, v ); },\r\n\r\n\t\t// Single float vector (from flat array or THREE.VectorN)\r\n\r\n\t\tsetValue2fv = function( gl, v ) {\r\n\r\n\t\t\tif ( v.x === undefined ) gl.uniform2fv( this.addr, v );\r\n\t\t\telse gl.uniform2f( this.addr, v.x, v.y );\r\n\r\n\t\t},\r\n\r\n\t\tsetValue3fv = function( gl, v ) {\r\n\r\n\t\t\tif ( v.x !== undefined )\r\n\t\t\t\tgl.uniform3f( this.addr, v.x, v.y, v.z );\r\n\t\t\telse if ( v.r !== undefined )\r\n\t\t\t\tgl.uniform3f( this.addr, v.r, v.g, v.b );\r\n\t\t\telse\r\n\t\t\t\tgl.uniform3fv( this.addr, v );\r\n\r\n\t\t},\r\n\r\n\t\tsetValue4fv = function( gl, v ) {\r\n\r\n\t\t\tif ( v.x === undefined ) gl.uniform4fv( this.addr, v );\r\n\t\t\telse gl.uniform4f( this.addr, v.x, v.y, v.z, v.w );\r\n\r\n\t\t},\r\n\r\n\t\t// Single matrix (from flat array or MatrixN)\r\n\r\n\t\tsetValue2fm = function( gl, v ) {\r\n\r\n\t\t\tgl.uniformMatrix2fv( this.addr, false, v.elements || v );\r\n\r\n\t\t},\r\n\r\n\t\tsetValue3fm = function( gl, v ) {\r\n\r\n\t\t\tgl.uniformMatrix3fv( this.addr, false, v.elements || v );\r\n\r\n\t\t},\r\n\r\n\t\tsetValue4fm = function( gl, v ) {\r\n\r\n\t\t\tgl.uniformMatrix4fv( this.addr, false, v.elements || v );\r\n\r\n\t\t},\r\n\r\n\t\t// Single texture (2D / Cube)\r\n\r\n\t\tsetValueT1 = function( gl, v, renderer ) {\r\n\r\n\t\t\tvar unit = renderer.allocTextureUnit();\r\n\t\t\tgl.uniform1i( this.addr, unit );\r\n\t\t\tif ( v ) renderer.setTexture2D( v, unit );\r\n\r\n\t\t},\r\n\r\n\t\tsetValueT6 = function( gl, v, renderer ) {\r\n\r\n\t\t\tvar unit = renderer.allocTextureUnit();\r\n\t\t\tgl.uniform1i( this.addr, unit );\r\n\t\t\tif ( v ) renderer.setTextureCube( v, unit );\r\n\r\n\t\t},\r\n\r\n\t\t// Integer / Boolean vectors or arrays thereof (always flat arrays)\r\n\r\n\t\tsetValue2iv = function( gl, v ) { gl.uniform2iv( this.addr, v ); },\r\n\t\tsetValue3iv = function( gl, v ) { gl.uniform3iv( this.addr, v ); },\r\n\t\tsetValue4iv = function( gl, v ) { gl.uniform4iv( this.addr, v ); },\r\n\r\n\t\t// Helper to pick the right setter for the singular case\r\n\r\n\t\tgetSingularSetter = function( type ) {\r\n\r\n\t\t\tswitch ( type ) {\r\n\r\n\t\t\t\tcase 0x1406: return setValue1f; // FLOAT\r\n\t\t\t\tcase 0x8b50: return setValue2fv; // _VEC2\r\n\t\t\t\tcase 0x8b51: return setValue3fv; // _VEC3\r\n\t\t\t\tcase 0x8b52: return setValue4fv; // _VEC4\r\n\r\n\t\t\t\tcase 0x8b5a: return setValue2fm; // _MAT2\r\n\t\t\t\tcase 0x8b5b: return setValue3fm; // _MAT3\r\n\t\t\t\tcase 0x8b5c: return setValue4fm; // _MAT4\r\n\r\n\t\t\t\tcase 0x8b5e: return setValueT1; // SAMPLER_2D\r\n\t\t\t\tcase 0x8b60: return setValueT6; // SAMPLER_CUBE\r\n\r\n\t\t\t\tcase 0x1404: case 0x8b56: return setValue1i; // INT, BOOL\r\n\t\t\t\tcase 0x8b53: case 0x8b57: return setValue2iv; // _VEC2\r\n\t\t\t\tcase 0x8b54: case 0x8b58: return setValue3iv; // _VEC3\r\n\t\t\t\tcase 0x8b55: case 0x8b59: return setValue4iv; // _VEC4\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\t// Array of scalars\r\n\r\n\t\tsetValue1fv = function( gl, v ) { gl.uniform1fv( this.addr, v ); },\r\n\t\tsetValue1iv = function( gl, v ) { gl.uniform1iv( this.addr, v ); },\r\n\r\n\t\t// Array of vectors (flat or from THREE classes)\r\n\r\n\t\tsetValueV2a = function( gl, v ) {\r\n\r\n\t\t\tgl.uniform2fv( this.addr, flatten( v, this.size, 2 ) );\r\n\r\n\t\t},\r\n\r\n\t\tsetValueV3a = function( gl, v ) {\r\n\r\n\t\t\tgl.uniform3fv( this.addr, flatten( v, this.size, 3 ) );\r\n\r\n\t\t},\r\n\r\n\t\tsetValueV4a = function( gl, v ) {\r\n\r\n\t\t\tgl.uniform4fv( this.addr, flatten( v, this.size, 4 ) );\r\n\r\n\t\t},\r\n\r\n\t\t// Array of matrices (flat or from THREE clases)\r\n\r\n\t\tsetValueM2a = function( gl, v ) {\r\n\r\n\t\t\tgl.uniformMatrix2fv( this.addr, false, flatten( v, this.size, 4 ) );\r\n\r\n\t\t},\r\n\r\n\t\tsetValueM3a = function( gl, v ) {\r\n\r\n\t\t\tgl.uniformMatrix3fv( this.addr, false, flatten( v, this.size, 9 ) );\r\n\r\n\t\t},\r\n\r\n\t\tsetValueM4a = function( gl, v ) {\r\n\r\n\t\t\tgl.uniformMatrix4fv( this.addr, false, flatten( v, this.size, 16 ) );\r\n\r\n\t\t},\r\n\r\n\t\t// Array of textures (2D / Cube)\r\n\r\n\t\tsetValueT1a = function( gl, v, renderer ) {\r\n\r\n\t\t\tvar n = v.length,\r\n\t\t\t\tunits = allocTexUnits( renderer, n );\r\n\r\n\t\t\tgl.uniform1iv( this.addr, units );\r\n\r\n\t\t\tfor ( var i = 0; i !== n; ++ i ) {\r\n\r\n\t\t\t\tvar tex = v[ i ];\r\n\t\t\t\tif ( tex ) renderer.setTexture2D( tex, units[ i ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tsetValueT6a = function( gl, v, renderer ) {\r\n\r\n\t\t\tvar n = v.length,\r\n\t\t\t\tunits = allocTexUnits( renderer, n );\r\n\r\n\t\t\tgl.uniform1iv( this.addr, units );\r\n\r\n\t\t\tfor ( var i = 0; i !== n; ++ i ) {\r\n\r\n\t\t\t\tvar tex = v[ i ];\r\n\t\t\t\tif ( tex ) renderer.setTextureCube( tex, units[ i ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\r\n\t\t// Helper to pick the right setter for a pure (bottom-level) array\r\n\r\n\t\tgetPureArraySetter = function( type ) {\r\n\r\n\t\t\tswitch ( type ) {\r\n\r\n\t\t\t\tcase 0x1406: return setValue1fv; // FLOAT\r\n\t\t\t\tcase 0x8b50: return setValueV2a; // _VEC2\r\n\t\t\t\tcase 0x8b51: return setValueV3a; // _VEC3\r\n\t\t\t\tcase 0x8b52: return setValueV4a; // _VEC4\r\n\r\n\t\t\t\tcase 0x8b5a: return setValueM2a; // _MAT2\r\n\t\t\t\tcase 0x8b5b: return setValueM3a; // _MAT3\r\n\t\t\t\tcase 0x8b5c: return setValueM4a; // _MAT4\r\n\r\n\t\t\t\tcase 0x8b5e: return setValueT1a; // SAMPLER_2D\r\n\t\t\t\tcase 0x8b60: return setValueT6a; // SAMPLER_CUBE\r\n\r\n\t\t\t\tcase 0x1404: case 0x8b56: return setValue1iv; // INT, BOOL\r\n\t\t\t\tcase 0x8b53: case 0x8b57: return setValue2iv; // _VEC2\r\n\t\t\t\tcase 0x8b54: case 0x8b58: return setValue3iv; // _VEC3\r\n\t\t\t\tcase 0x8b55: case 0x8b59: return setValue4iv; // _VEC4\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t// --- Uniform Classes ---\r\n\r\n\t\tSingleUniform = function SingleUniform( id, activeInfo, addr ) {\r\n\r\n\t\t\tthis.id = id;\r\n\t\t\tthis.addr = addr;\r\n\t\t\tthis.setValue = getSingularSetter( activeInfo.type );\r\n\r\n\t\t\t// this.path = activeInfo.name; // DEBUG\r\n\r\n\t\t},\r\n\r\n\t\tPureArrayUniform = function( id, activeInfo, addr ) {\r\n\r\n\t\t\tthis.id = id;\r\n\t\t\tthis.addr = addr;\r\n\t\t\tthis.size = activeInfo.size;\r\n\t\t\tthis.setValue = getPureArraySetter( activeInfo.type );\r\n\r\n\t\t\t// this.path = activeInfo.name; // DEBUG\r\n\r\n\t\t},\r\n\r\n\t\tStructuredUniform = function( id ) {\r\n\r\n\t\t\tthis.id = id;\r\n\r\n\t\t\tUniformContainer.call( this ); // mix-in\r\n\r\n\t\t};\r\n\r\n\tStructuredUniform.prototype.setValue = function( gl, value ) {\r\n\r\n\t\t// Note: Don't need an extra 'renderer' parameter, since samplers\r\n\t\t// are not allowed in structured uniforms.\r\n\r\n\t\tvar seq = this.seq;\r\n\r\n\t\tfor ( var i = 0, n = seq.length; i !== n; ++ i ) {\r\n\r\n\t\t\tvar u = seq[ i ];\r\n\t\t\tu.setValue( gl, value[ u.id ] );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\t// --- Top-level ---\r\n\r\n\t// Parser - builds up the property tree from the path strings\r\n\r\n\tvar RePathPart = /([\\w\\d_]+)(\\])?(\\[|\\.)?/g,\r\n\t\t// extracts\r\n\t\t// \t- the identifier (member name or array index)\r\n\t\t//  - followed by an optional right bracket (found when array index)\r\n\t\t//  - followed by an optional left bracket or dot (type of subscript)\r\n\t\t//\r\n\t\t// Note: These portions can be read in a non-overlapping fashion and\r\n\t\t// allow straightforward parsing of the hierarchy that WebGL encodes\r\n\t\t// in the uniform names.\r\n\r\n\t\taddUniform = function( container, uniformObject ) {\r\n\r\n\t\t\tcontainer.seq.push( uniformObject );\r\n\t\t\tcontainer.map[ uniformObject.id ] = uniformObject;\r\n\r\n\t\t},\r\n\r\n\t\tparseUniform = function( activeInfo, addr, container ) {\r\n\r\n\t\t\tvar path = activeInfo.name,\r\n\t\t\t\tpathLength = path.length;\r\n\r\n\t\t\t// reset RegExp object, because of the early exit of a previous run\r\n\t\t\tRePathPart.lastIndex = 0;\r\n\r\n\t\t\tfor (; ;) {\r\n\r\n\t\t\t\tvar match = RePathPart.exec( path ),\r\n\t\t\t\t\tmatchEnd = RePathPart.lastIndex,\r\n\r\n\t\t\t\t\tid = match[ 1 ],\r\n\t\t\t\t\tidIsIndex = match[ 2 ] === ']',\r\n\t\t\t\t\tsubscript = match[ 3 ];\r\n\r\n\t\t\t\tif ( idIsIndex ) id = id | 0; // convert to integer\r\n\r\n\t\t\t\tif ( subscript === undefined ||\r\n\t\t\t\t\t\tsubscript === '[' && matchEnd + 2 === pathLength ) {\r\n\t\t\t\t\t// bare name or \"pure\" bottom-level array \"[0]\" suffix\r\n\r\n\t\t\t\t\taddUniform( container, subscript === undefined ?\r\n\t\t\t\t\t\t\tnew SingleUniform( id, activeInfo, addr ) :\r\n\t\t\t\t\t\t\tnew PureArrayUniform( id, activeInfo, addr ) );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// step into inner node / create it in case it doesn't exist\r\n\r\n\t\t\t\t\tvar map = container.map,\r\n\t\t\t\t\t\tnext = map[ id ];\r\n\r\n\t\t\t\t\tif ( next === undefined ) {\r\n\r\n\t\t\t\t\t\tnext = new StructuredUniform( id );\r\n\t\t\t\t\t\taddUniform( container, next );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tcontainer = next;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t// Root Container\r\n\r\n\t\tWebGLUniforms = function WebGLUniforms( gl, program, renderer ) {\r\n\r\n\t\t\tUniformContainer.call( this );\r\n\r\n\t\t\tthis.renderer = renderer;\r\n\r\n\t\t\tvar n = gl.getProgramParameter( program, gl.ACTIVE_UNIFORMS );\r\n\r\n\t\t\tfor ( var i = 0; i !== n; ++ i ) {\r\n\r\n\t\t\t\tvar info = gl.getActiveUniform( program, i ),\r\n\t\t\t\t\tpath = info.name,\r\n\t\t\t\t\taddr = gl.getUniformLocation( program, path );\r\n\r\n\t\t\t\tparseUniform( info, addr, this );\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\r\n\tWebGLUniforms.prototype.setValue = function( gl, name, value ) {\r\n\r\n\t\tvar u = this.map[ name ];\r\n\r\n\t\tif ( u !== undefined ) u.setValue( gl, value, this.renderer );\r\n\r\n\t};\r\n\r\n\tWebGLUniforms.prototype.set = function( gl, object, name ) {\r\n\r\n\t\tvar u = this.map[ name ];\r\n\r\n\t\tif ( u !== undefined ) u.setValue( gl, object[ name ], this.renderer );\r\n\r\n\t};\r\n\r\n\tWebGLUniforms.prototype.setOptional = function( gl, object, name ) {\r\n\r\n\t\tvar v = object[ name ];\r\n\r\n\t\tif ( v !== undefined ) this.setValue( gl, name, v );\r\n\r\n\t};\r\n\r\n\r\n\t// Static interface\r\n\r\n\tWebGLUniforms.upload = function( gl, seq, values, renderer ) {\r\n\r\n\t\tfor ( var i = 0, n = seq.length; i !== n; ++ i ) {\r\n\r\n\t\t\tvar u = seq[ i ],\r\n\t\t\t\tv = values[ u.id ];\r\n\r\n\t\t\tif ( v.needsUpdate !== false ) {\r\n\t\t\t\t// note: always updating when .needsUpdate is undefined\r\n\r\n\t\t\t\tu.setValue( gl, v.value, renderer );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tWebGLUniforms.seqWithValue = function( seq, values ) {\r\n\r\n\t\tvar r = [];\r\n\r\n\t\tfor ( var i = 0, n = seq.length; i !== n; ++ i ) {\r\n\r\n\t\t\tvar u = seq[ i ];\r\n\t\t\tif ( u.id in values ) r.push( u );\r\n\r\n\t\t}\r\n\r\n\t\treturn r;\r\n\r\n\t};\r\n\r\n\tWebGLUniforms.splitDynamic = function( seq, values ) {\r\n\r\n\t\tvar r = null,\r\n\t\t\tn = seq.length,\r\n\t\t\tw = 0;\r\n\r\n\t\tfor ( var i = 0; i !== n; ++ i ) {\r\n\r\n\t\t\tvar u = seq[ i ],\r\n\t\t\t\tv = values[ u.id ];\r\n\r\n\t\t\tif ( v && v.dynamic === true ) {\r\n\r\n\t\t\t\tif ( r === null ) r = [];\r\n\t\t\t\tr.push( u );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// in-place compact 'seq', removing the matches\r\n\t\t\t\tif ( w < i ) seq[ w ] = u;\r\n\t\t\t\t++ w;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( w < n ) seq.length = w;\r\n\r\n\t\treturn r;\r\n\r\n\t};\r\n\r\n\tWebGLUniforms.evalDynamic = function( seq, values, object, camera ) {\r\n\r\n\t\tfor ( var i = 0, n = seq.length; i !== n; ++ i ) {\r\n\r\n\t\t\tvar v = values[ seq[ i ].id ],\r\n\t\t\t\tf = v.onUpdateCallback;\r\n\r\n\t\t\tif ( f !== undefined ) f.call( v, object, camera );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\treturn WebGLUniforms;\r\n\r\n} )();\r\n\r\n\r\n// File:src/renderers/webgl/plugins/LensFlarePlugin.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.LensFlarePlugin = function ( renderer, flares ) {\r\n\r\n\tvar gl = renderer.context;\r\n\tvar state = renderer.state;\r\n\r\n\tvar vertexBuffer, elementBuffer;\r\n\tvar shader, program, attributes, uniforms;\r\n\r\n\tvar tempTexture, occlusionTexture;\r\n\r\n\tfunction init() {\r\n\r\n\t\tvar vertices = new Float32Array( [\r\n\t\t\t- 1, - 1,  0, 0,\r\n\t\t\t 1, - 1,  1, 0,\r\n\t\t\t 1,  1,  1, 1,\r\n\t\t\t- 1,  1,  0, 1\r\n\t\t] );\r\n\r\n\t\tvar faces = new Uint16Array( [\r\n\t\t\t0, 1, 2,\r\n\t\t\t0, 2, 3\r\n\t\t] );\r\n\r\n\t\t// buffers\r\n\r\n\t\tvertexBuffer     = gl.createBuffer();\r\n\t\telementBuffer    = gl.createBuffer();\r\n\r\n\t\tgl.bindBuffer( gl.ARRAY_BUFFER, vertexBuffer );\r\n\t\tgl.bufferData( gl.ARRAY_BUFFER, vertices, gl.STATIC_DRAW );\r\n\r\n\t\tgl.bindBuffer( gl.ELEMENT_ARRAY_BUFFER, elementBuffer );\r\n\t\tgl.bufferData( gl.ELEMENT_ARRAY_BUFFER, faces, gl.STATIC_DRAW );\r\n\r\n\t\t// textures\r\n\r\n\t\ttempTexture      = gl.createTexture();\r\n\t\tocclusionTexture = gl.createTexture();\r\n\r\n\t\tstate.bindTexture( gl.TEXTURE_2D, tempTexture );\r\n\t\tgl.texImage2D( gl.TEXTURE_2D, 0, gl.RGB, 16, 16, 0, gl.RGB, gl.UNSIGNED_BYTE, null );\r\n\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE );\r\n\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE );\r\n\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST );\r\n\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST );\r\n\r\n\t\tstate.bindTexture( gl.TEXTURE_2D, occlusionTexture );\r\n\t\tgl.texImage2D( gl.TEXTURE_2D, 0, gl.RGBA, 16, 16, 0, gl.RGBA, gl.UNSIGNED_BYTE, null );\r\n\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE );\r\n\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE );\r\n\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST );\r\n\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST );\r\n\r\n\t\tshader = {\r\n\r\n\t\t\tvertexShader: [\r\n\r\n\t\t\t\t\"uniform lowp int renderType;\",\r\n\r\n\t\t\t\t\"uniform vec3 screenPosition;\",\r\n\t\t\t\t\"uniform vec2 scale;\",\r\n\t\t\t\t\"uniform float rotation;\",\r\n\r\n\t\t\t\t\"uniform sampler2D occlusionMap;\",\r\n\r\n\t\t\t\t\"attribute vec2 position;\",\r\n\t\t\t\t\"attribute vec2 uv;\",\r\n\r\n\t\t\t\t\"varying vec2 vUV;\",\r\n\t\t\t\t\"varying float vVisibility;\",\r\n\r\n\t\t\t\t\"void main() {\",\r\n\r\n\t\t\t\t\t\"vUV = uv;\",\r\n\r\n\t\t\t\t\t\"vec2 pos = position;\",\r\n\r\n\t\t\t\t\t\"if ( renderType == 2 ) {\",\r\n\r\n\t\t\t\t\t\t\"vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );\",\r\n\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );\",\r\n\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );\",\r\n\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );\",\r\n\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );\",\r\n\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );\",\r\n\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );\",\r\n\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );\",\r\n\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );\",\r\n\r\n\t\t\t\t\t\t\"vVisibility =        visibility.r / 9.0;\",\r\n\t\t\t\t\t\t\"vVisibility *= 1.0 - visibility.g / 9.0;\",\r\n\t\t\t\t\t\t\"vVisibility *=       visibility.b / 9.0;\",\r\n\t\t\t\t\t\t\"vVisibility *= 1.0 - visibility.a / 9.0;\",\r\n\r\n\t\t\t\t\t\t\"pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\",\r\n\t\t\t\t\t\t\"pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\",\r\n\r\n\t\t\t\t\t\"}\",\r\n\r\n\t\t\t\t\t\"gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\",\r\n\r\n\t\t\t\t\"}\"\r\n\r\n\t\t\t].join( \"\\n\" ),\r\n\r\n\t\t\tfragmentShader: [\r\n\r\n\t\t\t\t\"uniform lowp int renderType;\",\r\n\r\n\t\t\t\t\"uniform sampler2D map;\",\r\n\t\t\t\t\"uniform float opacity;\",\r\n\t\t\t\t\"uniform vec3 color;\",\r\n\r\n\t\t\t\t\"varying vec2 vUV;\",\r\n\t\t\t\t\"varying float vVisibility;\",\r\n\r\n\t\t\t\t\"void main() {\",\r\n\r\n\t\t\t\t\t// pink square\r\n\r\n\t\t\t\t\t\"if ( renderType == 0 ) {\",\r\n\r\n\t\t\t\t\t\t\"gl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );\",\r\n\r\n\t\t\t\t\t// restore\r\n\r\n\t\t\t\t\t\"} else if ( renderType == 1 ) {\",\r\n\r\n\t\t\t\t\t\t\"gl_FragColor = texture2D( map, vUV );\",\r\n\r\n\t\t\t\t\t// flare\r\n\r\n\t\t\t\t\t\"} else {\",\r\n\r\n\t\t\t\t\t\t\"vec4 texture = texture2D( map, vUV );\",\r\n\t\t\t\t\t\t\"texture.a *= opacity * vVisibility;\",\r\n\t\t\t\t\t\t\"gl_FragColor = texture;\",\r\n\t\t\t\t\t\t\"gl_FragColor.rgb *= color;\",\r\n\r\n\t\t\t\t\t\"}\",\r\n\r\n\t\t\t\t\"}\"\r\n\r\n\t\t\t].join( \"\\n\" )\r\n\r\n\t\t};\r\n\r\n\t\tprogram = createProgram( shader );\r\n\r\n\t\tattributes = {\r\n\t\t\tvertex: gl.getAttribLocation ( program, \"position\" ),\r\n\t\t\tuv:     gl.getAttribLocation ( program, \"uv\" )\r\n\t\t};\r\n\r\n\t\tuniforms = {\r\n\t\t\trenderType:     gl.getUniformLocation( program, \"renderType\" ),\r\n\t\t\tmap:            gl.getUniformLocation( program, \"map\" ),\r\n\t\t\tocclusionMap:   gl.getUniformLocation( program, \"occlusionMap\" ),\r\n\t\t\topacity:        gl.getUniformLocation( program, \"opacity\" ),\r\n\t\t\tcolor:          gl.getUniformLocation( program, \"color\" ),\r\n\t\t\tscale:          gl.getUniformLocation( program, \"scale\" ),\r\n\t\t\trotation:       gl.getUniformLocation( program, \"rotation\" ),\r\n\t\t\tscreenPosition: gl.getUniformLocation( program, \"screenPosition\" )\r\n\t\t};\r\n\r\n\t}\r\n\r\n\t/*\r\n\t * Render lens flares\r\n\t * Method: renders 16x16 0xff00ff-colored points scattered over the light source area,\r\n\t *         reads these back and calculates occlusion.\r\n\t */\r\n\r\n\tthis.render = function ( scene, camera, viewport ) {\r\n\r\n\t\tif ( flares.length === 0 ) return;\r\n\r\n\t\tvar tempPosition = new THREE.Vector3();\r\n\r\n\t\tvar invAspect = viewport.w / viewport.z,\r\n\t\t\thalfViewportWidth = viewport.z * 0.5,\r\n\t\t\thalfViewportHeight = viewport.w * 0.5;\r\n\r\n\t\tvar size = 16 / viewport.w,\r\n\t\t\tscale = new THREE.Vector2( size * invAspect, size );\r\n\r\n\t\tvar screenPosition = new THREE.Vector3( 1, 1, 0 ),\r\n\t\t\tscreenPositionPixels = new THREE.Vector2( 1, 1 );\r\n\r\n\t\tvar validArea = new THREE.Box2();\r\n\r\n\t\tvalidArea.min.set( 0, 0 );\r\n\t\tvalidArea.max.set( viewport.z - 16, viewport.w - 16 );\r\n\r\n\t\tif ( program === undefined ) {\r\n\r\n\t\t\tinit();\r\n\r\n\t\t}\r\n\r\n\t\tgl.useProgram( program );\r\n\r\n\t\tstate.initAttributes();\r\n\t\tstate.enableAttribute( attributes.vertex );\r\n\t\tstate.enableAttribute( attributes.uv );\r\n\t\tstate.disableUnusedAttributes();\r\n\r\n\t\t// loop through all lens flares to update their occlusion and positions\r\n\t\t// setup gl and common used attribs/uniforms\r\n\r\n\t\tgl.uniform1i( uniforms.occlusionMap, 0 );\r\n\t\tgl.uniform1i( uniforms.map, 1 );\r\n\r\n\t\tgl.bindBuffer( gl.ARRAY_BUFFER, vertexBuffer );\r\n\t\tgl.vertexAttribPointer( attributes.vertex, 2, gl.FLOAT, false, 2 * 8, 0 );\r\n\t\tgl.vertexAttribPointer( attributes.uv, 2, gl.FLOAT, false, 2 * 8, 8 );\r\n\r\n\t\tgl.bindBuffer( gl.ELEMENT_ARRAY_BUFFER, elementBuffer );\r\n\r\n\t\tstate.disable( gl.CULL_FACE );\r\n\t\tstate.setDepthWrite( false );\r\n\r\n\t\tfor ( var i = 0, l = flares.length; i < l; i ++ ) {\r\n\r\n\t\t\tsize = 16 / viewport.w;\r\n\t\t\tscale.set( size * invAspect, size );\r\n\r\n\t\t\t// calc object screen position\r\n\r\n\t\t\tvar flare = flares[ i ];\r\n\r\n\t\t\ttempPosition.set( flare.matrixWorld.elements[ 12 ], flare.matrixWorld.elements[ 13 ], flare.matrixWorld.elements[ 14 ] );\r\n\r\n\t\t\ttempPosition.applyMatrix4( camera.matrixWorldInverse );\r\n\t\t\ttempPosition.applyProjection( camera.projectionMatrix );\r\n\r\n\t\t\t// setup arrays for gl programs\r\n\r\n\t\t\tscreenPosition.copy( tempPosition );\r\n\r\n\t\t\t// horizontal and vertical coordinate of the lower left corner of the pixels to copy\r\n\r\n\t\t\tscreenPositionPixels.x = viewport.x + ( screenPosition.x * halfViewportWidth ) + halfViewportWidth - 8;\r\n\t\t\tscreenPositionPixels.y = viewport.y + ( screenPosition.y * halfViewportHeight ) + halfViewportHeight - 8;\r\n\r\n\t\t\t// screen cull\r\n\r\n\t\t\tif ( validArea.containsPoint( screenPositionPixels ) === true ) {\r\n\r\n\t\t\t\t// save current RGB to temp texture\r\n\r\n\t\t\t\tstate.activeTexture( gl.TEXTURE0 );\r\n\t\t\t\tstate.bindTexture( gl.TEXTURE_2D, null );\r\n\t\t\t\tstate.activeTexture( gl.TEXTURE1 );\r\n\t\t\t\tstate.bindTexture( gl.TEXTURE_2D, tempTexture );\r\n\t\t\t\tgl.copyTexImage2D( gl.TEXTURE_2D, 0, gl.RGB, screenPositionPixels.x, screenPositionPixels.y, 16, 16, 0 );\r\n\r\n\r\n\t\t\t\t// render pink quad\r\n\r\n\t\t\t\tgl.uniform1i( uniforms.renderType, 0 );\r\n\t\t\t\tgl.uniform2f( uniforms.scale, scale.x, scale.y );\r\n\t\t\t\tgl.uniform3f( uniforms.screenPosition, screenPosition.x, screenPosition.y, screenPosition.z );\r\n\r\n\t\t\t\tstate.disable( gl.BLEND );\r\n\t\t\t\tstate.enable( gl.DEPTH_TEST );\r\n\r\n\t\t\t\tgl.drawElements( gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0 );\r\n\r\n\r\n\t\t\t\t// copy result to occlusionMap\r\n\r\n\t\t\t\tstate.activeTexture( gl.TEXTURE0 );\r\n\t\t\t\tstate.bindTexture( gl.TEXTURE_2D, occlusionTexture );\r\n\t\t\t\tgl.copyTexImage2D( gl.TEXTURE_2D, 0, gl.RGBA, screenPositionPixels.x, screenPositionPixels.y, 16, 16, 0 );\r\n\r\n\r\n\t\t\t\t// restore graphics\r\n\r\n\t\t\t\tgl.uniform1i( uniforms.renderType, 1 );\r\n\t\t\t\tstate.disable( gl.DEPTH_TEST );\r\n\r\n\t\t\t\tstate.activeTexture( gl.TEXTURE1 );\r\n\t\t\t\tstate.bindTexture( gl.TEXTURE_2D, tempTexture );\r\n\t\t\t\tgl.drawElements( gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0 );\r\n\r\n\r\n\t\t\t\t// update object positions\r\n\r\n\t\t\t\tflare.positionScreen.copy( screenPosition );\r\n\r\n\t\t\t\tif ( flare.customUpdateCallback ) {\r\n\r\n\t\t\t\t\tflare.customUpdateCallback( flare );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tflare.updateLensFlares();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// render flares\r\n\r\n\t\t\t\tgl.uniform1i( uniforms.renderType, 2 );\r\n\t\t\t\tstate.enable( gl.BLEND );\r\n\r\n\t\t\t\tfor ( var j = 0, jl = flare.lensFlares.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\t\tvar sprite = flare.lensFlares[ j ];\r\n\r\n\t\t\t\t\tif ( sprite.opacity > 0.001 && sprite.scale > 0.001 ) {\r\n\r\n\t\t\t\t\t\tscreenPosition.x = sprite.x;\r\n\t\t\t\t\t\tscreenPosition.y = sprite.y;\r\n\t\t\t\t\t\tscreenPosition.z = sprite.z;\r\n\r\n\t\t\t\t\t\tsize = sprite.size * sprite.scale / viewport.w;\r\n\r\n\t\t\t\t\t\tscale.x = size * invAspect;\r\n\t\t\t\t\t\tscale.y = size;\r\n\r\n\t\t\t\t\t\tgl.uniform3f( uniforms.screenPosition, screenPosition.x, screenPosition.y, screenPosition.z );\r\n\t\t\t\t\t\tgl.uniform2f( uniforms.scale, scale.x, scale.y );\r\n\t\t\t\t\t\tgl.uniform1f( uniforms.rotation, sprite.rotation );\r\n\r\n\t\t\t\t\t\tgl.uniform1f( uniforms.opacity, sprite.opacity );\r\n\t\t\t\t\t\tgl.uniform3f( uniforms.color, sprite.color.r, sprite.color.g, sprite.color.b );\r\n\r\n\t\t\t\t\t\tstate.setBlending( sprite.blending, sprite.blendEquation, sprite.blendSrc, sprite.blendDst );\r\n\t\t\t\t\t\trenderer.setTexture2D( sprite.texture, 1 );\r\n\r\n\t\t\t\t\t\tgl.drawElements( gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0 );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// restore gl\r\n\r\n\t\tstate.enable( gl.CULL_FACE );\r\n\t\tstate.enable( gl.DEPTH_TEST );\r\n\t\tstate.setDepthWrite( true );\r\n\r\n\t\trenderer.resetGLState();\r\n\r\n\t};\r\n\r\n\tfunction createProgram ( shader ) {\r\n\r\n\t\tvar program = gl.createProgram();\r\n\r\n\t\tvar fragmentShader = gl.createShader( gl.FRAGMENT_SHADER );\r\n\t\tvar vertexShader = gl.createShader( gl.VERTEX_SHADER );\r\n\r\n\t\tvar prefix = \"precision \" + renderer.getPrecision() + \" float;\\n\";\r\n\r\n\t\tgl.shaderSource( fragmentShader, prefix + shader.fragmentShader );\r\n\t\tgl.shaderSource( vertexShader, prefix + shader.vertexShader );\r\n\r\n\t\tgl.compileShader( fragmentShader );\r\n\t\tgl.compileShader( vertexShader );\r\n\r\n\t\tgl.attachShader( program, fragmentShader );\r\n\t\tgl.attachShader( program, vertexShader );\r\n\r\n\t\tgl.linkProgram( program );\r\n\r\n\t\treturn program;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/renderers/webgl/plugins/SpritePlugin.js\r\n\r\n/**\r\n * @author mikael emtinger / http://gomo.se/\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.SpritePlugin = function ( renderer, sprites ) {\r\n\r\n\tvar gl = renderer.context;\r\n\tvar state = renderer.state;\r\n\r\n\tvar vertexBuffer, elementBuffer;\r\n\tvar program, attributes, uniforms;\r\n\r\n\tvar texture;\r\n\r\n\t// decompose matrixWorld\r\n\r\n\tvar spritePosition = new THREE.Vector3();\r\n\tvar spriteRotation = new THREE.Quaternion();\r\n\tvar spriteScale = new THREE.Vector3();\r\n\r\n\tfunction init() {\r\n\r\n\t\tvar vertices = new Float32Array( [\r\n\t\t\t- 0.5, - 0.5,  0, 0,\r\n\t\t\t  0.5, - 0.5,  1, 0,\r\n\t\t\t  0.5,   0.5,  1, 1,\r\n\t\t\t- 0.5,   0.5,  0, 1\r\n\t\t] );\r\n\r\n\t\tvar faces = new Uint16Array( [\r\n\t\t\t0, 1, 2,\r\n\t\t\t0, 2, 3\r\n\t\t] );\r\n\r\n\t\tvertexBuffer  = gl.createBuffer();\r\n\t\telementBuffer = gl.createBuffer();\r\n\r\n\t\tgl.bindBuffer( gl.ARRAY_BUFFER, vertexBuffer );\r\n\t\tgl.bufferData( gl.ARRAY_BUFFER, vertices, gl.STATIC_DRAW );\r\n\r\n\t\tgl.bindBuffer( gl.ELEMENT_ARRAY_BUFFER, elementBuffer );\r\n\t\tgl.bufferData( gl.ELEMENT_ARRAY_BUFFER, faces, gl.STATIC_DRAW );\r\n\r\n\t\tprogram = createProgram();\r\n\r\n\t\tattributes = {\r\n\t\t\tposition:\t\t\tgl.getAttribLocation ( program, 'position' ),\r\n\t\t\tuv:\t\t\t\t\tgl.getAttribLocation ( program, 'uv' )\r\n\t\t};\r\n\r\n\t\tuniforms = {\r\n\t\t\tuvOffset:\t\t\tgl.getUniformLocation( program, 'uvOffset' ),\r\n\t\t\tuvScale:\t\t\tgl.getUniformLocation( program, 'uvScale' ),\r\n\r\n\t\t\trotation:\t\t\tgl.getUniformLocation( program, 'rotation' ),\r\n\t\t\tscale:\t\t\t\tgl.getUniformLocation( program, 'scale' ),\r\n\r\n\t\t\tcolor:\t\t\t\tgl.getUniformLocation( program, 'color' ),\r\n\t\t\tmap:\t\t\t\tgl.getUniformLocation( program, 'map' ),\r\n\t\t\topacity:\t\t\tgl.getUniformLocation( program, 'opacity' ),\r\n\r\n\t\t\tmodelViewMatrix: \tgl.getUniformLocation( program, 'modelViewMatrix' ),\r\n\t\t\tprojectionMatrix:\tgl.getUniformLocation( program, 'projectionMatrix' ),\r\n\r\n\t\t\tfogType:\t\t\tgl.getUniformLocation( program, 'fogType' ),\r\n\t\t\tfogDensity:\t\t\tgl.getUniformLocation( program, 'fogDensity' ),\r\n\t\t\tfogNear:\t\t\tgl.getUniformLocation( program, 'fogNear' ),\r\n\t\t\tfogFar:\t\t\t\tgl.getUniformLocation( program, 'fogFar' ),\r\n\t\t\tfogColor:\t\t\tgl.getUniformLocation( program, 'fogColor' ),\r\n\r\n\t\t\talphaTest:\t\t\tgl.getUniformLocation( program, 'alphaTest' )\r\n\t\t};\r\n\r\n\t\tvar canvas = document.createElement( 'canvas' );\r\n\t\tcanvas.width = 8;\r\n\t\tcanvas.height = 8;\r\n\r\n\t\tvar context = canvas.getContext( '2d' );\r\n\t\tcontext.fillStyle = 'white';\r\n\t\tcontext.fillRect( 0, 0, 8, 8 );\r\n\r\n\t\ttexture = new THREE.Texture( canvas );\r\n\t\ttexture.needsUpdate = true;\r\n\r\n\t}\r\n\r\n\tthis.render = function ( scene, camera ) {\r\n\r\n\t\tif ( sprites.length === 0 ) return;\r\n\r\n\t\t// setup gl\r\n\r\n\t\tif ( program === undefined ) {\r\n\r\n\t\t\tinit();\r\n\r\n\t\t}\r\n\r\n\t\tgl.useProgram( program );\r\n\r\n\t\tstate.initAttributes();\r\n\t\tstate.enableAttribute( attributes.position );\r\n\t\tstate.enableAttribute( attributes.uv );\r\n\t\tstate.disableUnusedAttributes();\r\n\r\n\t\tstate.disable( gl.CULL_FACE );\r\n\t\tstate.enable( gl.BLEND );\r\n\r\n\t\tgl.bindBuffer( gl.ARRAY_BUFFER, vertexBuffer );\r\n\t\tgl.vertexAttribPointer( attributes.position, 2, gl.FLOAT, false, 2 * 8, 0 );\r\n\t\tgl.vertexAttribPointer( attributes.uv, 2, gl.FLOAT, false, 2 * 8, 8 );\r\n\r\n\t\tgl.bindBuffer( gl.ELEMENT_ARRAY_BUFFER, elementBuffer );\r\n\r\n\t\tgl.uniformMatrix4fv( uniforms.projectionMatrix, false, camera.projectionMatrix.elements );\r\n\r\n\t\tstate.activeTexture( gl.TEXTURE0 );\r\n\t\tgl.uniform1i( uniforms.map, 0 );\r\n\r\n\t\tvar oldFogType = 0;\r\n\t\tvar sceneFogType = 0;\r\n\t\tvar fog = scene.fog;\r\n\r\n\t\tif ( fog ) {\r\n\r\n\t\t\tgl.uniform3f( uniforms.fogColor, fog.color.r, fog.color.g, fog.color.b );\r\n\r\n\t\t\tif ( fog instanceof THREE.Fog ) {\r\n\r\n\t\t\t\tgl.uniform1f( uniforms.fogNear, fog.near );\r\n\t\t\t\tgl.uniform1f( uniforms.fogFar, fog.far );\r\n\r\n\t\t\t\tgl.uniform1i( uniforms.fogType, 1 );\r\n\t\t\t\toldFogType = 1;\r\n\t\t\t\tsceneFogType = 1;\r\n\r\n\t\t\t} else if ( fog instanceof THREE.FogExp2 ) {\r\n\r\n\t\t\t\tgl.uniform1f( uniforms.fogDensity, fog.density );\r\n\r\n\t\t\t\tgl.uniform1i( uniforms.fogType, 2 );\r\n\t\t\t\toldFogType = 2;\r\n\t\t\t\tsceneFogType = 2;\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tgl.uniform1i( uniforms.fogType, 0 );\r\n\t\t\toldFogType = 0;\r\n\t\t\tsceneFogType = 0;\r\n\r\n\t\t}\r\n\r\n\r\n\t\t// update positions and sort\r\n\r\n\t\tfor ( var i = 0, l = sprites.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar sprite = sprites[ i ];\r\n\r\n\t\t\tsprite.modelViewMatrix.multiplyMatrices( camera.matrixWorldInverse, sprite.matrixWorld );\r\n\t\t\tsprite.z = - sprite.modelViewMatrix.elements[ 14 ];\r\n\r\n\t\t}\r\n\r\n\t\tsprites.sort( painterSortStable );\r\n\r\n\t\t// render all sprites\r\n\r\n\t\tvar scale = [];\r\n\r\n\t\tfor ( var i = 0, l = sprites.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar sprite = sprites[ i ];\r\n\t\t\tvar material = sprite.material;\r\n\r\n\t\t\tgl.uniform1f( uniforms.alphaTest, material.alphaTest );\r\n\t\t\tgl.uniformMatrix4fv( uniforms.modelViewMatrix, false, sprite.modelViewMatrix.elements );\r\n\r\n\t\t\tsprite.matrixWorld.decompose( spritePosition, spriteRotation, spriteScale );\r\n\r\n\t\t\tscale[ 0 ] = spriteScale.x;\r\n\t\t\tscale[ 1 ] = spriteScale.y;\r\n\r\n\t\t\tvar fogType = 0;\r\n\r\n\t\t\tif ( scene.fog && material.fog ) {\r\n\r\n\t\t\t\tfogType = sceneFogType;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( oldFogType !== fogType ) {\r\n\r\n\t\t\t\tgl.uniform1i( uniforms.fogType, fogType );\r\n\t\t\t\toldFogType = fogType;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.map !== null ) {\r\n\r\n\t\t\t\tgl.uniform2f( uniforms.uvOffset, material.map.offset.x, material.map.offset.y );\r\n\t\t\t\tgl.uniform2f( uniforms.uvScale, material.map.repeat.x, material.map.repeat.y );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tgl.uniform2f( uniforms.uvOffset, 0, 0 );\r\n\t\t\t\tgl.uniform2f( uniforms.uvScale, 1, 1 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgl.uniform1f( uniforms.opacity, material.opacity );\r\n\t\t\tgl.uniform3f( uniforms.color, material.color.r, material.color.g, material.color.b );\r\n\r\n\t\t\tgl.uniform1f( uniforms.rotation, material.rotation );\r\n\t\t\tgl.uniform2fv( uniforms.scale, scale );\r\n\r\n\t\t\tstate.setBlending( material.blending, material.blendEquation, material.blendSrc, material.blendDst );\r\n\t\t\tstate.setDepthTest( material.depthTest );\r\n\t\t\tstate.setDepthWrite( material.depthWrite );\r\n\r\n\t\t\tif ( material.map ) {\r\n\r\n\t\t\t\trenderer.setTexture2D( material.map, 0 );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\trenderer.setTexture2D( texture, 0 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgl.drawElements( gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0 );\r\n\r\n\t\t}\r\n\r\n\t\t// restore gl\r\n\r\n\t\tstate.enable( gl.CULL_FACE );\r\n\r\n\t\trenderer.resetGLState();\r\n\r\n\t};\r\n\r\n\tfunction createProgram () {\r\n\r\n\t\tvar program = gl.createProgram();\r\n\r\n\t\tvar vertexShader = gl.createShader( gl.VERTEX_SHADER );\r\n\t\tvar fragmentShader = gl.createShader( gl.FRAGMENT_SHADER );\r\n\r\n\t\tgl.shaderSource( vertexShader, [\r\n\r\n\t\t\t'precision ' + renderer.getPrecision() + ' float;',\r\n\r\n\t\t\t'uniform mat4 modelViewMatrix;',\r\n\t\t\t'uniform mat4 projectionMatrix;',\r\n\t\t\t'uniform float rotation;',\r\n\t\t\t'uniform vec2 scale;',\r\n\t\t\t'uniform vec2 uvOffset;',\r\n\t\t\t'uniform vec2 uvScale;',\r\n\r\n\t\t\t'attribute vec2 position;',\r\n\t\t\t'attribute vec2 uv;',\r\n\r\n\t\t\t'varying vec2 vUV;',\r\n\r\n\t\t\t'void main() {',\r\n\r\n\t\t\t\t'vUV = uvOffset + uv * uvScale;',\r\n\r\n\t\t\t\t'vec2 alignedPosition = position * scale;',\r\n\r\n\t\t\t\t'vec2 rotatedPosition;',\r\n\t\t\t\t'rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;',\r\n\t\t\t\t'rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;',\r\n\r\n\t\t\t\t'vec4 finalPosition;',\r\n\r\n\t\t\t\t'finalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );',\r\n\t\t\t\t'finalPosition.xy += rotatedPosition;',\r\n\t\t\t\t'finalPosition = projectionMatrix * finalPosition;',\r\n\r\n\t\t\t\t'gl_Position = finalPosition;',\r\n\r\n\t\t\t'}'\r\n\r\n\t\t].join( '\\n' ) );\r\n\r\n\t\tgl.shaderSource( fragmentShader, [\r\n\r\n\t\t\t'precision ' + renderer.getPrecision() + ' float;',\r\n\r\n\t\t\t'uniform vec3 color;',\r\n\t\t\t'uniform sampler2D map;',\r\n\t\t\t'uniform float opacity;',\r\n\r\n\t\t\t'uniform int fogType;',\r\n\t\t\t'uniform vec3 fogColor;',\r\n\t\t\t'uniform float fogDensity;',\r\n\t\t\t'uniform float fogNear;',\r\n\t\t\t'uniform float fogFar;',\r\n\t\t\t'uniform float alphaTest;',\r\n\r\n\t\t\t'varying vec2 vUV;',\r\n\r\n\t\t\t'void main() {',\r\n\r\n\t\t\t\t'vec4 texture = texture2D( map, vUV );',\r\n\r\n\t\t\t\t'if ( texture.a < alphaTest ) discard;',\r\n\r\n\t\t\t\t'gl_FragColor = vec4( color * texture.xyz, texture.a * opacity );',\r\n\r\n\t\t\t\t'if ( fogType > 0 ) {',\r\n\r\n\t\t\t\t\t'float depth = gl_FragCoord.z / gl_FragCoord.w;',\r\n\t\t\t\t\t'float fogFactor = 0.0;',\r\n\r\n\t\t\t\t\t'if ( fogType == 1 ) {',\r\n\r\n\t\t\t\t\t\t'fogFactor = smoothstep( fogNear, fogFar, depth );',\r\n\r\n\t\t\t\t\t'} else {',\r\n\r\n\t\t\t\t\t\t'const float LOG2 = 1.442695;',\r\n\t\t\t\t\t\t'fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );',\r\n\t\t\t\t\t\t'fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );',\r\n\r\n\t\t\t\t\t'}',\r\n\r\n\t\t\t\t\t'gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );',\r\n\r\n\t\t\t\t'}',\r\n\r\n\t\t\t'}'\r\n\r\n\t\t].join( '\\n' ) );\r\n\r\n\t\tgl.compileShader( vertexShader );\r\n\t\tgl.compileShader( fragmentShader );\r\n\r\n\t\tgl.attachShader( program, vertexShader );\r\n\t\tgl.attachShader( program, fragmentShader );\r\n\r\n\t\tgl.linkProgram( program );\r\n\r\n\t\treturn program;\r\n\r\n\t}\r\n\r\n\tfunction painterSortStable ( a, b ) {\r\n\t\t\r\n\t\tif ( a.renderOrder !== b.renderOrder ) {\r\n\r\n\t\t\treturn a.renderOrder - b.renderOrder;\r\n\r\n\t\t} else if ( a.z !== b.z ) {\r\n\r\n\t\t\treturn b.z - a.z;\r\n\r\n\t\t} else {\r\n\r\n\t\t\treturn b.id - a.id;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/Three.Legacy.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nObject.assign( THREE, {\r\n\tFace4: function ( a, b, c, d, normal, color, materialIndex ) {\r\n\t\tconsole.warn( 'THREE.Face4 has been removed. A THREE.Face3 will be created instead.' );\r\n\t\treturn new THREE.Face3( a, b, c, normal, color, materialIndex );\r\n\t},\r\n\tLineStrip: 0,\r\n\tLinePieces: 1,\r\n\tMeshFaceMaterial: THREE.MultiMaterial,\r\n\tPointCloud: function ( geometry, material ) {\r\n\t\tconsole.warn( 'THREE.PointCloud has been renamed to THREE.Points.' );\r\n\t\treturn new THREE.Points( geometry, material );\r\n\t},\r\n\tParticle: THREE.Sprite,\r\n\tParticleSystem: function ( geometry, material ) {\r\n\t\tconsole.warn( 'THREE.ParticleSystem has been renamed to THREE.Points.' );\r\n\t\treturn new THREE.Points( geometry, material );\r\n\t},\r\n\tPointCloudMaterial: function ( parameters ) {\r\n\t\tconsole.warn( 'THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial.' );\r\n\t\treturn new THREE.PointsMaterial( parameters );\r\n\t},\r\n\tParticleBasicMaterial: function ( parameters ) {\r\n\t\tconsole.warn( 'THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial.' );\r\n\t\treturn new THREE.PointsMaterial( parameters );\r\n\t},\r\n\tParticleSystemMaterial: function ( parameters ) {\r\n\t\tconsole.warn( 'THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial.' );\r\n\t\treturn new THREE.PointsMaterial( parameters );\r\n\t},\r\n\tVertex: function ( x, y, z ) {\r\n\t\tconsole.warn( 'THREE.Vertex has been removed. Use THREE.Vector3 instead.' );\r\n\t\treturn new THREE.Vector3( x, y, z );\r\n\t}\r\n} );\r\n\r\n//\r\n\r\nObject.assign( THREE.Box2.prototype, {\r\n\tempty: function () {\r\n\t\tconsole.warn( 'THREE.Box2: .empty() has been renamed to .isEmpty().' );\r\n\t\treturn this.isEmpty();\r\n\t},\r\n\tisIntersectionBox: function ( box ) {\r\n\t\tconsole.warn( 'THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox().' );\r\n\t\treturn this.intersectsBox( box );\r\n\t}\r\n} );\r\n\r\nObject.assign( THREE.Box3.prototype, {\r\n\tempty: function () {\r\n\t\tconsole.warn( 'THREE.Box3: .empty() has been renamed to .isEmpty().' );\r\n\t\treturn this.isEmpty();\r\n\t},\r\n\tisIntersectionBox: function ( box ) {\r\n\t\tconsole.warn( 'THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox().' );\r\n\t\treturn this.intersectsBox( box );\r\n\t},\r\n\tisIntersectionSphere: function ( sphere ) {\r\n\t\tconsole.warn( 'THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere().' );\r\n\t\treturn this.intersectsSphere( sphere );\r\n\t}\r\n} );\r\n\r\nObject.assign( THREE.Matrix3.prototype, {\r\n\tmultiplyVector3: function ( vector ) {\r\n\t\tconsole.warn( 'THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead.' );\r\n\t\treturn vector.applyMatrix3( this );\r\n\t},\r\n\tmultiplyVector3Array: function ( a ) {\r\n\t\tconsole.warn( 'THREE.Matrix3: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead.' );\r\n\t\treturn this.applyToVector3Array( a );\r\n\t}\r\n} );\r\n\r\nObject.assign( THREE.Matrix4.prototype, {\r\n\textractPosition: function ( m ) {\r\n\t\tconsole.warn( 'THREE.Matrix4: .extractPosition() has been renamed to .copyPosition().' );\r\n\t\treturn this.copyPosition( m );\r\n\t},\r\n\tsetRotationFromQuaternion: function ( q ) {\r\n\t\tconsole.warn( 'THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion().' );\r\n\t\treturn this.makeRotationFromQuaternion( q );\r\n\t},\r\n\tmultiplyVector3: function ( vector ) {\r\n\t\tconsole.warn( 'THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead.' );\r\n\t\treturn vector.applyProjection( this );\r\n\t},\r\n\tmultiplyVector4: function ( vector ) {\r\n\t\tconsole.warn( 'THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead.' );\r\n\t\treturn vector.applyMatrix4( this );\r\n\t},\r\n\tmultiplyVector3Array: function ( a ) {\r\n\t\tconsole.warn( 'THREE.Matrix4: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead.' );\r\n\t\treturn this.applyToVector3Array( a );\r\n\t},\r\n\trotateAxis: function ( v ) {\r\n\t\tconsole.warn( 'THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead.' );\r\n\t\tv.transformDirection( this );\r\n\t},\r\n\tcrossVector: function ( vector ) {\r\n\t\tconsole.warn( 'THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead.' );\r\n\t\treturn vector.applyMatrix4( this );\r\n\t},\r\n\ttranslate: function ( v ) {\r\n\t\tconsole.error( 'THREE.Matrix4: .translate() has been removed.' );\r\n\t},\r\n\trotateX: function ( angle ) {\r\n\t\tconsole.error( 'THREE.Matrix4: .rotateX() has been removed.' );\r\n\t},\r\n\trotateY: function ( angle ) {\r\n\t\tconsole.error( 'THREE.Matrix4: .rotateY() has been removed.' );\r\n\t},\r\n\trotateZ: function ( angle ) {\r\n\t\tconsole.error( 'THREE.Matrix4: .rotateZ() has been removed.' );\r\n\t},\r\n\trotateByAxis: function ( axis, angle ) {\r\n\t\tconsole.error( 'THREE.Matrix4: .rotateByAxis() has been removed.' );\r\n\t}\r\n} );\r\n\r\nObject.assign( THREE.Plane.prototype, {\r\n\tisIntersectionLine: function ( line ) {\r\n\t\tconsole.warn( 'THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine().' );\r\n\t\treturn this.intersectsLine( line );\r\n\t}\r\n} );\r\n\r\nObject.assign( THREE.Quaternion.prototype, {\r\n\tmultiplyVector3: function ( vector ) {\r\n\t\tconsole.warn( 'THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead.' );\r\n\t\treturn vector.applyQuaternion( this );\r\n\t}\r\n} );\r\n\r\nObject.assign( THREE.Ray.prototype, {\r\n\tisIntersectionBox: function ( box ) {\r\n\t\tconsole.warn( 'THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox().' );\r\n\t\treturn this.intersectsBox( box );\r\n\t},\r\n\tisIntersectionPlane: function ( plane ) {\r\n\t\tconsole.warn( 'THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane().' );\r\n\t\treturn this.intersectsPlane( plane );\r\n\t},\r\n\tisIntersectionSphere: function ( sphere ) {\r\n\t\tconsole.warn( 'THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere().' );\r\n\t\treturn this.intersectsSphere( sphere );\r\n\t}\r\n} );\r\n\r\nObject.assign( THREE.Vector3.prototype, {\r\n\tsetEulerFromRotationMatrix: function () {\r\n\t\tconsole.error( 'THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.' );\r\n\t},\r\n\tsetEulerFromQuaternion: function () {\r\n\t\tconsole.error( 'THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.' );\r\n\t},\r\n\tgetPositionFromMatrix: function ( m ) {\r\n\t\tconsole.warn( 'THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition().' );\r\n\t\treturn this.setFromMatrixPosition( m );\r\n\t},\r\n\tgetScaleFromMatrix: function ( m ) {\r\n\t\tconsole.warn( 'THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale().' );\r\n\t\treturn this.setFromMatrixScale( m );\r\n\t},\r\n\tgetColumnFromMatrix: function ( index, matrix ) {\r\n\t\tconsole.warn( 'THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn().' );\r\n\t\treturn this.setFromMatrixColumn( matrix, index );\r\n\t}\r\n} );\r\n\r\n//\r\n\r\nObject.assign( THREE.Object3D.prototype, {\r\n\tgetChildByName: function ( name ) {\r\n\t\tconsole.warn( 'THREE.Object3D: .getChildByName() has been renamed to .getObjectByName().' );\r\n\t\treturn this.getObjectByName( name );\r\n\t},\r\n\trenderDepth: function ( value ) {\r\n\t\tconsole.warn( 'THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.' );\r\n\t},\r\n\ttranslate: function ( distance, axis ) {\r\n\t\tconsole.warn( 'THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead.' );\r\n\t\treturn this.translateOnAxis( axis, distance );\r\n\t}\r\n} );\r\n\r\nObject.defineProperties( THREE.Object3D.prototype, {\r\n\teulerOrder: {\r\n\t\tget: function () {\r\n\t\t\tconsole.warn( 'THREE.Object3D: .eulerOrder is now .rotation.order.' );\r\n\t\t\treturn this.rotation.order;\r\n\t\t},\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.Object3D: .eulerOrder is now .rotation.order.' );\r\n\t\t\tthis.rotation.order = value;\r\n\t\t}\r\n\t},\r\n\tuseQuaternion: {\r\n\t\tget: function () {\r\n\t\t\tconsole.warn( 'THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.' );\r\n\t\t},\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.' );\r\n\t\t}\r\n\t}\r\n} );\r\n\r\nObject.defineProperties( THREE.LOD.prototype, {\r\n\tobjects: {\r\n\t\tget: function () {\r\n\t\t\tconsole.warn( 'THREE.LOD: .objects has been renamed to .levels.' );\r\n\t\t\treturn this.levels;\r\n\t\t}\r\n\t}\r\n} );\r\n\r\n//\r\n\r\nTHREE.PerspectiveCamera.prototype.setLens = function ( focalLength, filmGauge ) {\r\n\r\n\tconsole.warn( \"THREE.PerspectiveCamera.setLens is deprecated. \" +\r\n\t\t\t\"Use .setFocalLength and .filmGauge for a photographic setup.\" );\r\n\r\n\tif ( filmGauge !== undefined ) this.filmGauge = filmGauge;\r\n\tthis.setFocalLength( focalLength );\r\n\r\n};\r\n\r\n//\r\n\r\nObject.defineProperties( THREE.Light.prototype, {\r\n\tonlyShadow: {\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.Light: .onlyShadow has been removed.' );\r\n\t\t}\r\n\t},\r\n\tshadowCameraFov: {\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.Light: .shadowCameraFov is now .shadow.camera.fov.' );\r\n\t\t\tthis.shadow.camera.fov = value;\r\n\t\t}\r\n\t},\r\n\tshadowCameraLeft: {\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.Light: .shadowCameraLeft is now .shadow.camera.left.' );\r\n\t\t\tthis.shadow.camera.left = value;\r\n\t\t}\r\n\t},\r\n\tshadowCameraRight: {\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.Light: .shadowCameraRight is now .shadow.camera.right.' );\r\n\t\t\tthis.shadow.camera.right = value;\r\n\t\t}\r\n\t},\r\n\tshadowCameraTop: {\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.Light: .shadowCameraTop is now .shadow.camera.top.' );\r\n\t\t\tthis.shadow.camera.top = value;\r\n\t\t}\r\n\t},\r\n\tshadowCameraBottom: {\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom.' );\r\n\t\t\tthis.shadow.camera.bottom = value;\r\n\t\t}\r\n\t},\r\n\tshadowCameraNear: {\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.Light: .shadowCameraNear is now .shadow.camera.near.' );\r\n\t\t\tthis.shadow.camera.near = value;\r\n\t\t}\r\n\t},\r\n\tshadowCameraFar: {\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.Light: .shadowCameraFar is now .shadow.camera.far.' );\r\n\t\t\tthis.shadow.camera.far = value;\r\n\t\t}\r\n\t},\r\n\tshadowCameraVisible: {\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.' );\r\n\t\t}\r\n\t},\r\n\tshadowBias: {\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.Light: .shadowBias is now .shadow.bias.' );\r\n\t\t\tthis.shadow.bias = value;\r\n\t\t}\r\n\t},\r\n\tshadowDarkness: {\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.Light: .shadowDarkness has been removed.' );\r\n\t\t}\r\n\t},\r\n\tshadowMapWidth: {\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.Light: .shadowMapWidth is now .shadow.mapSize.width.' );\r\n\t\t\tthis.shadow.mapSize.width = value;\r\n\t\t}\r\n\t},\r\n\tshadowMapHeight: {\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.Light: .shadowMapHeight is now .shadow.mapSize.height.' );\r\n\t\t\tthis.shadow.mapSize.height = value;\r\n\t\t}\r\n\t}\r\n} );\r\n\r\n//\r\n\r\nObject.defineProperties( THREE.BufferAttribute.prototype, {\r\n\tlength: {\r\n\t\tget: function () {\r\n\t\t\tconsole.warn( 'THREE.BufferAttribute: .length has been deprecated. Please use .count.' );\r\n\t\t\treturn this.array.length;\r\n\t\t}\r\n\t}\r\n} );\r\n\r\nObject.assign( THREE.BufferGeometry.prototype, {\r\n\taddIndex: function ( index ) {\r\n\t\tconsole.warn( 'THREE.BufferGeometry: .addIndex() has been renamed to .setIndex().' );\r\n\t\tthis.setIndex( index );\r\n\t},\r\n\taddDrawCall: function ( start, count, indexOffset ) {\r\n\t\tif ( indexOffset !== undefined ) {\r\n\t\t\tconsole.warn( 'THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset.' );\r\n\t\t}\r\n\t\tconsole.warn( 'THREE.BufferGeometry: .addDrawCall() is now .addGroup().' );\r\n\t\tthis.addGroup( start, count );\r\n\t},\r\n\tclearDrawCalls: function () {\r\n\t\tconsole.warn( 'THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups().' );\r\n\t\tthis.clearGroups();\r\n\t},\r\n\tcomputeTangents: function () {\r\n\t\tconsole.warn( 'THREE.BufferGeometry: .computeTangents() has been removed.' );\r\n\t},\r\n\tcomputeOffsets: function () {\r\n\t\tconsole.warn( 'THREE.BufferGeometry: .computeOffsets() has been removed.' );\r\n\t}\r\n} );\r\n\r\nObject.defineProperties( THREE.BufferGeometry.prototype, {\r\n\tdrawcalls: {\r\n\t\tget: function () {\r\n\t\t\tconsole.error( 'THREE.BufferGeometry: .drawcalls has been renamed to .groups.' );\r\n\t\t\treturn this.groups;\r\n\t\t}\r\n\t},\r\n\toffsets: {\r\n\t\tget: function () {\r\n\t\t\tconsole.warn( 'THREE.BufferGeometry: .offsets has been renamed to .groups.' );\r\n\t\t\treturn this.groups;\r\n\t\t}\r\n\t}\r\n} );\r\n\r\n//\r\n\r\nObject.defineProperties( THREE.Material.prototype, {\r\n\twrapAround: {\r\n\t\tget: function () {\r\n\t\t\tconsole.warn( 'THREE.' + this.type + ': .wrapAround has been removed.' );\r\n\t\t},\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.' + this.type + ': .wrapAround has been removed.' );\r\n\t\t}\r\n\t},\r\n\twrapRGB: {\r\n\t\tget: function () {\r\n\t\t\tconsole.warn( 'THREE.' + this.type + ': .wrapRGB has been removed.' );\r\n\t\t\treturn new THREE.Color();\r\n\t\t}\r\n\t}\r\n} );\r\n\r\nObject.defineProperties( THREE.MeshPhongMaterial.prototype, {\r\n\tmetal: {\r\n\t\tget: function () {\r\n\t\t\tconsole.warn( 'THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead.' );\r\n\t\t\treturn false;\r\n\t\t},\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead' );\r\n\t\t}\r\n\t}\r\n} );\r\n\r\nObject.defineProperties( THREE.ShaderMaterial.prototype, {\r\n\tderivatives: {\r\n\t\tget: function () {\r\n\t\t\tconsole.warn( 'THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives.' );\r\n\t\t\treturn this.extensions.derivatives;\r\n\t\t},\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives.' );\r\n\t\t\tthis.extensions.derivatives = value;\r\n\t\t}\r\n\t}\r\n} );\r\n\r\n//\r\n\r\nTHREE.EventDispatcher.prototype = Object.assign( Object.create( {\r\n\r\n\t// Note: Extra base ensures these properties are not 'assign'ed.\r\n\r\n\tconstructor: THREE.EventDispatcher,\r\n\r\n\tapply: function ( target ) {\r\n\r\n\t\tconsole.warn( \"THREE.EventDispatcher: .apply is deprecated, \" +\r\n\t\t\t\t\"just inherit or Object.assign the prototype to mix-in.\" );\r\n\r\n\t\tObject.assign( target, this );\r\n\r\n\t}\r\n\r\n} ), THREE.EventDispatcher.prototype );\r\n\r\n//\r\n\r\nObject.assign( THREE.WebGLRenderer.prototype, {\r\n\tsupportsFloatTextures: function () {\r\n\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( \\'OES_texture_float\\' ).' );\r\n\t\treturn this.extensions.get( 'OES_texture_float' );\r\n\t},\r\n\tsupportsHalfFloatTextures: function () {\r\n\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( \\'OES_texture_half_float\\' ).' );\r\n\t\treturn this.extensions.get( 'OES_texture_half_float' );\r\n\t},\r\n\tsupportsStandardDerivatives: function () {\r\n\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( \\'OES_standard_derivatives\\' ).' );\r\n\t\treturn this.extensions.get( 'OES_standard_derivatives' );\r\n\t},\r\n\tsupportsCompressedTextureS3TC: function () {\r\n\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( \\'WEBGL_compressed_texture_s3tc\\' ).' );\r\n\t\treturn this.extensions.get( 'WEBGL_compressed_texture_s3tc' );\r\n\t},\r\n\tsupportsCompressedTexturePVRTC: function () {\r\n\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( \\'WEBGL_compressed_texture_pvrtc\\' ).' );\r\n\t\treturn this.extensions.get( 'WEBGL_compressed_texture_pvrtc' );\r\n\t},\r\n\tsupportsBlendMinMax: function () {\r\n\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( \\'EXT_blend_minmax\\' ).' );\r\n\t\treturn this.extensions.get( 'EXT_blend_minmax' );\r\n\t},\r\n\tsupportsVertexTextures: function () {\r\n\t\treturn this.capabilities.vertexTextures;\r\n\t},\r\n\tsupportsInstancedArrays: function () {\r\n\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( \\'ANGLE_instanced_arrays\\' ).' );\r\n\t\treturn this.extensions.get( 'ANGLE_instanced_arrays' );\r\n\t},\r\n\tenableScissorTest: function ( boolean ) {\r\n\t\tconsole.warn( 'THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest().' );\r\n\t\tthis.setScissorTest( boolean );\r\n\t},\r\n\tinitMaterial: function () {\r\n\t\tconsole.warn( 'THREE.WebGLRenderer: .initMaterial() has been removed.' );\r\n\t},\r\n\taddPrePlugin: function () {\r\n\t\tconsole.warn( 'THREE.WebGLRenderer: .addPrePlugin() has been removed.' );\r\n\t},\r\n\taddPostPlugin: function () {\r\n\t\tconsole.warn( 'THREE.WebGLRenderer: .addPostPlugin() has been removed.' );\r\n\t},\r\n\tupdateShadowMap: function () {\r\n\t\tconsole.warn( 'THREE.WebGLRenderer: .updateShadowMap() has been removed.' );\r\n\t}\r\n} );\r\n\r\nObject.defineProperties( THREE.WebGLRenderer.prototype, {\r\n\tshadowMapEnabled: {\r\n\t\tget: function () {\r\n\t\t\treturn this.shadowMap.enabled;\r\n\t\t},\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled.' );\r\n\t\t\tthis.shadowMap.enabled = value;\r\n\t\t}\r\n\t},\r\n\tshadowMapType: {\r\n\t\tget: function () {\r\n\t\t\treturn this.shadowMap.type;\r\n\t\t},\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type.' );\r\n\t\t\tthis.shadowMap.type = value;\r\n\t\t}\r\n\t},\r\n\tshadowMapCullFace: {\r\n\t\tget: function () {\r\n\t\t\treturn this.shadowMap.cullFace;\r\n\t\t},\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .shadowMapCullFace is now .shadowMap.cullFace.' );\r\n\t\t\tthis.shadowMap.cullFace = value;\r\n\t\t}\r\n\t}\r\n} );\r\n\r\nObject.defineProperties( THREE.WebGLShadowMap.prototype, {\r\n\tcullFace: {\r\n\t\tget: function () {\r\n\t\t\treturn this.renderReverseSided ? THREE.CullFaceFront : THREE.CullFaceBack;\r\n\t\t},\r\n\t\tset: function ( cullFace ) {\r\n\t\t\tvar value = ( cullFace !== THREE.CullFaceBack );\r\n\t\t\tconsole.warn( \"WebGLRenderer: .shadowMap.cullFace is deprecated. Set .shadowMap.renderReverseSided to \" + value + \".\" );\r\n\t\t\tthis.renderReverseSided = value;\r\n\t\t}\r\n\t}\r\n} );\r\n\r\n//\r\n\r\nObject.defineProperties( THREE.WebGLRenderTarget.prototype, {\r\n\twrapS: {\r\n\t\tget: function () {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS.' );\r\n\t\t\treturn this.texture.wrapS;\r\n\t\t},\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS.' );\r\n\t\t\tthis.texture.wrapS = value;\r\n\t\t}\r\n\t},\r\n\twrapT: {\r\n\t\tget: function () {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT.' );\r\n\t\t\treturn this.texture.wrapT;\r\n\t\t},\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT.' );\r\n\t\t\tthis.texture.wrapT = value;\r\n\t\t}\r\n\t},\r\n\tmagFilter: {\r\n\t\tget: function () {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter.' );\r\n\t\t\treturn this.texture.magFilter;\r\n\t\t},\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter.' );\r\n\t\t\tthis.texture.magFilter = value;\r\n\t\t}\r\n\t},\r\n\tminFilter: {\r\n\t\tget: function () {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter.' );\r\n\t\t\treturn this.texture.minFilter;\r\n\t\t},\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter.' );\r\n\t\t\tthis.texture.minFilter = value;\r\n\t\t}\r\n\t},\r\n\tanisotropy: {\r\n\t\tget: function () {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy.' );\r\n\t\t\treturn this.texture.anisotropy;\r\n\t\t},\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy.' );\r\n\t\t\tthis.texture.anisotropy = value;\r\n\t\t}\r\n\t},\r\n\toffset: {\r\n\t\tget: function () {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .offset is now .texture.offset.' );\r\n\t\t\treturn this.texture.offset;\r\n\t\t},\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .offset is now .texture.offset.' );\r\n\t\t\tthis.texture.offset = value;\r\n\t\t}\r\n\t},\r\n\trepeat: {\r\n\t\tget: function () {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .repeat is now .texture.repeat.' );\r\n\t\t\treturn this.texture.repeat;\r\n\t\t},\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .repeat is now .texture.repeat.' );\r\n\t\t\tthis.texture.repeat = value;\r\n\t\t}\r\n\t},\r\n\tformat: {\r\n\t\tget: function () {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .format is now .texture.format.' );\r\n\t\t\treturn this.texture.format;\r\n\t\t},\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .format is now .texture.format.' );\r\n\t\t\tthis.texture.format = value;\r\n\t\t}\r\n\t},\r\n\ttype: {\r\n\t\tget: function () {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .type is now .texture.type.' );\r\n\t\t\treturn this.texture.type;\r\n\t\t},\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .type is now .texture.type.' );\r\n\t\t\tthis.texture.type = value;\r\n\t\t}\r\n\t},\r\n\tgenerateMipmaps: {\r\n\t\tget: function () {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps.' );\r\n\t\t\treturn this.texture.generateMipmaps;\r\n\t\t},\r\n\t\tset: function ( value ) {\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps.' );\r\n\t\t\tthis.texture.generateMipmaps = value;\r\n\t\t}\r\n\t}\r\n} );\r\n\r\n//\r\n\r\nObject.assign( THREE.Audio.prototype, {\r\n\tload: function ( file ) {\r\n\t\tconsole.warn( 'THREE.Audio: .load has been deprecated. Please use THREE.AudioLoader.' );\r\n\t\tvar scope = this;\r\n\t\tvar audioLoader = new THREE.AudioLoader();\r\n\t\taudioLoader.load( file, function ( buffer ) {\r\n\t\t\tscope.setBuffer( buffer );\r\n\t\t} );\r\n\t\treturn this;\r\n\t}\r\n} );\r\n\r\nObject.assign( THREE.AudioAnalyser.prototype, {\r\n\tgetData: function ( file ) {\r\n\t\tconsole.warn( 'THREE.AudioAnalyser: .getData() is now .getFrequencyData().' );\r\n\t\treturn this.getFrequencyData();\r\n\t}\r\n} );\r\n\r\n//\r\n\r\nTHREE.GeometryUtils = {\r\n\r\n\tmerge: function ( geometry1, geometry2, materialIndexOffset ) {\r\n\r\n\t\tconsole.warn( 'THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.' );\r\n\r\n\t\tvar matrix;\r\n\r\n\t\tif ( geometry2 instanceof THREE.Mesh ) {\r\n\r\n\t\t\tgeometry2.matrixAutoUpdate && geometry2.updateMatrix();\r\n\r\n\t\t\tmatrix = geometry2.matrix;\r\n\t\t\tgeometry2 = geometry2.geometry;\r\n\r\n\t\t}\r\n\r\n\t\tgeometry1.merge( geometry2, matrix, materialIndexOffset );\r\n\r\n\t},\r\n\r\n\tcenter: function ( geometry ) {\r\n\r\n\t\tconsole.warn( 'THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead.' );\r\n\t\treturn geometry.center();\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.ImageUtils = {\r\n\r\n\tcrossOrigin: undefined,\r\n\r\n\tloadTexture: function ( url, mapping, onLoad, onError ) {\r\n\r\n\t\tconsole.warn( 'THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.' );\r\n\r\n\t\tvar loader = new THREE.TextureLoader();\r\n\t\tloader.setCrossOrigin( this.crossOrigin );\r\n\r\n\t\tvar texture = loader.load( url, onLoad, undefined, onError );\r\n\r\n\t\tif ( mapping ) texture.mapping = mapping;\r\n\r\n\t\treturn texture;\r\n\r\n\t},\r\n\r\n\tloadTextureCube: function ( urls, mapping, onLoad, onError ) {\r\n\r\n\t\tconsole.warn( 'THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.' );\r\n\r\n\t\tvar loader = new THREE.CubeTextureLoader();\r\n\t\tloader.setCrossOrigin( this.crossOrigin );\r\n\r\n\t\tvar texture = loader.load( urls, onLoad, undefined, onError );\r\n\r\n\t\tif ( mapping ) texture.mapping = mapping;\r\n\r\n\t\treturn texture;\r\n\r\n\t},\r\n\r\n\tloadCompressedTexture: function () {\r\n\r\n\t\tconsole.error( 'THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.' );\r\n\r\n\t},\r\n\r\n\tloadCompressedTextureCube: function () {\r\n\r\n\t\tconsole.error( 'THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.' );\r\n\r\n\t}\r\n\r\n};\r\n\r\n//\r\n\r\nTHREE.Projector = function () {\r\n\r\n\tconsole.error( 'THREE.Projector has been moved to /examples/js/renderers/Projector.js.' );\r\n\r\n\tthis.projectVector = function ( vector, camera ) {\r\n\r\n\t\tconsole.warn( 'THREE.Projector: .projectVector() is now vector.project().' );\r\n\t\tvector.project( camera );\r\n\r\n\t};\r\n\r\n\tthis.unprojectVector = function ( vector, camera ) {\r\n\r\n\t\tconsole.warn( 'THREE.Projector: .unprojectVector() is now vector.unproject().' );\r\n\t\tvector.unproject( camera );\r\n\r\n\t};\r\n\r\n\tthis.pickingRay = function ( vector, camera ) {\r\n\r\n\t\tconsole.error( 'THREE.Projector: .pickingRay() is now raycaster.setFromCamera().' );\r\n\r\n\t};\r\n\r\n};\r\n\r\n//\r\n\r\nTHREE.CanvasRenderer = function () {\r\n\r\n\tconsole.error( 'THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js' );\r\n\r\n\tthis.domElement = document.createElement( 'canvas' );\r\n\tthis.clear = function () {};\r\n\tthis.render = function () {};\r\n\tthis.setClearColor = function () {};\r\n\tthis.setSize = function () {};\r\n\r\n};\r\n\r\n// File:src/extras/CurveUtils.js\r\n\r\n/**\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n */\r\n\r\nTHREE.CurveUtils = {\r\n\r\n\ttangentQuadraticBezier: function ( t, p0, p1, p2 ) {\r\n\r\n\t\treturn 2 * ( 1 - t ) * ( p1 - p0 ) + 2 * t * ( p2 - p1 );\r\n\r\n\t},\r\n\r\n\t// Puay Bing, thanks for helping with this derivative!\r\n\r\n\ttangentCubicBezier: function ( t, p0, p1, p2, p3 ) {\r\n\r\n\t\treturn - 3 * p0 * ( 1 - t ) * ( 1 - t )  +\r\n\t\t\t3 * p1 * ( 1 - t ) * ( 1 - t ) - 6 * t * p1 * ( 1 - t ) +\r\n\t\t\t6 * t *  p2 * ( 1 - t ) - 3 * t * t * p2 +\r\n\t\t\t3 * t * t * p3;\r\n\r\n\t},\r\n\r\n\ttangentSpline: function ( t, p0, p1, p2, p3 ) {\r\n\r\n\t\t// To check if my formulas are correct\r\n\r\n\t\tvar h00 = 6 * t * t - 6 * t; \t// derived from 2t^3  3t^2 + 1\r\n\t\tvar h10 = 3 * t * t - 4 * t + 1; // t^3  2t^2 + t\r\n\t\tvar h01 = - 6 * t * t + 6 * t; \t//  2t3 + 3t2\r\n\t\tvar h11 = 3 * t * t - 2 * t;\t// t3  t2\r\n\r\n\t\treturn h00 + h10 + h01 + h11;\r\n\r\n\t},\r\n\r\n\t// Catmull-Rom\r\n\r\n\tinterpolate: function( p0, p1, p2, p3, t ) {\r\n\r\n\t\tvar v0 = ( p2 - p0 ) * 0.5;\r\n\t\tvar v1 = ( p3 - p1 ) * 0.5;\r\n\t\tvar t2 = t * t;\r\n\t\tvar t3 = t * t2;\r\n\t\treturn ( 2 * p1 - 2 * p2 + v0 + v1 ) * t3 + ( - 3 * p1 + 3 * p2 - 2 * v0 - v1 ) * t2 + v0 * t + p1;\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/extras/SceneUtils.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.SceneUtils = {\r\n\r\n\tcreateMultiMaterialObject: function ( geometry, materials ) {\r\n\r\n\t\tvar group = new THREE.Group();\r\n\r\n\t\tfor ( var i = 0, l = materials.length; i < l; i ++ ) {\r\n\r\n\t\t\tgroup.add( new THREE.Mesh( geometry, materials[ i ] ) );\r\n\r\n\t\t}\r\n\r\n\t\treturn group;\r\n\r\n\t},\r\n\r\n\tdetach: function ( child, parent, scene ) {\r\n\r\n\t\tchild.applyMatrix( parent.matrixWorld );\r\n\t\tparent.remove( child );\r\n\t\tscene.add( child );\r\n\r\n\t},\r\n\r\n\tattach: function ( child, scene, parent ) {\r\n\r\n\t\tvar matrixWorldInverse = new THREE.Matrix4();\r\n\t\tmatrixWorldInverse.getInverse( parent.matrixWorld );\r\n\t\tchild.applyMatrix( matrixWorldInverse );\r\n\r\n\t\tscene.remove( child );\r\n\t\tparent.add( child );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/extras/ShapeUtils.js\r\n\r\n/**\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n */\r\n\r\nTHREE.ShapeUtils = {\r\n\r\n\t// calculate area of the contour polygon\r\n\r\n\tarea: function ( contour ) {\r\n\r\n\t\tvar n = contour.length;\r\n\t\tvar a = 0.0;\r\n\r\n\t\tfor ( var p = n - 1, q = 0; q < n; p = q ++ ) {\r\n\r\n\t\t\ta += contour[ p ].x * contour[ q ].y - contour[ q ].x * contour[ p ].y;\r\n\r\n\t\t}\r\n\r\n\t\treturn a * 0.5;\r\n\r\n\t},\r\n\r\n\ttriangulate: ( function () {\r\n\r\n\t\t/**\r\n\t\t * This code is a quick port of code written in C++ which was submitted to\r\n\t\t * flipcode.com by John W. Ratcliff  // July 22, 2000\r\n\t\t * See original code and more information here:\r\n\t\t * http://www.flipcode.com/archives/Efficient_Polygon_Triangulation.shtml\r\n\t\t *\r\n\t\t * ported to actionscript by Zevan Rosser\r\n\t\t * www.actionsnippet.com\r\n\t\t *\r\n\t\t * ported to javascript by Joshua Koo\r\n\t\t * http://www.lab4games.net/zz85/blog\r\n\t\t *\r\n\t\t */\r\n\r\n\t\tfunction snip( contour, u, v, w, n, verts ) {\r\n\r\n\t\t\tvar p;\r\n\t\t\tvar ax, ay, bx, by;\r\n\t\t\tvar cx, cy, px, py;\r\n\r\n\t\t\tax = contour[ verts[ u ] ].x;\r\n\t\t\tay = contour[ verts[ u ] ].y;\r\n\r\n\t\t\tbx = contour[ verts[ v ] ].x;\r\n\t\t\tby = contour[ verts[ v ] ].y;\r\n\r\n\t\t\tcx = contour[ verts[ w ] ].x;\r\n\t\t\tcy = contour[ verts[ w ] ].y;\r\n\r\n\t\t\tif ( Number.EPSILON > ( ( ( bx - ax ) * ( cy - ay ) ) - ( ( by - ay ) * ( cx - ax ) ) ) ) return false;\r\n\r\n\t\t\tvar aX, aY, bX, bY, cX, cY;\r\n\t\t\tvar apx, apy, bpx, bpy, cpx, cpy;\r\n\t\t\tvar cCROSSap, bCROSScp, aCROSSbp;\r\n\r\n\t\t\taX = cx - bx;  aY = cy - by;\r\n\t\t\tbX = ax - cx;  bY = ay - cy;\r\n\t\t\tcX = bx - ax;  cY = by - ay;\r\n\r\n\t\t\tfor ( p = 0; p < n; p ++ ) {\r\n\r\n\t\t\t\tpx = contour[ verts[ p ] ].x;\r\n\t\t\t\tpy = contour[ verts[ p ] ].y;\r\n\r\n\t\t\t\tif ( ( ( px === ax ) && ( py === ay ) ) ||\r\n\t\t\t\t\t ( ( px === bx ) && ( py === by ) ) ||\r\n\t\t\t\t\t ( ( px === cx ) && ( py === cy ) ) )\tcontinue;\r\n\r\n\t\t\t\tapx = px - ax;  apy = py - ay;\r\n\t\t\t\tbpx = px - bx;  bpy = py - by;\r\n\t\t\t\tcpx = px - cx;  cpy = py - cy;\r\n\r\n\t\t\t\t// see if p is inside triangle abc\r\n\r\n\t\t\t\taCROSSbp = aX * bpy - aY * bpx;\r\n\t\t\t\tcCROSSap = cX * apy - cY * apx;\r\n\t\t\t\tbCROSScp = bX * cpy - bY * cpx;\r\n\r\n\t\t\t\tif ( ( aCROSSbp >= - Number.EPSILON ) && ( bCROSScp >= - Number.EPSILON ) && ( cCROSSap >= - Number.EPSILON ) ) return false;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn true;\r\n\r\n\t\t}\r\n\r\n\t\t// takes in an contour array and returns\r\n\r\n\t\treturn function ( contour, indices ) {\r\n\r\n\t\t\tvar n = contour.length;\r\n\r\n\t\t\tif ( n < 3 ) return null;\r\n\r\n\t\t\tvar result = [],\r\n\t\t\t\tverts = [],\r\n\t\t\t\tvertIndices = [];\r\n\r\n\t\t\t/* we want a counter-clockwise polygon in verts */\r\n\r\n\t\t\tvar u, v, w;\r\n\r\n\t\t\tif ( THREE.ShapeUtils.area( contour ) > 0.0 ) {\r\n\r\n\t\t\t\tfor ( v = 0; v < n; v ++ ) verts[ v ] = v;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tfor ( v = 0; v < n; v ++ ) verts[ v ] = ( n - 1 ) - v;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar nv = n;\r\n\r\n\t\t\t/*  remove nv - 2 vertices, creating 1 triangle every time */\r\n\r\n\t\t\tvar count = 2 * nv;   /* error detection */\r\n\r\n\t\t\tfor ( v = nv - 1; nv > 2; ) {\r\n\r\n\t\t\t\t/* if we loop, it is probably a non-simple polygon */\r\n\r\n\t\t\t\tif ( ( count -- ) <= 0 ) {\r\n\r\n\t\t\t\t\t//** Triangulate: ERROR - probable bad polygon!\r\n\r\n\t\t\t\t\t//throw ( \"Warning, unable to triangulate polygon!\" );\r\n\t\t\t\t\t//return null;\r\n\t\t\t\t\t// Sometimes warning is fine, especially polygons are triangulated in reverse.\r\n\t\t\t\t\tconsole.warn( 'THREE.ShapeUtils: Unable to triangulate polygon! in triangulate()' );\r\n\r\n\t\t\t\t\tif ( indices ) return vertIndices;\r\n\t\t\t\t\treturn result;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t/* three consecutive vertices in current polygon, <u,v,w> */\r\n\r\n\t\t\t\tu = v; \t \tif ( nv <= u ) u = 0;     /* previous */\r\n\t\t\t\tv = u + 1;  if ( nv <= v ) v = 0;     /* new v    */\r\n\t\t\t\tw = v + 1;  if ( nv <= w ) w = 0;     /* next     */\r\n\r\n\t\t\t\tif ( snip( contour, u, v, w, nv, verts ) ) {\r\n\r\n\t\t\t\t\tvar a, b, c, s, t;\r\n\r\n\t\t\t\t\t/* true names of the vertices */\r\n\r\n\t\t\t\t\ta = verts[ u ];\r\n\t\t\t\t\tb = verts[ v ];\r\n\t\t\t\t\tc = verts[ w ];\r\n\r\n\t\t\t\t\t/* output Triangle */\r\n\r\n\t\t\t\t\tresult.push( [ contour[ a ],\r\n\t\t\t\t\t\tcontour[ b ],\r\n\t\t\t\t\t\tcontour[ c ] ] );\r\n\r\n\r\n\t\t\t\t\tvertIndices.push( [ verts[ u ], verts[ v ], verts[ w ] ] );\r\n\r\n\t\t\t\t\t/* remove v from the remaining polygon */\r\n\r\n\t\t\t\t\tfor ( s = v, t = v + 1; t < nv; s ++, t ++ ) {\r\n\r\n\t\t\t\t\t\tverts[ s ] = verts[ t ];\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tnv --;\r\n\r\n\t\t\t\t\t/* reset error detection counter */\r\n\r\n\t\t\t\t\tcount = 2 * nv;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( indices ) return vertIndices;\r\n\t\t\treturn result;\r\n\r\n\t\t}\r\n\r\n\t} )(),\r\n\r\n\ttriangulateShape: function ( contour, holes ) {\r\n\r\n\t\tfunction point_in_segment_2D_colin( inSegPt1, inSegPt2, inOtherPt ) {\r\n\r\n\t\t\t// inOtherPt needs to be collinear to the inSegment\r\n\t\t\tif ( inSegPt1.x !== inSegPt2.x ) {\r\n\r\n\t\t\t\tif ( inSegPt1.x < inSegPt2.x ) {\r\n\r\n\t\t\t\t\treturn\t( ( inSegPt1.x <= inOtherPt.x ) && ( inOtherPt.x <= inSegPt2.x ) );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\treturn\t( ( inSegPt2.x <= inOtherPt.x ) && ( inOtherPt.x <= inSegPt1.x ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tif ( inSegPt1.y < inSegPt2.y ) {\r\n\r\n\t\t\t\t\treturn\t( ( inSegPt1.y <= inOtherPt.y ) && ( inOtherPt.y <= inSegPt2.y ) );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\treturn\t( ( inSegPt2.y <= inOtherPt.y ) && ( inOtherPt.y <= inSegPt1.y ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction intersect_segments_2D( inSeg1Pt1, inSeg1Pt2, inSeg2Pt1, inSeg2Pt2, inExcludeAdjacentSegs ) {\r\n\r\n\t\t\tvar seg1dx = inSeg1Pt2.x - inSeg1Pt1.x,   seg1dy = inSeg1Pt2.y - inSeg1Pt1.y;\r\n\t\t\tvar seg2dx = inSeg2Pt2.x - inSeg2Pt1.x,   seg2dy = inSeg2Pt2.y - inSeg2Pt1.y;\r\n\r\n\t\t\tvar seg1seg2dx = inSeg1Pt1.x - inSeg2Pt1.x;\r\n\t\t\tvar seg1seg2dy = inSeg1Pt1.y - inSeg2Pt1.y;\r\n\r\n\t\t\tvar limit\t\t= seg1dy * seg2dx - seg1dx * seg2dy;\r\n\t\t\tvar perpSeg1\t= seg1dy * seg1seg2dx - seg1dx * seg1seg2dy;\r\n\r\n\t\t\tif ( Math.abs( limit ) > Number.EPSILON ) {\r\n\r\n\t\t\t\t// not parallel\r\n\r\n\t\t\t\tvar perpSeg2;\r\n\t\t\t\tif ( limit > 0 ) {\r\n\r\n\t\t\t\t\tif ( ( perpSeg1 < 0 ) || ( perpSeg1 > limit ) ) \t\treturn [];\r\n\t\t\t\t\tperpSeg2 = seg2dy * seg1seg2dx - seg2dx * seg1seg2dy;\r\n\t\t\t\t\tif ( ( perpSeg2 < 0 ) || ( perpSeg2 > limit ) ) \t\treturn [];\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tif ( ( perpSeg1 > 0 ) || ( perpSeg1 < limit ) ) \t\treturn [];\r\n\t\t\t\t\tperpSeg2 = seg2dy * seg1seg2dx - seg2dx * seg1seg2dy;\r\n\t\t\t\t\tif ( ( perpSeg2 > 0 ) || ( perpSeg2 < limit ) ) \t\treturn [];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// i.e. to reduce rounding errors\r\n\t\t\t\t// intersection at endpoint of segment#1?\r\n\t\t\t\tif ( perpSeg2 === 0 ) {\r\n\r\n\t\t\t\t\tif ( ( inExcludeAdjacentSegs ) &&\r\n\t\t\t\t\t\t ( ( perpSeg1 === 0 ) || ( perpSeg1 === limit ) ) )\t\treturn [];\r\n\t\t\t\t\treturn [ inSeg1Pt1 ];\r\n\r\n\t\t\t\t}\r\n\t\t\t\tif ( perpSeg2 === limit ) {\r\n\r\n\t\t\t\t\tif ( ( inExcludeAdjacentSegs ) &&\r\n\t\t\t\t\t\t ( ( perpSeg1 === 0 ) || ( perpSeg1 === limit ) ) )\t\treturn [];\r\n\t\t\t\t\treturn [ inSeg1Pt2 ];\r\n\r\n\t\t\t\t}\r\n\t\t\t\t// intersection at endpoint of segment#2?\r\n\t\t\t\tif ( perpSeg1 === 0 )\t\treturn [ inSeg2Pt1 ];\r\n\t\t\t\tif ( perpSeg1 === limit )\treturn [ inSeg2Pt2 ];\r\n\r\n\t\t\t\t// return real intersection point\r\n\t\t\t\tvar factorSeg1 = perpSeg2 / limit;\r\n\t\t\t\treturn\t[ { x: inSeg1Pt1.x + factorSeg1 * seg1dx,\r\n\t\t\t\t\t\t\ty: inSeg1Pt1.y + factorSeg1 * seg1dy } ];\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// parallel or collinear\r\n\t\t\t\tif ( ( perpSeg1 !== 0 ) ||\r\n\t\t\t\t\t ( seg2dy * seg1seg2dx !== seg2dx * seg1seg2dy ) ) \t\t\treturn [];\r\n\r\n\t\t\t\t// they are collinear or degenerate\r\n\t\t\t\tvar seg1Pt = ( ( seg1dx === 0 ) && ( seg1dy === 0 ) );\t// segment1 is just a point?\r\n\t\t\t\tvar seg2Pt = ( ( seg2dx === 0 ) && ( seg2dy === 0 ) );\t// segment2 is just a point?\r\n\t\t\t\t// both segments are points\r\n\t\t\t\tif ( seg1Pt && seg2Pt ) {\r\n\r\n\t\t\t\t\tif ( ( inSeg1Pt1.x !== inSeg2Pt1.x ) ||\r\n\t\t\t\t\t\t ( inSeg1Pt1.y !== inSeg2Pt1.y ) )\t\treturn [];\t// they are distinct  points\r\n\t\t\t\t\treturn [ inSeg1Pt1 ];                 \t\t\t\t\t\t// they are the same point\r\n\r\n\t\t\t\t}\r\n\t\t\t\t// segment#1  is a single point\r\n\t\t\t\tif ( seg1Pt ) {\r\n\r\n\t\t\t\t\tif ( ! point_in_segment_2D_colin( inSeg2Pt1, inSeg2Pt2, inSeg1Pt1 ) )\t\treturn [];\t\t// but not in segment#2\r\n\t\t\t\t\treturn [ inSeg1Pt1 ];\r\n\r\n\t\t\t\t}\r\n\t\t\t\t// segment#2  is a single point\r\n\t\t\t\tif ( seg2Pt ) {\r\n\r\n\t\t\t\t\tif ( ! point_in_segment_2D_colin( inSeg1Pt1, inSeg1Pt2, inSeg2Pt1 ) )\t\treturn [];\t\t// but not in segment#1\r\n\t\t\t\t\treturn [ inSeg2Pt1 ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// they are collinear segments, which might overlap\r\n\t\t\t\tvar seg1min, seg1max, seg1minVal, seg1maxVal;\r\n\t\t\t\tvar seg2min, seg2max, seg2minVal, seg2maxVal;\r\n\t\t\t\tif ( seg1dx !== 0 ) {\r\n\r\n\t\t\t\t\t// the segments are NOT on a vertical line\r\n\t\t\t\t\tif ( inSeg1Pt1.x < inSeg1Pt2.x ) {\r\n\r\n\t\t\t\t\t\tseg1min = inSeg1Pt1; seg1minVal = inSeg1Pt1.x;\r\n\t\t\t\t\t\tseg1max = inSeg1Pt2; seg1maxVal = inSeg1Pt2.x;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tseg1min = inSeg1Pt2; seg1minVal = inSeg1Pt2.x;\r\n\t\t\t\t\t\tseg1max = inSeg1Pt1; seg1maxVal = inSeg1Pt1.x;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( inSeg2Pt1.x < inSeg2Pt2.x ) {\r\n\r\n\t\t\t\t\t\tseg2min = inSeg2Pt1; seg2minVal = inSeg2Pt1.x;\r\n\t\t\t\t\t\tseg2max = inSeg2Pt2; seg2maxVal = inSeg2Pt2.x;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tseg2min = inSeg2Pt2; seg2minVal = inSeg2Pt2.x;\r\n\t\t\t\t\t\tseg2max = inSeg2Pt1; seg2maxVal = inSeg2Pt1.x;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t// the segments are on a vertical line\r\n\t\t\t\t\tif ( inSeg1Pt1.y < inSeg1Pt2.y ) {\r\n\r\n\t\t\t\t\t\tseg1min = inSeg1Pt1; seg1minVal = inSeg1Pt1.y;\r\n\t\t\t\t\t\tseg1max = inSeg1Pt2; seg1maxVal = inSeg1Pt2.y;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tseg1min = inSeg1Pt2; seg1minVal = inSeg1Pt2.y;\r\n\t\t\t\t\t\tseg1max = inSeg1Pt1; seg1maxVal = inSeg1Pt1.y;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( inSeg2Pt1.y < inSeg2Pt2.y ) {\r\n\r\n\t\t\t\t\t\tseg2min = inSeg2Pt1; seg2minVal = inSeg2Pt1.y;\r\n\t\t\t\t\t\tseg2max = inSeg2Pt2; seg2maxVal = inSeg2Pt2.y;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tseg2min = inSeg2Pt2; seg2minVal = inSeg2Pt2.y;\r\n\t\t\t\t\t\tseg2max = inSeg2Pt1; seg2maxVal = inSeg2Pt1.y;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t\tif ( seg1minVal <= seg2minVal ) {\r\n\r\n\t\t\t\t\tif ( seg1maxVal <  seg2minVal )\treturn [];\r\n\t\t\t\t\tif ( seg1maxVal === seg2minVal )\t{\r\n\r\n\t\t\t\t\t\tif ( inExcludeAdjacentSegs )\t\treturn [];\r\n\t\t\t\t\t\treturn [ seg2min ];\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( seg1maxVal <= seg2maxVal )\treturn [ seg2min, seg1max ];\r\n\t\t\t\t\treturn\t[ seg2min, seg2max ];\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tif ( seg1minVal >  seg2maxVal )\treturn [];\r\n\t\t\t\t\tif ( seg1minVal === seg2maxVal )\t{\r\n\r\n\t\t\t\t\t\tif ( inExcludeAdjacentSegs )\t\treturn [];\r\n\t\t\t\t\t\treturn [ seg1min ];\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( seg1maxVal <= seg2maxVal )\treturn [ seg1min, seg1max ];\r\n\t\t\t\t\treturn\t[ seg1min, seg2max ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction isPointInsideAngle( inVertex, inLegFromPt, inLegToPt, inOtherPt ) {\r\n\r\n\t\t\t// The order of legs is important\r\n\r\n\t\t\t// translation of all points, so that Vertex is at (0,0)\r\n\t\t\tvar legFromPtX\t= inLegFromPt.x - inVertex.x,  legFromPtY\t= inLegFromPt.y - inVertex.y;\r\n\t\t\tvar legToPtX\t= inLegToPt.x\t- inVertex.x,  legToPtY\t\t= inLegToPt.y\t- inVertex.y;\r\n\t\t\tvar otherPtX\t= inOtherPt.x\t- inVertex.x,  otherPtY\t\t= inOtherPt.y\t- inVertex.y;\r\n\r\n\t\t\t// main angle >0: < 180 deg.; 0: 180 deg.; <0: > 180 deg.\r\n\t\t\tvar from2toAngle\t= legFromPtX * legToPtY - legFromPtY * legToPtX;\r\n\t\t\tvar from2otherAngle\t= legFromPtX * otherPtY - legFromPtY * otherPtX;\r\n\r\n\t\t\tif ( Math.abs( from2toAngle ) > Number.EPSILON ) {\r\n\r\n\t\t\t\t// angle != 180 deg.\r\n\r\n\t\t\t\tvar other2toAngle\t\t= otherPtX * legToPtY - otherPtY * legToPtX;\r\n\t\t\t\t// console.log( \"from2to: \" + from2toAngle + \", from2other: \" + from2otherAngle + \", other2to: \" + other2toAngle );\r\n\r\n\t\t\t\tif ( from2toAngle > 0 ) {\r\n\r\n\t\t\t\t\t// main angle < 180 deg.\r\n\t\t\t\t\treturn\t( ( from2otherAngle >= 0 ) && ( other2toAngle >= 0 ) );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t// main angle > 180 deg.\r\n\t\t\t\t\treturn\t( ( from2otherAngle >= 0 ) || ( other2toAngle >= 0 ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// angle == 180 deg.\r\n\t\t\t\t// console.log( \"from2to: 180 deg., from2other: \" + from2otherAngle  );\r\n\t\t\t\treturn\t( from2otherAngle > 0 );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\r\n\t\tfunction removeHoles( contour, holes ) {\r\n\r\n\t\t\tvar shape = contour.concat(); // work on this shape\r\n\t\t\tvar hole;\r\n\r\n\t\t\tfunction isCutLineInsideAngles( inShapeIdx, inHoleIdx ) {\r\n\r\n\t\t\t\t// Check if hole point lies within angle around shape point\r\n\t\t\t\tvar lastShapeIdx = shape.length - 1;\r\n\r\n\t\t\t\tvar prevShapeIdx = inShapeIdx - 1;\r\n\t\t\t\tif ( prevShapeIdx < 0 )\t\t\tprevShapeIdx = lastShapeIdx;\r\n\r\n\t\t\t\tvar nextShapeIdx = inShapeIdx + 1;\r\n\t\t\t\tif ( nextShapeIdx > lastShapeIdx )\tnextShapeIdx = 0;\r\n\r\n\t\t\t\tvar insideAngle = isPointInsideAngle( shape[ inShapeIdx ], shape[ prevShapeIdx ], shape[ nextShapeIdx ], hole[ inHoleIdx ] );\r\n\t\t\t\tif ( ! insideAngle ) {\r\n\r\n\t\t\t\t\t// console.log( \"Vertex (Shape): \" + inShapeIdx + \", Point: \" + hole[inHoleIdx].x + \"/\" + hole[inHoleIdx].y );\r\n\t\t\t\t\treturn\tfalse;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Check if shape point lies within angle around hole point\r\n\t\t\t\tvar lastHoleIdx = hole.length - 1;\r\n\r\n\t\t\t\tvar prevHoleIdx = inHoleIdx - 1;\r\n\t\t\t\tif ( prevHoleIdx < 0 )\t\t\tprevHoleIdx = lastHoleIdx;\r\n\r\n\t\t\t\tvar nextHoleIdx = inHoleIdx + 1;\r\n\t\t\t\tif ( nextHoleIdx > lastHoleIdx )\tnextHoleIdx = 0;\r\n\r\n\t\t\t\tinsideAngle = isPointInsideAngle( hole[ inHoleIdx ], hole[ prevHoleIdx ], hole[ nextHoleIdx ], shape[ inShapeIdx ] );\r\n\t\t\t\tif ( ! insideAngle ) {\r\n\r\n\t\t\t\t\t// console.log( \"Vertex (Hole): \" + inHoleIdx + \", Point: \" + shape[inShapeIdx].x + \"/\" + shape[inShapeIdx].y );\r\n\t\t\t\t\treturn\tfalse;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn\ttrue;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfunction intersectsShapeEdge( inShapePt, inHolePt ) {\r\n\r\n\t\t\t\t// checks for intersections with shape edges\r\n\t\t\t\tvar sIdx, nextIdx, intersection;\r\n\t\t\t\tfor ( sIdx = 0; sIdx < shape.length; sIdx ++ ) {\r\n\r\n\t\t\t\t\tnextIdx = sIdx + 1; nextIdx %= shape.length;\r\n\t\t\t\t\tintersection = intersect_segments_2D( inShapePt, inHolePt, shape[ sIdx ], shape[ nextIdx ], true );\r\n\t\t\t\t\tif ( intersection.length > 0 )\t\treturn\ttrue;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn\tfalse;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar indepHoles = [];\r\n\r\n\t\t\tfunction intersectsHoleEdge( inShapePt, inHolePt ) {\r\n\r\n\t\t\t\t// checks for intersections with hole edges\r\n\t\t\t\tvar ihIdx, chkHole,\r\n\t\t\t\t\thIdx, nextIdx, intersection;\r\n\t\t\t\tfor ( ihIdx = 0; ihIdx < indepHoles.length; ihIdx ++ ) {\r\n\r\n\t\t\t\t\tchkHole = holes[ indepHoles[ ihIdx ]];\r\n\t\t\t\t\tfor ( hIdx = 0; hIdx < chkHole.length; hIdx ++ ) {\r\n\r\n\t\t\t\t\t\tnextIdx = hIdx + 1; nextIdx %= chkHole.length;\r\n\t\t\t\t\t\tintersection = intersect_segments_2D( inShapePt, inHolePt, chkHole[ hIdx ], chkHole[ nextIdx ], true );\r\n\t\t\t\t\t\tif ( intersection.length > 0 )\t\treturn\ttrue;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t\treturn\tfalse;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar holeIndex, shapeIndex,\r\n\t\t\t\tshapePt, holePt,\r\n\t\t\t\tholeIdx, cutKey, failedCuts = [],\r\n\t\t\t\ttmpShape1, tmpShape2,\r\n\t\t\t\ttmpHole1, tmpHole2;\r\n\r\n\t\t\tfor ( var h = 0, hl = holes.length; h < hl; h ++ ) {\r\n\r\n\t\t\t\tindepHoles.push( h );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar minShapeIndex = 0;\r\n\t\t\tvar counter = indepHoles.length * 2;\r\n\t\t\twhile ( indepHoles.length > 0 ) {\r\n\r\n\t\t\t\tcounter --;\r\n\t\t\t\tif ( counter < 0 ) {\r\n\r\n\t\t\t\t\tconsole.log( \"Infinite Loop! Holes left:\" + indepHoles.length + \", Probably Hole outside Shape!\" );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// search for shape-vertex and hole-vertex,\r\n\t\t\t\t// which can be connected without intersections\r\n\t\t\t\tfor ( shapeIndex = minShapeIndex; shapeIndex < shape.length; shapeIndex ++ ) {\r\n\r\n\t\t\t\t\tshapePt = shape[ shapeIndex ];\r\n\t\t\t\t\tholeIndex\t= - 1;\r\n\r\n\t\t\t\t\t// search for hole which can be reached without intersections\r\n\t\t\t\t\tfor ( var h = 0; h < indepHoles.length; h ++ ) {\r\n\r\n\t\t\t\t\t\tholeIdx = indepHoles[ h ];\r\n\r\n\t\t\t\t\t\t// prevent multiple checks\r\n\t\t\t\t\t\tcutKey = shapePt.x + \":\" + shapePt.y + \":\" + holeIdx;\r\n\t\t\t\t\t\tif ( failedCuts[ cutKey ] !== undefined )\t\t\tcontinue;\r\n\r\n\t\t\t\t\t\thole = holes[ holeIdx ];\r\n\t\t\t\t\t\tfor ( var h2 = 0; h2 < hole.length; h2 ++ ) {\r\n\r\n\t\t\t\t\t\t\tholePt = hole[ h2 ];\r\n\t\t\t\t\t\t\tif ( ! isCutLineInsideAngles( shapeIndex, h2 ) )\t\tcontinue;\r\n\t\t\t\t\t\t\tif ( intersectsShapeEdge( shapePt, holePt ) )\t\tcontinue;\r\n\t\t\t\t\t\t\tif ( intersectsHoleEdge( shapePt, holePt ) )\t\tcontinue;\r\n\r\n\t\t\t\t\t\t\tholeIndex = h2;\r\n\t\t\t\t\t\t\tindepHoles.splice( h, 1 );\r\n\r\n\t\t\t\t\t\t\ttmpShape1 = shape.slice( 0, shapeIndex + 1 );\r\n\t\t\t\t\t\t\ttmpShape2 = shape.slice( shapeIndex );\r\n\t\t\t\t\t\t\ttmpHole1 = hole.slice( holeIndex );\r\n\t\t\t\t\t\t\ttmpHole2 = hole.slice( 0, holeIndex + 1 );\r\n\r\n\t\t\t\t\t\t\tshape = tmpShape1.concat( tmpHole1 ).concat( tmpHole2 ).concat( tmpShape2 );\r\n\r\n\t\t\t\t\t\t\tminShapeIndex = shapeIndex;\r\n\r\n\t\t\t\t\t\t\t// Debug only, to show the selected cuts\r\n\t\t\t\t\t\t\t// glob_CutLines.push( [ shapePt, holePt ] );\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif ( holeIndex >= 0 )\tbreak;\t\t// hole-vertex found\r\n\r\n\t\t\t\t\t\tfailedCuts[ cutKey ] = true;\t\t\t// remember failure\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( holeIndex >= 0 )\tbreak;\t\t// hole-vertex found\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn shape; \t\t\t/* shape with no holes */\r\n\r\n\t\t}\r\n\r\n\r\n\t\tvar i, il, f, face,\r\n\t\t\tkey, index,\r\n\t\t\tallPointsMap = {};\r\n\r\n\t\t// To maintain reference to old shape, one must match coordinates, or offset the indices from original arrays. It's probably easier to do the first.\r\n\r\n\t\tvar allpoints = contour.concat();\r\n\r\n\t\tfor ( var h = 0, hl = holes.length; h < hl; h ++ ) {\r\n\r\n\t\t\tArray.prototype.push.apply( allpoints, holes[ h ] );\r\n\r\n\t\t}\r\n\r\n\t\t//console.log( \"allpoints\",allpoints, allpoints.length );\r\n\r\n\t\t// prepare all points map\r\n\r\n\t\tfor ( i = 0, il = allpoints.length; i < il; i ++ ) {\r\n\r\n\t\t\tkey = allpoints[ i ].x + \":\" + allpoints[ i ].y;\r\n\r\n\t\t\tif ( allPointsMap[ key ] !== undefined ) {\r\n\r\n\t\t\t\tconsole.warn( \"THREE.Shape: Duplicate point\", key );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tallPointsMap[ key ] = i;\r\n\r\n\t\t}\r\n\r\n\t\t// remove holes by cutting paths to holes and adding them to the shape\r\n\t\tvar shapeWithoutHoles = removeHoles( contour, holes );\r\n\r\n\t\tvar triangles = THREE.ShapeUtils.triangulate( shapeWithoutHoles, false ); // True returns indices for points of spooled shape\r\n\t\t//console.log( \"triangles\",triangles, triangles.length );\r\n\r\n\t\t// check all face vertices against all points map\r\n\r\n\t\tfor ( i = 0, il = triangles.length; i < il; i ++ ) {\r\n\r\n\t\t\tface = triangles[ i ];\r\n\r\n\t\t\tfor ( f = 0; f < 3; f ++ ) {\r\n\r\n\t\t\t\tkey = face[ f ].x + \":\" + face[ f ].y;\r\n\r\n\t\t\t\tindex = allPointsMap[ key ];\r\n\r\n\t\t\t\tif ( index !== undefined ) {\r\n\r\n\t\t\t\t\tface[ f ] = index;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn triangles.concat();\r\n\r\n\t},\r\n\r\n\tisClockWise: function ( pts ) {\r\n\r\n\t\treturn THREE.ShapeUtils.area( pts ) < 0;\r\n\r\n\t},\r\n\r\n\t// Bezier Curves formulas obtained from\r\n\t// http://en.wikipedia.org/wiki/B%C3%A9zier_curve\r\n\r\n\t// Quad Bezier Functions\r\n\r\n\tb2: ( function () {\r\n\r\n\t\tfunction b2p0( t, p ) {\r\n\r\n\t\t\tvar k = 1 - t;\r\n\t\t\treturn k * k * p;\r\n\r\n\t\t}\r\n\r\n\t\tfunction b2p1( t, p ) {\r\n\r\n\t\t\treturn 2 * ( 1 - t ) * t * p;\r\n\r\n\t\t}\r\n\r\n\t\tfunction b2p2( t, p ) {\r\n\r\n\t\t\treturn t * t * p;\r\n\r\n\t\t}\r\n\r\n\t\treturn function ( t, p0, p1, p2 ) {\r\n\r\n\t\t\treturn b2p0( t, p0 ) + b2p1( t, p1 ) + b2p2( t, p2 );\r\n\r\n\t\t};\r\n\r\n\t} )(),\r\n\r\n\t// Cubic Bezier Functions\r\n\r\n\tb3: ( function () {\r\n\r\n\t\tfunction b3p0( t, p ) {\r\n\r\n\t\t\tvar k = 1 - t;\r\n\t\t\treturn k * k * k * p;\r\n\r\n\t\t}\r\n\r\n\t\tfunction b3p1( t, p ) {\r\n\r\n\t\t\tvar k = 1 - t;\r\n\t\t\treturn 3 * k * k * t * p;\r\n\r\n\t\t}\r\n\r\n\t\tfunction b3p2( t, p ) {\r\n\r\n\t\t\tvar k = 1 - t;\r\n\t\t\treturn 3 * k * t * t * p;\r\n\r\n\t\t}\r\n\r\n\t\tfunction b3p3( t, p ) {\r\n\r\n\t\t\treturn t * t * t * p;\r\n\r\n\t\t}\r\n\r\n\t\treturn function ( t, p0, p1, p2, p3 ) {\r\n\r\n\t\t\treturn b3p0( t, p0 ) + b3p1( t, p1 ) + b3p2( t, p2 ) + b3p3( t, p3 );\r\n\r\n\t\t};\r\n\r\n\t} )()\r\n\r\n};\r\n\r\n// File:src/extras/core/Curve.js\r\n\r\n/**\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n * Extensible curve object\r\n *\r\n * Some common of Curve methods\r\n * .getPoint(t), getTangent(t)\r\n * .getPointAt(u), getTagentAt(u)\r\n * .getPoints(), .getSpacedPoints()\r\n * .getLength()\r\n * .updateArcLengths()\r\n *\r\n * This following classes subclasses THREE.Curve:\r\n *\r\n * -- 2d classes --\r\n * THREE.LineCurve\r\n * THREE.QuadraticBezierCurve\r\n * THREE.CubicBezierCurve\r\n * THREE.SplineCurve\r\n * THREE.ArcCurve\r\n * THREE.EllipseCurve\r\n *\r\n * -- 3d classes --\r\n * THREE.LineCurve3\r\n * THREE.QuadraticBezierCurve3\r\n * THREE.CubicBezierCurve3\r\n * THREE.SplineCurve3\r\n *\r\n * A series of curves can be represented as a THREE.CurvePath\r\n *\r\n **/\r\n\r\n/**************************************************************\r\n *\tAbstract Curve base class\r\n **************************************************************/\r\n\r\nTHREE.Curve = function () {\r\n\r\n};\r\n\r\nTHREE.Curve.prototype = {\r\n\r\n\tconstructor: THREE.Curve,\r\n\r\n\t// Virtual base class method to overwrite and implement in subclasses\r\n\t//\t- t [0 .. 1]\r\n\r\n\tgetPoint: function ( t ) {\r\n\r\n\t\tconsole.warn( \"THREE.Curve: Warning, getPoint() not implemented!\" );\r\n\t\treturn null;\r\n\r\n\t},\r\n\r\n\t// Get point at relative position in curve according to arc length\r\n\t// - u [0 .. 1]\r\n\r\n\tgetPointAt: function ( u ) {\r\n\r\n\t\tvar t = this.getUtoTmapping( u );\r\n\t\treturn this.getPoint( t );\r\n\r\n\t},\r\n\r\n\t// Get sequence of points using getPoint( t )\r\n\r\n\tgetPoints: function ( divisions ) {\r\n\r\n\t\tif ( ! divisions ) divisions = 5;\r\n\r\n\t\tvar d, pts = [];\r\n\r\n\t\tfor ( d = 0; d <= divisions; d ++ ) {\r\n\r\n\t\t\tpts.push( this.getPoint( d / divisions ) );\r\n\r\n\t\t}\r\n\r\n\t\treturn pts;\r\n\r\n\t},\r\n\r\n\t// Get sequence of points using getPointAt( u )\r\n\r\n\tgetSpacedPoints: function ( divisions ) {\r\n\r\n\t\tif ( ! divisions ) divisions = 5;\r\n\r\n\t\tvar d, pts = [];\r\n\r\n\t\tfor ( d = 0; d <= divisions; d ++ ) {\r\n\r\n\t\t\tpts.push( this.getPointAt( d / divisions ) );\r\n\r\n\t\t}\r\n\r\n\t\treturn pts;\r\n\r\n\t},\r\n\r\n\t// Get total curve arc length\r\n\r\n\tgetLength: function () {\r\n\r\n\t\tvar lengths = this.getLengths();\r\n\t\treturn lengths[ lengths.length - 1 ];\r\n\r\n\t},\r\n\r\n\t// Get list of cumulative segment lengths\r\n\r\n\tgetLengths: function ( divisions ) {\r\n\r\n\t\tif ( ! divisions ) divisions = ( this.__arcLengthDivisions ) ? ( this.__arcLengthDivisions ) : 200;\r\n\r\n\t\tif ( this.cacheArcLengths\r\n\t\t\t&& ( this.cacheArcLengths.length === divisions + 1 )\r\n\t\t\t&& ! this.needsUpdate ) {\r\n\r\n\t\t\t//console.log( \"cached\", this.cacheArcLengths );\r\n\t\t\treturn this.cacheArcLengths;\r\n\r\n\t\t}\r\n\r\n\t\tthis.needsUpdate = false;\r\n\r\n\t\tvar cache = [];\r\n\t\tvar current, last = this.getPoint( 0 );\r\n\t\tvar p, sum = 0;\r\n\r\n\t\tcache.push( 0 );\r\n\r\n\t\tfor ( p = 1; p <= divisions; p ++ ) {\r\n\r\n\t\t\tcurrent = this.getPoint ( p / divisions );\r\n\t\t\tsum += current.distanceTo( last );\r\n\t\t\tcache.push( sum );\r\n\t\t\tlast = current;\r\n\r\n\t\t}\r\n\r\n\t\tthis.cacheArcLengths = cache;\r\n\r\n\t\treturn cache; // { sums: cache, sum:sum }; Sum is in the last element.\r\n\r\n\t},\r\n\r\n\tupdateArcLengths: function() {\r\n\r\n\t\tthis.needsUpdate = true;\r\n\t\tthis.getLengths();\r\n\r\n\t},\r\n\r\n\t// Given u ( 0 .. 1 ), get a t to find p. This gives you points which are equidistant\r\n\r\n\tgetUtoTmapping: function ( u, distance ) {\r\n\r\n\t\tvar arcLengths = this.getLengths();\r\n\r\n\t\tvar i = 0, il = arcLengths.length;\r\n\r\n\t\tvar targetArcLength; // The targeted u distance value to get\r\n\r\n\t\tif ( distance ) {\r\n\r\n\t\t\ttargetArcLength = distance;\r\n\r\n\t\t} else {\r\n\r\n\t\t\ttargetArcLength = u * arcLengths[ il - 1 ];\r\n\r\n\t\t}\r\n\r\n\t\t//var time = Date.now();\r\n\r\n\t\t// binary search for the index with largest value smaller than target u distance\r\n\r\n\t\tvar low = 0, high = il - 1, comparison;\r\n\r\n\t\twhile ( low <= high ) {\r\n\r\n\t\t\ti = Math.floor( low + ( high - low ) / 2 ); // less likely to overflow, though probably not issue here, JS doesn't really have integers, all numbers are floats\r\n\r\n\t\t\tcomparison = arcLengths[ i ] - targetArcLength;\r\n\r\n\t\t\tif ( comparison < 0 ) {\r\n\r\n\t\t\t\tlow = i + 1;\r\n\r\n\t\t\t} else if ( comparison > 0 ) {\r\n\r\n\t\t\t\thigh = i - 1;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\thigh = i;\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\t// DONE\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\ti = high;\r\n\r\n\t\t//console.log('b' , i, low, high, Date.now()- time);\r\n\r\n\t\tif ( arcLengths[ i ] === targetArcLength ) {\r\n\r\n\t\t\tvar t = i / ( il - 1 );\r\n\t\t\treturn t;\r\n\r\n\t\t}\r\n\r\n\t\t// we could get finer grain at lengths, or use simple interpolation between two points\r\n\r\n\t\tvar lengthBefore = arcLengths[ i ];\r\n\t\tvar lengthAfter = arcLengths[ i + 1 ];\r\n\r\n\t\tvar segmentLength = lengthAfter - lengthBefore;\r\n\r\n\t\t// determine where we are between the 'before' and 'after' points\r\n\r\n\t\tvar segmentFraction = ( targetArcLength - lengthBefore ) / segmentLength;\r\n\r\n\t\t// add that fractional amount to t\r\n\r\n\t\tvar t = ( i + segmentFraction ) / ( il - 1 );\r\n\r\n\t\treturn t;\r\n\r\n\t},\r\n\r\n\t// Returns a unit vector tangent at t\r\n\t// In case any sub curve does not implement its tangent derivation,\r\n\t// 2 points a small delta apart will be used to find its gradient\r\n\t// which seems to give a reasonable approximation\r\n\r\n\tgetTangent: function( t ) {\r\n\r\n\t\tvar delta = 0.0001;\r\n\t\tvar t1 = t - delta;\r\n\t\tvar t2 = t + delta;\r\n\r\n\t\t// Capping in case of danger\r\n\r\n\t\tif ( t1 < 0 ) t1 = 0;\r\n\t\tif ( t2 > 1 ) t2 = 1;\r\n\r\n\t\tvar pt1 = this.getPoint( t1 );\r\n\t\tvar pt2 = this.getPoint( t2 );\r\n\r\n\t\tvar vec = pt2.clone().sub( pt1 );\r\n\t\treturn vec.normalize();\r\n\r\n\t},\r\n\r\n\tgetTangentAt: function ( u ) {\r\n\r\n\t\tvar t = this.getUtoTmapping( u );\r\n\t\treturn this.getTangent( t );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// TODO: Transformation for Curves?\r\n\r\n/**************************************************************\r\n *\t3D Curves\r\n **************************************************************/\r\n\r\n// A Factory method for creating new curve subclasses\r\n\r\nTHREE.Curve.create = function ( constructor, getPointFunc ) {\r\n\r\n\tconstructor.prototype = Object.create( THREE.Curve.prototype );\r\n\tconstructor.prototype.constructor = constructor;\r\n\tconstructor.prototype.getPoint = getPointFunc;\r\n\r\n\treturn constructor;\r\n\r\n};\r\n\r\n// File:src/extras/core/CurvePath.js\r\n\r\n/**\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n *\r\n **/\r\n\r\n/**************************************************************\r\n *\tCurved Path - a curve path is simply a array of connected\r\n *  curves, but retains the api of a curve\r\n **************************************************************/\r\n\r\nTHREE.CurvePath = function () {\r\n\r\n\tthis.curves = [];\r\n\r\n\tthis.autoClose = false; // Automatically closes the path\r\n\r\n};\r\n\r\nTHREE.CurvePath.prototype = Object.assign( Object.create( THREE.Curve.prototype ), {\r\n\r\n\tconstructor: THREE.CurvePath,\r\n\r\n\tadd: function ( curve ) {\r\n\r\n\t\tthis.curves.push( curve );\r\n\r\n\t},\r\n\r\n\tclosePath: function () {\r\n\r\n\t\t// TODO Test\r\n\t\t// and verify for vector3 (needs to implement equals)\r\n\t\t// Add a line curve if start and end of lines are not connected\r\n\t\tvar startPoint = this.curves[ 0 ].getPoint( 0 );\r\n\t\tvar endPoint = this.curves[ this.curves.length - 1 ].getPoint( 1 );\r\n\r\n\t\tif ( ! startPoint.equals( endPoint ) ) {\r\n\r\n\t\t\tthis.curves.push( new THREE.LineCurve( endPoint, startPoint ) );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\t// To get accurate point with reference to\r\n\t// entire path distance at time t,\r\n\t// following has to be done:\r\n\r\n\t// 1. Length of each sub path have to be known\r\n\t// 2. Locate and identify type of curve\r\n\t// 3. Get t for the curve\r\n\t// 4. Return curve.getPointAt(t')\r\n\r\n\tgetPoint: function ( t ) {\r\n\r\n\t\tvar d = t * this.getLength();\r\n\t\tvar curveLengths = this.getCurveLengths();\r\n\t\tvar i = 0;\r\n\r\n\t\t// To think about boundaries points.\r\n\r\n\t\twhile ( i < curveLengths.length ) {\r\n\r\n\t\t\tif ( curveLengths[ i ] >= d ) {\r\n\r\n\t\t\t\tvar diff = curveLengths[ i ] - d;\r\n\t\t\t\tvar curve = this.curves[ i ];\r\n\r\n\t\t\t\tvar u = 1 - diff / curve.getLength();\r\n\r\n\t\t\t\treturn curve.getPointAt( u );\r\n\r\n\t\t\t}\r\n\r\n\t\t\ti ++;\r\n\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\r\n\t\t// loop where sum != 0, sum > d , sum+1 <d\r\n\r\n\t},\r\n\r\n\t// We cannot use the default THREE.Curve getPoint() with getLength() because in\r\n\t// THREE.Curve, getLength() depends on getPoint() but in THREE.CurvePath\r\n\t// getPoint() depends on getLength\r\n\r\n\tgetLength: function () {\r\n\r\n\t\tvar lens = this.getCurveLengths();\r\n\t\treturn lens[ lens.length - 1 ];\r\n\r\n\t},\r\n\r\n\t// Compute lengths and cache them\r\n\t// We cannot overwrite getLengths() because UtoT mapping uses it.\r\n\r\n\tgetCurveLengths: function () {\r\n\r\n\t\t// We use cache values if curves and cache array are same length\r\n\r\n\t\tif ( this.cacheLengths && this.cacheLengths.length === this.curves.length ) {\r\n\r\n\t\t\treturn this.cacheLengths;\r\n\r\n\t\t}\r\n\r\n\t\t// Get length of sub-curve\r\n\t\t// Push sums into cached array\r\n\r\n\t\tvar lengths = [], sums = 0;\r\n\r\n\t\tfor ( var i = 0, l = this.curves.length; i < l; i ++ ) {\r\n\r\n\t\t\tsums += this.curves[ i ].getLength();\r\n\t\t\tlengths.push( sums );\r\n\r\n\t\t}\r\n\r\n\t\tthis.cacheLengths = lengths;\r\n\r\n\t\treturn lengths;\r\n\r\n\t},\r\n\r\n\t/**************************************************************\r\n\t *\tCreate Geometries Helpers\r\n\t **************************************************************/\r\n\r\n\t/// Generate geometry from path points (for Line or Points objects)\r\n\r\n\tcreatePointsGeometry: function ( divisions ) {\r\n\r\n\t\tvar pts = this.getPoints( divisions );\r\n\t\treturn this.createGeometry( pts );\r\n\r\n\t},\r\n\r\n\t// Generate geometry from equidistant sampling along the path\r\n\r\n\tcreateSpacedPointsGeometry: function ( divisions ) {\r\n\r\n\t\tvar pts = this.getSpacedPoints( divisions );\r\n\t\treturn this.createGeometry( pts );\r\n\r\n\t},\r\n\r\n\tcreateGeometry: function ( points ) {\r\n\r\n\t\tvar geometry = new THREE.Geometry();\r\n\r\n\t\tfor ( var i = 0, l = points.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar point = points[ i ];\r\n\t\t\tgeometry.vertices.push( new THREE.Vector3( point.x, point.y, point.z || 0 ) );\r\n\r\n\t\t}\r\n\r\n\t\treturn geometry;\r\n\r\n\t}\r\n\r\n} );\r\n\r\n// File:src/extras/core/Font.js\r\n\r\n/**\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.Font = function ( data ) {\r\n\r\n\tthis.data = data;\r\n\r\n};\r\n\r\nObject.assign( THREE.Font.prototype, {\r\n\r\n\tgenerateShapes: function ( text, size, divisions ) {\r\n\r\n\t\tfunction createPaths( text ) {\r\n\r\n\t\t\tvar chars = String( text ).split( '' );\r\n\t\t\tvar scale = size / data.resolution;\r\n\t\t\tvar offset = 0;\r\n\r\n\t\t\tvar paths = [];\r\n\r\n\t\t\tfor ( var i = 0; i < chars.length; i ++ ) {\r\n\r\n\t\t\t\tvar ret = createPath( chars[ i ], scale, offset );\r\n\t\t\t\toffset += ret.offset;\r\n\r\n\t\t\t\tpaths.push( ret.path );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn paths;\r\n\r\n\t\t}\r\n\r\n\t\tfunction createPath( c, scale, offset ) {\r\n\r\n\t\t\tvar glyph = data.glyphs[ c ] || data.glyphs[ '?' ];\r\n\r\n\t\t\tif ( ! glyph ) return;\r\n\r\n\t\t\tvar path = new THREE.Path();\r\n\r\n\t\t\tvar pts = [], b2 = THREE.ShapeUtils.b2, b3 = THREE.ShapeUtils.b3;\r\n\t\t\tvar x, y, cpx, cpy, cpx0, cpy0, cpx1, cpy1, cpx2, cpy2, laste;\r\n\r\n\t\t\tif ( glyph.o ) {\r\n\r\n\t\t\t\tvar outline = glyph._cachedOutline || ( glyph._cachedOutline = glyph.o.split( ' ' ) );\r\n\r\n\t\t\t\tfor ( var i = 0, l = outline.length; i < l; ) {\r\n\r\n\t\t\t\t\tvar action = outline[ i ++ ];\r\n\r\n\t\t\t\t\tswitch ( action ) {\r\n\r\n\t\t\t\t\t\tcase 'm': // moveTo\r\n\r\n\t\t\t\t\t\t\tx = outline[ i ++ ] * scale + offset;\r\n\t\t\t\t\t\t\ty = outline[ i ++ ] * scale;\r\n\r\n\t\t\t\t\t\t\tpath.moveTo( x, y );\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'l': // lineTo\r\n\r\n\t\t\t\t\t\t\tx = outline[ i ++ ] * scale + offset;\r\n\t\t\t\t\t\t\ty = outline[ i ++ ] * scale;\r\n\r\n\t\t\t\t\t\t\tpath.lineTo( x, y );\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'q': // quadraticCurveTo\r\n\r\n\t\t\t\t\t\t\tcpx  = outline[ i ++ ] * scale + offset;\r\n\t\t\t\t\t\t\tcpy  = outline[ i ++ ] * scale;\r\n\t\t\t\t\t\t\tcpx1 = outline[ i ++ ] * scale + offset;\r\n\t\t\t\t\t\t\tcpy1 = outline[ i ++ ] * scale;\r\n\r\n\t\t\t\t\t\t\tpath.quadraticCurveTo( cpx1, cpy1, cpx, cpy );\r\n\r\n\t\t\t\t\t\t\tlaste = pts[ pts.length - 1 ];\r\n\r\n\t\t\t\t\t\t\tif ( laste ) {\r\n\r\n\t\t\t\t\t\t\t\tcpx0 = laste.x;\r\n\t\t\t\t\t\t\t\tcpy0 = laste.y;\r\n\r\n\t\t\t\t\t\t\t\tfor ( var i2 = 1; i2 <= divisions; i2 ++ ) {\r\n\r\n\t\t\t\t\t\t\t\t\tvar t = i2 / divisions;\r\n\t\t\t\t\t\t\t\t\tb2( t, cpx0, cpx1, cpx );\r\n\t\t\t\t\t\t\t\t\tb2( t, cpy0, cpy1, cpy );\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'b': // bezierCurveTo\r\n\r\n\t\t\t\t\t\t\tcpx  = outline[ i ++ ] * scale + offset;\r\n\t\t\t\t\t\t\tcpy  = outline[ i ++ ] * scale;\r\n\t\t\t\t\t\t\tcpx1 = outline[ i ++ ] * scale + offset;\r\n\t\t\t\t\t\t\tcpy1 = outline[ i ++ ] * scale;\r\n\t\t\t\t\t\t\tcpx2 = outline[ i ++ ] * scale + offset;\r\n\t\t\t\t\t\t\tcpy2 = outline[ i ++ ] * scale;\r\n\r\n\t\t\t\t\t\t\tpath.bezierCurveTo( cpx1, cpy1, cpx2, cpy2, cpx, cpy );\r\n\r\n\t\t\t\t\t\t\tlaste = pts[ pts.length - 1 ];\r\n\r\n\t\t\t\t\t\t\tif ( laste ) {\r\n\r\n\t\t\t\t\t\t\t\tcpx0 = laste.x;\r\n\t\t\t\t\t\t\t\tcpy0 = laste.y;\r\n\r\n\t\t\t\t\t\t\t\tfor ( var i2 = 1; i2 <= divisions; i2 ++ ) {\r\n\r\n\t\t\t\t\t\t\t\t\tvar t = i2 / divisions;\r\n\t\t\t\t\t\t\t\t\tb3( t, cpx0, cpx1, cpx2, cpx );\r\n\t\t\t\t\t\t\t\t\tb3( t, cpy0, cpy1, cpy2, cpy );\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn { offset: glyph.ha * scale, path: path };\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tif ( size === undefined ) size = 100;\r\n\t\tif ( divisions === undefined ) divisions = 4;\r\n\r\n\t\tvar data = this.data;\r\n\r\n\t\tvar paths = createPaths( text );\r\n\t\tvar shapes = [];\r\n\r\n\t\tfor ( var p = 0, pl = paths.length; p < pl; p ++ ) {\r\n\r\n\t\t\tArray.prototype.push.apply( shapes, paths[ p ].toShapes() );\r\n\r\n\t\t}\r\n\r\n\t\treturn shapes;\r\n\r\n\t}\r\n\r\n} );\r\n\r\n// File:src/extras/core/Path.js\r\n\r\n/**\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n * Creates free form 2d path using series of points, lines or curves.\r\n *\r\n **/\r\n\r\nTHREE.Path = function ( points ) {\r\n\r\n\tTHREE.CurvePath.call( this );\r\n\r\n\tthis.actions = [];\r\n\r\n\tif ( points ) {\r\n\r\n\t\tthis.fromPoints( points );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.Path.prototype = Object.assign( Object.create( THREE.CurvePath.prototype ), {\r\n\r\n\tconstructor: THREE.Path,\r\n\r\n\t// TODO Clean up PATH API\r\n\r\n\t// Create path using straight lines to connect all points\r\n\t// - vectors: array of Vector2\r\n\r\n\tfromPoints: function ( vectors ) {\r\n\r\n\t\tthis.moveTo( vectors[ 0 ].x, vectors[ 0 ].y );\r\n\r\n\t\tfor ( var i = 1, l = vectors.length; i < l; i ++ ) {\r\n\r\n\t\t\tthis.lineTo( vectors[ i ].x, vectors[ i ].y );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tmoveTo: function ( x, y ) {\r\n\r\n\t\tthis.actions.push( { action: 'moveTo', args: [ x, y ] } );\r\n\r\n\t},\r\n\r\n\tlineTo: function ( x, y ) {\r\n\r\n\t\tvar lastargs = this.actions[ this.actions.length - 1 ].args;\r\n\r\n\t\tvar x0 = lastargs[ lastargs.length - 2 ];\r\n\t\tvar y0 = lastargs[ lastargs.length - 1 ];\r\n\r\n\t\tvar curve = new THREE.LineCurve( new THREE.Vector2( x0, y0 ), new THREE.Vector2( x, y ) );\r\n\t\tthis.curves.push( curve );\r\n\r\n\t\tthis.actions.push( { action: 'lineTo', args: [ x, y ] } );\r\n\r\n\t},\r\n\r\n\tquadraticCurveTo: function ( aCPx, aCPy, aX, aY ) {\r\n\r\n\t\tvar lastargs = this.actions[ this.actions.length - 1 ].args;\r\n\r\n\t\tvar x0 = lastargs[ lastargs.length - 2 ];\r\n\t\tvar y0 = lastargs[ lastargs.length - 1 ];\r\n\r\n\t\tvar curve = new THREE.QuadraticBezierCurve(\r\n\t\t\tnew THREE.Vector2( x0, y0 ),\r\n\t\t\tnew THREE.Vector2( aCPx, aCPy ),\r\n\t\t\tnew THREE.Vector2( aX, aY )\r\n\t\t);\r\n\r\n\t\tthis.curves.push( curve );\r\n\r\n\t\tthis.actions.push( { action: 'quadraticCurveTo', args: [ aCPx, aCPy, aX, aY ] } );\r\n\r\n\t},\r\n\r\n\tbezierCurveTo: function ( aCP1x, aCP1y, aCP2x, aCP2y, aX, aY ) {\r\n\r\n\t\tvar lastargs = this.actions[ this.actions.length - 1 ].args;\r\n\r\n\t\tvar x0 = lastargs[ lastargs.length - 2 ];\r\n\t\tvar y0 = lastargs[ lastargs.length - 1 ];\r\n\r\n\t\tvar curve = new THREE.CubicBezierCurve(\r\n\t\t\tnew THREE.Vector2( x0, y0 ),\r\n\t\t\tnew THREE.Vector2( aCP1x, aCP1y ),\r\n\t\t\tnew THREE.Vector2( aCP2x, aCP2y ),\r\n\t\t\tnew THREE.Vector2( aX, aY )\r\n\t\t);\r\n\r\n\t\tthis.curves.push( curve );\r\n\r\n\t\tthis.actions.push( { action: 'bezierCurveTo', args: [ aCP1x, aCP1y, aCP2x, aCP2y, aX, aY ] } );\r\n\r\n\t},\r\n\r\n\tsplineThru: function ( pts /*Array of Vector*/ ) {\r\n\r\n\t\tvar args = Array.prototype.slice.call( arguments );\r\n\r\n\t\tvar lastargs = this.actions[ this.actions.length - 1 ].args;\r\n\r\n\t\tvar x0 = lastargs[ lastargs.length - 2 ];\r\n\t\tvar y0 = lastargs[ lastargs.length - 1 ];\r\n\r\n\t\tvar npts = [ new THREE.Vector2( x0, y0 ) ];\r\n\t\tArray.prototype.push.apply( npts, pts );\r\n\r\n\t\tvar curve = new THREE.SplineCurve( npts );\r\n\t\tthis.curves.push( curve );\r\n\r\n\t\tthis.actions.push( { action: 'splineThru', args: args } );\r\n\r\n\t},\r\n\r\n\tarc: function ( aX, aY, aRadius, aStartAngle, aEndAngle, aClockwise ) {\r\n\r\n\t\tvar lastargs = this.actions[ this.actions.length - 1 ].args;\r\n\t\tvar x0 = lastargs[ lastargs.length - 2 ];\r\n\t\tvar y0 = lastargs[ lastargs.length - 1 ];\r\n\r\n\t\tthis.absarc( aX + x0, aY + y0, aRadius,\r\n\t\t\taStartAngle, aEndAngle, aClockwise );\r\n\r\n\t},\r\n\r\n\tabsarc: function ( aX, aY, aRadius, aStartAngle, aEndAngle, aClockwise ) {\r\n\r\n\t\tthis.absellipse( aX, aY, aRadius, aRadius, aStartAngle, aEndAngle, aClockwise );\r\n\r\n\t},\r\n\r\n\tellipse: function ( aX, aY, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation ) {\r\n\r\n\t\tvar lastargs = this.actions[ this.actions.length - 1 ].args;\r\n\t\tvar x0 = lastargs[ lastargs.length - 2 ];\r\n\t\tvar y0 = lastargs[ lastargs.length - 1 ];\r\n\r\n\t\tthis.absellipse( aX + x0, aY + y0, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation );\r\n\r\n\t},\r\n\r\n\tabsellipse: function ( aX, aY, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation ) {\r\n\r\n\t\tvar args = [\r\n\t\t\taX, aY,\r\n\t\t\txRadius, yRadius,\r\n\t\t\taStartAngle, aEndAngle,\r\n\t\t\taClockwise,\r\n\t\t\taRotation || 0 // aRotation is optional.\r\n\t\t];\r\n\r\n\t\tvar curve = new THREE.EllipseCurve( aX, aY, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation );\r\n\t\tthis.curves.push( curve );\r\n\r\n\t\tvar lastPoint = curve.getPoint( 1 );\r\n\t\targs.push( lastPoint.x );\r\n\t\targs.push( lastPoint.y );\r\n\r\n\t\tthis.actions.push( { action: 'ellipse', args: args } );\r\n\r\n\t},\r\n\r\n\tgetSpacedPoints: function ( divisions ) {\r\n\r\n\t\tif ( ! divisions ) divisions = 40;\r\n\r\n\t\tvar points = [];\r\n\r\n\t\tfor ( var i = 0; i < divisions; i ++ ) {\r\n\r\n\t\t\tpoints.push( this.getPoint( i / divisions ) );\r\n\r\n\t\t\t//if ( !this.getPoint( i / divisions ) ) throw \"DIE\";\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.autoClose ) {\r\n\r\n\t\t\tpoints.push( points[ 0 ] );\r\n\r\n\t\t}\r\n\r\n\t\treturn points;\r\n\r\n\t},\r\n\r\n\tgetPoints: function ( divisions ) {\r\n\r\n\t\tdivisions = divisions || 12;\r\n\r\n\t\tvar b2 = THREE.ShapeUtils.b2;\r\n\t\tvar b3 = THREE.ShapeUtils.b3;\r\n\r\n\t\tvar points = [];\r\n\r\n\t\tvar cpx, cpy, cpx2, cpy2, cpx1, cpy1, cpx0, cpy0,\r\n\t\t\tlaste, tx, ty;\r\n\r\n\t\tfor ( var i = 0, l = this.actions.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar item = this.actions[ i ];\r\n\r\n\t\t\tvar action = item.action;\r\n\t\t\tvar args = item.args;\r\n\r\n\t\t\tswitch ( action ) {\r\n\r\n\t\t\tcase 'moveTo':\r\n\r\n\t\t\t\tpoints.push( new THREE.Vector2( args[ 0 ], args[ 1 ] ) );\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 'lineTo':\r\n\r\n\t\t\t\tpoints.push( new THREE.Vector2( args[ 0 ], args[ 1 ] ) );\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 'quadraticCurveTo':\r\n\r\n\t\t\t\tcpx  = args[ 2 ];\r\n\t\t\t\tcpy  = args[ 3 ];\r\n\r\n\t\t\t\tcpx1 = args[ 0 ];\r\n\t\t\t\tcpy1 = args[ 1 ];\r\n\r\n\t\t\t\tif ( points.length > 0 ) {\r\n\r\n\t\t\t\t\tlaste = points[ points.length - 1 ];\r\n\r\n\t\t\t\t\tcpx0 = laste.x;\r\n\t\t\t\t\tcpy0 = laste.y;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tlaste = this.actions[ i - 1 ].args;\r\n\r\n\t\t\t\t\tcpx0 = laste[ laste.length - 2 ];\r\n\t\t\t\t\tcpy0 = laste[ laste.length - 1 ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor ( var j = 1; j <= divisions; j ++ ) {\r\n\r\n\t\t\t\t\tvar t = j / divisions;\r\n\r\n\t\t\t\t\ttx = b2( t, cpx0, cpx1, cpx );\r\n\t\t\t\t\tty = b2( t, cpy0, cpy1, cpy );\r\n\r\n\t\t\t\t\tpoints.push( new THREE.Vector2( tx, ty ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 'bezierCurveTo':\r\n\r\n\t\t\t\tcpx  = args[ 4 ];\r\n\t\t\t\tcpy  = args[ 5 ];\r\n\r\n\t\t\t\tcpx1 = args[ 0 ];\r\n\t\t\t\tcpy1 = args[ 1 ];\r\n\r\n\t\t\t\tcpx2 = args[ 2 ];\r\n\t\t\t\tcpy2 = args[ 3 ];\r\n\r\n\t\t\t\tif ( points.length > 0 ) {\r\n\r\n\t\t\t\t\tlaste = points[ points.length - 1 ];\r\n\r\n\t\t\t\t\tcpx0 = laste.x;\r\n\t\t\t\t\tcpy0 = laste.y;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tlaste = this.actions[ i - 1 ].args;\r\n\r\n\t\t\t\t\tcpx0 = laste[ laste.length - 2 ];\r\n\t\t\t\t\tcpy0 = laste[ laste.length - 1 ];\r\n\r\n\t\t\t\t}\r\n\r\n\r\n\t\t\t\tfor ( var j = 1; j <= divisions; j ++ ) {\r\n\r\n\t\t\t\t\tvar t = j / divisions;\r\n\r\n\t\t\t\t\ttx = b3( t, cpx0, cpx1, cpx2, cpx );\r\n\t\t\t\t\tty = b3( t, cpy0, cpy1, cpy2, cpy );\r\n\r\n\t\t\t\t\tpoints.push( new THREE.Vector2( tx, ty ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 'splineThru':\r\n\r\n\t\t\t\tlaste = this.actions[ i - 1 ].args;\r\n\r\n\t\t\t\tvar last = new THREE.Vector2( laste[ laste.length - 2 ], laste[ laste.length - 1 ] );\r\n\t\t\t\tvar spts = [ last ];\r\n\r\n\t\t\t\tvar n = divisions * args[ 0 ].length;\r\n\r\n\t\t\t\tspts = spts.concat( args[ 0 ] );\r\n\r\n\t\t\t\tvar spline = new THREE.SplineCurve( spts );\r\n\r\n\t\t\t\tfor ( var j = 1; j <= n; j ++ ) {\r\n\r\n\t\t\t\t\tpoints.push( spline.getPointAt( j / n ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 'arc':\r\n\r\n\t\t\t\tvar aX = args[ 0 ], aY = args[ 1 ],\r\n\t\t\t\t\taRadius = args[ 2 ],\r\n\t\t\t\t\taStartAngle = args[ 3 ], aEndAngle = args[ 4 ],\r\n\t\t\t\t\taClockwise = !! args[ 5 ];\r\n\r\n\t\t\t\tvar deltaAngle = aEndAngle - aStartAngle;\r\n\t\t\t\tvar angle;\r\n\t\t\t\tvar tdivisions = divisions * 2;\r\n\r\n\t\t\t\tfor ( var j = 1; j <= tdivisions; j ++ ) {\r\n\r\n\t\t\t\t\tvar t = j / tdivisions;\r\n\r\n\t\t\t\t\tif ( ! aClockwise ) {\r\n\r\n\t\t\t\t\t\tt = 1 - t;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tangle = aStartAngle + t * deltaAngle;\r\n\r\n\t\t\t\t\ttx = aX + aRadius * Math.cos( angle );\r\n\t\t\t\t\tty = aY + aRadius * Math.sin( angle );\r\n\r\n\t\t\t\t\t//console.log('t', t, 'angle', angle, 'tx', tx, 'ty', ty);\r\n\r\n\t\t\t\t\tpoints.push( new THREE.Vector2( tx, ty ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//console.log(points);\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 'ellipse':\r\n\r\n\t\t\t\tvar aX = args[ 0 ], aY = args[ 1 ],\r\n\t\t\t\t\txRadius = args[ 2 ],\r\n\t\t\t\t\tyRadius = args[ 3 ],\r\n\t\t\t\t\taStartAngle = args[ 4 ], aEndAngle = args[ 5 ],\r\n\t\t\t\t\taClockwise = !! args[ 6 ],\r\n\t\t\t\t\taRotation = args[ 7 ];\r\n\r\n\r\n\t\t\t\tvar deltaAngle = aEndAngle - aStartAngle;\r\n\t\t\t\tvar angle;\r\n\t\t\t\tvar tdivisions = divisions * 2;\r\n\r\n\t\t\t\tvar cos, sin;\r\n\t\t\t\tif ( aRotation !== 0 ) {\r\n\r\n\t\t\t\t\tcos = Math.cos( aRotation );\r\n\t\t\t\t\tsin = Math.sin( aRotation );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor ( var j = 1; j <= tdivisions; j ++ ) {\r\n\r\n\t\t\t\t\tvar t = j / tdivisions;\r\n\r\n\t\t\t\t\tif ( ! aClockwise ) {\r\n\r\n\t\t\t\t\t\tt = 1 - t;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tangle = aStartAngle + t * deltaAngle;\r\n\r\n\t\t\t\t\ttx = aX + xRadius * Math.cos( angle );\r\n\t\t\t\t\tty = aY + yRadius * Math.sin( angle );\r\n\r\n\t\t\t\t\tif ( aRotation !== 0 ) {\r\n\r\n\t\t\t\t\t\tvar x = tx, y = ty;\r\n\r\n\t\t\t\t\t\t// Rotate the point about the center of the ellipse.\r\n\t\t\t\t\t\ttx = ( x - aX ) * cos - ( y - aY ) * sin + aX;\r\n\t\t\t\t\t\tty = ( x - aX ) * sin + ( y - aY ) * cos + aY;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t//console.log('t', t, 'angle', angle, 'tx', tx, 'ty', ty);\r\n\r\n\t\t\t\t\tpoints.push( new THREE.Vector2( tx, ty ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//console.log(points);\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t} // end switch\r\n\r\n\t\t}\r\n\r\n\r\n\r\n\t\t// Normalize to remove the closing point by default.\r\n\t\tvar lastPoint = points[ points.length - 1 ];\r\n\t\tif ( Math.abs( lastPoint.x - points[ 0 ].x ) < Number.EPSILON &&\r\n\t\t\t\t Math.abs( lastPoint.y - points[ 0 ].y ) < Number.EPSILON )\r\n\t\t\tpoints.splice( points.length - 1, 1 );\r\n\r\n\t\tif ( this.autoClose ) {\r\n\r\n\t\t\tpoints.push( points[ 0 ] );\r\n\r\n\t\t}\r\n\r\n\t\treturn points;\r\n\r\n\t},\r\n\r\n\ttoShapes: function ( isCCW, noHoles ) {\r\n\r\n\t\tfunction extractSubpaths( inActions ) {\r\n\r\n\t\t\tvar subPaths = [], lastPath = new THREE.Path();\r\n\r\n\t\t\tfor ( var i = 0, l = inActions.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar item = inActions[ i ];\r\n\r\n\t\t\t\tvar args = item.args;\r\n\t\t\t\tvar action = item.action;\r\n\r\n\t\t\t\tif ( action === 'moveTo' ) {\r\n\r\n\t\t\t\t\tif ( lastPath.actions.length !== 0 ) {\r\n\r\n\t\t\t\t\t\tsubPaths.push( lastPath );\r\n\t\t\t\t\t\tlastPath = new THREE.Path();\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlastPath[ action ].apply( lastPath, args );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( lastPath.actions.length !== 0 ) {\r\n\r\n\t\t\t\tsubPaths.push( lastPath );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// console.log(subPaths);\r\n\r\n\t\t\treturn\tsubPaths;\r\n\r\n\t\t}\r\n\r\n\t\tfunction toShapesNoHoles( inSubpaths ) {\r\n\r\n\t\t\tvar shapes = [];\r\n\r\n\t\t\tfor ( var i = 0, l = inSubpaths.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar tmpPath = inSubpaths[ i ];\r\n\r\n\t\t\t\tvar tmpShape = new THREE.Shape();\r\n\t\t\t\ttmpShape.actions = tmpPath.actions;\r\n\t\t\t\ttmpShape.curves = tmpPath.curves;\r\n\r\n\t\t\t\tshapes.push( tmpShape );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//console.log(\"shape\", shapes);\r\n\r\n\t\t\treturn shapes;\r\n\r\n\t\t}\r\n\r\n\t\tfunction isPointInsidePolygon( inPt, inPolygon ) {\r\n\r\n\t\t\tvar polyLen = inPolygon.length;\r\n\r\n\t\t\t// inPt on polygon contour => immediate success    or\r\n\t\t\t// toggling of inside/outside at every single! intersection point of an edge\r\n\t\t\t//  with the horizontal line through inPt, left of inPt\r\n\t\t\t//  not counting lowerY endpoints of edges and whole edges on that line\r\n\t\t\tvar inside = false;\r\n\t\t\tfor ( var p = polyLen - 1, q = 0; q < polyLen; p = q ++ ) {\r\n\r\n\t\t\t\tvar edgeLowPt  = inPolygon[ p ];\r\n\t\t\t\tvar edgeHighPt = inPolygon[ q ];\r\n\r\n\t\t\t\tvar edgeDx = edgeHighPt.x - edgeLowPt.x;\r\n\t\t\t\tvar edgeDy = edgeHighPt.y - edgeLowPt.y;\r\n\r\n\t\t\t\tif ( Math.abs( edgeDy ) > Number.EPSILON ) {\r\n\r\n\t\t\t\t\t// not parallel\r\n\t\t\t\t\tif ( edgeDy < 0 ) {\r\n\r\n\t\t\t\t\t\tedgeLowPt  = inPolygon[ q ]; edgeDx = - edgeDx;\r\n\t\t\t\t\t\tedgeHighPt = inPolygon[ p ]; edgeDy = - edgeDy;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( ( inPt.y < edgeLowPt.y ) || ( inPt.y > edgeHighPt.y ) ) \t\tcontinue;\r\n\r\n\t\t\t\t\tif ( inPt.y === edgeLowPt.y ) {\r\n\r\n\t\t\t\t\t\tif ( inPt.x === edgeLowPt.x )\t\treturn\ttrue;\t\t// inPt is on contour ?\r\n\t\t\t\t\t\t// continue;\t\t\t\t// no intersection or edgeLowPt => doesn't count !!!\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tvar perpEdge = edgeDy * ( inPt.x - edgeLowPt.x ) - edgeDx * ( inPt.y - edgeLowPt.y );\r\n\t\t\t\t\t\tif ( perpEdge === 0 )\t\t\t\treturn\ttrue;\t\t// inPt is on contour ?\r\n\t\t\t\t\t\tif ( perpEdge < 0 ) \t\t\t\tcontinue;\r\n\t\t\t\t\t\tinside = ! inside;\t\t// true intersection left of inPt\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t// parallel or collinear\r\n\t\t\t\t\tif ( inPt.y !== edgeLowPt.y ) \t\tcontinue;\t\t\t// parallel\r\n\t\t\t\t\t// edge lies on the same horizontal line as inPt\r\n\t\t\t\t\tif ( ( ( edgeHighPt.x <= inPt.x ) && ( inPt.x <= edgeLowPt.x ) ) ||\r\n\t\t\t\t\t\t ( ( edgeLowPt.x <= inPt.x ) && ( inPt.x <= edgeHighPt.x ) ) )\t\treturn\ttrue;\t// inPt: Point on contour !\r\n\t\t\t\t\t// continue;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn\tinside;\r\n\r\n\t\t}\r\n\r\n\t\tvar isClockWise = THREE.ShapeUtils.isClockWise;\r\n\r\n\t\tvar subPaths = extractSubpaths( this.actions );\r\n\t\tif ( subPaths.length === 0 ) return [];\r\n\r\n\t\tif ( noHoles === true )\treturn\ttoShapesNoHoles( subPaths );\r\n\r\n\r\n\t\tvar solid, tmpPath, tmpShape, shapes = [];\r\n\r\n\t\tif ( subPaths.length === 1 ) {\r\n\r\n\t\t\ttmpPath = subPaths[ 0 ];\r\n\t\t\ttmpShape = new THREE.Shape();\r\n\t\t\ttmpShape.actions = tmpPath.actions;\r\n\t\t\ttmpShape.curves = tmpPath.curves;\r\n\t\t\tshapes.push( tmpShape );\r\n\t\t\treturn shapes;\r\n\r\n\t\t}\r\n\r\n\t\tvar holesFirst = ! isClockWise( subPaths[ 0 ].getPoints() );\r\n\t\tholesFirst = isCCW ? ! holesFirst : holesFirst;\r\n\r\n\t\t// console.log(\"Holes first\", holesFirst);\r\n\r\n\t\tvar betterShapeHoles = [];\r\n\t\tvar newShapes = [];\r\n\t\tvar newShapeHoles = [];\r\n\t\tvar mainIdx = 0;\r\n\t\tvar tmpPoints;\r\n\r\n\t\tnewShapes[ mainIdx ] = undefined;\r\n\t\tnewShapeHoles[ mainIdx ] = [];\r\n\r\n\t\tfor ( var i = 0, l = subPaths.length; i < l; i ++ ) {\r\n\r\n\t\t\ttmpPath = subPaths[ i ];\r\n\t\t\ttmpPoints = tmpPath.getPoints();\r\n\t\t\tsolid = isClockWise( tmpPoints );\r\n\t\t\tsolid = isCCW ? ! solid : solid;\r\n\r\n\t\t\tif ( solid ) {\r\n\r\n\t\t\t\tif ( ( ! holesFirst ) && ( newShapes[ mainIdx ] ) )\tmainIdx ++;\r\n\r\n\t\t\t\tnewShapes[ mainIdx ] = { s: new THREE.Shape(), p: tmpPoints };\r\n\t\t\t\tnewShapes[ mainIdx ].s.actions = tmpPath.actions;\r\n\t\t\t\tnewShapes[ mainIdx ].s.curves = tmpPath.curves;\r\n\r\n\t\t\t\tif ( holesFirst )\tmainIdx ++;\r\n\t\t\t\tnewShapeHoles[ mainIdx ] = [];\r\n\r\n\t\t\t\t//console.log('cw', i);\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tnewShapeHoles[ mainIdx ].push( { h: tmpPath, p: tmpPoints[ 0 ] } );\r\n\r\n\t\t\t\t//console.log('ccw', i);\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// only Holes? -> probably all Shapes with wrong orientation\r\n\t\tif ( ! newShapes[ 0 ] )\treturn\ttoShapesNoHoles( subPaths );\r\n\r\n\r\n\t\tif ( newShapes.length > 1 ) {\r\n\r\n\t\t\tvar ambiguous = false;\r\n\t\t\tvar toChange = [];\r\n\r\n\t\t\tfor ( var sIdx = 0, sLen = newShapes.length; sIdx < sLen; sIdx ++ ) {\r\n\r\n\t\t\t\tbetterShapeHoles[ sIdx ] = [];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var sIdx = 0, sLen = newShapes.length; sIdx < sLen; sIdx ++ ) {\r\n\r\n\t\t\t\tvar sho = newShapeHoles[ sIdx ];\r\n\r\n\t\t\t\tfor ( var hIdx = 0; hIdx < sho.length; hIdx ++ ) {\r\n\r\n\t\t\t\t\tvar ho = sho[ hIdx ];\r\n\t\t\t\t\tvar hole_unassigned = true;\r\n\r\n\t\t\t\t\tfor ( var s2Idx = 0; s2Idx < newShapes.length; s2Idx ++ ) {\r\n\r\n\t\t\t\t\t\tif ( isPointInsidePolygon( ho.p, newShapes[ s2Idx ].p ) ) {\r\n\r\n\t\t\t\t\t\t\tif ( sIdx !== s2Idx )\ttoChange.push( { froms: sIdx, tos: s2Idx, hole: hIdx } );\r\n\t\t\t\t\t\t\tif ( hole_unassigned ) {\r\n\r\n\t\t\t\t\t\t\t\thole_unassigned = false;\r\n\t\t\t\t\t\t\t\tbetterShapeHoles[ s2Idx ].push( ho );\r\n\r\n\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\tambiguous = true;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( hole_unassigned ) {\r\n\r\n\t\t\t\t\t\tbetterShapeHoles[ sIdx ].push( ho );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t\t// console.log(\"ambiguous: \", ambiguous);\r\n\t\t\tif ( toChange.length > 0 ) {\r\n\r\n\t\t\t\t// console.log(\"to change: \", toChange);\r\n\t\t\t\tif ( ! ambiguous )\tnewShapeHoles = betterShapeHoles;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar tmpHoles;\r\n\r\n\t\tfor ( var i = 0, il = newShapes.length; i < il; i ++ ) {\r\n\r\n\t\t\ttmpShape = newShapes[ i ].s;\r\n\t\t\tshapes.push( tmpShape );\r\n\t\t\ttmpHoles = newShapeHoles[ i ];\r\n\r\n\t\t\tfor ( var j = 0, jl = tmpHoles.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\ttmpShape.holes.push( tmpHoles[ j ].h );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t//console.log(\"shape\", shapes);\r\n\r\n\t\treturn shapes;\r\n\r\n\t}\r\n\r\n} );\r\n\r\n// File:src/extras/core/Shape.js\r\n\r\n/**\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n * Defines a 2d shape plane using paths.\r\n **/\r\n\r\n// STEP 1 Create a path.\r\n// STEP 2 Turn path into shape.\r\n// STEP 3 ExtrudeGeometry takes in Shape/Shapes\r\n// STEP 3a - Extract points from each shape, turn to vertices\r\n// STEP 3b - Triangulate each shape, add faces.\r\n\r\nTHREE.Shape = function () {\r\n\r\n\tTHREE.Path.apply( this, arguments );\r\n\r\n\tthis.holes = [];\r\n\r\n};\r\n\r\nTHREE.Shape.prototype = Object.assign( Object.create( THREE.Path.prototype ), {\r\n\r\n\tconstructor: THREE.Shape,\r\n\r\n\t// Convenience method to return ExtrudeGeometry\r\n\r\n\textrude: function ( options ) {\r\n\r\n\t\treturn new THREE.ExtrudeGeometry( this, options );\r\n\r\n\t},\r\n\r\n\t// Convenience method to return ShapeGeometry\r\n\r\n\tmakeGeometry: function ( options ) {\r\n\r\n\t\treturn new THREE.ShapeGeometry( this, options );\r\n\r\n\t},\r\n\r\n\tgetPointsHoles: function ( divisions ) {\r\n\r\n\t\tvar holesPts = [];\r\n\r\n\t\tfor ( var i = 0, l = this.holes.length; i < l; i ++ ) {\r\n\r\n\t\t\tholesPts[ i ] = this.holes[ i ].getPoints( divisions );\r\n\r\n\t\t}\r\n\r\n\t\treturn holesPts;\r\n\r\n\t},\r\n\r\n\t// Get points of shape and holes (keypoints based on segments parameter)\r\n\r\n\textractAllPoints: function ( divisions ) {\r\n\r\n\t\treturn {\r\n\r\n\t\t\tshape: this.getPoints( divisions ),\r\n\t\t\tholes: this.getPointsHoles( divisions )\r\n\r\n\t\t};\r\n\r\n\t},\r\n\r\n\textractPoints: function ( divisions ) {\r\n\r\n\t\treturn this.extractAllPoints( divisions );\r\n\r\n\t}\r\n\r\n} );\r\n\r\n// File:src/extras/curves/LineCurve.js\r\n\r\n/**************************************************************\r\n *\tLine\r\n **************************************************************/\r\n\r\nTHREE.LineCurve = function ( v1, v2 ) {\r\n\r\n\tthis.v1 = v1;\r\n\tthis.v2 = v2;\r\n\r\n};\r\n\r\nTHREE.LineCurve.prototype = Object.create( THREE.Curve.prototype );\r\nTHREE.LineCurve.prototype.constructor = THREE.LineCurve;\r\n\r\nTHREE.LineCurve.prototype.getPoint = function ( t ) {\r\n\r\n\tvar point = this.v2.clone().sub( this.v1 );\r\n\tpoint.multiplyScalar( t ).add( this.v1 );\r\n\r\n\treturn point;\r\n\r\n};\r\n\r\n// Line curve is linear, so we can overwrite default getPointAt\r\n\r\nTHREE.LineCurve.prototype.getPointAt = function ( u ) {\r\n\r\n\treturn this.getPoint( u );\r\n\r\n};\r\n\r\nTHREE.LineCurve.prototype.getTangent = function( t ) {\r\n\r\n\tvar tangent = this.v2.clone().sub( this.v1 );\r\n\r\n\treturn tangent.normalize();\r\n\r\n};\r\n\r\n// File:src/extras/curves/QuadraticBezierCurve.js\r\n\r\n/**************************************************************\r\n *\tQuadratic Bezier curve\r\n **************************************************************/\r\n\r\n\r\nTHREE.QuadraticBezierCurve = function ( v0, v1, v2 ) {\r\n\r\n\tthis.v0 = v0;\r\n\tthis.v1 = v1;\r\n\tthis.v2 = v2;\r\n\r\n};\r\n\r\nTHREE.QuadraticBezierCurve.prototype = Object.create( THREE.Curve.prototype );\r\nTHREE.QuadraticBezierCurve.prototype.constructor = THREE.QuadraticBezierCurve;\r\n\r\n\r\nTHREE.QuadraticBezierCurve.prototype.getPoint = function ( t ) {\r\n\r\n\tvar b2 = THREE.ShapeUtils.b2;\r\n\r\n\treturn new THREE.Vector2(\r\n\t\tb2( t, this.v0.x, this.v1.x, this.v2.x ),\r\n\t\tb2( t, this.v0.y, this.v1.y, this.v2.y )\r\n\t);\r\n\r\n};\r\n\r\n\r\nTHREE.QuadraticBezierCurve.prototype.getTangent = function( t ) {\r\n\r\n\tvar tangentQuadraticBezier = THREE.CurveUtils.tangentQuadraticBezier;\r\n\r\n\treturn new THREE.Vector2(\r\n\t\ttangentQuadraticBezier( t, this.v0.x, this.v1.x, this.v2.x ),\r\n\t\ttangentQuadraticBezier( t, this.v0.y, this.v1.y, this.v2.y )\r\n\t).normalize();\r\n\r\n};\r\n\r\n// File:src/extras/curves/CubicBezierCurve.js\r\n\r\n/**************************************************************\r\n *\tCubic Bezier curve\r\n **************************************************************/\r\n\r\nTHREE.CubicBezierCurve = function ( v0, v1, v2, v3 ) {\r\n\r\n\tthis.v0 = v0;\r\n\tthis.v1 = v1;\r\n\tthis.v2 = v2;\r\n\tthis.v3 = v3;\r\n\r\n};\r\n\r\nTHREE.CubicBezierCurve.prototype = Object.create( THREE.Curve.prototype );\r\nTHREE.CubicBezierCurve.prototype.constructor = THREE.CubicBezierCurve;\r\n\r\nTHREE.CubicBezierCurve.prototype.getPoint = function ( t ) {\r\n\r\n\tvar b3 = THREE.ShapeUtils.b3;\r\n\r\n\treturn new THREE.Vector2( \r\n\t\tb3( t, this.v0.x, this.v1.x, this.v2.x, this.v3.x ),\r\n\t\tb3( t, this.v0.y, this.v1.y, this.v2.y, this.v3.y )\r\n\t);\r\n\r\n};\r\n\r\nTHREE.CubicBezierCurve.prototype.getTangent = function( t ) {\r\n\r\n\tvar tangentCubicBezier = THREE.CurveUtils.tangentCubicBezier;\r\n\r\n\treturn new THREE.Vector2( \r\n\t\ttangentCubicBezier( t, this.v0.x, this.v1.x, this.v2.x, this.v3.x ),\r\n\t\ttangentCubicBezier( t, this.v0.y, this.v1.y, this.v2.y, this.v3.y )\r\n\t).normalize();\r\n\r\n};\r\n\r\n// File:src/extras/curves/SplineCurve.js\r\n\r\n/**************************************************************\r\n *\tSpline curve\r\n **************************************************************/\r\n\r\nTHREE.SplineCurve = function ( points /* array of Vector2 */ ) {\r\n\r\n\tthis.points = ( points == undefined ) ? [] : points;\r\n\r\n};\r\n\r\nTHREE.SplineCurve.prototype = Object.create( THREE.Curve.prototype );\r\nTHREE.SplineCurve.prototype.constructor = THREE.SplineCurve;\r\n\r\nTHREE.SplineCurve.prototype.getPoint = function ( t ) {\r\n\r\n\tvar points = this.points;\r\n\tvar point = ( points.length - 1 ) * t;\r\n\r\n\tvar intPoint = Math.floor( point );\r\n\tvar weight = point - intPoint;\r\n\r\n\tvar point0 = points[ intPoint === 0 ? intPoint : intPoint - 1 ];\r\n\tvar point1 = points[ intPoint ];\r\n\tvar point2 = points[ intPoint > points.length - 2 ? points.length - 1 : intPoint + 1 ];\r\n\tvar point3 = points[ intPoint > points.length - 3 ? points.length - 1 : intPoint + 2 ];\r\n\r\n\tvar interpolate = THREE.CurveUtils.interpolate;\r\n\r\n\treturn new THREE.Vector2(\r\n\t\tinterpolate( point0.x, point1.x, point2.x, point3.x, weight ),\r\n\t\tinterpolate( point0.y, point1.y, point2.y, point3.y, weight )\r\n\t);\r\n\r\n};\r\n\r\n// File:src/extras/curves/EllipseCurve.js\r\n\r\n/**************************************************************\r\n *\tEllipse curve\r\n **************************************************************/\r\n\r\nTHREE.EllipseCurve = function ( aX, aY, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation ) {\r\n\r\n\tthis.aX = aX;\r\n\tthis.aY = aY;\r\n\r\n\tthis.xRadius = xRadius;\r\n\tthis.yRadius = yRadius;\r\n\r\n\tthis.aStartAngle = aStartAngle;\r\n\tthis.aEndAngle = aEndAngle;\r\n\r\n\tthis.aClockwise = aClockwise;\r\n\t\r\n\tthis.aRotation = aRotation || 0;\r\n\r\n};\r\n\r\nTHREE.EllipseCurve.prototype = Object.create( THREE.Curve.prototype );\r\nTHREE.EllipseCurve.prototype.constructor = THREE.EllipseCurve;\r\n\r\nTHREE.EllipseCurve.prototype.getPoint = function ( t ) {\r\n\r\n\tvar deltaAngle = this.aEndAngle - this.aStartAngle;\r\n\r\n\tif ( deltaAngle < 0 ) deltaAngle += Math.PI * 2;\r\n\tif ( deltaAngle > Math.PI * 2 ) deltaAngle -= Math.PI * 2;\r\n\r\n\tvar angle;\r\n\r\n\tif ( this.aClockwise === true ) {\r\n\r\n\t\tangle = this.aEndAngle + ( 1 - t ) * ( Math.PI * 2 - deltaAngle );\r\n\r\n\t} else {\r\n\r\n\t\tangle = this.aStartAngle + t * deltaAngle;\r\n\r\n\t}\r\n\t\r\n\tvar x = this.aX + this.xRadius * Math.cos( angle );\r\n\tvar y = this.aY + this.yRadius * Math.sin( angle );\r\n\r\n\tif ( this.aRotation !== 0 ) {\r\n\r\n\t\tvar cos = Math.cos( this.aRotation );\r\n\t\tvar sin = Math.sin( this.aRotation );\r\n\r\n\t\tvar tx = x, ty = y;\r\n\r\n\t\t// Rotate the point about the center of the ellipse.\r\n\t\tx = ( tx - this.aX ) * cos - ( ty - this.aY ) * sin + this.aX;\r\n\t\ty = ( tx - this.aX ) * sin + ( ty - this.aY ) * cos + this.aY;\r\n\r\n\t}\r\n\r\n\treturn new THREE.Vector2( x, y );\r\n\r\n};\r\n\r\n// File:src/extras/curves/ArcCurve.js\r\n\r\n/**************************************************************\r\n *\tArc curve\r\n **************************************************************/\r\n\r\nTHREE.ArcCurve = function ( aX, aY, aRadius, aStartAngle, aEndAngle, aClockwise ) {\r\n\r\n\tTHREE.EllipseCurve.call( this, aX, aY, aRadius, aRadius, aStartAngle, aEndAngle, aClockwise );\r\n\r\n};\r\n\r\nTHREE.ArcCurve.prototype = Object.create( THREE.EllipseCurve.prototype );\r\nTHREE.ArcCurve.prototype.constructor = THREE.ArcCurve;\r\n\r\n// File:src/extras/curves/LineCurve3.js\r\n\r\n/**************************************************************\r\n *\tLine3D\r\n **************************************************************/\r\n\r\nTHREE.LineCurve3 = THREE.Curve.create(\r\n\r\n\tfunction ( v1, v2 ) {\r\n\r\n\t\tthis.v1 = v1;\r\n\t\tthis.v2 = v2;\r\n\r\n\t},\r\n\r\n\tfunction ( t ) {\r\n\r\n\t\tvar vector = new THREE.Vector3();\r\n\r\n\t\tvector.subVectors( this.v2, this.v1 ); // diff\r\n\t\tvector.multiplyScalar( t );\r\n\t\tvector.add( this.v1 );\r\n\r\n\t\treturn vector;\r\n\r\n\t}\r\n\r\n);\r\n\r\n// File:src/extras/curves/QuadraticBezierCurve3.js\r\n\r\n/**************************************************************\r\n *\tQuadratic Bezier 3D curve\r\n **************************************************************/\r\n\r\nTHREE.QuadraticBezierCurve3 = THREE.Curve.create(\r\n\r\n\tfunction ( v0, v1, v2 ) {\r\n\r\n\t\tthis.v0 = v0;\r\n\t\tthis.v1 = v1;\r\n\t\tthis.v2 = v2;\r\n\r\n\t},\r\n\r\n\tfunction ( t ) {\r\n\r\n\t\tvar b2 = THREE.ShapeUtils.b2;\t\t\r\n\r\n\t\treturn new THREE.Vector3(\r\n\t\t\tb2( t, this.v0.x, this.v1.x, this.v2.x ),\r\n\t\t\tb2( t, this.v0.y, this.v1.y, this.v2.y ),\r\n\t\t\tb2( t, this.v0.z, this.v1.z, this.v2.z )\r\n\t\t);\r\n\r\n\t}\r\n\r\n);\r\n\r\n// File:src/extras/curves/CubicBezierCurve3.js\r\n\r\n/**************************************************************\r\n *\tCubic Bezier 3D curve\r\n **************************************************************/\r\n\r\nTHREE.CubicBezierCurve3 = THREE.Curve.create(\r\n\r\n\tfunction ( v0, v1, v2, v3 ) {\r\n\r\n\t\tthis.v0 = v0;\r\n\t\tthis.v1 = v1;\r\n\t\tthis.v2 = v2;\r\n\t\tthis.v3 = v3;\r\n\r\n\t},\r\n\r\n\tfunction ( t ) {\r\n\r\n\t\tvar b3 = THREE.ShapeUtils.b3;\r\n\r\n\t\treturn new THREE.Vector3(\r\n\t\t\tb3( t, this.v0.x, this.v1.x, this.v2.x, this.v3.x ),\r\n\t\t\tb3( t, this.v0.y, this.v1.y, this.v2.y, this.v3.y ),\r\n\t\t\tb3( t, this.v0.z, this.v1.z, this.v2.z, this.v3.z )\r\n\t\t);\r\n\r\n\t}\r\n\r\n);\r\n\r\n// File:src/extras/curves/SplineCurve3.js\r\n\r\n/**************************************************************\r\n *\tSpline 3D curve\r\n **************************************************************/\r\n\r\n\r\nTHREE.SplineCurve3 = THREE.Curve.create(\r\n\r\n\tfunction ( points /* array of Vector3 */ ) {\r\n\r\n\t\tconsole.warn( 'THREE.SplineCurve3 will be deprecated. Please use THREE.CatmullRomCurve3' );\r\n\t\tthis.points = ( points == undefined ) ? [] : points;\r\n\r\n\t},\r\n\r\n\tfunction ( t ) {\r\n\r\n\t\tvar points = this.points;\r\n\t\tvar point = ( points.length - 1 ) * t;\r\n\r\n\t\tvar intPoint = Math.floor( point );\r\n\t\tvar weight = point - intPoint;\r\n\r\n\t\tvar point0 = points[ intPoint == 0 ? intPoint : intPoint - 1 ];\r\n\t\tvar point1 = points[ intPoint ];\r\n\t\tvar point2 = points[ intPoint > points.length - 2 ? points.length - 1 : intPoint + 1 ];\r\n\t\tvar point3 = points[ intPoint > points.length - 3 ? points.length - 1 : intPoint + 2 ];\r\n\r\n\t\tvar interpolate = THREE.CurveUtils.interpolate;\r\n\r\n\t\treturn new THREE.Vector3(\r\n\t\t\tinterpolate( point0.x, point1.x, point2.x, point3.x, weight ),\r\n\t\t\tinterpolate( point0.y, point1.y, point2.y, point3.y, weight ),\r\n\t\t\tinterpolate( point0.z, point1.z, point2.z, point3.z, weight )\r\n\t\t);\r\n\r\n\t}\r\n\r\n);\r\n\r\n// File:src/extras/curves/CatmullRomCurve3.js\r\n\r\n/**\r\n * @author zz85 https://github.com/zz85\r\n *\r\n * Centripetal CatmullRom Curve - which is useful for avoiding\r\n * cusps and self-intersections in non-uniform catmull rom curves.\r\n * http://www.cemyuksel.com/research/catmullrom_param/catmullrom.pdf\r\n *\r\n * curve.type accepts centripetal(default), chordal and catmullrom\r\n * curve.tension is used for catmullrom which defaults to 0.5\r\n */\r\n\r\nTHREE.CatmullRomCurve3 = ( function() {\r\n\r\n\tvar\r\n\t\ttmp = new THREE.Vector3(),\r\n\t\tpx = new CubicPoly(),\r\n\t\tpy = new CubicPoly(),\r\n\t\tpz = new CubicPoly();\r\n\r\n\t/*\r\n\tBased on an optimized c++ solution in\r\n\t - http://stackoverflow.com/questions/9489736/catmull-rom-curve-with-no-cusps-and-no-self-intersections/\r\n\t - http://ideone.com/NoEbVM\r\n\r\n\tThis CubicPoly class could be used for reusing some variables and calculations,\r\n\tbut for three.js curve use, it could be possible inlined and flatten into a single function call\r\n\twhich can be placed in CurveUtils.\r\n\t*/\r\n\r\n\tfunction CubicPoly() {\r\n\r\n\t}\r\n\r\n\t/*\r\n\t * Compute coefficients for a cubic polynomial\r\n\t *   p(s) = c0 + c1*s + c2*s^2 + c3*s^3\r\n\t * such that\r\n\t *   p(0) = x0, p(1) = x1\r\n\t *  and\r\n\t *   p'(0) = t0, p'(1) = t1.\r\n\t */\r\n\tCubicPoly.prototype.init = function( x0, x1, t0, t1 ) {\r\n\r\n\t\tthis.c0 = x0;\r\n\t\tthis.c1 = t0;\r\n\t\tthis.c2 = - 3 * x0 + 3 * x1 - 2 * t0 - t1;\r\n\t\tthis.c3 = 2 * x0 - 2 * x1 + t0 + t1;\r\n\r\n\t};\r\n\r\n\tCubicPoly.prototype.initNonuniformCatmullRom = function( x0, x1, x2, x3, dt0, dt1, dt2 ) {\r\n\r\n\t\t// compute tangents when parameterized in [t1,t2]\r\n\t\tvar t1 = ( x1 - x0 ) / dt0 - ( x2 - x0 ) / ( dt0 + dt1 ) + ( x2 - x1 ) / dt1;\r\n\t\tvar t2 = ( x2 - x1 ) / dt1 - ( x3 - x1 ) / ( dt1 + dt2 ) + ( x3 - x2 ) / dt2;\r\n\r\n\t\t// rescale tangents for parametrization in [0,1]\r\n\t\tt1 *= dt1;\r\n\t\tt2 *= dt1;\r\n\r\n\t\t// initCubicPoly\r\n\t\tthis.init( x1, x2, t1, t2 );\r\n\r\n\t};\r\n\r\n\t// standard Catmull-Rom spline: interpolate between x1 and x2 with previous/following points x1/x4\r\n\tCubicPoly.prototype.initCatmullRom = function( x0, x1, x2, x3, tension ) {\r\n\r\n\t\tthis.init( x1, x2, tension * ( x2 - x0 ), tension * ( x3 - x1 ) );\r\n\r\n\t};\r\n\r\n\tCubicPoly.prototype.calc = function( t ) {\r\n\r\n\t\tvar t2 = t * t;\r\n\t\tvar t3 = t2 * t;\r\n\t\treturn this.c0 + this.c1 * t + this.c2 * t2 + this.c3 * t3;\r\n\r\n\t};\r\n\r\n\t// Subclass Three.js curve\r\n\treturn THREE.Curve.create(\r\n\r\n\t\tfunction ( p /* array of Vector3 */ ) {\r\n\r\n\t\t\tthis.points = p || [];\r\n\t\t\tthis.closed = false;\r\n\r\n\t\t},\r\n\r\n\t\tfunction ( t ) {\r\n\r\n\t\t\tvar points = this.points,\r\n\t\t\t\tpoint, intPoint, weight, l;\r\n\r\n\t\t\tl = points.length;\r\n\r\n\t\t\tif ( l < 2 ) console.log( 'duh, you need at least 2 points' );\r\n\r\n\t\t\tpoint = ( l - ( this.closed ? 0 : 1 ) ) * t;\r\n\t\t\tintPoint = Math.floor( point );\r\n\t\t\tweight = point - intPoint;\r\n\r\n\t\t\tif ( this.closed ) {\r\n\r\n\t\t\t\tintPoint += intPoint > 0 ? 0 : ( Math.floor( Math.abs( intPoint ) / points.length ) + 1 ) * points.length;\r\n\r\n\t\t\t} else if ( weight === 0 && intPoint === l - 1 ) {\r\n\r\n\t\t\t\tintPoint = l - 2;\r\n\t\t\t\tweight = 1;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar p0, p1, p2, p3; // 4 points\r\n\r\n\t\t\tif ( this.closed || intPoint > 0 ) {\r\n\r\n\t\t\t\tp0 = points[ ( intPoint - 1 ) % l ];\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// extrapolate first point\r\n\t\t\t\ttmp.subVectors( points[ 0 ], points[ 1 ] ).add( points[ 0 ] );\r\n\t\t\t\tp0 = tmp;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tp1 = points[ intPoint % l ];\r\n\t\t\tp2 = points[ ( intPoint + 1 ) % l ];\r\n\r\n\t\t\tif ( this.closed || intPoint + 2 < l ) {\r\n\r\n\t\t\t\tp3 = points[ ( intPoint + 2 ) % l ];\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// extrapolate last point\r\n\t\t\t\ttmp.subVectors( points[ l - 1 ], points[ l - 2 ] ).add( points[ l - 1 ] );\r\n\t\t\t\tp3 = tmp;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( this.type === undefined || this.type === 'centripetal' || this.type === 'chordal' ) {\r\n\r\n\t\t\t\t// init Centripetal / Chordal Catmull-Rom\r\n\t\t\t\tvar pow = this.type === 'chordal' ? 0.5 : 0.25;\r\n\t\t\t\tvar dt0 = Math.pow( p0.distanceToSquared( p1 ), pow );\r\n\t\t\t\tvar dt1 = Math.pow( p1.distanceToSquared( p2 ), pow );\r\n\t\t\t\tvar dt2 = Math.pow( p2.distanceToSquared( p3 ), pow );\r\n\r\n\t\t\t\t// safety check for repeated points\r\n\t\t\t\tif ( dt1 < 1e-4 ) dt1 = 1.0;\r\n\t\t\t\tif ( dt0 < 1e-4 ) dt0 = dt1;\r\n\t\t\t\tif ( dt2 < 1e-4 ) dt2 = dt1;\r\n\r\n\t\t\t\tpx.initNonuniformCatmullRom( p0.x, p1.x, p2.x, p3.x, dt0, dt1, dt2 );\r\n\t\t\t\tpy.initNonuniformCatmullRom( p0.y, p1.y, p2.y, p3.y, dt0, dt1, dt2 );\r\n\t\t\t\tpz.initNonuniformCatmullRom( p0.z, p1.z, p2.z, p3.z, dt0, dt1, dt2 );\r\n\r\n\t\t\t} else if ( this.type === 'catmullrom' ) {\r\n\r\n\t\t\t\tvar tension = this.tension !== undefined ? this.tension : 0.5;\r\n\t\t\t\tpx.initCatmullRom( p0.x, p1.x, p2.x, p3.x, tension );\r\n\t\t\t\tpy.initCatmullRom( p0.y, p1.y, p2.y, p3.y, tension );\r\n\t\t\t\tpz.initCatmullRom( p0.z, p1.z, p2.z, p3.z, tension );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar v = new THREE.Vector3(\r\n\t\t\t\tpx.calc( weight ),\r\n\t\t\t\tpy.calc( weight ),\r\n\t\t\t\tpz.calc( weight )\r\n\t\t\t);\r\n\r\n\t\t\treturn v;\r\n\r\n\t\t}\r\n\r\n\t);\r\n\r\n} )();\r\n\r\n// File:src/extras/curves/ClosedSplineCurve3.js\r\n\r\n/**************************************************************\r\n *\tClosed Spline 3D curve\r\n **************************************************************/\r\n\r\n\r\nTHREE.ClosedSplineCurve3 = function ( points ) {\r\n\r\n\tconsole.warn( 'THREE.ClosedSplineCurve3 has been deprecated. Please use THREE.CatmullRomCurve3.' );\r\n\r\n\tTHREE.CatmullRomCurve3.call( this, points );\r\n\tthis.type = 'catmullrom';\r\n\tthis.closed = true;\r\n\r\n};\r\n\r\nTHREE.ClosedSplineCurve3.prototype = Object.create( THREE.CatmullRomCurve3.prototype );\r\n\r\n// File:src/extras/geometries/BoxGeometry.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * based on http://papervision3d.googlecode.com/svn/trunk/as3/trunk/src/org/papervision3d/objects/primitives/Cube.as\r\n */\r\n\r\nTHREE.BoxGeometry = function ( width, height, depth, widthSegments, heightSegments, depthSegments ) {\r\n\r\n\tTHREE.Geometry.call( this );\r\n\r\n\tthis.type = 'BoxGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\twidth: width,\r\n\t\theight: height,\r\n\t\tdepth: depth,\r\n\t\twidthSegments: widthSegments,\r\n\t\theightSegments: heightSegments,\r\n\t\tdepthSegments: depthSegments\r\n\t};\r\n\r\n\tthis.fromBufferGeometry( new THREE.BoxBufferGeometry( width, height, depth, widthSegments, heightSegments, depthSegments ) );\r\n\tthis.mergeVertices();\r\n\r\n};\r\n\r\nTHREE.BoxGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.BoxGeometry.prototype.constructor = THREE.BoxGeometry;\r\n\r\nTHREE.CubeGeometry = THREE.BoxGeometry;\r\n\r\n// File:src/extras/geometries/BoxBufferGeometry.js\r\n\r\n/**\r\n * @author Mugen87 / https://github.com/Mugen87\r\n */\r\n\r\nTHREE.BoxBufferGeometry = function ( width, height, depth, widthSegments, heightSegments, depthSegments ) {\r\n\r\n\tTHREE.BufferGeometry.call( this );\r\n\r\n\tthis.type = 'BoxBufferGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\twidth: width,\r\n\t\theight: height,\r\n\t\tdepth: depth,\r\n\t\twidthSegments: widthSegments,\r\n\t\theightSegments: heightSegments,\r\n\t\tdepthSegments: depthSegments\r\n\t};\r\n\r\n\tvar scope = this;\r\n\r\n\t// segments\r\n\twidthSegments = Math.floor( widthSegments ) || 1;\r\n\theightSegments = Math.floor( heightSegments ) || 1;\r\n\tdepthSegments = Math.floor( depthSegments ) || 1;\r\n\r\n\t// these are used to calculate buffer length\r\n\tvar vertexCount = calculateVertexCount( widthSegments, heightSegments, depthSegments );\r\n\tvar indexCount = calculateIndexCount( widthSegments, heightSegments, depthSegments );\r\n\r\n\t// buffers\r\n\tvar indices = new ( indexCount > 65535 ? Uint32Array : Uint16Array )( indexCount );\r\n\tvar vertices = new Float32Array( vertexCount * 3 );\r\n\tvar normals = new Float32Array( vertexCount * 3 );\r\n\tvar uvs = new Float32Array( vertexCount * 2 );\r\n\r\n\t// offset variables\r\n\tvar vertexBufferOffset = 0;\r\n\tvar uvBufferOffset = 0;\r\n\tvar indexBufferOffset = 0;\r\n\tvar numberOfVertices = 0;\r\n\r\n\t// group variables\r\n\tvar groupStart = 0;\r\n\r\n\t// build each side of the box geometry\r\n\tbuildPlane( 'z', 'y', 'x', - 1, - 1, depth, height,   width,  depthSegments, heightSegments, 0 ); // px\r\n\tbuildPlane( 'z', 'y', 'x',   1, - 1, depth, height, - width,  depthSegments, heightSegments, 1 ); // nx\r\n\tbuildPlane( 'x', 'z', 'y',   1,   1, width, depth,    height, widthSegments, depthSegments,  2 ); // py\r\n\tbuildPlane( 'x', 'z', 'y',   1, - 1, width, depth,  - height, widthSegments, depthSegments,  3 ); // ny\r\n\tbuildPlane( 'x', 'y', 'z',   1, - 1, width, height,   depth,  widthSegments, heightSegments, 4 ); // pz\r\n\tbuildPlane( 'x', 'y', 'z', - 1, - 1, width, height, - depth,  widthSegments, heightSegments, 5 ); // nz\r\n\r\n\t// build geometry\r\n\tthis.setIndex( new THREE.BufferAttribute( indices, 1 ) );\r\n\tthis.addAttribute( 'position', new THREE.BufferAttribute( vertices, 3 ) );\r\n\tthis.addAttribute( 'normal', new THREE.BufferAttribute( normals, 3 ) );\r\n\tthis.addAttribute( 'uv', new THREE.BufferAttribute( uvs, 2 ) );\r\n\r\n\t// helper functions\r\n\r\n\tfunction calculateVertexCount ( w, h, d ) {\r\n\r\n\t\tvar vertices = 0;\r\n\r\n\t\t// calculate the amount of vertices for each side (plane)\r\n\t\tvertices += (w + 1) * (h + 1) * 2; // xy\r\n\t\tvertices += (w + 1) * (d + 1) * 2; // xz\r\n\t\tvertices += (d + 1) * (h + 1) * 2; // zy\r\n\r\n\t\treturn vertices;\r\n\r\n\t}\r\n\r\n\tfunction calculateIndexCount ( w, h, d ) {\r\n\r\n\t\tvar index = 0;\r\n\r\n\t\t// calculate the amount of squares for each side\r\n\t\tindex += w * h * 2; // xy\r\n\t\tindex += w * d * 2; // xz\r\n\t\tindex += d * h * 2; // zy\r\n\r\n\t\treturn index * 6; // two triangles per square => six vertices per square\r\n\r\n\t}\r\n\r\n\tfunction buildPlane ( u, v, w, udir, vdir, width, height, depth, gridX, gridY, materialIndex ) {\r\n\r\n\t\tvar segmentWidth\t= width / gridX;\r\n\t\tvar segmentHeight = height / gridY;\r\n\r\n\t\tvar widthHalf = width / 2;\r\n\t\tvar heightHalf = height / 2;\r\n\t\tvar depthHalf = depth / 2;\r\n\r\n\t\tvar gridX1 = gridX + 1;\r\n\t\tvar gridY1 = gridY + 1;\r\n\r\n\t\tvar vertexCounter = 0;\r\n\t\tvar groupCount = 0;\r\n\r\n\t\tvar vector = new THREE.Vector3();\r\n\r\n\t\t// generate vertices, normals and uvs\r\n\r\n\t\tfor ( var iy = 0; iy < gridY1; iy ++ ) {\r\n\r\n\t\t\tvar y = iy * segmentHeight - heightHalf;\r\n\r\n\t\t\tfor ( var ix = 0; ix < gridX1; ix ++ ) {\r\n\r\n\t\t\t\tvar x = ix * segmentWidth - widthHalf;\r\n\r\n\t\t\t\t// set values to correct vector component\r\n\t\t\t\tvector[ u ] = x * udir;\r\n\t\t\t\tvector[ v ] = y * vdir;\r\n\t\t\t\tvector[ w ] = depthHalf;\r\n\r\n\t\t\t\t// now apply vector to vertex buffer\r\n\t\t\t\tvertices[ vertexBufferOffset ] = vector.x;\r\n\t\t\t\tvertices[ vertexBufferOffset + 1 ] = vector.y;\r\n\t\t\t\tvertices[ vertexBufferOffset + 2 ] = vector.z;\r\n\r\n\t\t\t\t// set values to correct vector component\r\n\t\t\t\tvector[ u ] = 0;\r\n\t\t\t\tvector[ v ] = 0;\r\n\t\t\t\tvector[ w ] = depth > 0 ? 1 : - 1;\r\n\r\n\t\t\t\t// now apply vector to normal buffer\r\n\t\t\t\tnormals[ vertexBufferOffset ] = vector.x;\r\n\t\t\t\tnormals[ vertexBufferOffset + 1 ] = vector.y;\r\n\t\t\t\tnormals[ vertexBufferOffset + 2 ] = vector.z;\r\n\r\n\t\t\t\t// uvs\r\n\t\t\t\tuvs[ uvBufferOffset ] = ix / gridX;\r\n\t\t\t\tuvs[ uvBufferOffset + 1 ] = 1 - ( iy / gridY );\r\n\r\n\t\t\t\t// update offsets and counters\r\n\t\t\t\tvertexBufferOffset += 3;\r\n\t\t\t\tuvBufferOffset += 2;\r\n\t\t\t\tvertexCounter += 1;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// 1. you need three indices to draw a single face\r\n\t\t// 2. a single segment consists of two faces\r\n\t\t// 3. so we need to generate six (2*3) indices per segment\r\n\r\n\t\tfor ( iy = 0; iy < gridY; iy ++ ) {\r\n\r\n\t\t\tfor ( ix = 0; ix < gridX; ix ++ ) {\r\n\r\n\t\t\t\t// indices\r\n\t\t\t\tvar a = numberOfVertices + ix + gridX1 * iy;\r\n\t\t\t\tvar b = numberOfVertices + ix + gridX1 * ( iy + 1 );\r\n\t\t\t\tvar c = numberOfVertices + ( ix + 1 ) + gridX1 * ( iy + 1 );\r\n\t\t\t\tvar d = numberOfVertices + ( ix + 1 ) + gridX1 * iy;\r\n\r\n\t\t\t\t// face one\r\n\t\t\t\tindices[ indexBufferOffset ] = a;\r\n\t\t\t\tindices[ indexBufferOffset + 1 ] = b;\r\n\t\t\t\tindices[ indexBufferOffset + 2 ] = d;\r\n\r\n\t\t\t\t// face two\r\n\t\t\t\tindices[ indexBufferOffset + 3 ] = b;\r\n\t\t\t\tindices[ indexBufferOffset + 4 ] = c;\r\n\t\t\t\tindices[ indexBufferOffset + 5 ] = d;\r\n\r\n\t\t\t\t// update offsets and counters\r\n\t\t\t\tindexBufferOffset += 6;\r\n\t\t\t\tgroupCount += 6;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// add a group to the geometry. this will ensure multi material support\r\n\t\tscope.addGroup( groupStart, groupCount, materialIndex );\r\n\r\n\t\t// calculate new start value for groups\r\n\t\tgroupStart += groupCount;\r\n\r\n\t\t// update total number of vertices\r\n\t\tnumberOfVertices += vertexCounter;\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.BoxBufferGeometry.prototype = Object.create( THREE.BufferGeometry.prototype );\r\nTHREE.BoxBufferGeometry.prototype.constructor = THREE.BoxBufferGeometry;\r\n\r\n// File:src/extras/geometries/CircleGeometry.js\r\n\r\n/**\r\n * @author hughes\r\n */\r\n\r\nTHREE.CircleGeometry = function ( radius, segments, thetaStart, thetaLength ) {\r\n\r\n\tTHREE.Geometry.call( this );\r\n\r\n\tthis.type = 'CircleGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tradius: radius,\r\n\t\tsegments: segments,\r\n\t\tthetaStart: thetaStart,\r\n\t\tthetaLength: thetaLength\r\n\t};\r\n\r\n\tthis.fromBufferGeometry( new THREE.CircleBufferGeometry( radius, segments, thetaStart, thetaLength ) );\r\n\r\n};\r\n\r\nTHREE.CircleGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.CircleGeometry.prototype.constructor = THREE.CircleGeometry;\r\n\r\n// File:src/extras/geometries/CircleBufferGeometry.js\r\n\r\n/**\r\n * @author benaadams / https://twitter.com/ben_a_adams\r\n */\r\n\r\nTHREE.CircleBufferGeometry = function ( radius, segments, thetaStart, thetaLength ) {\r\n\r\n\tTHREE.BufferGeometry.call( this );\r\n\r\n\tthis.type = 'CircleBufferGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tradius: radius,\r\n\t\tsegments: segments,\r\n\t\tthetaStart: thetaStart,\r\n\t\tthetaLength: thetaLength\r\n\t};\r\n\r\n\tradius = radius || 50;\r\n\tsegments = segments !== undefined ? Math.max( 3, segments ) : 8;\r\n\r\n\tthetaStart = thetaStart !== undefined ? thetaStart : 0;\r\n\tthetaLength = thetaLength !== undefined ? thetaLength : Math.PI * 2;\r\n\r\n\tvar vertices = segments + 2;\r\n\r\n\tvar positions = new Float32Array( vertices * 3 );\r\n\tvar normals = new Float32Array( vertices * 3 );\r\n\tvar uvs = new Float32Array( vertices * 2 );\r\n\r\n\t// center data is already zero, but need to set a few extras\r\n\tnormals[ 2 ] = 1.0;\r\n\tuvs[ 0 ] = 0.5;\r\n\tuvs[ 1 ] = 0.5;\r\n\r\n\tfor ( var s = 0, i = 3, ii = 2 ; s <= segments; s ++, i += 3, ii += 2 ) {\r\n\r\n\t\tvar segment = thetaStart + s / segments * thetaLength;\r\n\r\n\t\tpositions[ i ] = radius * Math.cos( segment );\r\n\t\tpositions[ i + 1 ] = radius * Math.sin( segment );\r\n\r\n\t\tnormals[ i + 2 ] = 1; // normal z\r\n\r\n\t\tuvs[ ii ] = ( positions[ i ] / radius + 1 ) / 2;\r\n\t\tuvs[ ii + 1 ] = ( positions[ i + 1 ] / radius + 1 ) / 2;\r\n\r\n\t}\r\n\r\n\tvar indices = [];\r\n\r\n\tfor ( var i = 1; i <= segments; i ++ ) {\r\n\r\n\t\tindices.push( i, i + 1, 0 );\r\n\r\n\t}\r\n\r\n\tthis.setIndex( new THREE.BufferAttribute( new Uint16Array( indices ), 1 ) );\r\n\tthis.addAttribute( 'position', new THREE.BufferAttribute( positions, 3 ) );\r\n\tthis.addAttribute( 'normal', new THREE.BufferAttribute( normals, 3 ) );\r\n\tthis.addAttribute( 'uv', new THREE.BufferAttribute( uvs, 2 ) );\r\n\r\n\tthis.boundingSphere = new THREE.Sphere( new THREE.Vector3(), radius );\r\n\r\n};\r\n\r\nTHREE.CircleBufferGeometry.prototype = Object.create( THREE.BufferGeometry.prototype );\r\nTHREE.CircleBufferGeometry.prototype.constructor = THREE.CircleBufferGeometry;\r\n\r\n// File:src/extras/geometries/CylinderBufferGeometry.js\r\n\r\n/**\r\n * @author Mugen87 / https://github.com/Mugen87\r\n */\r\n\r\nTHREE.CylinderBufferGeometry = function( radiusTop, radiusBottom, height, radialSegments, heightSegments, openEnded, thetaStart, thetaLength ) {\r\n\r\n\tTHREE.BufferGeometry.call( this );\r\n\r\n\tthis.type = 'CylinderBufferGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tradiusTop: radiusTop,\r\n\t\tradiusBottom: radiusBottom,\r\n\t\theight: height,\r\n\t\tradialSegments: radialSegments,\r\n\t\theightSegments: heightSegments,\r\n\t\topenEnded: openEnded,\r\n\t\tthetaStart: thetaStart,\r\n\t\tthetaLength: thetaLength\r\n\t};\r\n\r\n\tvar scope = this;\r\n\r\n\tradiusTop = radiusTop !== undefined ? radiusTop : 20;\r\n\tradiusBottom = radiusBottom !== undefined ? radiusBottom : 20;\r\n\theight = height !== undefined ? height : 100;\r\n\r\n\tradialSegments = Math.floor( radialSegments ) || 8;\r\n\theightSegments = Math.floor( heightSegments ) || 1;\r\n\r\n\topenEnded = openEnded !== undefined ? openEnded : false;\r\n\tthetaStart = thetaStart !== undefined ? thetaStart : 0.0;\r\n\tthetaLength = thetaLength !== undefined ? thetaLength : 2.0 * Math.PI;\r\n\r\n\t// used to calculate buffer length\r\n\r\n\tvar nbCap = 0;\r\n\r\n\tif ( openEnded === false ) {\r\n\r\n\t\tif ( radiusTop > 0 ) nbCap ++;\r\n\t\tif ( radiusBottom > 0 ) nbCap ++;\r\n\r\n\t}\r\n\r\n\tvar vertexCount = calculateVertexCount();\r\n\tvar indexCount = calculateIndexCount();\r\n\r\n\t// buffers\r\n\r\n\tvar indices = new THREE.BufferAttribute( new ( indexCount > 65535 ? Uint32Array : Uint16Array )( indexCount ), 1 );\r\n\tvar vertices = new THREE.BufferAttribute( new Float32Array( vertexCount * 3 ), 3 );\r\n\tvar normals = new THREE.BufferAttribute( new Float32Array( vertexCount * 3 ), 3 );\r\n\tvar uvs = new THREE.BufferAttribute( new Float32Array( vertexCount * 2 ), 2 );\r\n\r\n\t// helper variables\r\n\r\n\tvar index = 0,\r\n\t    indexOffset = 0,\r\n\t    indexArray = [],\r\n\t    halfHeight = height / 2;\r\n\r\n\t// group variables\r\n\tvar groupStart = 0;\r\n\r\n\t// generate geometry\r\n\r\n\tgenerateTorso();\r\n\r\n\tif ( openEnded === false ) {\r\n\r\n\t\tif ( radiusTop > 0 ) generateCap( true );\r\n\t\tif ( radiusBottom > 0 ) generateCap( false );\r\n\r\n\t}\r\n\r\n\t// build geometry\r\n\r\n\tthis.setIndex( indices );\r\n\tthis.addAttribute( 'position', vertices );\r\n\tthis.addAttribute( 'normal', normals );\r\n\tthis.addAttribute( 'uv', uvs );\r\n\r\n\t// helper functions\r\n\r\n\tfunction calculateVertexCount() {\r\n\r\n\t\tvar count = ( radialSegments + 1 ) * ( heightSegments + 1 );\r\n\r\n\t\tif ( openEnded === false ) {\r\n\r\n\t\t\tcount += ( ( radialSegments + 1 ) * nbCap ) + ( radialSegments * nbCap );\r\n\r\n\t\t}\r\n\r\n\t\treturn count;\r\n\r\n\t}\r\n\r\n\tfunction calculateIndexCount() {\r\n\r\n\t\tvar count = radialSegments * heightSegments * 2 * 3;\r\n\r\n\t\tif ( openEnded === false ) {\r\n\r\n\t\t\tcount += radialSegments * nbCap * 3;\r\n\r\n\t\t}\r\n\r\n\t\treturn count;\r\n\r\n\t}\r\n\r\n\tfunction generateTorso() {\r\n\r\n\t\tvar x, y;\r\n\t\tvar normal = new THREE.Vector3();\r\n\t\tvar vertex = new THREE.Vector3();\r\n\r\n\t\tvar groupCount = 0;\r\n\r\n\t\t// this will be used to calculate the normal\r\n\t\tvar tanTheta = ( radiusBottom - radiusTop ) / height;\r\n\r\n\t\t// generate vertices, normals and uvs\r\n\r\n\t\tfor ( y = 0; y <= heightSegments; y ++ ) {\r\n\r\n\t\t\tvar indexRow = [];\r\n\r\n\t\t\tvar v = y / heightSegments;\r\n\r\n\t\t\t// calculate the radius of the current row\r\n\t\t\tvar radius = v * ( radiusBottom - radiusTop ) + radiusTop;\r\n\r\n\t\t\tfor ( x = 0; x <= radialSegments; x ++ ) {\r\n\r\n\t\t\t\tvar u = x / radialSegments;\r\n\r\n\t\t\t\t// vertex\r\n\t\t\t\tvertex.x = radius * Math.sin( u * thetaLength + thetaStart );\r\n\t\t\t\tvertex.y = - v * height + halfHeight;\r\n\t\t\t\tvertex.z = radius * Math.cos( u * thetaLength + thetaStart );\r\n\t\t\t\tvertices.setXYZ( index, vertex.x, vertex.y, vertex.z );\r\n\r\n\t\t\t\t// normal\r\n\t\t\t\tnormal.copy( vertex );\r\n\r\n\t\t\t\t// handle special case if radiusTop/radiusBottom is zero\r\n\r\n\t\t\t\tif ( ( radiusTop === 0 && y === 0 ) || ( radiusBottom === 0 && y === heightSegments ) ) {\r\n\r\n\t\t\t\t\tnormal.x = Math.sin( u * thetaLength + thetaStart );\r\n\t\t\t\t\tnormal.z = Math.cos( u * thetaLength + thetaStart );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tnormal.setY( Math.sqrt( normal.x * normal.x + normal.z * normal.z ) * tanTheta ).normalize();\r\n\t\t\t\tnormals.setXYZ( index, normal.x, normal.y, normal.z );\r\n\r\n\t\t\t\t// uv\r\n\t\t\t\tuvs.setXY( index, u, 1 - v );\r\n\r\n\t\t\t\t// save index of vertex in respective row\r\n\t\t\t\tindexRow.push( index );\r\n\r\n\t\t\t\t// increase index\r\n\t\t\t\tindex ++;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// now save vertices of the row in our index array\r\n\t\t\tindexArray.push( indexRow );\r\n\r\n\t\t}\r\n\r\n\t\t// generate indices\r\n\r\n\t\tfor ( x = 0; x < radialSegments; x ++ ) {\r\n\r\n\t\t\tfor ( y = 0; y < heightSegments; y ++ ) {\r\n\r\n\t\t\t\t// we use the index array to access the correct indices\r\n\t\t\t\tvar i1 = indexArray[ y ][ x ];\r\n\t\t\t\tvar i2 = indexArray[ y + 1 ][ x ];\r\n\t\t\t\tvar i3 = indexArray[ y + 1 ][ x + 1 ];\r\n\t\t\t\tvar i4 = indexArray[ y ][ x + 1 ];\r\n\r\n\t\t\t\t// face one\r\n\t\t\t\tindices.setX( indexOffset, i1 ); indexOffset ++;\r\n\t\t\t\tindices.setX( indexOffset, i2 ); indexOffset ++;\r\n\t\t\t\tindices.setX( indexOffset, i4 ); indexOffset ++;\r\n\r\n\t\t\t\t// face two\r\n\t\t\t\tindices.setX( indexOffset, i2 ); indexOffset ++;\r\n\t\t\t\tindices.setX( indexOffset, i3 ); indexOffset ++;\r\n\t\t\t\tindices.setX( indexOffset, i4 ); indexOffset ++;\r\n\r\n\t\t\t\t// update counters\r\n\t\t\t\tgroupCount += 6;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// add a group to the geometry. this will ensure multi material support\r\n\t\tscope.addGroup( groupStart, groupCount, 0 );\r\n\r\n\t\t// calculate new start value for groups\r\n\t\tgroupStart += groupCount;\r\n\r\n\t}\r\n\r\n\tfunction generateCap( top ) {\r\n\r\n\t\tvar x, centerIndexStart, centerIndexEnd;\r\n\r\n\t\tvar uv = new THREE.Vector2();\r\n\t\tvar vertex = new THREE.Vector3();\r\n\r\n\t\tvar groupCount = 0;\r\n\r\n\t\tvar radius = ( top === true ) ? radiusTop : radiusBottom;\r\n\t\tvar sign = ( top === true ) ? 1 : - 1;\r\n\r\n\t\t// save the index of the first center vertex\r\n\t\tcenterIndexStart = index;\r\n\r\n\t\t// first we generate the center vertex data of the cap.\r\n\t\t// because the geometry needs one set of uvs per face,\r\n\t\t// we must generate a center vertex per face/segment\r\n\r\n\t\tfor ( x = 1; x <= radialSegments; x ++ ) {\r\n\r\n\t\t\t// vertex\r\n\t\t\tvertices.setXYZ( index, 0, halfHeight * sign, 0 );\r\n\r\n\t\t\t// normal\r\n\t\t\tnormals.setXYZ( index, 0, sign, 0 );\r\n\r\n\t\t\t// uv\r\n\t\t\tuv.x = 0.5;\r\n\t\t\tuv.y = 0.5;\r\n\r\n\t\t\tuvs.setXY( index, uv.x, uv.y );\r\n\r\n\t\t\t// increase index\r\n\t\t\tindex ++;\r\n\r\n\t\t}\r\n\r\n\t\t// save the index of the last center vertex\r\n\t\tcenterIndexEnd = index;\r\n\r\n\t\t// now we generate the surrounding vertices, normals and uvs\r\n\r\n\t\tfor ( x = 0; x <= radialSegments; x ++ ) {\r\n\r\n\t\t\tvar u = x / radialSegments;\r\n\t\t\tvar theta = u * thetaLength + thetaStart;\r\n\r\n\t\t\tvar cosTheta = Math.cos( theta );\r\n\t\t\tvar sinTheta = Math.sin( theta );\r\n\r\n\t\t\t// vertex\r\n\t\t\tvertex.x = radius * sinTheta;\r\n\t\t\tvertex.y = halfHeight * sign;\r\n\t\t\tvertex.z = radius * cosTheta;\r\n\t\t\tvertices.setXYZ( index, vertex.x, vertex.y, vertex.z );\r\n\r\n\t\t\t// normal\r\n\t\t\tnormals.setXYZ( index, 0, sign, 0 );\r\n\r\n\t\t\t// uv\r\n\t\t\tuv.x = ( cosTheta * 0.5 ) + 0.5;\r\n\t\t\tuv.y = ( sinTheta * 0.5 * sign ) + 0.5;\r\n\t\t\tuvs.setXY( index, uv.x, uv.y );\r\n\r\n\t\t\t// increase index\r\n\t\t\tindex ++;\r\n\r\n\t\t}\r\n\r\n\t\t// generate indices\r\n\r\n\t\tfor ( x = 0; x < radialSegments; x ++ ) {\r\n\r\n\t\t\tvar c = centerIndexStart + x;\r\n\t\t\tvar i = centerIndexEnd + x;\r\n\r\n\t\t\tif ( top === true ) {\r\n\r\n\t\t\t\t// face top\r\n\t\t\t\tindices.setX( indexOffset, i ); indexOffset ++;\r\n\t\t\t\tindices.setX( indexOffset, i + 1 ); indexOffset ++;\r\n\t\t\t\tindices.setX( indexOffset, c ); indexOffset ++;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// face bottom\r\n\t\t\t\tindices.setX( indexOffset, i + 1 ); indexOffset ++;\r\n\t\t\t\tindices.setX( indexOffset, i ); indexOffset ++;\r\n\t\t\t\tindices.setX( indexOffset, c ); indexOffset ++;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// update counters\r\n\t\t\tgroupCount += 3;\r\n\r\n\t\t}\r\n\r\n\t\t// add a group to the geometry. this will ensure multi material support\r\n\t\tscope.addGroup( groupStart, groupCount, top === true ? 1 : 2 );\r\n\r\n\t\t// calculate new start value for groups\r\n\t\tgroupStart += groupCount;\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.CylinderBufferGeometry.prototype = Object.create( THREE.BufferGeometry.prototype );\r\nTHREE.CylinderBufferGeometry.prototype.constructor = THREE.CylinderBufferGeometry;\r\n\r\n// File:src/extras/geometries/CylinderGeometry.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.CylinderGeometry = function ( radiusTop, radiusBottom, height, radialSegments, heightSegments, openEnded, thetaStart, thetaLength ) {\r\n\r\n\tTHREE.Geometry.call( this );\r\n\r\n\tthis.type = 'CylinderGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tradiusTop: radiusTop,\r\n\t\tradiusBottom: radiusBottom,\r\n\t\theight: height,\r\n\t\tradialSegments: radialSegments,\r\n\t\theightSegments: heightSegments,\r\n\t\topenEnded: openEnded,\r\n\t\tthetaStart: thetaStart,\r\n\t\tthetaLength: thetaLength\r\n\t};\r\n\r\n\tthis.fromBufferGeometry( new THREE.CylinderBufferGeometry( radiusTop, radiusBottom, height, radialSegments, heightSegments, openEnded, thetaStart, thetaLength ) );\r\n\tthis.mergeVertices();\r\n\r\n};\r\n\r\nTHREE.CylinderGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.CylinderGeometry.prototype.constructor = THREE.CylinderGeometry;\r\n\r\n// File:src/extras/geometries/ConeBufferGeometry.js\r\n\r\n/*\r\n * @author: abelnation / http://github.com/abelnation\r\n */\r\n\r\nTHREE.ConeBufferGeometry = function (\r\n\tradius, height,\r\n\tradialSegments, heightSegments,\r\n\topenEnded, thetaStart, thetaLength ) {\r\n\r\n\tTHREE.CylinderBufferGeometry.call( this,\r\n\t\t0, radius, height,\r\n\t\tradialSegments, heightSegments,\r\n\t\topenEnded, thetaStart, thetaLength );\r\n\r\n\tthis.type = 'ConeBufferGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tradius: radius,\r\n\t\theight: height,\r\n\t\tradialSegments: radialSegments,\r\n\t\theightSegments: heightSegments,\r\n\t\tthetaStart: thetaStart,\r\n\t\tthetaLength: thetaLength\r\n\t};\r\n\r\n};\r\n\r\nTHREE.ConeBufferGeometry.prototype = Object.create( THREE.BufferGeometry.prototype );\r\nTHREE.ConeBufferGeometry.prototype.constructor = THREE.ConeBufferGeometry;\r\n\r\n// File:src/extras/geometries/ConeGeometry.js\r\n\r\n/**\r\n * @author abelnation / http://github.com/abelnation\r\n */\r\n\r\nTHREE.ConeGeometry = function (\r\n\tradius, height,\r\n\tradialSegments, heightSegments,\r\n\topenEnded, thetaStart, thetaLength ) {\r\n\r\n\tTHREE.CylinderGeometry.call( this,\r\n\t\t0, radius, height,\r\n\t\tradialSegments, heightSegments,\r\n\t\topenEnded, thetaStart, thetaLength );\r\n\r\n\tthis.type = 'ConeGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tradius: radius,\r\n\t\theight: height,\r\n\t\tradialSegments: radialSegments,\r\n\t\theightSegments: heightSegments,\r\n\t\topenEnded: openEnded,\r\n\t\tthetaStart: thetaStart,\r\n\t\tthetaLength: thetaLength\r\n\t};\r\n\r\n};\r\n\r\nTHREE.ConeGeometry.prototype = Object.create( THREE.CylinderGeometry.prototype );\r\nTHREE.ConeGeometry.prototype.constructor = THREE.ConeGeometry;\r\n\r\n// File:src/extras/geometries/EdgesGeometry.js\r\n\r\n/**\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.EdgesGeometry = function ( geometry, thresholdAngle ) {\r\n\r\n\tTHREE.BufferGeometry.call( this );\r\n\r\n\tthresholdAngle = ( thresholdAngle !== undefined ) ? thresholdAngle : 1;\r\n\r\n\tvar thresholdDot = Math.cos( THREE.Math.DEG2RAD * thresholdAngle );\r\n\r\n\tvar edge = [ 0, 0 ], hash = {};\r\n\r\n\tfunction sortFunction( a, b ) {\r\n\r\n\t\treturn a - b;\r\n\r\n\t}\r\n\r\n\tvar keys = [ 'a', 'b', 'c' ];\r\n\r\n\tvar geometry2;\r\n\r\n\tif ( geometry instanceof THREE.BufferGeometry ) {\r\n\r\n\t\tgeometry2 = new THREE.Geometry();\r\n\t\tgeometry2.fromBufferGeometry( geometry );\r\n\r\n\t} else {\r\n\r\n\t\tgeometry2 = geometry.clone();\r\n\r\n\t}\r\n\r\n\tgeometry2.mergeVertices();\r\n\tgeometry2.computeFaceNormals();\r\n\r\n\tvar vertices = geometry2.vertices;\r\n\tvar faces = geometry2.faces;\r\n\r\n\tfor ( var i = 0, l = faces.length; i < l; i ++ ) {\r\n\r\n\t\tvar face = faces[ i ];\r\n\r\n\t\tfor ( var j = 0; j < 3; j ++ ) {\r\n\r\n\t\t\tedge[ 0 ] = face[ keys[ j ] ];\r\n\t\t\tedge[ 1 ] = face[ keys[ ( j + 1 ) % 3 ] ];\r\n\t\t\tedge.sort( sortFunction );\r\n\r\n\t\t\tvar key = edge.toString();\r\n\r\n\t\t\tif ( hash[ key ] === undefined ) {\r\n\r\n\t\t\t\thash[ key ] = { vert1: edge[ 0 ], vert2: edge[ 1 ], face1: i, face2: undefined };\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\thash[ key ].face2 = i;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tvar coords = [];\r\n\r\n\tfor ( var key in hash ) {\r\n\r\n\t\tvar h = hash[ key ];\r\n\r\n\t\tif ( h.face2 === undefined || faces[ h.face1 ].normal.dot( faces[ h.face2 ].normal ) <= thresholdDot ) {\r\n\r\n\t\t\tvar vertex = vertices[ h.vert1 ];\r\n\t\t\tcoords.push( vertex.x );\r\n\t\t\tcoords.push( vertex.y );\r\n\t\t\tcoords.push( vertex.z );\r\n\r\n\t\t\tvertex = vertices[ h.vert2 ];\r\n\t\t\tcoords.push( vertex.x );\r\n\t\t\tcoords.push( vertex.y );\r\n\t\t\tcoords.push( vertex.z );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tthis.addAttribute( 'position', new THREE.BufferAttribute( new Float32Array( coords ), 3 ) );\r\n\r\n};\r\n\r\nTHREE.EdgesGeometry.prototype = Object.create( THREE.BufferGeometry.prototype );\r\nTHREE.EdgesGeometry.prototype.constructor = THREE.EdgesGeometry;\r\n\r\n// File:src/extras/geometries/ExtrudeGeometry.js\r\n\r\n/**\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n *\r\n * Creates extruded geometry from a path shape.\r\n *\r\n * parameters = {\r\n *\r\n *  curveSegments: <int>, // number of points on the curves\r\n *  steps: <int>, // number of points for z-side extrusions / used for subdividing segments of extrude spline too\r\n *  amount: <int>, // Depth to extrude the shape\r\n *\r\n *  bevelEnabled: <bool>, // turn on bevel\r\n *  bevelThickness: <float>, // how deep into the original shape bevel goes\r\n *  bevelSize: <float>, // how far from shape outline is bevel\r\n *  bevelSegments: <int>, // number of bevel layers\r\n *\r\n *  extrudePath: <THREE.CurvePath> // 3d spline path to extrude shape along. (creates Frames if .frames aren't defined)\r\n *  frames: <THREE.TubeGeometry.FrenetFrames> // containing arrays of tangents, normals, binormals\r\n *\r\n *  uvGenerator: <Object> // object that provides UV generator functions\r\n *\r\n * }\r\n **/\r\n\r\nTHREE.ExtrudeGeometry = function ( shapes, options ) {\r\n\r\n\tif ( typeof( shapes ) === \"undefined\" ) {\r\n\r\n\t\tshapes = [];\r\n\t\treturn;\r\n\r\n\t}\r\n\r\n\tTHREE.Geometry.call( this );\r\n\r\n\tthis.type = 'ExtrudeGeometry';\r\n\r\n\tshapes = Array.isArray( shapes ) ? shapes : [ shapes ];\r\n\r\n\tthis.addShapeList( shapes, options );\r\n\r\n\tthis.computeFaceNormals();\r\n\r\n\t// can't really use automatic vertex normals\r\n\t// as then front and back sides get smoothed too\r\n\t// should do separate smoothing just for sides\r\n\r\n\t//this.computeVertexNormals();\r\n\r\n\t//console.log( \"took\", ( Date.now() - startTime ) );\r\n\r\n};\r\n\r\nTHREE.ExtrudeGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.ExtrudeGeometry.prototype.constructor = THREE.ExtrudeGeometry;\r\n\r\nTHREE.ExtrudeGeometry.prototype.addShapeList = function ( shapes, options ) {\r\n\r\n\tvar sl = shapes.length;\r\n\r\n\tfor ( var s = 0; s < sl; s ++ ) {\r\n\r\n\t\tvar shape = shapes[ s ];\r\n\t\tthis.addShape( shape, options );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.ExtrudeGeometry.prototype.addShape = function ( shape, options ) {\r\n\r\n\tvar amount = options.amount !== undefined ? options.amount : 100;\r\n\r\n\tvar bevelThickness = options.bevelThickness !== undefined ? options.bevelThickness : 6; // 10\r\n\tvar bevelSize = options.bevelSize !== undefined ? options.bevelSize : bevelThickness - 2; // 8\r\n\tvar bevelSegments = options.bevelSegments !== undefined ? options.bevelSegments : 3;\r\n\r\n\tvar bevelEnabled = options.bevelEnabled !== undefined ? options.bevelEnabled : true; // false\r\n\r\n\tvar curveSegments = options.curveSegments !== undefined ? options.curveSegments : 12;\r\n\r\n\tvar steps = options.steps !== undefined ? options.steps : 1;\r\n\r\n\tvar extrudePath = options.extrudePath;\r\n\tvar extrudePts, extrudeByPath = false;\r\n\r\n\t// Use default WorldUVGenerator if no UV generators are specified.\r\n\tvar uvgen = options.UVGenerator !== undefined ? options.UVGenerator : THREE.ExtrudeGeometry.WorldUVGenerator;\r\n\r\n\tvar splineTube, binormal, normal, position2;\r\n\tif ( extrudePath ) {\r\n\r\n\t\textrudePts = extrudePath.getSpacedPoints( steps );\r\n\r\n\t\textrudeByPath = true;\r\n\t\tbevelEnabled = false; // bevels not supported for path extrusion\r\n\r\n\t\t// SETUP TNB variables\r\n\r\n\t\t// Reuse TNB from TubeGeomtry for now.\r\n\t\t// TODO1 - have a .isClosed in spline?\r\n\r\n\t\tsplineTube = options.frames !== undefined ? options.frames : new THREE.TubeGeometry.FrenetFrames( extrudePath, steps, false );\r\n\r\n\t\t// console.log(splineTube, 'splineTube', splineTube.normals.length, 'steps', steps, 'extrudePts', extrudePts.length);\r\n\r\n\t\tbinormal = new THREE.Vector3();\r\n\t\tnormal = new THREE.Vector3();\r\n\t\tposition2 = new THREE.Vector3();\r\n\r\n\t}\r\n\r\n\t// Safeguards if bevels are not enabled\r\n\r\n\tif ( ! bevelEnabled ) {\r\n\r\n\t\tbevelSegments = 0;\r\n\t\tbevelThickness = 0;\r\n\t\tbevelSize = 0;\r\n\r\n\t}\r\n\r\n\t// Variables initialization\r\n\r\n\tvar ahole, h, hl; // looping of holes\r\n\tvar scope = this;\r\n\r\n\tvar shapesOffset = this.vertices.length;\r\n\r\n\tvar shapePoints = shape.extractPoints( curveSegments );\r\n\r\n\tvar vertices = shapePoints.shape;\r\n\tvar holes = shapePoints.holes;\r\n\r\n\tvar reverse = ! THREE.ShapeUtils.isClockWise( vertices );\r\n\r\n\tif ( reverse ) {\r\n\r\n\t\tvertices = vertices.reverse();\r\n\r\n\t\t// Maybe we should also check if holes are in the opposite direction, just to be safe ...\r\n\r\n\t\tfor ( h = 0, hl = holes.length; h < hl; h ++ ) {\r\n\r\n\t\t\tahole = holes[ h ];\r\n\r\n\t\t\tif ( THREE.ShapeUtils.isClockWise( ahole ) ) {\r\n\r\n\t\t\t\tholes[ h ] = ahole.reverse();\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treverse = false; // If vertices are in order now, we shouldn't need to worry about them again (hopefully)!\r\n\r\n\t}\r\n\r\n\r\n\tvar faces = THREE.ShapeUtils.triangulateShape( vertices, holes );\r\n\r\n\t/* Vertices */\r\n\r\n\tvar contour = vertices; // vertices has all points but contour has only points of circumference\r\n\r\n\tfor ( h = 0, hl = holes.length; h < hl; h ++ ) {\r\n\r\n\t\tahole = holes[ h ];\r\n\r\n\t\tvertices = vertices.concat( ahole );\r\n\r\n\t}\r\n\r\n\r\n\tfunction scalePt2 ( pt, vec, size ) {\r\n\r\n\t\tif ( ! vec ) console.error( \"THREE.ExtrudeGeometry: vec does not exist\" );\r\n\r\n\t\treturn vec.clone().multiplyScalar( size ).add( pt );\r\n\r\n\t}\r\n\r\n\tvar b, bs, t, z,\r\n\t\tvert, vlen = vertices.length,\r\n\t\tface, flen = faces.length;\r\n\r\n\r\n\t// Find directions for point movement\r\n\r\n\r\n\tfunction getBevelVec( inPt, inPrev, inNext ) {\r\n\r\n\t\t// computes for inPt the corresponding point inPt' on a new contour\r\n\t\t//   shifted by 1 unit (length of normalized vector) to the left\r\n\t\t// if we walk along contour clockwise, this new contour is outside the old one\r\n\t\t//\r\n\t\t// inPt' is the intersection of the two lines parallel to the two\r\n\t\t//  adjacent edges of inPt at a distance of 1 unit on the left side.\r\n\r\n\t\tvar v_trans_x, v_trans_y, shrink_by = 1;\t\t// resulting translation vector for inPt\r\n\r\n\t\t// good reading for geometry algorithms (here: line-line intersection)\r\n\t\t// http://geomalgorithms.com/a05-_intersect-1.html\r\n\r\n\t\tvar v_prev_x = inPt.x - inPrev.x, v_prev_y = inPt.y - inPrev.y;\r\n\t\tvar v_next_x = inNext.x - inPt.x, v_next_y = inNext.y - inPt.y;\r\n\r\n\t\tvar v_prev_lensq = ( v_prev_x * v_prev_x + v_prev_y * v_prev_y );\r\n\r\n\t\t// check for collinear edges\r\n\t\tvar collinear0 = ( v_prev_x * v_next_y - v_prev_y * v_next_x );\r\n\r\n\t\tif ( Math.abs( collinear0 ) > Number.EPSILON ) {\r\n\r\n\t\t\t// not collinear\r\n\r\n\t\t\t// length of vectors for normalizing\r\n\r\n\t\t\tvar v_prev_len = Math.sqrt( v_prev_lensq );\r\n\t\t\tvar v_next_len = Math.sqrt( v_next_x * v_next_x + v_next_y * v_next_y );\r\n\r\n\t\t\t// shift adjacent points by unit vectors to the left\r\n\r\n\t\t\tvar ptPrevShift_x = ( inPrev.x - v_prev_y / v_prev_len );\r\n\t\t\tvar ptPrevShift_y = ( inPrev.y + v_prev_x / v_prev_len );\r\n\r\n\t\t\tvar ptNextShift_x = ( inNext.x - v_next_y / v_next_len );\r\n\t\t\tvar ptNextShift_y = ( inNext.y + v_next_x / v_next_len );\r\n\r\n\t\t\t// scaling factor for v_prev to intersection point\r\n\r\n\t\t\tvar sf = (  ( ptNextShift_x - ptPrevShift_x ) * v_next_y -\r\n\t\t\t\t\t\t( ptNextShift_y - ptPrevShift_y ) * v_next_x    ) /\r\n\t\t\t\t\t  ( v_prev_x * v_next_y - v_prev_y * v_next_x );\r\n\r\n\t\t\t// vector from inPt to intersection point\r\n\r\n\t\t\tv_trans_x = ( ptPrevShift_x + v_prev_x * sf - inPt.x );\r\n\t\t\tv_trans_y = ( ptPrevShift_y + v_prev_y * sf - inPt.y );\r\n\r\n\t\t\t// Don't normalize!, otherwise sharp corners become ugly\r\n\t\t\t//  but prevent crazy spikes\r\n\t\t\tvar v_trans_lensq = ( v_trans_x * v_trans_x + v_trans_y * v_trans_y );\r\n\t\t\tif ( v_trans_lensq <= 2 ) {\r\n\r\n\t\t\t\treturn\tnew THREE.Vector2( v_trans_x, v_trans_y );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tshrink_by = Math.sqrt( v_trans_lensq / 2 );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// handle special case of collinear edges\r\n\r\n\t\t\tvar direction_eq = false;\t\t// assumes: opposite\r\n\t\t\tif ( v_prev_x > Number.EPSILON ) {\r\n\r\n\t\t\t\tif ( v_next_x > Number.EPSILON ) {\r\n\r\n\t\t\t\t\tdirection_eq = true;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tif ( v_prev_x < - Number.EPSILON ) {\r\n\r\n\t\t\t\t\tif ( v_next_x < - Number.EPSILON ) {\r\n\r\n\t\t\t\t\t\tdirection_eq = true;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tif ( Math.sign( v_prev_y ) === Math.sign( v_next_y ) ) {\r\n\r\n\t\t\t\t\t\tdirection_eq = true;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( direction_eq ) {\r\n\r\n\t\t\t\t// console.log(\"Warning: lines are a straight sequence\");\r\n\t\t\t\tv_trans_x = - v_prev_y;\r\n\t\t\t\tv_trans_y =  v_prev_x;\r\n\t\t\t\tshrink_by = Math.sqrt( v_prev_lensq );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// console.log(\"Warning: lines are a straight spike\");\r\n\t\t\t\tv_trans_x = v_prev_x;\r\n\t\t\t\tv_trans_y = v_prev_y;\r\n\t\t\t\tshrink_by = Math.sqrt( v_prev_lensq / 2 );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn\tnew THREE.Vector2( v_trans_x / shrink_by, v_trans_y / shrink_by );\r\n\r\n\t}\r\n\r\n\r\n\tvar contourMovements = [];\r\n\r\n\tfor ( var i = 0, il = contour.length, j = il - 1, k = i + 1; i < il; i ++, j ++, k ++ ) {\r\n\r\n\t\tif ( j === il ) j = 0;\r\n\t\tif ( k === il ) k = 0;\r\n\r\n\t\t//  (j)---(i)---(k)\r\n\t\t// console.log('i,j,k', i, j , k)\r\n\r\n\t\tcontourMovements[ i ] = getBevelVec( contour[ i ], contour[ j ], contour[ k ] );\r\n\r\n\t}\r\n\r\n\tvar holesMovements = [], oneHoleMovements, verticesMovements = contourMovements.concat();\r\n\r\n\tfor ( h = 0, hl = holes.length; h < hl; h ++ ) {\r\n\r\n\t\tahole = holes[ h ];\r\n\r\n\t\toneHoleMovements = [];\r\n\r\n\t\tfor ( i = 0, il = ahole.length, j = il - 1, k = i + 1; i < il; i ++, j ++, k ++ ) {\r\n\r\n\t\t\tif ( j === il ) j = 0;\r\n\t\t\tif ( k === il ) k = 0;\r\n\r\n\t\t\t//  (j)---(i)---(k)\r\n\t\t\toneHoleMovements[ i ] = getBevelVec( ahole[ i ], ahole[ j ], ahole[ k ] );\r\n\r\n\t\t}\r\n\r\n\t\tholesMovements.push( oneHoleMovements );\r\n\t\tverticesMovements = verticesMovements.concat( oneHoleMovements );\r\n\r\n\t}\r\n\r\n\r\n\t// Loop bevelSegments, 1 for the front, 1 for the back\r\n\r\n\tfor ( b = 0; b < bevelSegments; b ++ ) {\r\n\r\n\t\t//for ( b = bevelSegments; b > 0; b -- ) {\r\n\r\n\t\tt = b / bevelSegments;\r\n\t\tz = bevelThickness * ( 1 - t );\r\n\r\n\t\t//z = bevelThickness * t;\r\n\t\tbs = bevelSize * ( Math.sin ( t * Math.PI / 2 ) ); // curved\r\n\t\t//bs = bevelSize * t; // linear\r\n\r\n\t\t// contract shape\r\n\r\n\t\tfor ( i = 0, il = contour.length; i < il; i ++ ) {\r\n\r\n\t\t\tvert = scalePt2( contour[ i ], contourMovements[ i ], bs );\r\n\r\n\t\t\tv( vert.x, vert.y,  - z );\r\n\r\n\t\t}\r\n\r\n\t\t// expand holes\r\n\r\n\t\tfor ( h = 0, hl = holes.length; h < hl; h ++ ) {\r\n\r\n\t\t\tahole = holes[ h ];\r\n\t\t\toneHoleMovements = holesMovements[ h ];\r\n\r\n\t\t\tfor ( i = 0, il = ahole.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tvert = scalePt2( ahole[ i ], oneHoleMovements[ i ], bs );\r\n\r\n\t\t\t\tv( vert.x, vert.y,  - z );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tbs = bevelSize;\r\n\r\n\t// Back facing vertices\r\n\r\n\tfor ( i = 0; i < vlen; i ++ ) {\r\n\r\n\t\tvert = bevelEnabled ? scalePt2( vertices[ i ], verticesMovements[ i ], bs ) : vertices[ i ];\r\n\r\n\t\tif ( ! extrudeByPath ) {\r\n\r\n\t\t\tv( vert.x, vert.y, 0 );\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// v( vert.x, vert.y + extrudePts[ 0 ].y, extrudePts[ 0 ].x );\r\n\r\n\t\t\tnormal.copy( splineTube.normals[ 0 ] ).multiplyScalar( vert.x );\r\n\t\t\tbinormal.copy( splineTube.binormals[ 0 ] ).multiplyScalar( vert.y );\r\n\r\n\t\t\tposition2.copy( extrudePts[ 0 ] ).add( normal ).add( binormal );\r\n\r\n\t\t\tv( position2.x, position2.y, position2.z );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// Add stepped vertices...\r\n\t// Including front facing vertices\r\n\r\n\tvar s;\r\n\r\n\tfor ( s = 1; s <= steps; s ++ ) {\r\n\r\n\t\tfor ( i = 0; i < vlen; i ++ ) {\r\n\r\n\t\t\tvert = bevelEnabled ? scalePt2( vertices[ i ], verticesMovements[ i ], bs ) : vertices[ i ];\r\n\r\n\t\t\tif ( ! extrudeByPath ) {\r\n\r\n\t\t\t\tv( vert.x, vert.y, amount / steps * s );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// v( vert.x, vert.y + extrudePts[ s - 1 ].y, extrudePts[ s - 1 ].x );\r\n\r\n\t\t\t\tnormal.copy( splineTube.normals[ s ] ).multiplyScalar( vert.x );\r\n\t\t\t\tbinormal.copy( splineTube.binormals[ s ] ).multiplyScalar( vert.y );\r\n\r\n\t\t\t\tposition2.copy( extrudePts[ s ] ).add( normal ).add( binormal );\r\n\r\n\t\t\t\tv( position2.x, position2.y, position2.z );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\r\n\t// Add bevel segments planes\r\n\r\n\t//for ( b = 1; b <= bevelSegments; b ++ ) {\r\n\tfor ( b = bevelSegments - 1; b >= 0; b -- ) {\r\n\r\n\t\tt = b / bevelSegments;\r\n\t\tz = bevelThickness * ( 1 - t );\r\n\t\t//bs = bevelSize * ( 1-Math.sin ( ( 1 - t ) * Math.PI/2 ) );\r\n\t\tbs = bevelSize * Math.sin ( t * Math.PI / 2 );\r\n\r\n\t\t// contract shape\r\n\r\n\t\tfor ( i = 0, il = contour.length; i < il; i ++ ) {\r\n\r\n\t\t\tvert = scalePt2( contour[ i ], contourMovements[ i ], bs );\r\n\t\t\tv( vert.x, vert.y,  amount + z );\r\n\r\n\t\t}\r\n\r\n\t\t// expand holes\r\n\r\n\t\tfor ( h = 0, hl = holes.length; h < hl; h ++ ) {\r\n\r\n\t\t\tahole = holes[ h ];\r\n\t\t\toneHoleMovements = holesMovements[ h ];\r\n\r\n\t\t\tfor ( i = 0, il = ahole.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tvert = scalePt2( ahole[ i ], oneHoleMovements[ i ], bs );\r\n\r\n\t\t\t\tif ( ! extrudeByPath ) {\r\n\r\n\t\t\t\t\tv( vert.x, vert.y,  amount + z );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tv( vert.x, vert.y + extrudePts[ steps - 1 ].y, extrudePts[ steps - 1 ].x + z );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/* Faces */\r\n\r\n\t// Top and bottom faces\r\n\r\n\tbuildLidFaces();\r\n\r\n\t// Sides faces\r\n\r\n\tbuildSideFaces();\r\n\r\n\r\n\t/////  Internal functions\r\n\r\n\tfunction buildLidFaces() {\r\n\r\n\t\tif ( bevelEnabled ) {\r\n\r\n\t\t\tvar layer = 0; // steps + 1\r\n\t\t\tvar offset = vlen * layer;\r\n\r\n\t\t\t// Bottom faces\r\n\r\n\t\t\tfor ( i = 0; i < flen; i ++ ) {\r\n\r\n\t\t\t\tface = faces[ i ];\r\n\t\t\t\tf3( face[ 2 ] + offset, face[ 1 ] + offset, face[ 0 ] + offset );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tlayer = steps + bevelSegments * 2;\r\n\t\t\toffset = vlen * layer;\r\n\r\n\t\t\t// Top faces\r\n\r\n\t\t\tfor ( i = 0; i < flen; i ++ ) {\r\n\r\n\t\t\t\tface = faces[ i ];\r\n\t\t\t\tf3( face[ 0 ] + offset, face[ 1 ] + offset, face[ 2 ] + offset );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// Bottom faces\r\n\r\n\t\t\tfor ( i = 0; i < flen; i ++ ) {\r\n\r\n\t\t\t\tface = faces[ i ];\r\n\t\t\t\tf3( face[ 2 ], face[ 1 ], face[ 0 ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Top faces\r\n\r\n\t\t\tfor ( i = 0; i < flen; i ++ ) {\r\n\r\n\t\t\t\tface = faces[ i ];\r\n\t\t\t\tf3( face[ 0 ] + vlen * steps, face[ 1 ] + vlen * steps, face[ 2 ] + vlen * steps );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// Create faces for the z-sides of the shape\r\n\r\n\tfunction buildSideFaces() {\r\n\r\n\t\tvar layeroffset = 0;\r\n\t\tsidewalls( contour, layeroffset );\r\n\t\tlayeroffset += contour.length;\r\n\r\n\t\tfor ( h = 0, hl = holes.length; h < hl; h ++ ) {\r\n\r\n\t\t\tahole = holes[ h ];\r\n\t\t\tsidewalls( ahole, layeroffset );\r\n\r\n\t\t\t//, true\r\n\t\t\tlayeroffset += ahole.length;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction sidewalls( contour, layeroffset ) {\r\n\r\n\t\tvar j, k;\r\n\t\ti = contour.length;\r\n\r\n\t\twhile ( -- i >= 0 ) {\r\n\r\n\t\t\tj = i;\r\n\t\t\tk = i - 1;\r\n\t\t\tif ( k < 0 ) k = contour.length - 1;\r\n\r\n\t\t\t//console.log('b', i,j, i-1, k,vertices.length);\r\n\r\n\t\t\tvar s = 0, sl = steps  + bevelSegments * 2;\r\n\r\n\t\t\tfor ( s = 0; s < sl; s ++ ) {\r\n\r\n\t\t\t\tvar slen1 = vlen * s;\r\n\t\t\t\tvar slen2 = vlen * ( s + 1 );\r\n\r\n\t\t\t\tvar a = layeroffset + j + slen1,\r\n\t\t\t\t\tb = layeroffset + k + slen1,\r\n\t\t\t\t\tc = layeroffset + k + slen2,\r\n\t\t\t\t\td = layeroffset + j + slen2;\r\n\r\n\t\t\t\tf4( a, b, c, d, contour, s, sl, j, k );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\r\n\tfunction v( x, y, z ) {\r\n\r\n\t\tscope.vertices.push( new THREE.Vector3( x, y, z ) );\r\n\r\n\t}\r\n\r\n\tfunction f3( a, b, c ) {\r\n\r\n\t\ta += shapesOffset;\r\n\t\tb += shapesOffset;\r\n\t\tc += shapesOffset;\r\n\r\n\t\tscope.faces.push( new THREE.Face3( a, b, c, null, null, 0 ) );\r\n\r\n\t\tvar uvs = uvgen.generateTopUV( scope, a, b, c );\r\n\r\n\t\tscope.faceVertexUvs[ 0 ].push( uvs );\r\n\r\n\t}\r\n\r\n\tfunction f4( a, b, c, d, wallContour, stepIndex, stepsLength, contourIndex1, contourIndex2 ) {\r\n\r\n\t\ta += shapesOffset;\r\n\t\tb += shapesOffset;\r\n\t\tc += shapesOffset;\r\n\t\td += shapesOffset;\r\n\r\n\t\tscope.faces.push( new THREE.Face3( a, b, d, null, null, 1 ) );\r\n\t\tscope.faces.push( new THREE.Face3( b, c, d, null, null, 1 ) );\r\n\r\n\t\tvar uvs = uvgen.generateSideWallUV( scope, a, b, c, d );\r\n\r\n\t\tscope.faceVertexUvs[ 0 ].push( [ uvs[ 0 ], uvs[ 1 ], uvs[ 3 ] ] );\r\n\t\tscope.faceVertexUvs[ 0 ].push( [ uvs[ 1 ], uvs[ 2 ], uvs[ 3 ] ] );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.ExtrudeGeometry.WorldUVGenerator = {\r\n\r\n\tgenerateTopUV: function ( geometry, indexA, indexB, indexC ) {\r\n\r\n\t\tvar vertices = geometry.vertices;\r\n\r\n\t\tvar a = vertices[ indexA ];\r\n\t\tvar b = vertices[ indexB ];\r\n\t\tvar c = vertices[ indexC ];\r\n\r\n\t\treturn [\r\n\t\t\tnew THREE.Vector2( a.x, a.y ),\r\n\t\t\tnew THREE.Vector2( b.x, b.y ),\r\n\t\t\tnew THREE.Vector2( c.x, c.y )\r\n\t\t];\r\n\r\n\t},\r\n\r\n\tgenerateSideWallUV: function ( geometry, indexA, indexB, indexC, indexD ) {\r\n\r\n\t\tvar vertices = geometry.vertices;\r\n\r\n\t\tvar a = vertices[ indexA ];\r\n\t\tvar b = vertices[ indexB ];\r\n\t\tvar c = vertices[ indexC ];\r\n\t\tvar d = vertices[ indexD ];\r\n\r\n\t\tif ( Math.abs( a.y - b.y ) < 0.01 ) {\r\n\r\n\t\t\treturn [\r\n\t\t\t\tnew THREE.Vector2( a.x, 1 - a.z ),\r\n\t\t\t\tnew THREE.Vector2( b.x, 1 - b.z ),\r\n\t\t\t\tnew THREE.Vector2( c.x, 1 - c.z ),\r\n\t\t\t\tnew THREE.Vector2( d.x, 1 - d.z )\r\n\t\t\t];\r\n\r\n\t\t} else {\r\n\r\n\t\t\treturn [\r\n\t\t\t\tnew THREE.Vector2( a.y, 1 - a.z ),\r\n\t\t\t\tnew THREE.Vector2( b.y, 1 - b.z ),\r\n\t\t\t\tnew THREE.Vector2( c.y, 1 - c.z ),\r\n\t\t\t\tnew THREE.Vector2( d.y, 1 - d.z )\r\n\t\t\t];\r\n\r\n\t\t}\r\n\r\n\t}\r\n};\r\n\r\n// File:src/extras/geometries/ShapeGeometry.js\r\n\r\n/**\r\n * @author jonobr1 / http://jonobr1.com\r\n *\r\n * Creates a one-sided polygonal geometry from a path shape. Similar to\r\n * ExtrudeGeometry.\r\n *\r\n * parameters = {\r\n *\r\n *\tcurveSegments: <int>, // number of points on the curves. NOT USED AT THE MOMENT.\r\n *\r\n *\tmaterial: <int> // material index for front and back faces\r\n *\tuvGenerator: <Object> // object that provides UV generator functions\r\n *\r\n * }\r\n **/\r\n\r\nTHREE.ShapeGeometry = function ( shapes, options ) {\r\n\r\n\tTHREE.Geometry.call( this );\r\n\r\n\tthis.type = 'ShapeGeometry';\r\n\r\n\tif ( Array.isArray( shapes ) === false ) shapes = [ shapes ];\r\n\r\n\tthis.addShapeList( shapes, options );\r\n\r\n\tthis.computeFaceNormals();\r\n\r\n};\r\n\r\nTHREE.ShapeGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.ShapeGeometry.prototype.constructor = THREE.ShapeGeometry;\r\n\r\n/**\r\n * Add an array of shapes to THREE.ShapeGeometry.\r\n */\r\nTHREE.ShapeGeometry.prototype.addShapeList = function ( shapes, options ) {\r\n\r\n\tfor ( var i = 0, l = shapes.length; i < l; i ++ ) {\r\n\r\n\t\tthis.addShape( shapes[ i ], options );\r\n\r\n\t}\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\n/**\r\n * Adds a shape to THREE.ShapeGeometry, based on THREE.ExtrudeGeometry.\r\n */\r\nTHREE.ShapeGeometry.prototype.addShape = function ( shape, options ) {\r\n\r\n\tif ( options === undefined ) options = {};\r\n\tvar curveSegments = options.curveSegments !== undefined ? options.curveSegments : 12;\r\n\r\n\tvar material = options.material;\r\n\tvar uvgen = options.UVGenerator === undefined ? THREE.ExtrudeGeometry.WorldUVGenerator : options.UVGenerator;\r\n\r\n\t//\r\n\r\n\tvar i, l, hole;\r\n\r\n\tvar shapesOffset = this.vertices.length;\r\n\tvar shapePoints = shape.extractPoints( curveSegments );\r\n\r\n\tvar vertices = shapePoints.shape;\r\n\tvar holes = shapePoints.holes;\r\n\r\n\tvar reverse = ! THREE.ShapeUtils.isClockWise( vertices );\r\n\r\n\tif ( reverse ) {\r\n\r\n\t\tvertices = vertices.reverse();\r\n\r\n\t\t// Maybe we should also check if holes are in the opposite direction, just to be safe...\r\n\r\n\t\tfor ( i = 0, l = holes.length; i < l; i ++ ) {\r\n\r\n\t\t\thole = holes[ i ];\r\n\r\n\t\t\tif ( THREE.ShapeUtils.isClockWise( hole ) ) {\r\n\r\n\t\t\t\tholes[ i ] = hole.reverse();\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treverse = false;\r\n\r\n\t}\r\n\r\n\tvar faces = THREE.ShapeUtils.triangulateShape( vertices, holes );\r\n\r\n\t// Vertices\r\n\r\n\tfor ( i = 0, l = holes.length; i < l; i ++ ) {\r\n\r\n\t\thole = holes[ i ];\r\n\t\tvertices = vertices.concat( hole );\r\n\r\n\t}\r\n\r\n\t//\r\n\r\n\tvar vert, vlen = vertices.length;\r\n\tvar face, flen = faces.length;\r\n\r\n\tfor ( i = 0; i < vlen; i ++ ) {\r\n\r\n\t\tvert = vertices[ i ];\r\n\r\n\t\tthis.vertices.push( new THREE.Vector3( vert.x, vert.y, 0 ) );\r\n\r\n\t}\r\n\r\n\tfor ( i = 0; i < flen; i ++ ) {\r\n\r\n\t\tface = faces[ i ];\r\n\r\n\t\tvar a = face[ 0 ] + shapesOffset;\r\n\t\tvar b = face[ 1 ] + shapesOffset;\r\n\t\tvar c = face[ 2 ] + shapesOffset;\r\n\r\n\t\tthis.faces.push( new THREE.Face3( a, b, c, null, null, material ) );\r\n\t\tthis.faceVertexUvs[ 0 ].push( uvgen.generateTopUV( this, a, b, c ) );\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/extras/geometries/LatheBufferGeometry.js\r\n\r\n/**\r\n * @author Mugen87 / https://github.com/Mugen87\r\n */\r\n\r\n // points - to create a closed torus, one must use a set of points\r\n //    like so: [ a, b, c, d, a ], see first is the same as last.\r\n // segments - the number of circumference segments to create\r\n // phiStart - the starting radian\r\n // phiLength - the radian (0 to 2PI) range of the lathed section\r\n //    2PI is a closed lathe, less than 2PI is a portion.\r\n\r\nTHREE.LatheBufferGeometry = function ( points, segments, phiStart, phiLength ) {\r\n\r\n\tTHREE.BufferGeometry.call( this );\r\n\r\n\tthis.type = 'LatheBufferGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tpoints: points,\r\n\t\tsegments: segments,\r\n\t\tphiStart: phiStart,\r\n\t\tphiLength: phiLength\r\n\t};\r\n\r\n\tsegments = Math.floor( segments ) || 12;\r\n\tphiStart = phiStart || 0;\r\n\tphiLength = phiLength || Math.PI * 2;\r\n\r\n\t// clamp phiLength so it's in range of [ 0, 2PI ]\r\n\tphiLength = THREE.Math.clamp( phiLength, 0, Math.PI * 2 );\r\n\r\n\t// these are used to calculate buffer length\r\n\tvar vertexCount = ( segments + 1 ) * points.length;\r\n\tvar indexCount = segments * points.length * 2 * 3;\r\n\r\n\t// buffers\r\n\tvar indices = new THREE.BufferAttribute( new ( indexCount > 65535 ? Uint32Array : Uint16Array )( indexCount ) , 1 );\r\n\tvar vertices = new THREE.BufferAttribute( new Float32Array( vertexCount * 3 ), 3 );\r\n\tvar uvs = new THREE.BufferAttribute( new Float32Array( vertexCount * 2 ), 2 );\r\n\r\n\t// helper variables\r\n\tvar index = 0, indexOffset = 0, base;\r\n\tvar inversePointLength = 1.0 / ( points.length - 1 );\r\n\tvar inverseSegments = 1.0 / segments;\r\n\tvar vertex = new THREE.Vector3();\r\n\tvar uv = new THREE.Vector2();\r\n\tvar i, j;\r\n\r\n\t// generate vertices and uvs\r\n\r\n\tfor ( i = 0; i <= segments; i ++ ) {\r\n\r\n\t\tvar phi = phiStart + i * inverseSegments * phiLength;\r\n\r\n\t\tvar sin = Math.sin( phi );\r\n\t\tvar cos = Math.cos( phi );\r\n\r\n\t\tfor ( j = 0; j <= ( points.length - 1 ); j ++ ) {\r\n\r\n\t\t\t// vertex\r\n\t\t\tvertex.x = points[ j ].x * sin;\r\n\t\t\tvertex.y = points[ j ].y;\r\n\t\t\tvertex.z = points[ j ].x * cos;\r\n\t\t\tvertices.setXYZ( index, vertex.x, vertex.y, vertex.z );\r\n\r\n\t\t\t// uv\r\n\t\t\tuv.x = i / segments;\r\n\t\t\tuv.y = j / ( points.length - 1 );\r\n\t\t\tuvs.setXY( index, uv.x, uv.y );\r\n\r\n\t\t\t// increase index\r\n\t\t\tindex ++;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// generate indices\r\n\r\n\tfor ( i = 0; i < segments; i ++ ) {\r\n\r\n\t\tfor ( j = 0; j < ( points.length - 1 ); j ++ ) {\r\n\r\n\t\t\tbase = j + i * points.length;\r\n\r\n\t\t\t// indices\r\n\t\t\tvar a = base;\r\n\t\t\tvar b = base + points.length;\r\n\t\t\tvar c = base + points.length + 1;\r\n\t\t\tvar d = base + 1;\r\n\r\n\t\t\t// face one\r\n\t\t\tindices.setX( indexOffset, a ); indexOffset++;\r\n\t\t\tindices.setX( indexOffset, b ); indexOffset++;\r\n\t\t\tindices.setX( indexOffset, d ); indexOffset++;\r\n\r\n\t\t\t// face two\r\n\t\t\tindices.setX( indexOffset, b ); indexOffset++;\r\n\t\t\tindices.setX( indexOffset, c ); indexOffset++;\r\n\t\t\tindices.setX( indexOffset, d ); indexOffset++;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// build geometry\r\n\r\n\tthis.setIndex( indices );\r\n\tthis.addAttribute( 'position', vertices );\r\n\tthis.addAttribute( 'uv', uvs );\r\n\r\n\t// generate normals\r\n\r\n\tthis.computeVertexNormals();\r\n\r\n\t// if the geometry is closed, we need to average the normals along the seam.\r\n\t// because the corresponding vertices are identical (but still have different UVs).\r\n\r\n\tif( phiLength === Math.PI * 2 ) {\r\n\r\n\t\tvar normals = this.attributes.normal.array;\r\n\t\tvar n1 = new THREE.Vector3();\r\n\t\tvar n2 = new THREE.Vector3();\r\n\t\tvar n = new THREE.Vector3();\r\n\r\n\t\t// this is the buffer offset for the last line of vertices\r\n\t\tbase = segments * points.length * 3;\r\n\r\n\t\tfor( i = 0, j = 0; i < points.length; i ++, j += 3 ) {\r\n\r\n\t\t\t// select the normal of the vertex in the first line\r\n\t\t\tn1.x = normals[ j + 0 ];\r\n\t\t\tn1.y = normals[ j + 1 ];\r\n\t\t\tn1.z = normals[ j + 2 ];\r\n\r\n\t\t\t// select the normal of the vertex in the last line\r\n\t\t\tn2.x = normals[ base + j + 0 ];\r\n\t\t\tn2.y = normals[ base + j + 1 ];\r\n\t\t\tn2.z = normals[ base + j + 2 ];\r\n\r\n\t\t\t// average normals\r\n\t\t\tn.addVectors( n1, n2 ).normalize();\r\n\r\n\t\t\t// assign the new values to both normals\r\n\t\t\tnormals[ j + 0 ] = normals[ base + j + 0 ] = n.x;\r\n\t\t\tnormals[ j + 1 ] = normals[ base + j + 1 ] = n.y;\r\n\t\t\tnormals[ j + 2 ] = normals[ base + j + 2 ] = n.z;\r\n\r\n\t\t} // next row\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.LatheBufferGeometry.prototype = Object.create( THREE.BufferGeometry.prototype );\r\nTHREE.LatheBufferGeometry.prototype.constructor = THREE.LatheBufferGeometry;\r\n\r\n// File:src/extras/geometries/LatheGeometry.js\r\n\r\n/**\r\n * @author astrodud / http://astrodud.isgreat.org/\r\n * @author zz85 / https://github.com/zz85\r\n * @author bhouston / http://clara.io\r\n */\r\n\r\n// points - to create a closed torus, one must use a set of points\r\n//    like so: [ a, b, c, d, a ], see first is the same as last.\r\n// segments - the number of circumference segments to create\r\n// phiStart - the starting radian\r\n// phiLength - the radian (0 to 2PI) range of the lathed section\r\n//    2PI is a closed lathe, less than 2PI is a portion.\r\n\r\nTHREE.LatheGeometry = function ( points, segments, phiStart, phiLength ) {\r\n\r\n\tTHREE.Geometry.call( this );\r\n\r\n\tthis.type = 'LatheGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tpoints: points,\r\n\t\tsegments: segments,\r\n\t\tphiStart: phiStart,\r\n\t\tphiLength: phiLength\r\n\t};\r\n\r\n\tthis.fromBufferGeometry( new THREE.LatheBufferGeometry( points, segments, phiStart, phiLength ) );\r\n\tthis.mergeVertices();\r\n\r\n};\r\n\r\nTHREE.LatheGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.LatheGeometry.prototype.constructor = THREE.LatheGeometry;\r\n\r\n// File:src/extras/geometries/PlaneGeometry.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * based on http://papervision3d.googlecode.com/svn/trunk/as3/trunk/src/org/papervision3d/objects/primitives/Plane.as\r\n */\r\n\r\nTHREE.PlaneGeometry = function ( width, height, widthSegments, heightSegments ) {\r\n\r\n\tTHREE.Geometry.call( this );\r\n\r\n\tthis.type = 'PlaneGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\twidth: width,\r\n\t\theight: height,\r\n\t\twidthSegments: widthSegments,\r\n\t\theightSegments: heightSegments\r\n\t};\r\n\r\n\tthis.fromBufferGeometry( new THREE.PlaneBufferGeometry( width, height, widthSegments, heightSegments ) );\r\n\r\n};\r\n\r\nTHREE.PlaneGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.PlaneGeometry.prototype.constructor = THREE.PlaneGeometry;\r\n\r\n// File:src/extras/geometries/PlaneBufferGeometry.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * based on http://papervision3d.googlecode.com/svn/trunk/as3/trunk/src/org/papervision3d/objects/primitives/Plane.as\r\n */\r\n\r\nTHREE.PlaneBufferGeometry = function ( width, height, widthSegments, heightSegments ) {\r\n\r\n\tTHREE.BufferGeometry.call( this );\r\n\r\n\tthis.type = 'PlaneBufferGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\twidth: width,\r\n\t\theight: height,\r\n\t\twidthSegments: widthSegments,\r\n\t\theightSegments: heightSegments\r\n\t};\r\n\r\n\tvar width_half = width / 2;\r\n\tvar height_half = height / 2;\r\n\r\n\tvar gridX = Math.floor( widthSegments ) || 1;\r\n\tvar gridY = Math.floor( heightSegments ) || 1;\r\n\r\n\tvar gridX1 = gridX + 1;\r\n\tvar gridY1 = gridY + 1;\r\n\r\n\tvar segment_width = width / gridX;\r\n\tvar segment_height = height / gridY;\r\n\r\n\tvar vertices = new Float32Array( gridX1 * gridY1 * 3 );\r\n\tvar normals = new Float32Array( gridX1 * gridY1 * 3 );\r\n\tvar uvs = new Float32Array( gridX1 * gridY1 * 2 );\r\n\r\n\tvar offset = 0;\r\n\tvar offset2 = 0;\r\n\r\n\tfor ( var iy = 0; iy < gridY1; iy ++ ) {\r\n\r\n\t\tvar y = iy * segment_height - height_half;\r\n\r\n\t\tfor ( var ix = 0; ix < gridX1; ix ++ ) {\r\n\r\n\t\t\tvar x = ix * segment_width - width_half;\r\n\r\n\t\t\tvertices[ offset ] = x;\r\n\t\t\tvertices[ offset + 1 ] = - y;\r\n\r\n\t\t\tnormals[ offset + 2 ] = 1;\r\n\r\n\t\t\tuvs[ offset2 ] = ix / gridX;\r\n\t\t\tuvs[ offset2 + 1 ] = 1 - ( iy / gridY );\r\n\r\n\t\t\toffset += 3;\r\n\t\t\toffset2 += 2;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\toffset = 0;\r\n\r\n\tvar indices = new ( ( vertices.length / 3 ) > 65535 ? Uint32Array : Uint16Array )( gridX * gridY * 6 );\r\n\r\n\tfor ( var iy = 0; iy < gridY; iy ++ ) {\r\n\r\n\t\tfor ( var ix = 0; ix < gridX; ix ++ ) {\r\n\r\n\t\t\tvar a = ix + gridX1 * iy;\r\n\t\t\tvar b = ix + gridX1 * ( iy + 1 );\r\n\t\t\tvar c = ( ix + 1 ) + gridX1 * ( iy + 1 );\r\n\t\t\tvar d = ( ix + 1 ) + gridX1 * iy;\r\n\r\n\t\t\tindices[ offset ] = a;\r\n\t\t\tindices[ offset + 1 ] = b;\r\n\t\t\tindices[ offset + 2 ] = d;\r\n\r\n\t\t\tindices[ offset + 3 ] = b;\r\n\t\t\tindices[ offset + 4 ] = c;\r\n\t\t\tindices[ offset + 5 ] = d;\r\n\r\n\t\t\toffset += 6;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tthis.setIndex( new THREE.BufferAttribute( indices, 1 ) );\r\n\tthis.addAttribute( 'position', new THREE.BufferAttribute( vertices, 3 ) );\r\n\tthis.addAttribute( 'normal', new THREE.BufferAttribute( normals, 3 ) );\r\n\tthis.addAttribute( 'uv', new THREE.BufferAttribute( uvs, 2 ) );\r\n\r\n};\r\n\r\nTHREE.PlaneBufferGeometry.prototype = Object.create( THREE.BufferGeometry.prototype );\r\nTHREE.PlaneBufferGeometry.prototype.constructor = THREE.PlaneBufferGeometry;\r\n\r\n// File:src/extras/geometries/RingBufferGeometry.js\r\n\r\n/**\r\n * @author Mugen87 / https://github.com/Mugen87\r\n */\r\n\r\nTHREE.RingBufferGeometry = function ( innerRadius, outerRadius, thetaSegments, phiSegments, thetaStart, thetaLength ) {\r\n\r\n\tTHREE.BufferGeometry.call( this );\r\n\r\n\tthis.type = 'RingBufferGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tinnerRadius: innerRadius,\r\n\t\touterRadius: outerRadius,\r\n\t\tthetaSegments: thetaSegments,\r\n\t\tphiSegments: phiSegments,\r\n\t\tthetaStart: thetaStart,\r\n\t\tthetaLength: thetaLength\r\n\t};\r\n\r\n\tinnerRadius = innerRadius || 20;\r\n\touterRadius = outerRadius || 50;\r\n\r\n\tthetaStart = thetaStart !== undefined ? thetaStart : 0;\r\n\tthetaLength = thetaLength !== undefined ? thetaLength : Math.PI * 2;\r\n\r\n\tthetaSegments = thetaSegments !== undefined ? Math.max( 3, thetaSegments ) : 8;\r\n\tphiSegments = phiSegments !== undefined ? Math.max( 1, phiSegments ) : 1;\r\n\r\n\t// these are used to calculate buffer length\r\n\tvar vertexCount = ( thetaSegments + 1 ) * ( phiSegments + 1 );\r\n\tvar indexCount = thetaSegments * phiSegments * 2 * 3;\r\n\r\n\t// buffers\r\n\tvar indices = new THREE.BufferAttribute( new ( indexCount > 65535 ? Uint32Array : Uint16Array )( indexCount ) , 1 );\r\n\tvar vertices = new THREE.BufferAttribute( new Float32Array( vertexCount * 3 ), 3 );\r\n\tvar normals = new THREE.BufferAttribute( new Float32Array( vertexCount * 3 ), 3 );\r\n\tvar uvs = new THREE.BufferAttribute( new Float32Array( vertexCount * 2 ), 2 );\r\n\r\n\t// some helper variables\r\n\tvar index = 0, indexOffset = 0, segment;\r\n\tvar radius = innerRadius;\r\n\tvar radiusStep = ( ( outerRadius - innerRadius ) / phiSegments );\r\n\tvar vertex = new THREE.Vector3();\r\n\tvar uv = new THREE.Vector2();\r\n\tvar j, i;\r\n\r\n\t// generate vertices, normals and uvs\r\n\r\n\t// values are generate from the inside of the ring to the outside\r\n\r\n\tfor ( j = 0; j <= phiSegments; j ++ ) {\r\n\r\n\t\tfor ( i = 0; i <= thetaSegments; i ++ ) {\r\n\r\n\t\t\tsegment = thetaStart + i / thetaSegments * thetaLength;\r\n\r\n\t\t\t// vertex\r\n\t\t\tvertex.x = radius * Math.cos( segment );\r\n\t\t\tvertex.y = radius * Math.sin( segment );\r\n\t\t\tvertices.setXYZ( index, vertex.x, vertex.y, vertex.z );\r\n\r\n\t\t\t// normal\r\n\t\t\tnormals.setXYZ( index, 0, 0, 1 );\r\n\r\n\t\t\t// uv\r\n\t\t\tuv.x = ( vertex.x / outerRadius + 1 ) / 2;\r\n\t\t\tuv.y = ( vertex.y / outerRadius + 1 ) / 2;\r\n\t\t\tuvs.setXY( index, uv.x, uv.y );\r\n\r\n\t\t\t// increase index\r\n\t\t\tindex++;\r\n\r\n\t\t}\r\n\r\n\t\t// increase the radius for next row of vertices\r\n\t\tradius += radiusStep;\r\n\r\n\t}\r\n\r\n\t// generate indices\r\n\r\n\tfor ( j = 0; j < phiSegments; j ++ ) {\r\n\r\n\t\tvar thetaSegmentLevel = j * ( thetaSegments + 1 );\r\n\r\n\t\tfor ( i = 0; i < thetaSegments; i ++ ) {\r\n\r\n\t\t\tsegment = i + thetaSegmentLevel;\r\n\r\n\t\t\t// indices\r\n\t\t\tvar a = segment;\r\n\t\t\tvar b = segment + thetaSegments + 1;\r\n\t\t\tvar c = segment + thetaSegments + 2;\r\n\t\t\tvar d = segment + 1;\r\n\r\n\t\t\t// face one\r\n\t\t\tindices.setX( indexOffset, a ); indexOffset++;\r\n\t\t\tindices.setX( indexOffset, b ); indexOffset++;\r\n\t\t\tindices.setX( indexOffset, c ); indexOffset++;\r\n\r\n\t\t\t// face two\r\n\t\t\tindices.setX( indexOffset, a ); indexOffset++;\r\n\t\t\tindices.setX( indexOffset, c ); indexOffset++;\r\n\t\t\tindices.setX( indexOffset, d ); indexOffset++;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// build geometry\r\n\r\n\tthis.setIndex( indices );\r\n\tthis.addAttribute( 'position', vertices );\r\n\tthis.addAttribute( 'normal', normals );\r\n\tthis.addAttribute( 'uv', uvs );\r\n\r\n};\r\n\r\nTHREE.RingBufferGeometry.prototype = Object.create( THREE.BufferGeometry.prototype );\r\nTHREE.RingBufferGeometry.prototype.constructor = THREE.RingBufferGeometry;\r\n\r\n// File:src/extras/geometries/RingGeometry.js\r\n\r\n/**\r\n * @author Kaleb Murphy\r\n */\r\n\r\nTHREE.RingGeometry = function ( innerRadius, outerRadius, thetaSegments, phiSegments, thetaStart, thetaLength ) {\r\n\r\n\tTHREE.Geometry.call( this );\r\n\r\n\tthis.type = 'RingGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tinnerRadius: innerRadius,\r\n\t\touterRadius: outerRadius,\r\n\t\tthetaSegments: thetaSegments,\r\n\t\tphiSegments: phiSegments,\r\n\t\tthetaStart: thetaStart,\r\n\t\tthetaLength: thetaLength\r\n\t};\r\n\r\n\tthis.fromBufferGeometry( new THREE.RingBufferGeometry( innerRadius, outerRadius, thetaSegments, phiSegments, thetaStart, thetaLength ) );\r\n\r\n};\r\n\r\nTHREE.RingGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.RingGeometry.prototype.constructor = THREE.RingGeometry;\r\n\r\n// File:src/extras/geometries/SphereGeometry.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.SphereGeometry = function ( radius, widthSegments, heightSegments, phiStart, phiLength, thetaStart, thetaLength ) {\r\n\r\n\tTHREE.Geometry.call( this );\r\n\r\n\tthis.type = 'SphereGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tradius: radius,\r\n\t\twidthSegments: widthSegments,\r\n\t\theightSegments: heightSegments,\r\n\t\tphiStart: phiStart,\r\n\t\tphiLength: phiLength,\r\n\t\tthetaStart: thetaStart,\r\n\t\tthetaLength: thetaLength\r\n\t};\r\n\r\n\tthis.fromBufferGeometry( new THREE.SphereBufferGeometry( radius, widthSegments, heightSegments, phiStart, phiLength, thetaStart, thetaLength ) );\r\n\r\n};\r\n\r\nTHREE.SphereGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.SphereGeometry.prototype.constructor = THREE.SphereGeometry;\r\n\r\n// File:src/extras/geometries/SphereBufferGeometry.js\r\n\r\n/**\r\n * @author benaadams / https://twitter.com/ben_a_adams\r\n * based on THREE.SphereGeometry\r\n */\r\n\r\nTHREE.SphereBufferGeometry = function ( radius, widthSegments, heightSegments, phiStart, phiLength, thetaStart, thetaLength ) {\r\n\r\n\tTHREE.BufferGeometry.call( this );\r\n\r\n\tthis.type = 'SphereBufferGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tradius: radius,\r\n\t\twidthSegments: widthSegments,\r\n\t\theightSegments: heightSegments,\r\n\t\tphiStart: phiStart,\r\n\t\tphiLength: phiLength,\r\n\t\tthetaStart: thetaStart,\r\n\t\tthetaLength: thetaLength\r\n\t};\r\n\r\n\tradius = radius || 50;\r\n\r\n\twidthSegments = Math.max( 3, Math.floor( widthSegments ) || 8 );\r\n\theightSegments = Math.max( 2, Math.floor( heightSegments ) || 6 );\r\n\r\n\tphiStart = phiStart !== undefined ? phiStart : 0;\r\n\tphiLength = phiLength !== undefined ? phiLength : Math.PI * 2;\r\n\r\n\tthetaStart = thetaStart !== undefined ? thetaStart : 0;\r\n\tthetaLength = thetaLength !== undefined ? thetaLength : Math.PI;\r\n\r\n\tvar thetaEnd = thetaStart + thetaLength;\r\n\r\n\tvar vertexCount = ( ( widthSegments + 1 ) * ( heightSegments + 1 ) );\r\n\r\n\tvar positions = new THREE.BufferAttribute( new Float32Array( vertexCount * 3 ), 3 );\r\n\tvar normals = new THREE.BufferAttribute( new Float32Array( vertexCount * 3 ), 3 );\r\n\tvar uvs = new THREE.BufferAttribute( new Float32Array( vertexCount * 2 ), 2 );\r\n\r\n\tvar index = 0, vertices = [], normal = new THREE.Vector3();\r\n\r\n\tfor ( var y = 0; y <= heightSegments; y ++ ) {\r\n\r\n\t\tvar verticesRow = [];\r\n\r\n\t\tvar v = y / heightSegments;\r\n\r\n\t\tfor ( var x = 0; x <= widthSegments; x ++ ) {\r\n\r\n\t\t\tvar u = x / widthSegments;\r\n\r\n\t\t\tvar px = - radius * Math.cos( phiStart + u * phiLength ) * Math.sin( thetaStart + v * thetaLength );\r\n\t\t\tvar py = radius * Math.cos( thetaStart + v * thetaLength );\r\n\t\t\tvar pz = radius * Math.sin( phiStart + u * phiLength ) * Math.sin( thetaStart + v * thetaLength );\r\n\r\n\t\t\tnormal.set( px, py, pz ).normalize();\r\n\r\n\t\t\tpositions.setXYZ( index, px, py, pz );\r\n\t\t\tnormals.setXYZ( index, normal.x, normal.y, normal.z );\r\n\t\t\tuvs.setXY( index, u, 1 - v );\r\n\r\n\t\t\tverticesRow.push( index );\r\n\r\n\t\t\tindex ++;\r\n\r\n\t\t}\r\n\r\n\t\tvertices.push( verticesRow );\r\n\r\n\t}\r\n\r\n\tvar indices = [];\r\n\r\n\tfor ( var y = 0; y < heightSegments; y ++ ) {\r\n\r\n\t\tfor ( var x = 0; x < widthSegments; x ++ ) {\r\n\r\n\t\t\tvar v1 = vertices[ y ][ x + 1 ];\r\n\t\t\tvar v2 = vertices[ y ][ x ];\r\n\t\t\tvar v3 = vertices[ y + 1 ][ x ];\r\n\t\t\tvar v4 = vertices[ y + 1 ][ x + 1 ];\r\n\r\n\t\t\tif ( y !== 0 || thetaStart > 0 ) indices.push( v1, v2, v4 );\r\n\t\t\tif ( y !== heightSegments - 1 || thetaEnd < Math.PI ) indices.push( v2, v3, v4 );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tthis.setIndex( new ( positions.count > 65535 ? THREE.Uint32Attribute : THREE.Uint16Attribute )( indices, 1 ) );\r\n\tthis.addAttribute( 'position', positions );\r\n\tthis.addAttribute( 'normal', normals );\r\n\tthis.addAttribute( 'uv', uvs );\r\n\r\n\tthis.boundingSphere = new THREE.Sphere( new THREE.Vector3(), radius );\r\n\r\n};\r\n\r\nTHREE.SphereBufferGeometry.prototype = Object.create( THREE.BufferGeometry.prototype );\r\nTHREE.SphereBufferGeometry.prototype.constructor = THREE.SphereBufferGeometry;\r\n\r\n// File:src/extras/geometries/TextGeometry.js\r\n\r\n/**\r\n * @author zz85 / http://www.lab4games.net/zz85/blog\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n * Text = 3D Text\r\n *\r\n * parameters = {\r\n *  font: <THREE.Font>, // font\r\n *\r\n *  size: <float>, // size of the text\r\n *  height: <float>, // thickness to extrude text\r\n *  curveSegments: <int>, // number of points on the curves\r\n *\r\n *  bevelEnabled: <bool>, // turn on bevel\r\n *  bevelThickness: <float>, // how deep into text bevel goes\r\n *  bevelSize: <float> // how far from text outline is bevel\r\n * }\r\n */\r\n\r\nTHREE.TextGeometry = function ( text, parameters ) {\r\n\r\n\tparameters = parameters || {};\r\n\r\n\tvar font = parameters.font;\r\n\r\n\tif ( font instanceof THREE.Font === false ) {\r\n\r\n\t\tconsole.error( 'THREE.TextGeometry: font parameter is not an instance of THREE.Font.' );\r\n\t\treturn new THREE.Geometry();\r\n\r\n\t}\r\n\r\n\tvar shapes = font.generateShapes( text, parameters.size, parameters.curveSegments );\r\n\r\n\t// translate parameters to ExtrudeGeometry API\r\n\r\n\tparameters.amount = parameters.height !== undefined ? parameters.height : 50;\r\n\r\n\t// defaults\r\n\r\n\tif ( parameters.bevelThickness === undefined ) parameters.bevelThickness = 10;\r\n\tif ( parameters.bevelSize === undefined ) parameters.bevelSize = 8;\r\n\tif ( parameters.bevelEnabled === undefined ) parameters.bevelEnabled = false;\r\n\r\n\tTHREE.ExtrudeGeometry.call( this, shapes, parameters );\r\n\r\n\tthis.type = 'TextGeometry';\r\n\r\n};\r\n\r\nTHREE.TextGeometry.prototype = Object.create( THREE.ExtrudeGeometry.prototype );\r\nTHREE.TextGeometry.prototype.constructor = THREE.TextGeometry;\r\n\r\n// File:src/extras/geometries/TorusBufferGeometry.js\r\n\r\n/**\r\n * @author Mugen87 / https://github.com/Mugen87\r\n */\r\n\r\nTHREE.TorusBufferGeometry = function ( radius, tube, radialSegments, tubularSegments, arc ) {\r\n\r\n\tTHREE.BufferGeometry.call( this );\r\n\r\n\tthis.type = 'TorusBufferGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tradius: radius,\r\n\t\ttube: tube,\r\n\t\tradialSegments: radialSegments,\r\n\t\ttubularSegments: tubularSegments,\r\n\t\tarc: arc\r\n\t};\r\n\r\n\tradius = radius || 100;\r\n\ttube = tube || 40;\r\n\tradialSegments = Math.floor( radialSegments ) || 8;\r\n\ttubularSegments = Math.floor( tubularSegments ) || 6;\r\n\tarc = arc || Math.PI * 2;\r\n\r\n\t// used to calculate buffer length\r\n\tvar vertexCount = ( ( radialSegments + 1 ) * ( tubularSegments + 1 ) );\r\n\tvar indexCount = radialSegments * tubularSegments * 2 * 3;\r\n\r\n\t// buffers\r\n\tvar indices = new ( indexCount > 65535 ? Uint32Array : Uint16Array )( indexCount );\r\n\tvar vertices = new Float32Array( vertexCount * 3 );\r\n\tvar normals = new Float32Array( vertexCount * 3 );\r\n\tvar uvs = new Float32Array( vertexCount * 2 );\r\n\r\n\t// offset variables\r\n\tvar vertexBufferOffset = 0;\r\n\tvar uvBufferOffset = 0;\r\n\tvar indexBufferOffset = 0;\r\n\r\n\t// helper variables\r\n\tvar center = new THREE.Vector3();\r\n\tvar vertex = new THREE.Vector3();\r\n\tvar normal = new THREE.Vector3();\r\n\r\n\tvar j, i;\r\n\r\n\t// generate vertices, normals and uvs\r\n\r\n\tfor ( j = 0; j <= radialSegments; j ++ ) {\r\n\r\n\t\tfor ( i = 0; i <= tubularSegments; i ++ ) {\r\n\r\n\t\t\tvar u = i / tubularSegments * arc;\r\n\t\t\tvar v = j / radialSegments * Math.PI * 2;\r\n\r\n\t\t\t// vertex\r\n\t\t\tvertex.x = ( radius + tube * Math.cos( v ) ) * Math.cos( u );\r\n\t\t\tvertex.y = ( radius + tube * Math.cos( v ) ) * Math.sin( u );\r\n\t\t\tvertex.z = tube * Math.sin( v );\r\n\r\n\t\t\tvertices[ vertexBufferOffset ] = vertex.x;\r\n\t\t\tvertices[ vertexBufferOffset + 1 ] = vertex.y;\r\n\t\t\tvertices[ vertexBufferOffset + 2 ] = vertex.z;\r\n\r\n\t\t\t// this vector is used to calculate the normal\r\n\t\t\tcenter.x = radius * Math.cos( u );\r\n\t\t\tcenter.y = radius * Math.sin( u );\r\n\r\n\t\t\t// normal\r\n\t\t\tnormal.subVectors( vertex, center ).normalize();\r\n\r\n\t\t\tnormals[ vertexBufferOffset ] = normal.x;\r\n\t\t\tnormals[ vertexBufferOffset + 1 ] = normal.y;\r\n\t\t\tnormals[ vertexBufferOffset + 2 ] = normal.z;\r\n\r\n\t\t\t// uv\r\n\t\t\tuvs[ uvBufferOffset ] = i / tubularSegments;\r\n\t\t\tuvs[ uvBufferOffset + 1 ] = j / radialSegments;\r\n\r\n\t\t\t// update offsets\r\n\t\t\tvertexBufferOffset += 3;\r\n\t\t\tuvBufferOffset += 2;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// generate indices\r\n\r\n\tfor ( j = 1; j <= radialSegments; j ++ ) {\r\n\r\n\t\tfor ( i = 1; i <= tubularSegments; i ++ ) {\r\n\r\n\t\t\t// indices\r\n\t\t\tvar a = ( tubularSegments + 1 ) * j + i - 1;\r\n\t\t\tvar b = ( tubularSegments + 1 ) * ( j - 1 ) + i - 1;\r\n\t\t\tvar c = ( tubularSegments + 1 ) * ( j - 1 ) + i;\r\n\t\t\tvar d = ( tubularSegments + 1 ) * j + i;\r\n\r\n\t\t\t// face one\r\n\t\t\tindices[ indexBufferOffset ] = a;\r\n\t\t\tindices[ indexBufferOffset + 1 ] = b;\r\n\t\t\tindices[ indexBufferOffset + 2 ] = d;\r\n\r\n\t\t\t// face two\r\n\t\t\tindices[ indexBufferOffset + 3 ] = b;\r\n\t\t\tindices[ indexBufferOffset + 4 ] = c;\r\n\t\t\tindices[ indexBufferOffset + 5 ] = d;\r\n\r\n\t\t\t// update offset\r\n\t\t\tindexBufferOffset += 6;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// build geometry\r\n\tthis.setIndex( new THREE.BufferAttribute( indices, 1 ) );\r\n\tthis.addAttribute( 'position', new THREE.BufferAttribute( vertices, 3 ) );\r\n\tthis.addAttribute( 'normal', new THREE.BufferAttribute( normals, 3 ) );\r\n\tthis.addAttribute( 'uv', new THREE.BufferAttribute( uvs, 2 ) );\r\n\r\n};\r\n\r\nTHREE.TorusBufferGeometry.prototype = Object.create( THREE.BufferGeometry.prototype );\r\nTHREE.TorusBufferGeometry.prototype.constructor = THREE.TorusBufferGeometry;\r\n\r\n// File:src/extras/geometries/TorusGeometry.js\r\n\r\n/**\r\n * @author oosmoxiecode\r\n * @author mrdoob / http://mrdoob.com/\r\n * based on http://code.google.com/p/away3d/source/browse/trunk/fp10/Away3DLite/src/away3dlite/primitives/Torus.as?r=2888\r\n */\r\n\r\nTHREE.TorusGeometry = function ( radius, tube, radialSegments, tubularSegments, arc ) {\r\n\r\n\tTHREE.Geometry.call( this );\r\n\r\n\tthis.type = 'TorusGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tradius: radius,\r\n\t\ttube: tube,\r\n\t\tradialSegments: radialSegments,\r\n\t\ttubularSegments: tubularSegments,\r\n\t\tarc: arc\r\n\t};\r\n\r\n\tthis.fromBufferGeometry( new THREE.TorusBufferGeometry( radius, tube, radialSegments, tubularSegments, arc ) );\r\n\r\n};\r\n\r\nTHREE.TorusGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.TorusGeometry.prototype.constructor = THREE.TorusGeometry;\r\n\r\n// File:src/extras/geometries/TorusKnotBufferGeometry.js\r\n\r\n/**\r\n * @author Mugen87 / https://github.com/Mugen87\r\n *\r\n * see: http://www.blackpawn.com/texts/pqtorus/\r\n */\r\nTHREE.TorusKnotBufferGeometry = function ( radius, tube, tubularSegments, radialSegments, p, q ) {\r\n\r\n\tTHREE.BufferGeometry.call( this );\r\n\r\n\tthis.type = 'TorusKnotBufferGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tradius: radius,\r\n\t\ttube: tube,\r\n\t\ttubularSegments: tubularSegments,\r\n\t\tradialSegments: radialSegments,\r\n\t\tp: p,\r\n\t\tq: q\r\n\t};\r\n\r\n\tradius = radius || 100;\r\n\ttube = tube || 40;\r\n\ttubularSegments = Math.floor( tubularSegments ) || 64;\r\n\tradialSegments = Math.floor( radialSegments ) || 8;\r\n\tp = p || 2;\r\n\tq = q || 3;\r\n\r\n\t// used to calculate buffer length\r\n\tvar vertexCount = ( ( radialSegments + 1 ) * ( tubularSegments + 1 ) );\r\n\tvar indexCount = radialSegments * tubularSegments * 2 * 3;\r\n\r\n\t// buffers\r\n\tvar indices = new THREE.BufferAttribute( new ( indexCount > 65535 ? Uint32Array : Uint16Array )( indexCount ) , 1 );\r\n\tvar vertices = new THREE.BufferAttribute( new Float32Array( vertexCount * 3 ), 3 );\r\n\tvar normals = new THREE.BufferAttribute( new Float32Array( vertexCount * 3 ), 3 );\r\n\tvar uvs = new THREE.BufferAttribute( new Float32Array( vertexCount * 2 ), 2 );\r\n\r\n\t// helper variables\r\n\tvar i, j, index = 0, indexOffset = 0;\r\n\r\n\tvar vertex = new THREE.Vector3();\r\n\tvar normal = new THREE.Vector3();\r\n\tvar uv = new THREE.Vector2();\r\n\r\n\tvar P1 = new THREE.Vector3();\r\n\tvar P2 = new THREE.Vector3();\r\n\r\n\tvar B = new THREE.Vector3();\r\n\tvar T = new THREE.Vector3();\r\n\tvar N = new THREE.Vector3();\r\n\r\n\t// generate vertices, normals and uvs\r\n\r\n\tfor ( i = 0; i <= tubularSegments; ++ i ) {\r\n\r\n\t\t// the radian \"u\" is used to calculate the position on the torus curve of the current tubular segement\r\n\r\n\t\tvar u = i / tubularSegments * p * Math.PI * 2;\r\n\r\n\t\t// now we calculate two points. P1 is our current position on the curve, P2 is a little farther ahead.\r\n\t\t// these points are used to create a special \"coordinate space\", which is necessary to calculate the correct vertex positions\r\n\r\n\t\tcalculatePositionOnCurve( u, p, q, radius, P1 );\r\n\t\tcalculatePositionOnCurve( u + 0.01, p, q, radius, P2 );\r\n\r\n\t\t// calculate orthonormal basis\r\n\r\n\t\tT.subVectors( P2, P1 );\r\n\t\tN.addVectors( P2, P1 );\r\n\t\tB.crossVectors( T, N );\r\n\t\tN.crossVectors( B, T );\r\n\r\n\t\t// normalize B, N. T can be ignored, we don't use it\r\n\r\n\t\tB.normalize();\r\n\t\tN.normalize();\r\n\r\n\t\tfor ( j = 0; j <= radialSegments; ++ j ) {\r\n\r\n\t\t\t// now calculate the vertices. they are nothing more than an extrusion of the torus curve.\r\n\t\t\t// because we extrude a shape in the xy-plane, there is no need to calculate a z-value.\r\n\r\n\t\t\tvar v = j / radialSegments * Math.PI * 2;\r\n\t\t\tvar cx = - tube * Math.cos( v );\r\n\t\t\tvar cy = tube * Math.sin( v );\r\n\r\n\t\t\t// now calculate the final vertex position.\r\n\t\t\t// first we orient the extrusion with our basis vectos, then we add it to the current position on the curve\r\n\r\n\t\t\tvertex.x = P1.x + ( cx * N.x + cy * B.x );\r\n\t\t\tvertex.y = P1.y + ( cx * N.y + cy * B.y );\r\n\t\t\tvertex.z = P1.z + ( cx * N.z + cy * B.z );\r\n\r\n\t\t\t// vertex\r\n\t\t\tvertices.setXYZ( index, vertex.x, vertex.y, vertex.z );\r\n\r\n\t\t\t// normal (P1 is always the center/origin of the extrusion, thus we can use it to calculate the normal)\r\n\t\t\tnormal.subVectors( vertex, P1 ).normalize();\r\n\t\t\tnormals.setXYZ( index, normal.x, normal.y, normal.z );\r\n\r\n\t\t\t// uv\r\n\t\t\tuv.x = i / tubularSegments;\r\n\t\t\tuv.y = j / radialSegments;\r\n\t\t\tuvs.setXY( index, uv.x, uv.y );\r\n\r\n\t\t\t// increase index\r\n\t\t\tindex ++;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// generate indices\r\n\r\n\tfor ( j = 1; j <= tubularSegments; j ++ ) {\r\n\r\n\t\tfor ( i = 1; i <= radialSegments; i ++ ) {\r\n\r\n\t\t\t// indices\r\n\t\t\tvar a = ( radialSegments + 1 ) * ( j - 1 ) + ( i - 1 );\r\n\t\t\tvar b = ( radialSegments + 1 ) * j + ( i - 1 );\r\n\t\t\tvar c = ( radialSegments + 1 ) * j + i;\r\n\t\t\tvar d = ( radialSegments + 1 ) * ( j - 1 ) + i;\r\n\r\n\t\t\t// face one\r\n\t\t\tindices.setX( indexOffset, a ); indexOffset++;\r\n\t\t\tindices.setX( indexOffset, b ); indexOffset++;\r\n\t\t\tindices.setX( indexOffset, d ); indexOffset++;\r\n\r\n\t\t\t// face two\r\n\t\t\tindices.setX( indexOffset, b ); indexOffset++;\r\n\t\t\tindices.setX( indexOffset, c ); indexOffset++;\r\n\t\t\tindices.setX( indexOffset, d ); indexOffset++;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// build geometry\r\n\r\n\tthis.setIndex( indices );\r\n\tthis.addAttribute( 'position', vertices );\r\n\tthis.addAttribute( 'normal', normals );\r\n\tthis.addAttribute( 'uv', uvs );\r\n\r\n\t// this function calculates the current position on the torus curve\r\n\r\n\tfunction calculatePositionOnCurve( u, p, q, radius, position ) {\r\n\r\n\t\tvar cu = Math.cos( u );\r\n\t\tvar su = Math.sin( u );\r\n\t\tvar quOverP = q / p * u;\r\n\t\tvar cs = Math.cos( quOverP );\r\n\r\n\t\tposition.x = radius * ( 2 + cs ) * 0.5 * cu;\r\n\t\tposition.y = radius * ( 2 + cs ) * su * 0.5;\r\n\t\tposition.z = radius * Math.sin( quOverP ) * 0.5;\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.TorusKnotBufferGeometry.prototype = Object.create( THREE.BufferGeometry.prototype );\r\nTHREE.TorusKnotBufferGeometry.prototype.constructor = THREE.TorusKnotBufferGeometry;\r\n\r\n// File:src/extras/geometries/TorusKnotGeometry.js\r\n\r\n/**\r\n * @author oosmoxiecode\r\n */\r\n\r\nTHREE.TorusKnotGeometry = function ( radius, tube, tubularSegments, radialSegments, p, q, heightScale ) {\r\n\r\n\tTHREE.Geometry.call( this );\r\n\r\n\tthis.type = 'TorusKnotGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tradius: radius,\r\n\t\ttube: tube,\r\n\t\ttubularSegments: tubularSegments,\r\n\t\tradialSegments: radialSegments,\r\n\t\tp: p,\r\n\t\tq: q\r\n\t};\r\n\r\n\tif( heightScale !== undefined ) console.warn( 'THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead.' );\r\n\r\n\tthis.fromBufferGeometry( new THREE.TorusKnotBufferGeometry( radius, tube, tubularSegments, radialSegments, p, q ) );\r\n\tthis.mergeVertices();\r\n\r\n};\r\n\r\nTHREE.TorusKnotGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.TorusKnotGeometry.prototype.constructor = THREE.TorusKnotGeometry;\r\n\r\n// File:src/extras/geometries/TubeGeometry.js\r\n\r\n/**\r\n * @author WestLangley / https://github.com/WestLangley\r\n * @author zz85 / https://github.com/zz85\r\n * @author miningold / https://github.com/miningold\r\n * @author jonobr1 / https://github.com/jonobr1\r\n *\r\n * Modified from the TorusKnotGeometry by @oosmoxiecode\r\n *\r\n * Creates a tube which extrudes along a 3d spline\r\n *\r\n * Uses parallel transport frames as described in\r\n * http://www.cs.indiana.edu/pub/techreports/TR425.pdf\r\n */\r\n\r\nTHREE.TubeGeometry = function ( path, segments, radius, radialSegments, closed, taper ) {\r\n\r\n\tTHREE.Geometry.call( this );\r\n\r\n\tthis.type = 'TubeGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tpath: path,\r\n\t\tsegments: segments,\r\n\t\tradius: radius,\r\n\t\tradialSegments: radialSegments,\r\n\t\tclosed: closed,\r\n\t\ttaper: taper\r\n\t};\r\n\r\n\tsegments = segments || 64;\r\n\tradius = radius || 1;\r\n\tradialSegments = radialSegments || 8;\r\n\tclosed = closed || false;\r\n\ttaper = taper || THREE.TubeGeometry.NoTaper;\r\n\r\n\tvar grid = [];\r\n\r\n\tvar scope = this,\r\n\r\n\t\ttangent,\r\n\t\tnormal,\r\n\t\tbinormal,\r\n\r\n\t\tnumpoints = segments + 1,\r\n\r\n\t\tu, v, r,\r\n\r\n\t\tcx, cy,\r\n\t\tpos, pos2 = new THREE.Vector3(),\r\n\t\ti, j,\r\n\t\tip, jp,\r\n\t\ta, b, c, d,\r\n\t\tuva, uvb, uvc, uvd;\r\n\r\n\tvar frames = new THREE.TubeGeometry.FrenetFrames( path, segments, closed ),\r\n\t\ttangents = frames.tangents,\r\n\t\tnormals = frames.normals,\r\n\t\tbinormals = frames.binormals;\r\n\r\n\t// proxy internals\r\n\tthis.tangents = tangents;\r\n\tthis.normals = normals;\r\n\tthis.binormals = binormals;\r\n\r\n\tfunction vert( x, y, z ) {\r\n\r\n\t\treturn scope.vertices.push( new THREE.Vector3( x, y, z ) ) - 1;\r\n\r\n\t}\r\n\r\n\t// construct the grid\r\n\r\n\tfor ( i = 0; i < numpoints; i ++ ) {\r\n\r\n\t\tgrid[ i ] = [];\r\n\r\n\t\tu = i / ( numpoints - 1 );\r\n\r\n\t\tpos = path.getPointAt( u );\r\n\r\n\t\ttangent = tangents[ i ];\r\n\t\tnormal = normals[ i ];\r\n\t\tbinormal = binormals[ i ];\r\n\r\n\t\tr = radius * taper( u );\r\n\r\n\t\tfor ( j = 0; j < radialSegments; j ++ ) {\r\n\r\n\t\t\tv = j / radialSegments * 2 * Math.PI;\r\n\r\n\t\t\tcx = - r * Math.cos( v ); // TODO: Hack: Negating it so it faces outside.\r\n\t\t\tcy = r * Math.sin( v );\r\n\r\n\t\t\tpos2.copy( pos );\r\n\t\t\tpos2.x += cx * normal.x + cy * binormal.x;\r\n\t\t\tpos2.y += cx * normal.y + cy * binormal.y;\r\n\t\t\tpos2.z += cx * normal.z + cy * binormal.z;\r\n\r\n\t\t\tgrid[ i ][ j ] = vert( pos2.x, pos2.y, pos2.z );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\r\n\t// construct the mesh\r\n\r\n\tfor ( i = 0; i < segments; i ++ ) {\r\n\r\n\t\tfor ( j = 0; j < radialSegments; j ++ ) {\r\n\r\n\t\t\tip = ( closed ) ? ( i + 1 ) % segments : i + 1;\r\n\t\t\tjp = ( j + 1 ) % radialSegments;\r\n\r\n\t\t\ta = grid[ i ][ j ];\t\t// *** NOT NECESSARILY PLANAR ! ***\r\n\t\t\tb = grid[ ip ][ j ];\r\n\t\t\tc = grid[ ip ][ jp ];\r\n\t\t\td = grid[ i ][ jp ];\r\n\r\n\t\t\tuva = new THREE.Vector2( i / segments, j / radialSegments );\r\n\t\t\tuvb = new THREE.Vector2( ( i + 1 ) / segments, j / radialSegments );\r\n\t\t\tuvc = new THREE.Vector2( ( i + 1 ) / segments, ( j + 1 ) / radialSegments );\r\n\t\t\tuvd = new THREE.Vector2( i / segments, ( j + 1 ) / radialSegments );\r\n\r\n\t\t\tthis.faces.push( new THREE.Face3( a, b, d ) );\r\n\t\t\tthis.faceVertexUvs[ 0 ].push( [ uva, uvb, uvd ] );\r\n\r\n\t\t\tthis.faces.push( new THREE.Face3( b, c, d ) );\r\n\t\t\tthis.faceVertexUvs[ 0 ].push( [ uvb.clone(), uvc, uvd.clone() ] );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tthis.computeFaceNormals();\r\n\tthis.computeVertexNormals();\r\n\r\n};\r\n\r\nTHREE.TubeGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.TubeGeometry.prototype.constructor = THREE.TubeGeometry;\r\n\r\nTHREE.TubeGeometry.NoTaper = function ( u ) {\r\n\r\n\treturn 1;\r\n\r\n};\r\n\r\nTHREE.TubeGeometry.SinusoidalTaper = function ( u ) {\r\n\r\n\treturn Math.sin( Math.PI * u );\r\n\r\n};\r\n\r\n// For computing of Frenet frames, exposing the tangents, normals and binormals the spline\r\nTHREE.TubeGeometry.FrenetFrames = function ( path, segments, closed ) {\r\n\r\n\tvar\tnormal = new THREE.Vector3(),\r\n\r\n\t\ttangents = [],\r\n\t\tnormals = [],\r\n\t\tbinormals = [],\r\n\r\n\t\tvec = new THREE.Vector3(),\r\n\t\tmat = new THREE.Matrix4(),\r\n\r\n\t\tnumpoints = segments + 1,\r\n\t\ttheta,\r\n\t\tsmallest,\r\n\r\n\t\ttx, ty, tz,\r\n\t\ti, u;\r\n\r\n\r\n\t// expose internals\r\n\tthis.tangents = tangents;\r\n\tthis.normals = normals;\r\n\tthis.binormals = binormals;\r\n\r\n\t// compute the tangent vectors for each segment on the path\r\n\r\n\tfor ( i = 0; i < numpoints; i ++ ) {\r\n\r\n\t\tu = i / ( numpoints - 1 );\r\n\r\n\t\ttangents[ i ] = path.getTangentAt( u );\r\n\t\ttangents[ i ].normalize();\r\n\r\n\t}\r\n\r\n\tinitialNormal3();\r\n\r\n\t/*\r\n\tfunction initialNormal1(lastBinormal) {\r\n\t\t// fixed start binormal. Has dangers of 0 vectors\r\n\t\tnormals[ 0 ] = new THREE.Vector3();\r\n\t\tbinormals[ 0 ] = new THREE.Vector3();\r\n\t\tif (lastBinormal===undefined) lastBinormal = new THREE.Vector3( 0, 0, 1 );\r\n\t\tnormals[ 0 ].crossVectors( lastBinormal, tangents[ 0 ] ).normalize();\r\n\t\tbinormals[ 0 ].crossVectors( tangents[ 0 ], normals[ 0 ] ).normalize();\r\n\t}\r\n\r\n\tfunction initialNormal2() {\r\n\r\n\t\t// This uses the Frenet-Serret formula for deriving binormal\r\n\t\tvar t2 = path.getTangentAt( epsilon );\r\n\r\n\t\tnormals[ 0 ] = new THREE.Vector3().subVectors( t2, tangents[ 0 ] ).normalize();\r\n\t\tbinormals[ 0 ] = new THREE.Vector3().crossVectors( tangents[ 0 ], normals[ 0 ] );\r\n\r\n\t\tnormals[ 0 ].crossVectors( binormals[ 0 ], tangents[ 0 ] ).normalize(); // last binormal x tangent\r\n\t\tbinormals[ 0 ].crossVectors( tangents[ 0 ], normals[ 0 ] ).normalize();\r\n\r\n\t}\r\n\t*/\r\n\r\n\tfunction initialNormal3() {\r\n\r\n\t\t// select an initial normal vector perpendicular to the first tangent vector,\r\n\t\t// and in the direction of the smallest tangent xyz component\r\n\r\n\t\tnormals[ 0 ] = new THREE.Vector3();\r\n\t\tbinormals[ 0 ] = new THREE.Vector3();\r\n\t\tsmallest = Number.MAX_VALUE;\r\n\t\ttx = Math.abs( tangents[ 0 ].x );\r\n\t\tty = Math.abs( tangents[ 0 ].y );\r\n\t\ttz = Math.abs( tangents[ 0 ].z );\r\n\r\n\t\tif ( tx <= smallest ) {\r\n\r\n\t\t\tsmallest = tx;\r\n\t\t\tnormal.set( 1, 0, 0 );\r\n\r\n\t\t}\r\n\r\n\t\tif ( ty <= smallest ) {\r\n\r\n\t\t\tsmallest = ty;\r\n\t\t\tnormal.set( 0, 1, 0 );\r\n\r\n\t\t}\r\n\r\n\t\tif ( tz <= smallest ) {\r\n\r\n\t\t\tnormal.set( 0, 0, 1 );\r\n\r\n\t\t}\r\n\r\n\t\tvec.crossVectors( tangents[ 0 ], normal ).normalize();\r\n\r\n\t\tnormals[ 0 ].crossVectors( tangents[ 0 ], vec );\r\n\t\tbinormals[ 0 ].crossVectors( tangents[ 0 ], normals[ 0 ] );\r\n\r\n\t}\r\n\r\n\r\n\t// compute the slowly-varying normal and binormal vectors for each segment on the path\r\n\r\n\tfor ( i = 1; i < numpoints; i ++ ) {\r\n\r\n\t\tnormals[ i ] = normals[ i - 1 ].clone();\r\n\r\n\t\tbinormals[ i ] = binormals[ i - 1 ].clone();\r\n\r\n\t\tvec.crossVectors( tangents[ i - 1 ], tangents[ i ] );\r\n\r\n\t\tif ( vec.length() > Number.EPSILON ) {\r\n\r\n\t\t\tvec.normalize();\r\n\r\n\t\t\ttheta = Math.acos( THREE.Math.clamp( tangents[ i - 1 ].dot( tangents[ i ] ), - 1, 1 ) ); // clamp for floating pt errors\r\n\r\n\t\t\tnormals[ i ].applyMatrix4( mat.makeRotationAxis( vec, theta ) );\r\n\r\n\t\t}\r\n\r\n\t\tbinormals[ i ].crossVectors( tangents[ i ], normals[ i ] );\r\n\r\n\t}\r\n\r\n\r\n\t// if the curve is closed, postprocess the vectors so the first and last normal vectors are the same\r\n\r\n\tif ( closed ) {\r\n\r\n\t\ttheta = Math.acos( THREE.Math.clamp( normals[ 0 ].dot( normals[ numpoints - 1 ] ), - 1, 1 ) );\r\n\t\ttheta /= ( numpoints - 1 );\r\n\r\n\t\tif ( tangents[ 0 ].dot( vec.crossVectors( normals[ 0 ], normals[ numpoints - 1 ] ) ) > 0 ) {\r\n\r\n\t\t\ttheta = - theta;\r\n\r\n\t\t}\r\n\r\n\t\tfor ( i = 1; i < numpoints; i ++ ) {\r\n\r\n\t\t\t// twist a little...\r\n\t\t\tnormals[ i ].applyMatrix4( mat.makeRotationAxis( tangents[ i ], theta * i ) );\r\n\t\t\tbinormals[ i ].crossVectors( tangents[ i ], normals[ i ] );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\n// File:src/extras/geometries/PolyhedronGeometry.js\r\n\r\n/**\r\n * @author clockworkgeek / https://github.com/clockworkgeek\r\n * @author timothypratley / https://github.com/timothypratley\r\n * @author WestLangley / http://github.com/WestLangley\r\n*/\r\n\r\nTHREE.PolyhedronGeometry = function ( vertices, indices, radius, detail ) {\r\n\r\n\tTHREE.Geometry.call( this );\r\n\r\n\tthis.type = 'PolyhedronGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tvertices: vertices,\r\n\t\tindices: indices,\r\n\t\tradius: radius,\r\n\t\tdetail: detail\r\n\t};\r\n\r\n\tradius = radius || 1;\r\n\tdetail = detail || 0;\r\n\r\n\tvar that = this;\r\n\r\n\tfor ( var i = 0, l = vertices.length; i < l; i += 3 ) {\r\n\r\n\t\tprepare( new THREE.Vector3( vertices[ i ], vertices[ i + 1 ], vertices[ i + 2 ] ) );\r\n\r\n\t}\r\n\r\n\tvar p = this.vertices;\r\n\r\n\tvar faces = [];\r\n\r\n\tfor ( var i = 0, j = 0, l = indices.length; i < l; i += 3, j ++ ) {\r\n\r\n\t\tvar v1 = p[ indices[ i ] ];\r\n\t\tvar v2 = p[ indices[ i + 1 ] ];\r\n\t\tvar v3 = p[ indices[ i + 2 ] ];\r\n\r\n\t\tfaces[ j ] = new THREE.Face3( v1.index, v2.index, v3.index, [ v1.clone(), v2.clone(), v3.clone() ], undefined, j );\r\n\r\n\t}\r\n\r\n\tvar centroid = new THREE.Vector3();\r\n\r\n\tfor ( var i = 0, l = faces.length; i < l; i ++ ) {\r\n\r\n\t\tsubdivide( faces[ i ], detail );\r\n\r\n\t}\r\n\r\n\r\n\t// Handle case when face straddles the seam\r\n\r\n\tfor ( var i = 0, l = this.faceVertexUvs[ 0 ].length; i < l; i ++ ) {\r\n\r\n\t\tvar uvs = this.faceVertexUvs[ 0 ][ i ];\r\n\r\n\t\tvar x0 = uvs[ 0 ].x;\r\n\t\tvar x1 = uvs[ 1 ].x;\r\n\t\tvar x2 = uvs[ 2 ].x;\r\n\r\n\t\tvar max = Math.max( x0, x1, x2 );\r\n\t\tvar min = Math.min( x0, x1, x2 );\r\n\r\n\t\tif ( max > 0.9 && min < 0.1 ) {\r\n\r\n\t\t\t// 0.9 is somewhat arbitrary\r\n\r\n\t\t\tif ( x0 < 0.2 ) uvs[ 0 ].x += 1;\r\n\t\t\tif ( x1 < 0.2 ) uvs[ 1 ].x += 1;\r\n\t\t\tif ( x2 < 0.2 ) uvs[ 2 ].x += 1;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\r\n\t// Apply radius\r\n\r\n\tfor ( var i = 0, l = this.vertices.length; i < l; i ++ ) {\r\n\r\n\t\tthis.vertices[ i ].multiplyScalar( radius );\r\n\r\n\t}\r\n\r\n\r\n\t// Merge vertices\r\n\r\n\tthis.mergeVertices();\r\n\r\n\tthis.computeFaceNormals();\r\n\r\n\tthis.boundingSphere = new THREE.Sphere( new THREE.Vector3(), radius );\r\n\r\n\r\n\t// Project vector onto sphere's surface\r\n\r\n\tfunction prepare( vector ) {\r\n\r\n\t\tvar vertex = vector.normalize().clone();\r\n\t\tvertex.index = that.vertices.push( vertex ) - 1;\r\n\r\n\t\t// Texture coords are equivalent to map coords, calculate angle and convert to fraction of a circle.\r\n\r\n\t\tvar u = azimuth( vector ) / 2 / Math.PI + 0.5;\r\n\t\tvar v = inclination( vector ) / Math.PI + 0.5;\r\n\t\tvertex.uv = new THREE.Vector2( u, 1 - v );\r\n\r\n\t\treturn vertex;\r\n\r\n\t}\r\n\r\n\r\n\t// Approximate a curved face with recursively sub-divided triangles.\r\n\r\n\tfunction make( v1, v2, v3, materialIndex ) {\r\n\r\n\t\tvar face = new THREE.Face3( v1.index, v2.index, v3.index, [ v1.clone(), v2.clone(), v3.clone() ], undefined, materialIndex );\r\n\t\tthat.faces.push( face );\r\n\r\n\t\tcentroid.copy( v1 ).add( v2 ).add( v3 ).divideScalar( 3 );\r\n\r\n\t\tvar azi = azimuth( centroid );\r\n\r\n\t\tthat.faceVertexUvs[ 0 ].push( [\r\n\t\t\tcorrectUV( v1.uv, v1, azi ),\r\n\t\t\tcorrectUV( v2.uv, v2, azi ),\r\n\t\t\tcorrectUV( v3.uv, v3, azi )\r\n\t\t] );\r\n\r\n\t}\r\n\r\n\r\n\t// Analytically subdivide a face to the required detail level.\r\n\r\n\tfunction subdivide( face, detail ) {\r\n\r\n\t\tvar cols = Math.pow( 2, detail );\r\n\t\tvar a = prepare( that.vertices[ face.a ] );\r\n\t\tvar b = prepare( that.vertices[ face.b ] );\r\n\t\tvar c = prepare( that.vertices[ face.c ] );\r\n\t\tvar v = [];\r\n\r\n\t\tvar materialIndex = face.materialIndex;\r\n\r\n\t\t// Construct all of the vertices for this subdivision.\r\n\r\n\t\tfor ( var i = 0 ; i <= cols; i ++ ) {\r\n\r\n\t\t\tv[ i ] = [];\r\n\r\n\t\t\tvar aj = prepare( a.clone().lerp( c, i / cols ) );\r\n\t\t\tvar bj = prepare( b.clone().lerp( c, i / cols ) );\r\n\t\t\tvar rows = cols - i;\r\n\r\n\t\t\tfor ( var j = 0; j <= rows; j ++ ) {\r\n\r\n\t\t\t\tif ( j === 0 && i === cols ) {\r\n\r\n\t\t\t\t\tv[ i ][ j ] = aj;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tv[ i ][ j ] = prepare( aj.clone().lerp( bj, j / rows ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// Construct all of the faces.\r\n\r\n\t\tfor ( var i = 0; i < cols ; i ++ ) {\r\n\r\n\t\t\tfor ( var j = 0; j < 2 * ( cols - i ) - 1; j ++ ) {\r\n\r\n\t\t\t\tvar k = Math.floor( j / 2 );\r\n\r\n\t\t\t\tif ( j % 2 === 0 ) {\r\n\r\n\t\t\t\t\tmake(\r\n\t\t\t\t\t\tv[ i ][ k + 1 ],\r\n\t\t\t\t\t\tv[ i + 1 ][ k ],\r\n\t\t\t\t\t\tv[ i ][ k ],\r\n\t\t\t\t\t\tmaterialIndex\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tmake(\r\n\t\t\t\t\t\tv[ i ][ k + 1 ],\r\n\t\t\t\t\t\tv[ i + 1 ][ k + 1 ],\r\n\t\t\t\t\t\tv[ i + 1 ][ k ],\r\n\t\t\t\t\t\tmaterialIndex\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\r\n\t// Angle around the Y axis, counter-clockwise when looking from above.\r\n\r\n\tfunction azimuth( vector ) {\r\n\r\n\t\treturn Math.atan2( vector.z, - vector.x );\r\n\r\n\t}\r\n\r\n\r\n\t// Angle above the XZ plane.\r\n\r\n\tfunction inclination( vector ) {\r\n\r\n\t\treturn Math.atan2( - vector.y, Math.sqrt( ( vector.x * vector.x ) + ( vector.z * vector.z ) ) );\r\n\r\n\t}\r\n\r\n\r\n\t// Texture fixing helper. Spheres have some odd behaviours.\r\n\r\n\tfunction correctUV( uv, vector, azimuth ) {\r\n\r\n\t\tif ( ( azimuth < 0 ) && ( uv.x === 1 ) ) uv = new THREE.Vector2( uv.x - 1, uv.y );\r\n\t\tif ( ( vector.x === 0 ) && ( vector.z === 0 ) ) uv = new THREE.Vector2( azimuth / 2 / Math.PI + 0.5, uv.y );\r\n\t\treturn uv.clone();\r\n\r\n\t}\r\n\r\n\r\n};\r\n\r\nTHREE.PolyhedronGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.PolyhedronGeometry.prototype.constructor = THREE.PolyhedronGeometry;\r\n\r\n// File:src/extras/geometries/DodecahedronGeometry.js\r\n\r\n/**\r\n * @author Abe Pazos / https://hamoid.com\r\n */\r\n\r\nTHREE.DodecahedronGeometry = function ( radius, detail ) {\r\n\r\n\tvar t = ( 1 + Math.sqrt( 5 ) ) / 2;\r\n\tvar r = 1 / t;\r\n\r\n\tvar vertices = [\r\n\r\n\t\t// (1, 1, 1)\r\n\t\t- 1, - 1, - 1,    - 1, - 1,  1,\r\n\t\t- 1,  1, - 1,    - 1,  1,  1,\r\n\t\t 1, - 1, - 1,     1, - 1,  1,\r\n\t\t 1,  1, - 1,     1,  1,  1,\r\n\r\n\t\t// (0, 1/, )\r\n\t\t 0, - r, - t,     0, - r,  t,\r\n\t\t 0,  r, - t,     0,  r,  t,\r\n\r\n\t\t// (1/, , 0)\r\n\t\t- r, - t,  0,    - r,  t,  0,\r\n\t\t r, - t,  0,     r,  t,  0,\r\n\r\n\t\t// (, 0, 1/)\r\n\t\t- t,  0, - r,     t,  0, - r,\r\n\t\t- t,  0,  r,     t,  0,  r\r\n\t];\r\n\r\n\tvar indices = [\r\n\t\t 3, 11,  7,      3,  7, 15,      3, 15, 13,\r\n\t\t 7, 19, 17,      7, 17,  6,      7,  6, 15,\r\n\t\t17,  4,  8,     17,  8, 10,     17, 10,  6,\r\n\t\t 8,  0, 16,      8, 16,  2,      8,  2, 10,\r\n\t\t 0, 12,  1,      0,  1, 18,      0, 18, 16,\r\n\t\t 6, 10,  2,      6,  2, 13,      6, 13, 15,\r\n\t\t 2, 16, 18,      2, 18,  3,      2,  3, 13,\r\n\t\t18,  1,  9,     18,  9, 11,     18, 11,  3,\r\n\t\t 4, 14, 12,      4, 12,  0,      4,  0,  8,\r\n\t\t11,  9,  5,     11,  5, 19,     11, 19,  7,\r\n\t\t19,  5, 14,     19, 14,  4,     19,  4, 17,\r\n\t\t 1, 12, 14,      1, 14,  5,      1,  5,  9\r\n\t];\r\n\r\n\tTHREE.PolyhedronGeometry.call( this, vertices, indices, radius, detail );\r\n\r\n\tthis.type = 'DodecahedronGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tradius: radius,\r\n\t\tdetail: detail\r\n\t};\r\n\r\n};\r\n\r\nTHREE.DodecahedronGeometry.prototype = Object.create( THREE.PolyhedronGeometry.prototype );\r\nTHREE.DodecahedronGeometry.prototype.constructor = THREE.DodecahedronGeometry;\r\n\r\n// File:src/extras/geometries/IcosahedronGeometry.js\r\n\r\n/**\r\n * @author timothypratley / https://github.com/timothypratley\r\n */\r\n\r\nTHREE.IcosahedronGeometry = function ( radius, detail ) {\r\n\r\n\tvar t = ( 1 + Math.sqrt( 5 ) ) / 2;\r\n\r\n\tvar vertices = [\r\n\t\t- 1,  t,  0,    1,  t,  0,   - 1, - t,  0,    1, - t,  0,\r\n\t\t 0, - 1,  t,    0,  1,  t,    0, - 1, - t,    0,  1, - t,\r\n\t\t t,  0, - 1,    t,  0,  1,   - t,  0, - 1,   - t,  0,  1\r\n\t];\r\n\r\n\tvar indices = [\r\n\t\t 0, 11,  5,    0,  5,  1,    0,  1,  7,    0,  7, 10,    0, 10, 11,\r\n\t\t 1,  5,  9,    5, 11,  4,   11, 10,  2,   10,  7,  6,    7,  1,  8,\r\n\t\t 3,  9,  4,    3,  4,  2,    3,  2,  6,    3,  6,  8,    3,  8,  9,\r\n\t\t 4,  9,  5,    2,  4, 11,    6,  2, 10,    8,  6,  7,    9,  8,  1\r\n\t];\r\n\r\n\tTHREE.PolyhedronGeometry.call( this, vertices, indices, radius, detail );\r\n\r\n\tthis.type = 'IcosahedronGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tradius: radius,\r\n\t\tdetail: detail\r\n\t};\r\n\r\n};\r\n\r\nTHREE.IcosahedronGeometry.prototype = Object.create( THREE.PolyhedronGeometry.prototype );\r\nTHREE.IcosahedronGeometry.prototype.constructor = THREE.IcosahedronGeometry;\r\n\r\n// File:src/extras/geometries/OctahedronGeometry.js\r\n\r\n/**\r\n * @author timothypratley / https://github.com/timothypratley\r\n */\r\n\r\nTHREE.OctahedronGeometry = function ( radius, detail ) {\r\n\r\n\tvar vertices = [\r\n\t\t1, 0, 0,   - 1, 0, 0,    0, 1, 0,    0, - 1, 0,    0, 0, 1,    0, 0, - 1\r\n\t];\r\n\r\n\tvar indices = [\r\n\t\t0, 2, 4,    0, 4, 3,    0, 3, 5,    0, 5, 2,    1, 2, 5,    1, 5, 3,    1, 3, 4,    1, 4, 2\r\n\t];\r\n\r\n\tTHREE.PolyhedronGeometry.call( this, vertices, indices, radius, detail );\r\n\r\n\tthis.type = 'OctahedronGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tradius: radius,\r\n\t\tdetail: detail\r\n\t};\r\n\r\n};\r\n\r\nTHREE.OctahedronGeometry.prototype = Object.create( THREE.PolyhedronGeometry.prototype );\r\nTHREE.OctahedronGeometry.prototype.constructor = THREE.OctahedronGeometry;\r\n\r\n// File:src/extras/geometries/TetrahedronGeometry.js\r\n\r\n/**\r\n * @author timothypratley / https://github.com/timothypratley\r\n */\r\n\r\nTHREE.TetrahedronGeometry = function ( radius, detail ) {\r\n\r\n\tvar vertices = [\r\n\t\t 1,  1,  1,   - 1, - 1,  1,   - 1,  1, - 1,    1, - 1, - 1\r\n\t];\r\n\r\n\tvar indices = [\r\n\t\t 2,  1,  0,    0,  3,  2,    1,  3,  0,    2,  3,  1\r\n\t];\r\n\r\n\tTHREE.PolyhedronGeometry.call( this, vertices, indices, radius, detail );\r\n\r\n\tthis.type = 'TetrahedronGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tradius: radius,\r\n\t\tdetail: detail\r\n\t};\r\n\r\n};\r\n\r\nTHREE.TetrahedronGeometry.prototype = Object.create( THREE.PolyhedronGeometry.prototype );\r\nTHREE.TetrahedronGeometry.prototype.constructor = THREE.TetrahedronGeometry;\r\n\r\n// File:src/extras/geometries/ParametricGeometry.js\r\n\r\n/**\r\n * @author zz85 / https://github.com/zz85\r\n * Parametric Surfaces Geometry\r\n * based on the brilliant article by @prideout http://prideout.net/blog/?p=44\r\n *\r\n * new THREE.ParametricGeometry( parametricFunction, uSegments, ySegements );\r\n *\r\n */\r\n\r\nTHREE.ParametricGeometry = function ( func, slices, stacks ) {\r\n\r\n\tTHREE.Geometry.call( this );\r\n\r\n\tthis.type = 'ParametricGeometry';\r\n\r\n\tthis.parameters = {\r\n\t\tfunc: func,\r\n\t\tslices: slices,\r\n\t\tstacks: stacks\r\n\t};\r\n\r\n\tvar verts = this.vertices;\r\n\tvar faces = this.faces;\r\n\tvar uvs = this.faceVertexUvs[ 0 ];\r\n\r\n\tvar i, j, p;\r\n\tvar u, v;\r\n\r\n\tvar sliceCount = slices + 1;\r\n\r\n\tfor ( i = 0; i <= stacks; i ++ ) {\r\n\r\n\t\tv = i / stacks;\r\n\r\n\t\tfor ( j = 0; j <= slices; j ++ ) {\r\n\r\n\t\t\tu = j / slices;\r\n\r\n\t\t\tp = func( u, v );\r\n\t\t\tverts.push( p );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tvar a, b, c, d;\r\n\tvar uva, uvb, uvc, uvd;\r\n\r\n\tfor ( i = 0; i < stacks; i ++ ) {\r\n\r\n\t\tfor ( j = 0; j < slices; j ++ ) {\r\n\r\n\t\t\ta = i * sliceCount + j;\r\n\t\t\tb = i * sliceCount + j + 1;\r\n\t\t\tc = ( i + 1 ) * sliceCount + j + 1;\r\n\t\t\td = ( i + 1 ) * sliceCount + j;\r\n\r\n\t\t\tuva = new THREE.Vector2( j / slices, i / stacks );\r\n\t\t\tuvb = new THREE.Vector2( ( j + 1 ) / slices, i / stacks );\r\n\t\t\tuvc = new THREE.Vector2( ( j + 1 ) / slices, ( i + 1 ) / stacks );\r\n\t\t\tuvd = new THREE.Vector2( j / slices, ( i + 1 ) / stacks );\r\n\r\n\t\t\tfaces.push( new THREE.Face3( a, b, d ) );\r\n\t\t\tuvs.push( [ uva, uvb, uvd ] );\r\n\r\n\t\t\tfaces.push( new THREE.Face3( b, c, d ) );\r\n\t\t\tuvs.push( [ uvb.clone(), uvc, uvd.clone() ] );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// console.log(this);\r\n\r\n\t// magic bullet\r\n\t// var diff = this.mergeVertices();\r\n\t// console.log('removed ', diff, ' vertices by merging');\r\n\r\n\tthis.computeFaceNormals();\r\n\tthis.computeVertexNormals();\r\n\r\n};\r\n\r\nTHREE.ParametricGeometry.prototype = Object.create( THREE.Geometry.prototype );\r\nTHREE.ParametricGeometry.prototype.constructor = THREE.ParametricGeometry;\r\n\r\n// File:src/extras/geometries/WireframeGeometry.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.WireframeGeometry = function ( geometry ) {\r\n\r\n\tTHREE.BufferGeometry.call( this );\r\n\r\n\tvar edge = [ 0, 0 ], hash = {};\r\n\r\n\tfunction sortFunction( a, b ) {\r\n\r\n\t\treturn a - b;\r\n\r\n\t}\r\n\r\n\tvar keys = [ 'a', 'b', 'c' ];\r\n\r\n\tif ( geometry instanceof THREE.Geometry ) {\r\n\r\n\t\tvar vertices = geometry.vertices;\r\n\t\tvar faces = geometry.faces;\r\n\t\tvar numEdges = 0;\r\n\r\n\t\t// allocate maximal size\r\n\t\tvar edges = new Uint32Array( 6 * faces.length );\r\n\r\n\t\tfor ( var i = 0, l = faces.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar face = faces[ i ];\r\n\r\n\t\t\tfor ( var j = 0; j < 3; j ++ ) {\r\n\r\n\t\t\t\tedge[ 0 ] = face[ keys[ j ] ];\r\n\t\t\t\tedge[ 1 ] = face[ keys[ ( j + 1 ) % 3 ] ];\r\n\t\t\t\tedge.sort( sortFunction );\r\n\r\n\t\t\t\tvar key = edge.toString();\r\n\r\n\t\t\t\tif ( hash[ key ] === undefined ) {\r\n\r\n\t\t\t\t\tedges[ 2 * numEdges ] = edge[ 0 ];\r\n\t\t\t\t\tedges[ 2 * numEdges + 1 ] = edge[ 1 ];\r\n\t\t\t\t\thash[ key ] = true;\r\n\t\t\t\t\tnumEdges ++;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar coords = new Float32Array( numEdges * 2 * 3 );\r\n\r\n\t\tfor ( var i = 0, l = numEdges; i < l; i ++ ) {\r\n\r\n\t\t\tfor ( var j = 0; j < 2; j ++ ) {\r\n\r\n\t\t\t\tvar vertex = vertices[ edges [ 2 * i + j ] ];\r\n\r\n\t\t\t\tvar index = 6 * i + 3 * j;\r\n\t\t\t\tcoords[ index + 0 ] = vertex.x;\r\n\t\t\t\tcoords[ index + 1 ] = vertex.y;\r\n\t\t\t\tcoords[ index + 2 ] = vertex.z;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tthis.addAttribute( 'position', new THREE.BufferAttribute( coords, 3 ) );\r\n\r\n\t} else if ( geometry instanceof THREE.BufferGeometry ) {\r\n\r\n\t\tif ( geometry.index !== null ) {\r\n\r\n\t\t\t// Indexed BufferGeometry\r\n\r\n\t\t\tvar indices = geometry.index.array;\r\n\t\t\tvar vertices = geometry.attributes.position;\r\n\t\t\tvar groups = geometry.groups;\r\n\t\t\tvar numEdges = 0;\r\n\r\n\t\t\tif ( groups.length === 0 ) {\r\n\r\n\t\t\t\tgeometry.addGroup( 0, indices.length );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// allocate maximal size\r\n\t\t\tvar edges = new Uint32Array( 2 * indices.length );\r\n\r\n\t\t\tfor ( var o = 0, ol = groups.length; o < ol; ++ o ) {\r\n\r\n\t\t\t\tvar group = groups[ o ];\r\n\r\n\t\t\t\tvar start = group.start;\r\n\t\t\t\tvar count = group.count;\r\n\r\n\t\t\t\tfor ( var i = start, il = start + count; i < il; i += 3 ) {\r\n\r\n\t\t\t\t\tfor ( var j = 0; j < 3; j ++ ) {\r\n\r\n\t\t\t\t\t\tedge[ 0 ] = indices[ i + j ];\r\n\t\t\t\t\t\tedge[ 1 ] = indices[ i + ( j + 1 ) % 3 ];\r\n\t\t\t\t\t\tedge.sort( sortFunction );\r\n\r\n\t\t\t\t\t\tvar key = edge.toString();\r\n\r\n\t\t\t\t\t\tif ( hash[ key ] === undefined ) {\r\n\r\n\t\t\t\t\t\t\tedges[ 2 * numEdges ] = edge[ 0 ];\r\n\t\t\t\t\t\t\tedges[ 2 * numEdges + 1 ] = edge[ 1 ];\r\n\t\t\t\t\t\t\thash[ key ] = true;\r\n\t\t\t\t\t\t\tnumEdges ++;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar coords = new Float32Array( numEdges * 2 * 3 );\r\n\r\n\t\t\tfor ( var i = 0, l = numEdges; i < l; i ++ ) {\r\n\r\n\t\t\t\tfor ( var j = 0; j < 2; j ++ ) {\r\n\r\n\t\t\t\t\tvar index = 6 * i + 3 * j;\r\n\t\t\t\t\tvar index2 = edges[ 2 * i + j ];\r\n\r\n\t\t\t\t\tcoords[ index + 0 ] = vertices.getX( index2 );\r\n\t\t\t\t\tcoords[ index + 1 ] = vertices.getY( index2 );\r\n\t\t\t\t\tcoords[ index + 2 ] = vertices.getZ( index2 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.addAttribute( 'position', new THREE.BufferAttribute( coords, 3 ) );\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// non-indexed BufferGeometry\r\n\r\n\t\t\tvar vertices = geometry.attributes.position.array;\r\n\t\t\tvar numEdges = vertices.length / 3;\r\n\t\t\tvar numTris = numEdges / 3;\r\n\r\n\t\t\tvar coords = new Float32Array( numEdges * 2 * 3 );\r\n\r\n\t\t\tfor ( var i = 0, l = numTris; i < l; i ++ ) {\r\n\r\n\t\t\t\tfor ( var j = 0; j < 3; j ++ ) {\r\n\r\n\t\t\t\t\tvar index = 18 * i + 6 * j;\r\n\r\n\t\t\t\t\tvar index1 = 9 * i + 3 * j;\r\n\t\t\t\t\tcoords[ index + 0 ] = vertices[ index1 ];\r\n\t\t\t\t\tcoords[ index + 1 ] = vertices[ index1 + 1 ];\r\n\t\t\t\t\tcoords[ index + 2 ] = vertices[ index1 + 2 ];\r\n\r\n\t\t\t\t\tvar index2 = 9 * i + 3 * ( ( j + 1 ) % 3 );\r\n\t\t\t\t\tcoords[ index + 3 ] = vertices[ index2 ];\r\n\t\t\t\t\tcoords[ index + 4 ] = vertices[ index2 + 1 ];\r\n\t\t\t\t\tcoords[ index + 5 ] = vertices[ index2 + 2 ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.addAttribute( 'position', new THREE.BufferAttribute( coords, 3 ) );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.WireframeGeometry.prototype = Object.create( THREE.BufferGeometry.prototype );\r\nTHREE.WireframeGeometry.prototype.constructor = THREE.WireframeGeometry;\r\n\r\n// File:src/extras/helpers/AxisHelper.js\r\n\r\n/**\r\n * @author sroucheray / http://sroucheray.org/\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.AxisHelper = function ( size ) {\r\n\r\n\tsize = size || 1;\r\n\r\n\tvar vertices = new Float32Array( [\r\n\t\t0, 0, 0,  size, 0, 0,\r\n\t\t0, 0, 0,  0, size, 0,\r\n\t\t0, 0, 0,  0, 0, size\r\n\t] );\r\n\r\n\tvar colors = new Float32Array( [\r\n\t\t1, 0, 0,  1, 0.6, 0,\r\n\t\t0, 1, 0,  0.6, 1, 0,\r\n\t\t0, 0, 1,  0, 0.6, 1\r\n\t] );\r\n\r\n\tvar geometry = new THREE.BufferGeometry();\r\n\tgeometry.addAttribute( 'position', new THREE.BufferAttribute( vertices, 3 ) );\r\n\tgeometry.addAttribute( 'color', new THREE.BufferAttribute( colors, 3 ) );\r\n\r\n\tvar material = new THREE.LineBasicMaterial( { vertexColors: THREE.VertexColors } );\r\n\r\n\tTHREE.LineSegments.call( this, geometry, material );\r\n\r\n};\r\n\r\nTHREE.AxisHelper.prototype = Object.create( THREE.LineSegments.prototype );\r\nTHREE.AxisHelper.prototype.constructor = THREE.AxisHelper;\r\n\r\n// File:src/extras/helpers/ArrowHelper.js\r\n\r\n/**\r\n * @author WestLangley / http://github.com/WestLangley\r\n * @author zz85 / http://github.com/zz85\r\n * @author bhouston / http://clara.io\r\n *\r\n * Creates an arrow for visualizing directions\r\n *\r\n * Parameters:\r\n *  dir - Vector3\r\n *  origin - Vector3\r\n *  length - Number\r\n *  color - color in hex value\r\n *  headLength - Number\r\n *  headWidth - Number\r\n */\r\n\r\nTHREE.ArrowHelper = ( function () {\r\n\r\n\tvar lineGeometry = new THREE.BufferGeometry();\r\n\tlineGeometry.addAttribute( 'position', new THREE.Float32Attribute( [ 0, 0, 0, 0, 1, 0 ], 3 ) );\r\n\r\n\tvar coneGeometry = new THREE.CylinderBufferGeometry( 0, 0.5, 1, 5, 1 );\r\n\tconeGeometry.translate( 0, - 0.5, 0 );\r\n\r\n\treturn function ArrowHelper( dir, origin, length, color, headLength, headWidth ) {\r\n\r\n\t\t// dir is assumed to be normalized\r\n\r\n\t\tTHREE.Object3D.call( this );\r\n\r\n\t\tif ( color === undefined ) color = 0xffff00;\r\n\t\tif ( length === undefined ) length = 1;\r\n\t\tif ( headLength === undefined ) headLength = 0.2 * length;\r\n\t\tif ( headWidth === undefined ) headWidth = 0.2 * headLength;\r\n\r\n\t\tthis.position.copy( origin );\r\n\r\n\t\tthis.line = new THREE.Line( lineGeometry, new THREE.LineBasicMaterial( { color: color } ) );\r\n\t\tthis.line.matrixAutoUpdate = false;\r\n\t\tthis.add( this.line );\r\n\r\n\t\tthis.cone = new THREE.Mesh( coneGeometry, new THREE.MeshBasicMaterial( { color: color } ) );\r\n\t\tthis.cone.matrixAutoUpdate = false;\r\n\t\tthis.add( this.cone );\r\n\r\n\t\tthis.setDirection( dir );\r\n\t\tthis.setLength( length, headLength, headWidth );\r\n\r\n\t};\r\n\r\n}() );\r\n\r\nTHREE.ArrowHelper.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.ArrowHelper.prototype.constructor = THREE.ArrowHelper;\r\n\r\nTHREE.ArrowHelper.prototype.setDirection = ( function () {\r\n\r\n\tvar axis = new THREE.Vector3();\r\n\tvar radians;\r\n\r\n\treturn function setDirection( dir ) {\r\n\r\n\t\t// dir is assumed to be normalized\r\n\r\n\t\tif ( dir.y > 0.99999 ) {\r\n\r\n\t\t\tthis.quaternion.set( 0, 0, 0, 1 );\r\n\r\n\t\t} else if ( dir.y < - 0.99999 ) {\r\n\r\n\t\t\tthis.quaternion.set( 1, 0, 0, 0 );\r\n\r\n\t\t} else {\r\n\r\n\t\t\taxis.set( dir.z, 0, - dir.x ).normalize();\r\n\r\n\t\t\tradians = Math.acos( dir.y );\r\n\r\n\t\t\tthis.quaternion.setFromAxisAngle( axis, radians );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n}() );\r\n\r\nTHREE.ArrowHelper.prototype.setLength = function ( length, headLength, headWidth ) {\r\n\r\n\tif ( headLength === undefined ) headLength = 0.2 * length;\r\n\tif ( headWidth === undefined ) headWidth = 0.2 * headLength;\r\n\r\n\tthis.line.scale.set( 1, Math.max( 0, length - headLength ), 1 );\r\n\tthis.line.updateMatrix();\r\n\r\n\tthis.cone.scale.set( headWidth, headLength, headWidth );\r\n\tthis.cone.position.y = length;\r\n\tthis.cone.updateMatrix();\r\n\r\n};\r\n\r\nTHREE.ArrowHelper.prototype.setColor = function ( color ) {\r\n\r\n\tthis.line.material.color.copy( color );\r\n\tthis.cone.material.color.copy( color );\r\n\r\n};\r\n\r\n// File:src/extras/helpers/BoxHelper.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.BoxHelper = function ( object ) {\r\n\r\n\tvar indices = new Uint16Array( [ 0, 1, 1, 2, 2, 3, 3, 0, 4, 5, 5, 6, 6, 7, 7, 4, 0, 4, 1, 5, 2, 6, 3, 7 ] );\r\n\tvar positions = new Float32Array( 8 * 3 );\r\n\r\n\tvar geometry = new THREE.BufferGeometry();\r\n\tgeometry.setIndex( new THREE.BufferAttribute( indices, 1 ) );\r\n\tgeometry.addAttribute( 'position', new THREE.BufferAttribute( positions, 3 ) );\r\n\r\n\tTHREE.LineSegments.call( this, geometry, new THREE.LineBasicMaterial( { color: 0xffff00 } ) );\r\n\r\n\tif ( object !== undefined ) {\r\n\r\n\t\tthis.update( object );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.BoxHelper.prototype = Object.create( THREE.LineSegments.prototype );\r\nTHREE.BoxHelper.prototype.constructor = THREE.BoxHelper;\r\n\r\nTHREE.BoxHelper.prototype.update = ( function () {\r\n\r\n\tvar box = new THREE.Box3();\r\n\r\n\treturn function ( object ) {\r\n\r\n\t\tif ( object instanceof THREE.Box3 ) {\r\n\r\n\t\t\tbox.copy( object );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tbox.setFromObject( object );\r\n\r\n\t\t}\r\n\r\n\t\tif ( box.isEmpty() ) return;\r\n\r\n\t\tvar min = box.min;\r\n\t\tvar max = box.max;\r\n\r\n\t\t/*\r\n\t\t  5____4\r\n\t\t1/___0/|\r\n\t\t| 6__|_7\r\n\t\t2/___3/\r\n\r\n\t\t0: max.x, max.y, max.z\r\n\t\t1: min.x, max.y, max.z\r\n\t\t2: min.x, min.y, max.z\r\n\t\t3: max.x, min.y, max.z\r\n\t\t4: max.x, max.y, min.z\r\n\t\t5: min.x, max.y, min.z\r\n\t\t6: min.x, min.y, min.z\r\n\t\t7: max.x, min.y, min.z\r\n\t\t*/\r\n\r\n\t\tvar position = this.geometry.attributes.position;\r\n\t\tvar array = position.array;\r\n\r\n\t\tarray[  0 ] = max.x; array[  1 ] = max.y; array[  2 ] = max.z;\r\n\t\tarray[  3 ] = min.x; array[  4 ] = max.y; array[  5 ] = max.z;\r\n\t\tarray[  6 ] = min.x; array[  7 ] = min.y; array[  8 ] = max.z;\r\n\t\tarray[  9 ] = max.x; array[ 10 ] = min.y; array[ 11 ] = max.z;\r\n\t\tarray[ 12 ] = max.x; array[ 13 ] = max.y; array[ 14 ] = min.z;\r\n\t\tarray[ 15 ] = min.x; array[ 16 ] = max.y; array[ 17 ] = min.z;\r\n\t\tarray[ 18 ] = min.x; array[ 19 ] = min.y; array[ 20 ] = min.z;\r\n\t\tarray[ 21 ] = max.x; array[ 22 ] = min.y; array[ 23 ] = min.z;\r\n\r\n\t\tposition.needsUpdate = true;\r\n\r\n\t\tthis.geometry.computeBoundingSphere();\r\n\r\n\t};\r\n\r\n} )();\r\n\r\n// File:src/extras/helpers/BoundingBoxHelper.js\r\n\r\n/**\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\n// a helper to show the world-axis-aligned bounding box for an object\r\n\r\nTHREE.BoundingBoxHelper = function ( object, hex ) {\r\n\r\n\tvar color = ( hex !== undefined ) ? hex : 0x888888;\r\n\r\n\tthis.object = object;\r\n\r\n\tthis.box = new THREE.Box3();\r\n\r\n\tTHREE.Mesh.call( this, new THREE.BoxGeometry( 1, 1, 1 ), new THREE.MeshBasicMaterial( { color: color, wireframe: true } ) );\r\n\r\n};\r\n\r\nTHREE.BoundingBoxHelper.prototype = Object.create( THREE.Mesh.prototype );\r\nTHREE.BoundingBoxHelper.prototype.constructor = THREE.BoundingBoxHelper;\r\n\r\nTHREE.BoundingBoxHelper.prototype.update = function () {\r\n\r\n\tthis.box.setFromObject( this.object );\r\n\r\n\tthis.box.size( this.scale );\r\n\r\n\tthis.box.center( this.position );\r\n\r\n};\r\n\r\n// File:src/extras/helpers/CameraHelper.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n *\r\n *\t- shows frustum, line of sight and up of the camera\r\n *\t- suitable for fast updates\r\n * \t- based on frustum visualization in lightgl.js shadowmap example\r\n *\t\thttp://evanw.github.com/lightgl.js/tests/shadowmap.html\r\n */\r\n\r\nTHREE.CameraHelper = function ( camera ) {\r\n\r\n\tvar geometry = new THREE.Geometry();\r\n\tvar material = new THREE.LineBasicMaterial( { color: 0xffffff, vertexColors: THREE.FaceColors } );\r\n\r\n\tvar pointMap = {};\r\n\r\n\t// colors\r\n\r\n\tvar hexFrustum = 0xffaa00;\r\n\tvar hexCone = 0xff0000;\r\n\tvar hexUp = 0x00aaff;\r\n\tvar hexTarget = 0xffffff;\r\n\tvar hexCross = 0x333333;\r\n\r\n\t// near\r\n\r\n\taddLine( \"n1\", \"n2\", hexFrustum );\r\n\taddLine( \"n2\", \"n4\", hexFrustum );\r\n\taddLine( \"n4\", \"n3\", hexFrustum );\r\n\taddLine( \"n3\", \"n1\", hexFrustum );\r\n\r\n\t// far\r\n\r\n\taddLine( \"f1\", \"f2\", hexFrustum );\r\n\taddLine( \"f2\", \"f4\", hexFrustum );\r\n\taddLine( \"f4\", \"f3\", hexFrustum );\r\n\taddLine( \"f3\", \"f1\", hexFrustum );\r\n\r\n\t// sides\r\n\r\n\taddLine( \"n1\", \"f1\", hexFrustum );\r\n\taddLine( \"n2\", \"f2\", hexFrustum );\r\n\taddLine( \"n3\", \"f3\", hexFrustum );\r\n\taddLine( \"n4\", \"f4\", hexFrustum );\r\n\r\n\t// cone\r\n\r\n\taddLine( \"p\", \"n1\", hexCone );\r\n\taddLine( \"p\", \"n2\", hexCone );\r\n\taddLine( \"p\", \"n3\", hexCone );\r\n\taddLine( \"p\", \"n4\", hexCone );\r\n\r\n\t// up\r\n\r\n\taddLine( \"u1\", \"u2\", hexUp );\r\n\taddLine( \"u2\", \"u3\", hexUp );\r\n\taddLine( \"u3\", \"u1\", hexUp );\r\n\r\n\t// target\r\n\r\n\taddLine( \"c\", \"t\", hexTarget );\r\n\taddLine( \"p\", \"c\", hexCross );\r\n\r\n\t// cross\r\n\r\n\taddLine( \"cn1\", \"cn2\", hexCross );\r\n\taddLine( \"cn3\", \"cn4\", hexCross );\r\n\r\n\taddLine( \"cf1\", \"cf2\", hexCross );\r\n\taddLine( \"cf3\", \"cf4\", hexCross );\r\n\r\n\tfunction addLine( a, b, hex ) {\r\n\r\n\t\taddPoint( a, hex );\r\n\t\taddPoint( b, hex );\r\n\r\n\t}\r\n\r\n\tfunction addPoint( id, hex ) {\r\n\r\n\t\tgeometry.vertices.push( new THREE.Vector3() );\r\n\t\tgeometry.colors.push( new THREE.Color( hex ) );\r\n\r\n\t\tif ( pointMap[ id ] === undefined ) {\r\n\r\n\t\t\tpointMap[ id ] = [];\r\n\r\n\t\t}\r\n\r\n\t\tpointMap[ id ].push( geometry.vertices.length - 1 );\r\n\r\n\t}\r\n\r\n\tTHREE.LineSegments.call( this, geometry, material );\r\n\r\n\tthis.camera = camera;\r\n\tthis.camera.updateProjectionMatrix();\r\n\r\n\tthis.matrix = camera.matrixWorld;\r\n\tthis.matrixAutoUpdate = false;\r\n\r\n\tthis.pointMap = pointMap;\r\n\r\n\tthis.update();\r\n\r\n};\r\n\r\nTHREE.CameraHelper.prototype = Object.create( THREE.LineSegments.prototype );\r\nTHREE.CameraHelper.prototype.constructor = THREE.CameraHelper;\r\n\r\nTHREE.CameraHelper.prototype.update = function () {\r\n\r\n\tvar geometry, pointMap;\r\n\r\n\tvar vector = new THREE.Vector3();\r\n\tvar camera = new THREE.Camera();\r\n\r\n\tfunction setPoint( point, x, y, z ) {\r\n\r\n\t\tvector.set( x, y, z ).unproject( camera );\r\n\r\n\t\tvar points = pointMap[ point ];\r\n\r\n\t\tif ( points !== undefined ) {\r\n\r\n\t\t\tfor ( var i = 0, il = points.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tgeometry.vertices[ points[ i ] ].copy( vector );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\treturn function () {\r\n\r\n\t\tgeometry = this.geometry;\r\n\t\tpointMap = this.pointMap;\r\n\r\n\t\tvar w = 1, h = 1;\r\n\r\n\t\t// we need just camera projection matrix\r\n\t\t// world matrix must be identity\r\n\r\n\t\tcamera.projectionMatrix.copy( this.camera.projectionMatrix );\r\n\r\n\t\t// center / target\r\n\r\n\t\tsetPoint( \"c\", 0, 0, - 1 );\r\n\t\tsetPoint( \"t\", 0, 0,  1 );\r\n\r\n\t\t// near\r\n\r\n\t\tsetPoint( \"n1\", - w, - h, - 1 );\r\n\t\tsetPoint( \"n2\",   w, - h, - 1 );\r\n\t\tsetPoint( \"n3\", - w,   h, - 1 );\r\n\t\tsetPoint( \"n4\",   w,   h, - 1 );\r\n\r\n\t\t// far\r\n\r\n\t\tsetPoint( \"f1\", - w, - h, 1 );\r\n\t\tsetPoint( \"f2\",   w, - h, 1 );\r\n\t\tsetPoint( \"f3\", - w,   h, 1 );\r\n\t\tsetPoint( \"f4\",   w,   h, 1 );\r\n\r\n\t\t// up\r\n\r\n\t\tsetPoint( \"u1\",   w * 0.7, h * 1.1, - 1 );\r\n\t\tsetPoint( \"u2\", - w * 0.7, h * 1.1, - 1 );\r\n\t\tsetPoint( \"u3\",         0, h * 2,   - 1 );\r\n\r\n\t\t// cross\r\n\r\n\t\tsetPoint( \"cf1\", - w,   0, 1 );\r\n\t\tsetPoint( \"cf2\",   w,   0, 1 );\r\n\t\tsetPoint( \"cf3\",   0, - h, 1 );\r\n\t\tsetPoint( \"cf4\",   0,   h, 1 );\r\n\r\n\t\tsetPoint( \"cn1\", - w,   0, - 1 );\r\n\t\tsetPoint( \"cn2\",   w,   0, - 1 );\r\n\t\tsetPoint( \"cn3\",   0, - h, - 1 );\r\n\t\tsetPoint( \"cn4\",   0,   h, - 1 );\r\n\r\n\t\tgeometry.verticesNeedUpdate = true;\r\n\r\n\t};\r\n\r\n}();\r\n\r\n// File:src/extras/helpers/DirectionalLightHelper.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nTHREE.DirectionalLightHelper = function ( light, size ) {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.light = light;\r\n\tthis.light.updateMatrixWorld();\r\n\r\n\tthis.matrix = light.matrixWorld;\r\n\tthis.matrixAutoUpdate = false;\r\n\r\n\tif ( size === undefined ) size = 1;\r\n\r\n\tvar geometry = new THREE.BufferGeometry();\r\n\tgeometry.addAttribute( 'position', new THREE.Float32Attribute( [\r\n\t\t- size,   size, 0,\r\n\t\t  size,   size, 0,\r\n\t\t  size, - size, 0,\r\n\t\t- size, - size, 0,\r\n\t\t- size,   size, 0\r\n\t], 3 ) );\r\n\r\n\tvar material = new THREE.LineBasicMaterial( { fog: false } );\r\n\r\n\tthis.add( new THREE.Line( geometry, material ) );\r\n\r\n\tgeometry = new THREE.BufferGeometry();\r\n\tgeometry.addAttribute( 'position', new THREE.Float32Attribute( [ 0, 0, 0, 0, 0, 1 ], 3 ) );\r\n\r\n\tthis.add( new THREE.Line( geometry, material ));\r\n\r\n\tthis.update();\r\n\r\n};\r\n\r\nTHREE.DirectionalLightHelper.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.DirectionalLightHelper.prototype.constructor = THREE.DirectionalLightHelper;\r\n\r\nTHREE.DirectionalLightHelper.prototype.dispose = function () {\r\n\r\n\tvar lightPlane = this.children[ 0 ];\r\n\tvar targetLine = this.children[ 1 ];\r\n\r\n\tlightPlane.geometry.dispose();\r\n\tlightPlane.material.dispose();\r\n\ttargetLine.geometry.dispose();\r\n\ttargetLine.material.dispose();\r\n\r\n};\r\n\r\nTHREE.DirectionalLightHelper.prototype.update = function () {\r\n\r\n\tvar v1 = new THREE.Vector3();\r\n\tvar v2 = new THREE.Vector3();\r\n\tvar v3 = new THREE.Vector3();\r\n\r\n\treturn function () {\r\n\r\n\t\tv1.setFromMatrixPosition( this.light.matrixWorld );\r\n\t\tv2.setFromMatrixPosition( this.light.target.matrixWorld );\r\n\t\tv3.subVectors( v2, v1 );\r\n\r\n\t\tvar lightPlane = this.children[ 0 ];\r\n\t\tvar targetLine = this.children[ 1 ];\r\n\r\n\t\tlightPlane.lookAt( v3 );\r\n\t\tlightPlane.material.color.copy( this.light.color ).multiplyScalar( this.light.intensity );\r\n\r\n\t\ttargetLine.lookAt( v3 );\r\n\t\ttargetLine.scale.z = v3.length();\r\n\r\n\t};\r\n\r\n}();\r\n\r\n// File:src/extras/helpers/EdgesHelper.js\r\n\r\n/**\r\n * @author WestLangley / http://github.com/WestLangley\r\n * @param object THREE.Mesh whose geometry will be used\r\n * @param hex line color\r\n * @param thresholdAngle the minimum angle (in degrees),\r\n * between the face normals of adjacent faces,\r\n * that is required to render an edge. A value of 10 means\r\n * an edge is only rendered if the angle is at least 10 degrees.\r\n */\r\n\r\nTHREE.EdgesHelper = function ( object, hex, thresholdAngle ) {\r\n\r\n\tvar color = ( hex !== undefined ) ? hex : 0xffffff;\r\n\r\n\tTHREE.LineSegments.call( this, new THREE.EdgesGeometry( object.geometry, thresholdAngle ), new THREE.LineBasicMaterial( { color: color } ) );\r\n\r\n\tthis.matrix = object.matrixWorld;\r\n\tthis.matrixAutoUpdate = false;\r\n\r\n};\r\n\r\nTHREE.EdgesHelper.prototype = Object.create( THREE.LineSegments.prototype );\r\nTHREE.EdgesHelper.prototype.constructor = THREE.EdgesHelper;\r\n\r\n// File:src/extras/helpers/FaceNormalsHelper.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n*/\r\n\r\nTHREE.FaceNormalsHelper = function ( object, size, hex, linewidth ) {\r\n\r\n\t// FaceNormalsHelper only supports THREE.Geometry\r\n\r\n\tthis.object = object;\r\n\r\n\tthis.size = ( size !== undefined ) ? size : 1;\r\n\r\n\tvar color = ( hex !== undefined ) ? hex : 0xffff00;\r\n\r\n\tvar width = ( linewidth !== undefined ) ? linewidth : 1;\r\n\r\n\t//\r\n\r\n\tvar nNormals = 0;\r\n\r\n\tvar objGeometry = this.object.geometry;\r\n\r\n\tif ( objGeometry instanceof THREE.Geometry ) {\r\n\r\n\t\tnNormals = objGeometry.faces.length;\r\n\r\n\t} else {\r\n\r\n\t\tconsole.warn( 'THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.' );\r\n\r\n\t}\r\n\r\n\t//\r\n\r\n\tvar geometry = new THREE.BufferGeometry();\r\n\r\n\tvar positions = new THREE.Float32Attribute( nNormals * 2 * 3, 3 );\r\n\r\n\tgeometry.addAttribute( 'position', positions );\r\n\r\n\tTHREE.LineSegments.call( this, geometry, new THREE.LineBasicMaterial( { color: color, linewidth: width } ) );\r\n\r\n\t//\r\n\r\n\tthis.matrixAutoUpdate = false;\r\n\tthis.update();\r\n\r\n};\r\n\r\nTHREE.FaceNormalsHelper.prototype = Object.create( THREE.LineSegments.prototype );\r\nTHREE.FaceNormalsHelper.prototype.constructor = THREE.FaceNormalsHelper;\r\n\r\nTHREE.FaceNormalsHelper.prototype.update = ( function () {\r\n\r\n\tvar v1 = new THREE.Vector3();\r\n\tvar v2 = new THREE.Vector3();\r\n\tvar normalMatrix = new THREE.Matrix3();\r\n\r\n\treturn function update() {\r\n\r\n\t\tthis.object.updateMatrixWorld( true );\r\n\r\n\t\tnormalMatrix.getNormalMatrix( this.object.matrixWorld );\r\n\r\n\t\tvar matrixWorld = this.object.matrixWorld;\r\n\r\n\t\tvar position = this.geometry.attributes.position;\r\n\r\n\t\t//\r\n\r\n\t\tvar objGeometry = this.object.geometry;\r\n\r\n\t\tvar vertices = objGeometry.vertices;\r\n\r\n\t\tvar faces = objGeometry.faces;\r\n\r\n\t\tvar idx = 0;\r\n\r\n\t\tfor ( var i = 0, l = faces.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar face = faces[ i ];\r\n\r\n\t\t\tvar normal = face.normal;\r\n\r\n\t\t\tv1.copy( vertices[ face.a ] )\r\n\t\t\t\t.add( vertices[ face.b ] )\r\n\t\t\t\t.add( vertices[ face.c ] )\r\n\t\t\t\t.divideScalar( 3 )\r\n\t\t\t\t.applyMatrix4( matrixWorld );\r\n\r\n\t\t\tv2.copy( normal ).applyMatrix3( normalMatrix ).normalize().multiplyScalar( this.size ).add( v1 );\r\n\r\n\t\t\tposition.setXYZ( idx, v1.x, v1.y, v1.z );\r\n\r\n\t\t\tidx = idx + 1;\r\n\r\n\t\t\tposition.setXYZ( idx, v2.x, v2.y, v2.z );\r\n\r\n\t\t\tidx = idx + 1;\r\n\r\n\t\t}\r\n\r\n\t\tposition.needsUpdate = true;\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n}() );\r\n\r\n// File:src/extras/helpers/GridHelper.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.GridHelper = function ( size, step, color1, color2 ) {\r\n\r\n\tcolor1 = new THREE.Color( color1 !== undefined ? color1 : 0x444444 );\r\n\tcolor2 = new THREE.Color( color2 !== undefined ? color2 : 0x888888 );\r\n\r\n\tvar vertices = [];\r\n\tvar colors = [];\r\n\r\n\tfor ( var i = - size, j = 0; i <= size; i += step ) {\r\n\r\n\t\tvertices.push( - size, 0, i, size, 0, i );\r\n\t\tvertices.push( i, 0, - size, i, 0, size );\r\n\r\n\t\tvar color = i === 0 ? color1 : color2;\r\n\r\n\t\tcolor.toArray( colors, j ); j += 3;\r\n\t\tcolor.toArray( colors, j ); j += 3;\r\n\t\tcolor.toArray( colors, j ); j += 3;\r\n\t\tcolor.toArray( colors, j ); j += 3;\r\n\r\n\t}\r\n\r\n\tvar geometry = new THREE.BufferGeometry();\r\n\tgeometry.addAttribute( 'position', new THREE.Float32Attribute( vertices, 3 ) );\r\n\tgeometry.addAttribute( 'color', new THREE.Float32Attribute( colors, 3 ) );\r\n\r\n\tvar material = new THREE.LineBasicMaterial( { vertexColors: THREE.VertexColors } );\r\n\r\n\tTHREE.LineSegments.call( this, geometry, material );\r\n\r\n};\r\n\r\nTHREE.GridHelper.prototype = Object.create( THREE.LineSegments.prototype );\r\nTHREE.GridHelper.prototype.constructor = THREE.GridHelper;\r\n\r\nTHREE.GridHelper.prototype.setColors = function () {\r\n\r\n\tconsole.error( 'THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.' );\r\n\r\n};\r\n\r\n// File:src/extras/helpers/HemisphereLightHelper.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.HemisphereLightHelper = function ( light, sphereSize ) {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.light = light;\r\n\tthis.light.updateMatrixWorld();\r\n\r\n\tthis.matrix = light.matrixWorld;\r\n\tthis.matrixAutoUpdate = false;\r\n\r\n\tthis.colors = [ new THREE.Color(), new THREE.Color() ];\r\n\r\n\tvar geometry = new THREE.SphereGeometry( sphereSize, 4, 2 );\r\n\tgeometry.rotateX( - Math.PI / 2 );\r\n\r\n\tfor ( var i = 0, il = 8; i < il; i ++ ) {\r\n\r\n\t\tgeometry.faces[ i ].color = this.colors[ i < 4 ? 0 : 1 ];\r\n\r\n\t}\r\n\r\n\tvar material = new THREE.MeshBasicMaterial( { vertexColors: THREE.FaceColors, wireframe: true } );\r\n\r\n\tthis.lightSphere = new THREE.Mesh( geometry, material );\r\n\tthis.add( this.lightSphere );\r\n\r\n\tthis.update();\r\n\r\n};\r\n\r\nTHREE.HemisphereLightHelper.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.HemisphereLightHelper.prototype.constructor = THREE.HemisphereLightHelper;\r\n\r\nTHREE.HemisphereLightHelper.prototype.dispose = function () {\r\n\r\n\tthis.lightSphere.geometry.dispose();\r\n\tthis.lightSphere.material.dispose();\r\n\r\n};\r\n\r\nTHREE.HemisphereLightHelper.prototype.update = function () {\r\n\r\n\tvar vector = new THREE.Vector3();\r\n\r\n\treturn function () {\r\n\r\n\t\tthis.colors[ 0 ].copy( this.light.color ).multiplyScalar( this.light.intensity );\r\n\t\tthis.colors[ 1 ].copy( this.light.groundColor ).multiplyScalar( this.light.intensity );\r\n\r\n\t\tthis.lightSphere.lookAt( vector.setFromMatrixPosition( this.light.matrixWorld ).negate() );\r\n\t\tthis.lightSphere.geometry.colorsNeedUpdate = true;\r\n\r\n\t};\r\n\r\n}();\r\n\r\n// File:src/extras/helpers/PointLightHelper.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.PointLightHelper = function ( light, sphereSize ) {\r\n\r\n\tthis.light = light;\r\n\tthis.light.updateMatrixWorld();\r\n\r\n\tvar geometry = new THREE.SphereBufferGeometry( sphereSize, 4, 2 );\r\n\tvar material = new THREE.MeshBasicMaterial( { wireframe: true, fog: false } );\r\n\tmaterial.color.copy( this.light.color ).multiplyScalar( this.light.intensity );\r\n\r\n\tTHREE.Mesh.call( this, geometry, material );\r\n\r\n\tthis.matrix = this.light.matrixWorld;\r\n\tthis.matrixAutoUpdate = false;\r\n\r\n\t/*\r\n\tvar distanceGeometry = new THREE.IcosahedronGeometry( 1, 2 );\r\n\tvar distanceMaterial = new THREE.MeshBasicMaterial( { color: hexColor, fog: false, wireframe: true, opacity: 0.1, transparent: true } );\r\n\r\n\tthis.lightSphere = new THREE.Mesh( bulbGeometry, bulbMaterial );\r\n\tthis.lightDistance = new THREE.Mesh( distanceGeometry, distanceMaterial );\r\n\r\n\tvar d = light.distance;\r\n\r\n\tif ( d === 0.0 ) {\r\n\r\n\t\tthis.lightDistance.visible = false;\r\n\r\n\t} else {\r\n\r\n\t\tthis.lightDistance.scale.set( d, d, d );\r\n\r\n\t}\r\n\r\n\tthis.add( this.lightDistance );\r\n\t*/\r\n\r\n};\r\n\r\nTHREE.PointLightHelper.prototype = Object.create( THREE.Mesh.prototype );\r\nTHREE.PointLightHelper.prototype.constructor = THREE.PointLightHelper;\r\n\r\nTHREE.PointLightHelper.prototype.dispose = function () {\r\n\r\n\tthis.geometry.dispose();\r\n\tthis.material.dispose();\r\n\r\n};\r\n\r\nTHREE.PointLightHelper.prototype.update = function () {\r\n\r\n\tthis.material.color.copy( this.light.color ).multiplyScalar( this.light.intensity );\r\n\r\n\t/*\r\n\tvar d = this.light.distance;\r\n\r\n\tif ( d === 0.0 ) {\r\n\r\n\t\tthis.lightDistance.visible = false;\r\n\r\n\t} else {\r\n\r\n\t\tthis.lightDistance.visible = true;\r\n\t\tthis.lightDistance.scale.set( d, d, d );\r\n\r\n\t}\r\n\t*/\r\n\r\n};\r\n\r\n// File:src/extras/helpers/SkeletonHelper.js\r\n\r\n/**\r\n * @author Sean Griffin / http://twitter.com/sgrif\r\n * @author Michael Guerrero / http://realitymeltdown.com\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author ikerr / http://verold.com\r\n */\r\n\r\nTHREE.SkeletonHelper = function ( object ) {\r\n\r\n\tthis.bones = this.getBoneList( object );\r\n\r\n\tvar geometry = new THREE.Geometry();\r\n\r\n\tfor ( var i = 0; i < this.bones.length; i ++ ) {\r\n\r\n\t\tvar bone = this.bones[ i ];\r\n\r\n\t\tif ( bone.parent instanceof THREE.Bone ) {\r\n\r\n\t\t\tgeometry.vertices.push( new THREE.Vector3() );\r\n\t\t\tgeometry.vertices.push( new THREE.Vector3() );\r\n\t\t\tgeometry.colors.push( new THREE.Color( 0, 0, 1 ) );\r\n\t\t\tgeometry.colors.push( new THREE.Color( 0, 1, 0 ) );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tgeometry.dynamic = true;\r\n\r\n\tvar material = new THREE.LineBasicMaterial( { vertexColors: THREE.VertexColors, depthTest: false, depthWrite: false, transparent: true } );\r\n\r\n\tTHREE.LineSegments.call( this, geometry, material );\r\n\r\n\tthis.root = object;\r\n\r\n\tthis.matrix = object.matrixWorld;\r\n\tthis.matrixAutoUpdate = false;\r\n\r\n\tthis.update();\r\n\r\n};\r\n\r\n\r\nTHREE.SkeletonHelper.prototype = Object.create( THREE.LineSegments.prototype );\r\nTHREE.SkeletonHelper.prototype.constructor = THREE.SkeletonHelper;\r\n\r\nTHREE.SkeletonHelper.prototype.getBoneList = function( object ) {\r\n\r\n\tvar boneList = [];\r\n\r\n\tif ( object instanceof THREE.Bone ) {\r\n\r\n\t\tboneList.push( object );\r\n\r\n\t}\r\n\r\n\tfor ( var i = 0; i < object.children.length; i ++ ) {\r\n\r\n\t\tboneList.push.apply( boneList, this.getBoneList( object.children[ i ] ) );\r\n\r\n\t}\r\n\r\n\treturn boneList;\r\n\r\n};\r\n\r\nTHREE.SkeletonHelper.prototype.update = function () {\r\n\r\n\tvar geometry = this.geometry;\r\n\r\n\tvar matrixWorldInv = new THREE.Matrix4().getInverse( this.root.matrixWorld );\r\n\r\n\tvar boneMatrix = new THREE.Matrix4();\r\n\r\n\tvar j = 0;\r\n\r\n\tfor ( var i = 0; i < this.bones.length; i ++ ) {\r\n\r\n\t\tvar bone = this.bones[ i ];\r\n\r\n\t\tif ( bone.parent instanceof THREE.Bone ) {\r\n\r\n\t\t\tboneMatrix.multiplyMatrices( matrixWorldInv, bone.matrixWorld );\r\n\t\t\tgeometry.vertices[ j ].setFromMatrixPosition( boneMatrix );\r\n\r\n\t\t\tboneMatrix.multiplyMatrices( matrixWorldInv, bone.parent.matrixWorld );\r\n\t\t\tgeometry.vertices[ j + 1 ].setFromMatrixPosition( boneMatrix );\r\n\r\n\t\t\tj += 2;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tgeometry.verticesNeedUpdate = true;\r\n\r\n\tgeometry.computeBoundingSphere();\r\n\r\n};\r\n\r\n// File:src/extras/helpers/SpotLightHelper.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n*/\r\n\r\nTHREE.SpotLightHelper = function ( light ) {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.light = light;\r\n\tthis.light.updateMatrixWorld();\r\n\r\n\tthis.matrix = light.matrixWorld;\r\n\tthis.matrixAutoUpdate = false;\r\n\r\n\tvar geometry = new THREE.BufferGeometry();\r\n\r\n\tvar positions = [\r\n\t\t0, 0, 0,   0,   0,   1,\r\n\t\t0, 0, 0,   1,   0,   1,\r\n\t\t0, 0, 0, - 1,   0,   1,\r\n\t\t0, 0, 0,   0,   1,   1,\r\n\t\t0, 0, 0,   0, - 1,   1\r\n\t];\r\n\r\n\tfor ( var i = 0, j = 1, l = 32; i < l; i ++, j ++ ) {\r\n\r\n\t\tvar p1 = ( i / l ) * Math.PI * 2;\r\n\t\tvar p2 = ( j / l ) * Math.PI * 2;\r\n\r\n\t\tpositions.push(\r\n\t\t\tMath.cos( p1 ), Math.sin( p1 ), 1,\r\n\t\t\tMath.cos( p2 ), Math.sin( p2 ), 1\r\n\t\t);\r\n\r\n\t}\r\n\r\n\tgeometry.addAttribute( 'position', new THREE.Float32Attribute( positions, 3 ) );\r\n\r\n\tvar material = new THREE.LineBasicMaterial( { fog: false } );\r\n\r\n\tthis.cone = new THREE.LineSegments( geometry, material );\r\n\tthis.add( this.cone );\r\n\r\n\tthis.update();\r\n\r\n};\r\n\r\nTHREE.SpotLightHelper.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.SpotLightHelper.prototype.constructor = THREE.SpotLightHelper;\r\n\r\nTHREE.SpotLightHelper.prototype.dispose = function () {\r\n\r\n\tthis.cone.geometry.dispose();\r\n\tthis.cone.material.dispose();\r\n\r\n};\r\n\r\nTHREE.SpotLightHelper.prototype.update = function () {\r\n\r\n\tvar vector = new THREE.Vector3();\r\n\tvar vector2 = new THREE.Vector3();\r\n\r\n\treturn function () {\r\n\r\n\t\tvar coneLength = this.light.distance ? this.light.distance : 1000;\r\n\t\tvar coneWidth = coneLength * Math.tan( this.light.angle );\r\n\r\n\t\tthis.cone.scale.set( coneWidth, coneWidth, coneLength );\r\n\r\n\t\tvector.setFromMatrixPosition( this.light.matrixWorld );\r\n\t\tvector2.setFromMatrixPosition( this.light.target.matrixWorld );\r\n\r\n\t\tthis.cone.lookAt( vector2.sub( vector ) );\r\n\r\n\t\tthis.cone.material.color.copy( this.light.color ).multiplyScalar( this.light.intensity );\r\n\r\n\t};\r\n\r\n}();\r\n\r\n// File:src/extras/helpers/VertexNormalsHelper.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n*/\r\n\r\nTHREE.VertexNormalsHelper = function ( object, size, hex, linewidth ) {\r\n\r\n\tthis.object = object;\r\n\r\n\tthis.size = ( size !== undefined ) ? size : 1;\r\n\r\n\tvar color = ( hex !== undefined ) ? hex : 0xff0000;\r\n\r\n\tvar width = ( linewidth !== undefined ) ? linewidth : 1;\r\n\r\n\t//\r\n\r\n\tvar nNormals = 0;\r\n\r\n\tvar objGeometry = this.object.geometry;\r\n\r\n\tif ( objGeometry instanceof THREE.Geometry ) {\r\n\r\n\t\tnNormals = objGeometry.faces.length * 3;\r\n\r\n\t} else if ( objGeometry instanceof THREE.BufferGeometry ) {\r\n\r\n\t\tnNormals = objGeometry.attributes.normal.count;\r\n\r\n\t}\r\n\r\n\t//\r\n\r\n\tvar geometry = new THREE.BufferGeometry();\r\n\r\n\tvar positions = new THREE.Float32Attribute( nNormals * 2 * 3, 3 );\r\n\r\n\tgeometry.addAttribute( 'position', positions );\r\n\r\n\tTHREE.LineSegments.call( this, geometry, new THREE.LineBasicMaterial( { color: color, linewidth: width } ) );\r\n\r\n\t//\r\n\r\n\tthis.matrixAutoUpdate = false;\r\n\r\n\tthis.update();\r\n\r\n};\r\n\r\nTHREE.VertexNormalsHelper.prototype = Object.create( THREE.LineSegments.prototype );\r\nTHREE.VertexNormalsHelper.prototype.constructor = THREE.VertexNormalsHelper;\r\n\r\nTHREE.VertexNormalsHelper.prototype.update = ( function () {\r\n\r\n\tvar v1 = new THREE.Vector3();\r\n\tvar v2 = new THREE.Vector3();\r\n\tvar normalMatrix = new THREE.Matrix3();\r\n\r\n\treturn function update() {\r\n\r\n\t\tvar keys = [ 'a', 'b', 'c' ];\r\n\r\n\t\tthis.object.updateMatrixWorld( true );\r\n\r\n\t\tnormalMatrix.getNormalMatrix( this.object.matrixWorld );\r\n\r\n\t\tvar matrixWorld = this.object.matrixWorld;\r\n\r\n\t\tvar position = this.geometry.attributes.position;\r\n\r\n\t\t//\r\n\r\n\t\tvar objGeometry = this.object.geometry;\r\n\r\n\t\tif ( objGeometry instanceof THREE.Geometry ) {\r\n\r\n\t\t\tvar vertices = objGeometry.vertices;\r\n\r\n\t\t\tvar faces = objGeometry.faces;\r\n\r\n\t\t\tvar idx = 0;\r\n\r\n\t\t\tfor ( var i = 0, l = faces.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar face = faces[ i ];\r\n\r\n\t\t\t\tfor ( var j = 0, jl = face.vertexNormals.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\t\tvar vertex = vertices[ face[ keys[ j ] ] ];\r\n\r\n\t\t\t\t\tvar normal = face.vertexNormals[ j ];\r\n\r\n\t\t\t\t\tv1.copy( vertex ).applyMatrix4( matrixWorld );\r\n\r\n\t\t\t\t\tv2.copy( normal ).applyMatrix3( normalMatrix ).normalize().multiplyScalar( this.size ).add( v1 );\r\n\r\n\t\t\t\t\tposition.setXYZ( idx, v1.x, v1.y, v1.z );\r\n\r\n\t\t\t\t\tidx = idx + 1;\r\n\r\n\t\t\t\t\tposition.setXYZ( idx, v2.x, v2.y, v2.z );\r\n\r\n\t\t\t\t\tidx = idx + 1;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( objGeometry instanceof THREE.BufferGeometry ) {\r\n\r\n\t\t\tvar objPos = objGeometry.attributes.position;\r\n\r\n\t\t\tvar objNorm = objGeometry.attributes.normal;\r\n\r\n\t\t\tvar idx = 0;\r\n\r\n\t\t\t// for simplicity, ignore index and drawcalls, and render every normal\r\n\r\n\t\t\tfor ( var j = 0, jl = objPos.count; j < jl; j ++ ) {\r\n\r\n\t\t\t\tv1.set( objPos.getX( j ), objPos.getY( j ), objPos.getZ( j ) ).applyMatrix4( matrixWorld );\r\n\r\n\t\t\t\tv2.set( objNorm.getX( j ), objNorm.getY( j ), objNorm.getZ( j ) );\r\n\r\n\t\t\t\tv2.applyMatrix3( normalMatrix ).normalize().multiplyScalar( this.size ).add( v1 );\r\n\r\n\t\t\t\tposition.setXYZ( idx, v1.x, v1.y, v1.z );\r\n\r\n\t\t\t\tidx = idx + 1;\r\n\r\n\t\t\t\tposition.setXYZ( idx, v2.x, v2.y, v2.z );\r\n\r\n\t\t\t\tidx = idx + 1;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tposition.needsUpdate = true;\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n}() );\r\n\r\n// File:src/extras/helpers/WireframeHelper.js\r\n\r\n/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\nTHREE.WireframeHelper = function ( object, hex ) {\r\n\r\n\tvar color = ( hex !== undefined ) ? hex : 0xffffff;\r\n\r\n\tTHREE.LineSegments.call( this, new THREE.WireframeGeometry( object.geometry ), new THREE.LineBasicMaterial( { color: color } ) );\r\n\r\n\tthis.matrix = object.matrixWorld;\r\n\tthis.matrixAutoUpdate = false;\r\n\r\n};\r\n\r\nTHREE.WireframeHelper.prototype = Object.create( THREE.LineSegments.prototype );\r\nTHREE.WireframeHelper.prototype.constructor = THREE.WireframeHelper;\r\n\r\n// File:src/extras/objects/ImmediateRenderObject.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.ImmediateRenderObject = function ( material ) {\r\n\r\n\tTHREE.Object3D.call( this );\r\n\r\n\tthis.material = material;\r\n\tthis.render = function ( renderCallback ) {};\r\n\r\n};\r\n\r\nTHREE.ImmediateRenderObject.prototype = Object.create( THREE.Object3D.prototype );\r\nTHREE.ImmediateRenderObject.prototype.constructor = THREE.ImmediateRenderObject;\r\n\r\n// File:src/extras/objects/MorphBlendMesh.js\r\n\r\n/**\r\n * @author alteredq / http://alteredqualia.com/\r\n */\r\n\r\nTHREE.MorphBlendMesh = function( geometry, material ) {\r\n\r\n\tTHREE.Mesh.call( this, geometry, material );\r\n\r\n\tthis.animationsMap = {};\r\n\tthis.animationsList = [];\r\n\r\n\t// prepare default animation\r\n\t// (all frames played together in 1 second)\r\n\r\n\tvar numFrames = this.geometry.morphTargets.length;\r\n\r\n\tvar name = \"__default\";\r\n\r\n\tvar startFrame = 0;\r\n\tvar endFrame = numFrames - 1;\r\n\r\n\tvar fps = numFrames / 1;\r\n\r\n\tthis.createAnimation( name, startFrame, endFrame, fps );\r\n\tthis.setAnimationWeight( name, 1 );\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype = Object.create( THREE.Mesh.prototype );\r\nTHREE.MorphBlendMesh.prototype.constructor = THREE.MorphBlendMesh;\r\n\r\nTHREE.MorphBlendMesh.prototype.createAnimation = function ( name, start, end, fps ) {\r\n\r\n\tvar animation = {\r\n\r\n\t\tstart: start,\r\n\t\tend: end,\r\n\r\n\t\tlength: end - start + 1,\r\n\r\n\t\tfps: fps,\r\n\t\tduration: ( end - start ) / fps,\r\n\r\n\t\tlastFrame: 0,\r\n\t\tcurrentFrame: 0,\r\n\r\n\t\tactive: false,\r\n\r\n\t\ttime: 0,\r\n\t\tdirection: 1,\r\n\t\tweight: 1,\r\n\r\n\t\tdirectionBackwards: false,\r\n\t\tmirroredLoop: false\r\n\r\n\t};\r\n\r\n\tthis.animationsMap[ name ] = animation;\r\n\tthis.animationsList.push( animation );\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.autoCreateAnimations = function ( fps ) {\r\n\r\n\tvar pattern = /([a-z]+)_?(\\d+)/i;\r\n\r\n\tvar firstAnimation, frameRanges = {};\r\n\r\n\tvar geometry = this.geometry;\r\n\r\n\tfor ( var i = 0, il = geometry.morphTargets.length; i < il; i ++ ) {\r\n\r\n\t\tvar morph = geometry.morphTargets[ i ];\r\n\t\tvar chunks = morph.name.match( pattern );\r\n\r\n\t\tif ( chunks && chunks.length > 1 ) {\r\n\r\n\t\t\tvar name = chunks[ 1 ];\r\n\r\n\t\t\tif ( ! frameRanges[ name ] ) frameRanges[ name ] = { start: Infinity, end: - Infinity };\r\n\r\n\t\t\tvar range = frameRanges[ name ];\r\n\r\n\t\t\tif ( i < range.start ) range.start = i;\r\n\t\t\tif ( i > range.end ) range.end = i;\r\n\r\n\t\t\tif ( ! firstAnimation ) firstAnimation = name;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfor ( var name in frameRanges ) {\r\n\r\n\t\tvar range = frameRanges[ name ];\r\n\t\tthis.createAnimation( name, range.start, range.end, fps );\r\n\r\n\t}\r\n\r\n\tthis.firstAnimation = firstAnimation;\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.setAnimationDirectionForward = function ( name ) {\r\n\r\n\tvar animation = this.animationsMap[ name ];\r\n\r\n\tif ( animation ) {\r\n\r\n\t\tanimation.direction = 1;\r\n\t\tanimation.directionBackwards = false;\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.setAnimationDirectionBackward = function ( name ) {\r\n\r\n\tvar animation = this.animationsMap[ name ];\r\n\r\n\tif ( animation ) {\r\n\r\n\t\tanimation.direction = - 1;\r\n\t\tanimation.directionBackwards = true;\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.setAnimationFPS = function ( name, fps ) {\r\n\r\n\tvar animation = this.animationsMap[ name ];\r\n\r\n\tif ( animation ) {\r\n\r\n\t\tanimation.fps = fps;\r\n\t\tanimation.duration = ( animation.end - animation.start ) / animation.fps;\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.setAnimationDuration = function ( name, duration ) {\r\n\r\n\tvar animation = this.animationsMap[ name ];\r\n\r\n\tif ( animation ) {\r\n\r\n\t\tanimation.duration = duration;\r\n\t\tanimation.fps = ( animation.end - animation.start ) / animation.duration;\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.setAnimationWeight = function ( name, weight ) {\r\n\r\n\tvar animation = this.animationsMap[ name ];\r\n\r\n\tif ( animation ) {\r\n\r\n\t\tanimation.weight = weight;\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.setAnimationTime = function ( name, time ) {\r\n\r\n\tvar animation = this.animationsMap[ name ];\r\n\r\n\tif ( animation ) {\r\n\r\n\t\tanimation.time = time;\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.getAnimationTime = function ( name ) {\r\n\r\n\tvar time = 0;\r\n\r\n\tvar animation = this.animationsMap[ name ];\r\n\r\n\tif ( animation ) {\r\n\r\n\t\ttime = animation.time;\r\n\r\n\t}\r\n\r\n\treturn time;\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.getAnimationDuration = function ( name ) {\r\n\r\n\tvar duration = - 1;\r\n\r\n\tvar animation = this.animationsMap[ name ];\r\n\r\n\tif ( animation ) {\r\n\r\n\t\tduration = animation.duration;\r\n\r\n\t}\r\n\r\n\treturn duration;\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.playAnimation = function ( name ) {\r\n\r\n\tvar animation = this.animationsMap[ name ];\r\n\r\n\tif ( animation ) {\r\n\r\n\t\tanimation.time = 0;\r\n\t\tanimation.active = true;\r\n\r\n\t} else {\r\n\r\n\t\tconsole.warn( \"THREE.MorphBlendMesh: animation[\" + name + \"] undefined in .playAnimation()\" );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.stopAnimation = function ( name ) {\r\n\r\n\tvar animation = this.animationsMap[ name ];\r\n\r\n\tif ( animation ) {\r\n\r\n\t\tanimation.active = false;\r\n\r\n\t}\r\n\r\n};\r\n\r\nTHREE.MorphBlendMesh.prototype.update = function ( delta ) {\r\n\r\n\tfor ( var i = 0, il = this.animationsList.length; i < il; i ++ ) {\r\n\r\n\t\tvar animation = this.animationsList[ i ];\r\n\r\n\t\tif ( ! animation.active ) continue;\r\n\r\n\t\tvar frameTime = animation.duration / animation.length;\r\n\r\n\t\tanimation.time += animation.direction * delta;\r\n\r\n\t\tif ( animation.mirroredLoop ) {\r\n\r\n\t\t\tif ( animation.time > animation.duration || animation.time < 0 ) {\r\n\r\n\t\t\t\tanimation.direction *= - 1;\r\n\r\n\t\t\t\tif ( animation.time > animation.duration ) {\r\n\r\n\t\t\t\t\tanimation.time = animation.duration;\r\n\t\t\t\t\tanimation.directionBackwards = true;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( animation.time < 0 ) {\r\n\r\n\t\t\t\t\tanimation.time = 0;\r\n\t\t\t\t\tanimation.directionBackwards = false;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tanimation.time = animation.time % animation.duration;\r\n\r\n\t\t\tif ( animation.time < 0 ) animation.time += animation.duration;\r\n\r\n\t\t}\r\n\r\n\t\tvar keyframe = animation.start + THREE.Math.clamp( Math.floor( animation.time / frameTime ), 0, animation.length - 1 );\r\n\t\tvar weight = animation.weight;\r\n\r\n\t\tif ( keyframe !== animation.currentFrame ) {\r\n\r\n\t\t\tthis.morphTargetInfluences[ animation.lastFrame ] = 0;\r\n\t\t\tthis.morphTargetInfluences[ animation.currentFrame ] = 1 * weight;\r\n\r\n\t\t\tthis.morphTargetInfluences[ keyframe ] = 0;\r\n\r\n\t\t\tanimation.lastFrame = animation.currentFrame;\r\n\t\t\tanimation.currentFrame = keyframe;\r\n\r\n\t\t}\r\n\r\n\t\tvar mix = ( animation.time % frameTime ) / frameTime;\r\n\r\n\t\tif ( animation.directionBackwards ) mix = 1 - mix;\r\n\r\n\t\tif ( animation.currentFrame !== animation.lastFrame ) {\r\n\r\n\t\t\tthis.morphTargetInfluences[ animation.currentFrame ] = mix * weight;\r\n\t\t\tthis.morphTargetInfluences[ animation.lastFrame ] = ( 1 - mix ) * weight;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.morphTargetInfluences[ animation.currentFrame ] = weight;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\n\r\n// Export the THREE object for **Node.js**, with\r\n// backwards-compatibility for the old `require()` API. If we're in\r\n// the browser, add `_` as a global object via a string identifier,\r\n// for Closure Compiler \"advanced\" mode.\r\nif (typeof exports !== 'undefined') {\r\n  if (typeof module !== 'undefined' && module.exports) {\r\n    exports = module.exports = THREE;\r\n  }\r\n  exports.THREE = THREE;\r\n} else {\r\n  this['THREE'] = THREE;\r\n}\r\n"],"sourceRoot":""}